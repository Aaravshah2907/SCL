<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Handle COM Data in MATLAB</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../external-language-interfaces.html",
          "name": "External Language Interfaces"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../com-languages.html",
          "name": "COM with MATLAB"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../using-com-objects-in-matlab.html",
          "name": "Use COM Objects in MATLAB"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "using-com-objects-in-matlab"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "UISupport",
          "value": "Desktop"

        }</script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="con">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="con">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="Pass data to and handle data from a COM object."><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../external-language-interfaces.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">External Language Interfaces</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../com-languages.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">COM with MATLAB</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../using-com-objects-in-matlab.html?s_tid=CRUX_lftnav" itemprop="url" id="mw_6536c792-c14b-4404-b936-0b216ccdcafb"><span itemprop="title">Use COM Objects in MATLAB</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item"><a href="#responsive_offcanvas">Handle COM Data in MATLAB</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#bq4jkuh" class="nav-link intrnllnk">Pass Data to COM Objects</a><ul class="nav"><li class="nav-item"><a href="#bq4sbxq-1" class="nav-link intrnllnk">Variant Data</a></li><li class="nav-item"><a href="#bq4sbxq-2" class="nav-link intrnllnk">SAFEARRAY Data</a></li></ul></li><li class="nav-item"><a href="#bq4sbv3-1" class="nav-link intrnllnk">Handle Data from COM Objects</a></li><li class="nav-item"><a href="#bq4epvg-5" class="nav-link intrnllnk">Unsupported Types</a></li><li class="nav-item"><a href="#bq552_r" class="nav-link intrnllnk">Pass MATLAB SAFEARRAY to COM Object</a><ul class="nav"><li class="nav-item"><a href="#bq553k4" class="nav-link intrnllnk">Default Behavior in MATLAB</a></li><li class="nav-item"><a href="#bq553k_" class="nav-link intrnllnk">Examples</a></li><li class="nav-item"><a href="#bq553lb" class="nav-link intrnllnk">Pass Single-Dimension SAFEARRAY</a></li><li class="nav-item"><a href="#brc5jeu-1" class="nav-link intrnllnk">Pass SAFEARRAY by Reference</a></li></ul></li><li class="nav-item"><a href="#bq552_v" class="nav-link intrnllnk">Read SAFEARRAY from COM Objects in MATLAB Applications</a></li><li class="nav-item"><a href="#bq9byb0-1" class="nav-link intrnllnk">Display MATLAB Syntax for COM Objects</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=using-com-objects-in-matlab&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=using-com-objects-in-matlab&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=using-com-objects-in-matlab&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=using-com-objects-in-matlab&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=using-com-objects-in-matlab&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=using-com-objects-in-matlab&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-topic">
<section><h2 class="title r2025b" itemprop="title content" id="bq4epvg-1">Handle COM Data in <span class="trademark entity">MATLAB</span></h2><span id="data_conversion" class="anchor_target"></span><section><h3 class="title" id="bq4jkuh">Pass Data to COM Objects</h3><p>When you use a COM object in a MATLAB<sup>&#x00AE;</sup> command, the MATLAB types you pass in the call are converted to types native to the COM
                object. MATLAB performs this conversion on each argument that is passed. This section
                describes the conversion.</p><p>MATLAB converts MATLAB arguments into types that best represent the data to the COM object.
                The following table shows all the MATLAB base types for passed arguments and the COM types defined for input
                arguments. Each row shows a MATLAB type followed by the possible COM argument matches. For a description
                of COM variant types, see the table in <a href="handling-com-data-in-matlab-software.html#bq4sbv3-1" class="intrnllnk">Handle Data from COM Objects</a>.</p><div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="33%"><col class="tcol2" width="33%"><col class="tcol3" width="33%"></colgroup><thead><tr><th>MATLAB Argument</th><th>Closest COM Type</th><th>Allowed Types</th></tr></thead><tbody><tr><td>handle</td><td><code class="literal">VT_DISPATCH</code><br/>
<code class="literal">VT_UNKNOWN</code></td><td><code class="literal">VT_DISPATCH</code><br/>
<code class="literal">VT_UNKNOWN</code></td></tr><tr><td>character vector</td><td>
                                <code class="literal">VT_BSTR</code></td><td><code class="literal">VT_LPWSTR</code><br/>
<code class="literal">VT_LPSTR</code><br/>
<code class="literal">VT_BSTR</code><br/>
<code class="literal">VT_FILETIME</code><br/>
<code class="literal">VT_ERROR</code><br/>
<code class="literal">VT_DECIMAL</code><br/>
<code class="literal">VT_CLSID</code><br/>
<code class="literal">VT_DATE</code></td></tr><tr><td><code class="literal">int16</code></td><td>
                                <code class="literal">VT_I2</code></td><td><code class="literal">VT_I2</code></td></tr><tr><td><code class="literal">uint16</code></td><td><code class="literal">VT_UI2</code></td><td><code class="literal">VT_UI2</code></td></tr><tr><td><code class="literal">int32</code></td><td><code class="literal">VT_I4</code></td><td><code class="literal">VT_I4</code><br/>
<code class="literal">VT_INT</code></td></tr><tr><td><code class="literal">uint32</code></td><td><code class="literal">VT_UI4</code></td><td><code class="literal">VT_UI4</code><br/>
<code class="literal">VT_UINT</code></td></tr><tr><td><code class="literal">int64</code></td><td><code class="literal">VT_I8</code></td><td><code class="literal">VT_I8</code></td></tr><tr><td><code class="literal">uint64</code></td><td><code class="literal">VT_UI8</code></td><td><code class="literal">VT_UI8</code></td></tr><tr><td><code class="literal">single</code></td><td><code class="literal">VT_R4</code></td><td><code class="literal">VT_R4</code></td></tr><tr><td><code class="literal">double</code></td><td>
                                <code class="literal">VT_R8</code></td><td><code class="literal">VT_R8</code><br/>
<code class="literal">VT_CY</code>
                            </td></tr><tr><td><code class="literal">logical</code></td><td><code class="literal">VT_BOOL</code>
                            </td><td><code class="literal">VT_BOOL</code></td></tr><tr><td>char</td><td>
                                <code class="literal">VT_I1</code></td><td><code class="literal">VT_I1</code><br/>
<code class="literal">VT_UI1</code></td></tr></tbody></table></div><section><h4 class="title" id="bq4sbxq-1">Variant Data</h4><p><code class="literal">variant</code> is any data type except a structure or a sparse
                    array. (For more information, see <a href="../matlab_prog/fundamental-matlab-classes.html" class="a">Fundamental MATLAB Classes</a>.)</p><p>When used as an input argument, MATLAB treats <code class="literal">variant</code> and
                    <code class="literal">variant</code>(pointer) the same way.</p><p>If you pass an empty array (<code class="literal">[]</code>) of type
                        <code class="literal">double</code>, MATLAB creates a <code class="literal">variant</code>(pointer) set to
                        <code class="literal">VT_EMPTY</code>. Passing an empty array of any other numeric
                    type is not supported.</p><div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="33%"><col class="tcol2" width="33%"><col class="tcol3" width="33%"></colgroup><thead><tr><th>MATLAB Argument</th><th>Closest COM Type</th><th>Allowed Types</th></tr></thead><tbody><tr><td><code class="literal">variant</code></td><td>
                                    <code class="literal">VT_VARIANT</code></td><td><code class="literal">VT_VARIANT</code><br/>
<code class="literal">VT_USERDEFINED</code><br/>
<code class="literal">VT_ARRAY</code></td></tr><tr><td><code class="literal">variant</code>(pointer)</td><td><code class="literal">VT_VARIANT</code></td><td><code class="literal">VT_VARIANT</code> |
                                    <code class="literal">VT_BYREF</code></td></tr></tbody></table></div></section><section><h4 class="title" id="bq4sbxq-2">SAFEARRAY Data</h4><p>When a COM method identifies a <code class="literal">SAFEARRAY</code> or
                        <code class="literal">SAFEARRAY</code>(pointer), the MATLAB equivalent is a matrix.</p><div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="33%"><col class="tcol2" width="33%"><col class="tcol3" width="33%"></colgroup><thead><tr><th>MATLAB Argument</th><th>Closest COM Type</th><th>Allowed Types</th></tr></thead><tbody><tr><td><code class="literal">SAFEARRAY</code></td><td><code class="literal">VT_SAFEARRAY</code></td><td><code class="literal">VT_SAFEARRAY</code></td></tr><tr><td><code class="literal">SAFEARRAY</code>(pointer)</td><td>
                                    <code class="literal">VT_SAFEARRAY</code></td><td><code class="literal">VT_SAFEARRAY</code> |
                                    <code class="literal">VT_BYREF</code></td></tr></tbody></table></div></section></section><section><h3 class="title" id="bq4sbv3-1">Handle Data from COM Objects</h3><p>Data returned from a COM object is often
                incompatible with MATLAB types. When this occurs, MATLAB converts the returned value to a data type native to the MATLAB language. This section describes the conversion performed on the
                various types that can be returned from COM objects.</p><p>The following table shows how MATLAB converts data from a COM object into MATLAB variables.</p><div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="33%"><col class="tcol2" width="33%"><col class="tcol3" width="33%"></colgroup><thead><tr><th><p>COM Variant Type</p></th><th><p>Description</p></th><th><p>MATLAB Representation</p></th></tr></thead><tbody><tr><td><code class="literal">VT_DISPATCH</code></td><td><p><code class="literal">IDispatch *</code></p></td><td>handle</td></tr><tr><td><code class="literal">VT_LPWSTR</code><br/>
<code class="literal">VT_LPSTR</code><br/>
<code class="literal">VT_BSTR</code><br/>
<code class="literal">VT_FILETIME</code><br/>
<code class="literal">VT_ERROR</code><br/>
<code class="literal">VT_DECIMAL</code><br/>
<code class="literal">VT_CLSID</code><br/>
<code class="literal">VT_DATE</code>
                            </td><td><p>wide <code class="literal">null</code> terminated
                                        string<br/>
<code class="literal">null</code> terminated
                                    string<br/>
OLE Automation
                                        string<br/>
<code class="literal">FILETIME</code><br/>
<code class="literal">SCODE</code><br/>
16-byte
                                    fixed point<br/>
Class
                                    ID<br/>
date</p></td><td>character vector</td></tr><tr><td><code class="literal">VT_INT</code><br/>
<code class="literal">VT_UINT</code><br/>
<code class="literal">VT_I2</code><br/>
<code class="literal">VT_UI2</code><br/>
<code class="literal">VT_I4</code><br/>
<code class="literal">VT_UI4</code><br/>
<code class="literal">VT_R4</code><br/>
<code class="literal">VT_R8</code><br/>
<code class="literal">VT_CY</code>
                            </td><td><p><code class="literal">signed machine
                                        int</code><br/>
<code class="literal">unsigned machine
                                        int</code><br/>
2-byte <code class="literal">signed
                                        int</code><br/>

                                    <code class="literal">unsigned short</code><br/>
4-byte
                                        <code class="literal">signed
                                        int</code><br/>
<code class="literal">unsigned
                                        long</code><br/>
4-byte
                                        <code class="literal">real</code><br/>
8-byte
                                        <code class="literal">real</code><br/>
currency</p></td><td><code class="literal">double</code></td></tr><tr><td><code class="literal">VT_I8</code></td><td><p><code class="literal">signed int64</code></p></td><td><code class="literal">int64</code></td></tr><tr><td><code class="literal">VT_UI8</code></td><td><p><code class="literal">unsigned int64</code></p></td><td><code class="literal">uint64</code></td></tr><tr><td><code class="literal">VT_BOOL</code>
                            </td><td>&nbsp;</td><td><code class="literal">logical</code></td></tr><tr><td><code class="literal">VT_I1</code><br/>
<code class="literal">VT_UI1</code>
                            </td><td><code class="literal">signed char</code><br/>
<code class="literal">unsigned
                                    char</code></td><td>char</td></tr><tr><td><code class="literal">VT_VARIANT</code><br/>
<code class="literal">VT_USERDEFINED</code><br/>
<code class="literal">VT_ARRAY</code></td><td><p><code class="literal">VARIANT *</code><br/>
user-defined
                                        type<br/>
<code class="literal">SAFEARRAY*</code></p></td><td><code class="literal">variant</code></td></tr><tr><td><code class="literal">VT_VARIANT</code> | <code class="literal">VT_BYREF</code>
                            </td><td><p><code class="literal">VARIANT
                                        *</code><br/>
<code class="literal">void*</code> for
                                    local use</p></td><td><code class="literal">variant</code>(pointer)</td></tr><tr><td><code class="literal">VT_SAFEARRAY</code></td><td><p>use <code class="literal">VT_ARRAY</code> in
                                        <code class="literal">VARIANT</code></p></td><td><code class="literal">SAFEARRAY</code></td></tr><tr><td><code class="literal">VT_SAFEARRAY</code> |
                                <code class="literal">VT_BYREF</code></td><td>&nbsp;</td><td><code class="literal">SAFEARRAY</code>(pointer)</td></tr></tbody></table></div></section><section><h3 class="title" id="bq4epvg-5">Unsupported Types</h3><p>MATLAB does not support the following COM interface types.</p><div class="itemizedlist"><ul><li><p>Structure</p></li><li><p>Sparse array</p></li><li><p>Multidimensional <code class="literal">SAFEARRAY</code>s (greater than two
                        dimensions)</p></li><li><p>Write-only properties</p></li></ul></div></section><section><h3 class="title" id="bq552_r">Pass <span class="trademark entity">MATLAB</span> SAFEARRAY to COM Object</h3><p>The <code class="literal">SAFEARRAY</code> data type is a standard way to pass arrays
                between COM objects. This section explains how MATLAB passes <code class="literal">SAFEARRAY</code> data to a COM object.</p><ul><li><p><a class="intrnllnk" href="#bq553k4">Default Behavior in <span class="trademark entity">MATLAB</span></a></p></li><li><p><a class="intrnllnk" href="#bq553k_">Examples</a></p></li><li><p><a class="intrnllnk" href="#bq553lb">Pass Single-Dimension SAFEARRAY</a></p></li><li><p><a class="intrnllnk" href="#brc5jeu-1">Pass SAFEARRAY by Reference</a></p></li></ul><section><h4 class="title" id="bq553k4">Default Behavior in <span class="trademark entity">MATLAB</span></h4><p>MATLAB represents an <code class="literal">m</code>-by-<code class="literal">n</code> matrix
                    as a two-dimensional <code class="literal">SAFEARRAY</code>, where the first dimension has
                        <code class="literal">m</code> elements and the second dimension has
                        <code class="literal">n</code> elements. MATLAB passes the <code class="literal">SAFEARRAY</code> by value.</p></section><section><h4 class="title" id="bq553k_">Examples</h4><p>The following examples use a COM object that expects a
                        <code class="literal">SAFEARRAY</code> input parameter.</p><p>When MATLAB passes a <code class="literal">1</code>-by-<code class="literal">3</code>
                    array:</p><div class="code_responsive"><pre class="programlisting">B = [2 3 4]
B =
     2     3     4
</pre></div><p>the object reads:</p><div class="code_responsive"><pre class="programlisting">No. of dimensions: 2
Dim: 1, 	 No. of elements: 1 
Dim: 2, 	 No. of elements: 3 
	 	 Elements: 
	 	 2.0 
	 	 3.0 
	 	 4.0
</pre></div><p>When MATLAB passes a <code class="literal">3</code>-by-<code class="literal">1</code>
                    array:</p><div class="code_responsive"><pre class="programlisting">C = [1;2;3]
C =
     1
     2
     3
</pre></div><p>the object reads:</p><div class="code_responsive"><pre class="programlisting">No. of dimensions: 2
Dim: 1, 	 No. of elements: 3 
Dim: 2, 	 No. of elements: 1 
Elements: 
	 	 1.0 
	 	 2.0 
	 	 3.0
</pre></div><p>When MATLAB passes a <code class="literal">2</code>-by-<code class="literal">4</code>
                    array:</p><div class="code_responsive"><pre class="programlisting">D = [2 3 4 5;5 6 7 8]

D =
     2     3     4     5
     5     6     7     8
</pre></div><p>the object reads:</p><div class="code_responsive"><pre class="programlisting">No. of dimensions: 2
Dim: 1, 	 No. of elements: 2 
Dim: 2, 	 No. of elements: 4 
Elements: 
	 	 2.0 
	 	 3.0 
	 	 4.0 
	 	 5.0 
	 	 5.0 
	 	 6.0 
	 	 7.0 
	 	 8.0
</pre></div></section><section><h4 class="title" id="bq553lb">Pass Single-Dimension SAFEARRAY</h4><p>For information, see <a href="https://www.mathworks.com/matlabcentral/answers/92424-how-can-i-pass-arguments-to-an-activex-server-from-matlab-7-0-r14-as-one-dimensional-arrays">How can I pass arguments to an ActiveX server from MATLAB 7.0 (R14) as
                        one-dimensional arrays?</a></p></section><section><h4 class="title" id="brc5jeu-1">Pass SAFEARRAY by Reference</h4><p>For information, see <a href="https://www.mathworks.com/matlabcentral/answers/94888-how-can-i-pass-arguments-by-reference-to-an-activex-server-from-matlab-7-0-r14">How can I pass arguments by reference to an ActiveX server from MATLAB 7.0
                        (R14)?</a></p></section></section><section><h3 class="title" id="bq552_v">Read SAFEARRAY from COM Objects in <span class="trademark entity">MATLAB</span> Applications</h3><p>This section explains how MATLAB reads <code class="literal">SAFEARRAY</code> data from a COM object.</p><p>MATLAB reads a one-dimensional <code class="literal">SAFEARRAY</code> with
                    <code class="literal">n</code> elements from a COM object as a
                    <code class="literal">1</code>-by-<code class="literal">n</code> matrix.</p><p>MATLAB reads a two-dimensional <code class="literal">SAFEARRAY</code> with
                    <code class="literal">n</code> elements as a <code class="literal">2</code>-by-<code class="literal">n</code>
                matrix.</p><p>MATLAB reads a three-dimensional <code class="literal">SAFEARRAY</code> with two
                elements as a <code class="literal">2</code>-by-<code class="literal">2</code>-by-<code class="literal">2</code>
                cell array.</p></section><section><h3 class="title" id="bq9byb0-1">Display <span class="trademark entity">MATLAB</span> Syntax for COM Objects</h3><p>To determine which MATLAB types to use when passing arguments to COM objects, use the <a href="../ref/com.invoke.html"><code class="function">invoke</code></a> or <a href="../ref/methodsview.html"><code class="function">methodsview</code></a> functions. These functions list all the methods found in
                an object, along with a specification of the types required for each
                argument.</p><p>Consider a server called <code class="literal">MyApp</code>, which has a single method
                    <code class="literal">TestMeth1</code> with the following syntax:</p><div class="code_responsive"><pre class="programlisting">HRESULT TestMeth1 ([out, retval] double* dret);</pre></div><p>This method has no input argument, and it returns a variable of type
                    <code class="literal">double</code>. The following <strong class="keycap">pseudo-code</strong> displays
                the MATLAB syntax for calling the method.</p><div class="code_responsive"><pre class="programlisting">h = actxserver('MyApp');
invoke(h)
</pre></div><p>MATLAB displays:</p><div class="code_responsive"><pre class="programlisting">ans = 
   TestMeth1 = double TestMeth1 (handle)
</pre></div><p>The signature of <code class="literal">TestMeth1</code> is:</p><div class="code_responsive"><pre class="programlisting">double TestMeth1(handle)</pre></div><p>MATLAB requires you to use an object handle as an input argument for every
                method, in addition to any input arguments required by the method itself.</p><p>Use one of the following <strong class="keycap">pseudo-code</strong> commands to create the
                variable <code class="literal">var</code>, which is of type <code class="literal">double</code>.</p><div class="code_responsive"><pre class="programlisting">var = h.TestMeth1;</pre></div><p>or:</p><div class="code_responsive"><pre class="programlisting">var = TestMeth1(h);</pre></div><p>Although the following syntax is correct, its use is discouraged:</p><div class="code_responsive"><pre class="programlisting">var = invoke(h,'TestMeth1');</pre></div><p>Now consider the server called <code class="literal">MyApp1</code> with the following
                methods:</p><div class="code_responsive"><pre class="programlisting">HRESULT TestMeth1 ([out, retval] double* dret);
HRESULT TestMeth2 ([in] double* d, [out, retval] double* dret);
HRESULT TestMeth3 ([out] BSTR* sout,
                   [in, out] double* dinout,
                   [in, out] BSTR* sinout,
                   [in] short sh,
                   [out] long* ln,
                   [in, out] float* b1,
                   [out, retval] double* dret);
</pre></div><p>Using the <code class="function">invoke</code> function, MATLAB displays the list of methods:</p><div class="code_responsive"><pre class="programlisting">ans = 
   TestMeth1 = double TestMeth1 (handle)
   TestMeth2 = double TestMeth2 (handle, double)
   TestMeth3 = [double, string, double, string, int32, single] ...
               TestMeth3(handle, double, string, int16, single)
</pre></div><p><code class="literal">TestMeth2</code> requires an input argument <code class="literal">d</code> of
                type <code class="literal">double</code>, and returns a variable <code class="literal">dret</code> of
                type <code class="literal">double</code>. Some <strong class="keycap">pseudo-code</strong> examples of
                calling <code class="literal">TestMeth2</code> are:</p><div class="code_responsive"><pre class="programlisting">var = h.TestMeth2(5);</pre></div><p>or:</p><div class="code_responsive"><pre class="programlisting">var = TestMeth2(h, 5);</pre></div><p><code class="literal">TestMeth3</code> requires multiple input arguments, as indicated
                within the parentheses on the right side of the equal sign, and returns multiple
                output arguments, as indicated within the brackets on the left side of the equal
                sign.</p><div class="code_responsive"><pre class="programlisting">[double, string, double, string, int32, single]  %output arguments
TestMeth3(handle, double, string, int16, single) %input arguments
</pre></div><p>The first input argument is the required <code class="literal">handle</code>, followed by
                four input arguments.</p><div class="code_responsive"><pre class="programlisting">TestMeth3(handle, in1, in2, in3, in4)</pre></div><p>The first output argument is the return value <code class="literal">retval</code>, followed
                by five output arguments.</p><div class="code_responsive"><pre class="programlisting">[retval, out1, out2, out3, out4, out5]</pre></div><p>This is how the arguments map into a MATLAB command:</p><div class="code_responsive"><pre class="programlisting">[dret, sout, dinout, sinout, ln, b1] = TestMeth3(handle, ...
                                       dinout, sinout, sh, b1)
</pre></div><p>where <code class="literal">dret</code> is <code class="literal">double</code>,
                    <code class="literal">sout</code> is <code class="literal">string</code>, <code class="literal">dinout</code>
                is <code class="literal">double</code> and is both an input and an output argument,
                    <code class="literal">sinout</code> is <code class="literal">string</code> (input and output
                argument), <code class="literal">ln</code> is <code class="literal">int32</code>, <code class="literal">b1</code>
                is <code class="literal">single</code> (input and output argument), <code class="literal">handle</code>
                is the handle to the object, and <code class="literal">sh</code> is
                <code class="literal">int16</code>.</p></section></section>
    </div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">Â© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

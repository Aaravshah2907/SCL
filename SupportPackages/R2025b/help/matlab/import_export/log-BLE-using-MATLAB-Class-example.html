<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Log Characteristic Value from Bluetooth Low Energy Peripheral Device Using a MATLAB Class</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../data-import-and-analysis.html",
          "name": "Data Import and Analysis"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../data-import-and-export.html",
          "name": "Data Import and Export"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../hardware-network-comm.html",
          "name": "Hardware and Network Communication"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 5,

          "item": {
          "@id": "../bluetooth-low-energy-communication.html",
          "name": "Bluetooth Low Energy Communication"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "bluetooth-low-energy-communication"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Log Characteristic Value from Bluetooth Low Energy Peripheral Device Using a MATLAB Class",
          "description": "Implement a MATLAB&#174; class and object to collect on demand the value of a characteristic of your Bluetooth&#174; Low Energy (BLE) device for a desired duration.",
          "thumbnailURL": "../../examples/matlab/win64/LogCharDataBLEDeviceMATLABClassExample_01.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "identifier": "matlab.LogCharDataBLEDeviceMATLABClassExample",
          "name": "LogCharDataBLEDeviceMATLABClassExample",
          "url": "log-BLE-using-MATLAB-Class-example.html"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/LogCharDataBLEDeviceMATLABClassExample')"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "LogCharDataBLEDeviceMATLABClassExample.mlx",
        "bleDataCollector.m"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="ug">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="other">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This example shows how to implement a MATLAB&#174; class and object to collect on demand the value of a characteristic of your Bluetooth&#174; Low Energy (BLE) device for a desired duration."><meta xmlns="http://www.w3.org/1999/xhtml" content="../../examples/matlab/win64/LogCharDataBLEDeviceMATLABClassExample_01.png" itemprop="thumbnailUrl">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../data-import-and-analysis.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Data Import and Analysis</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../data-import-and-export.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Data Import and Export</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../hardware-network-comm.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Hardware and Network Communication</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../bluetooth-low-energy-communication.html?s_tid=CRUX_lftnav" itemprop="url" id="mw_fa1455ff-3f58-4b72-b4ef-ebc7bfb38995"><span itemprop="title">Bluetooth Low Energy Communication</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item"><a href="#responsive_offcanvas">Log Characteristic Value from Bluetooth Low Energy Peripheral Device Using a MATLAB Class</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#LogCharDataBLEDeviceMATLABClassExample-1" class="nav-link intrnllnk">Required Hardware</a></li><li class="nav-item"><a href="#LogCharDataBLEDeviceMATLABClassExample-2" class="nav-link intrnllnk">Discover and Connect to BLE Device</a></li><li class="nav-item"><a href="#LogCharDataBLEDeviceMATLABClassExample-3" class="nav-link intrnllnk">Retrieve Characteristic Value</a></li><li class="nav-item"><a href="#LogCharDataBLEDeviceMATLABClassExample-4" class="nav-link intrnllnk">Plot Characteristic Value</a></li><li class="nav-item"><a href="#LogCharDataBLEDeviceMATLABClassExample-5" class="nav-link intrnllnk">Clean Up</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=bluetooth-low-energy-communication&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=bluetooth-low-energy-communication&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=bluetooth-low-energy-communication&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=bluetooth-low-energy-communication&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=bluetooth-low-energy-communication&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=bluetooth-low-energy-communication&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-topic">
<section><h1 class="r2025b" itemprop="title content" id="mw_8a78eabb-cb0a-4ead-9c45-8226aeba7cc8">Log Characteristic Value from Bluetooth Low Energy Peripheral Device Using a MATLAB Class</h1><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/LogCharDataBLEDeviceMATLABClassExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-LogCharDataBLEDeviceMATLABClassExample"><meta itemprop="exampletitle" content="Log Characteristic Value from Bluetooth Low Energy Peripheral Device Using a MATLAB Class"></div><span id="LogCharDataBLEDeviceMATLABClassExample" class="anchor_target"></span><p class="shortdesc">This example shows how to implement a MATLAB&#174; class and object to collect on demand the value of a characteristic of your Bluetooth&#174; Low Energy (BLE) device for a desired duration.</p><p>To access the MATLAB&#174; class file for this example, click the <strong class="emphasis bold">Open Live Script</strong> button and download the attached file.</p><div class="procedure"><h3 class="title" id="LogCharDataBLEDeviceMATLABClassExample-1">Required Hardware</h3><p>Any BLE device with characteristics that supports attributes such as <code class="literal">Read</code> and either <code class="literal">Notify</code> or <code class="literal">Indicate</code>. For more details see, <a href="../ref/matlabshared.blelib.characteristic.html#mw_cee8631e-5668-476a-8f18-9798f7a0da54" data-docid="matlab_ref#mw_cee8631e-5668-476a-8f18-9798f7a0da54" class="a">Attributes</a>.</p><p>For this example uses Arduino&#174; Nano 33 BLE hardware. </p><h3 class="title" id="LogCharDataBLEDeviceMATLABClassExample-2"><strong class="emphasis bold">Discover and Connect to BLE Device</strong></h3><p>First, check that the BLE device supports connections by finding it in MATLAB&#174;. The <a href="../ref/blelist.html" data-docid="matlab_ref#mw_03c56391-dbd0-4413-abef-78b8bbf0f5b4" class="a"><code class="olink">blelist</code></a> function scans nearby Bluetooth Low Energy peripheral devices that are advertising indications.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>blelist</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>Run bluetoothlist to search for nearby Bluetooth classic devices.
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans=<span class="emphasis"><em>26×5 table</em></span>
    Index         Name            Address        RSSI    Advertisement
    _____    ______________    ______________    ____    _____________

      1      ""                "2F9C86A6E132"    -19      1×1 struct  
      2      "Mambo_560253"    "E014F6303DFD"    -36      1×1 struct  
      3      ""                "1FA6CF2C2A06"    -36      1×1 struct  
      4      ""                "34312F6C837B"    -39      1×1 struct  
      5      ""                "1A14CB869510"    -50      1×1 struct  
      6      ""                "3AAFEC3833AE"    -54      1×1 struct  
      7      ""                "18116441AF7D"    -54      1×1 struct  
      8      "WaveGen"         "42162F5C6B30"    -57      1×1 struct  
      9      ""                "3C43509C1069"    -60      1×1 struct  
     10      ""                "2B416C7DA051"    -63      1×1 struct  
     11      ""                "2DA656DCF568"    -63      1×1 struct  
     12      ""                "076ACA437939"    -65      1×1 struct  
     13      ""                "38ABD95443B2"    -67      1×1 struct  
     14      ""                "1DAF492B7D39"    -68      1×1 struct  
     15      ""                "063BFA8A1AD9"    -71      1×1 struct  
     16      "Mambo_621221"    "D03A6110E621"    -73      1×1 struct  
      &#x22EE;

</pre></div></div></div><p>Once you find the device is found in MATLAB, connect to it by calling <a href="../ref/ble.html" data-docid="matlab_ref#mw_499cc8b8-1504-4246-a067-c860ab1a01be" class="a"><code class="olink">ble</code></a>. Specify the name of the device if it has a unique name, or specify the device address. This example uses the device address.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>bleObj = ble(<span style="color:#A020F0">"42162F5C6B30"</span>);</pre></div></div></div><h3 class="title" id="LogCharDataBLEDeviceMATLABClassExample-3">Retrieve Characteristic Value</h3><p>Retrieve all the available characteristics of the BLE device.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>allCharacteristics = bleObj.Characteristics;</pre></div></div></div><p>This example uses a <code class="literal">bleDataCollector</code> class to collect and manage data from the BLE device. To access the <code class="literal">bleDataCollector </code>MATLAB&#174; class file for this example, click the <strong class="emphasis bold">Open Live Script</strong> button and download the attached file. </p><p>Use the <code class="literal">bleDataCollector</code> object to connect to a specific characteristic, and set up a data collection callback function. Use the <code class="literal">@</code> operator to assign the function handle to the <code class="literal">DataAvailableFcn</code> property of the characteristic object. Use <a href="../matlab_prog/anonymous-functions.html" data-docid="matlab_prog#f4-70115" class="a">Anonymous Functions</a> to pass arguments to your callback in addition to the source and event data arguments passed by MATLAB. Anonymous functions can use any variables that are available in the current workspace. For more details, see <a href="../matlab_oop/listener-callback-functions.html#bu0abkz" data-docid="matlab_oop#bu0abkz" class="a">Additional Arguments for Callback Function</a>. Initialize the callback function to collect the characteristic value sent by the BLE device.</p><div class="code_responsive"><pre id="d126e39739" class="programlisting"><span style="color:#0000FF">function</span> obj = bleDataCollector(bleObj,serviceInput,characteristicInput)
            <span style="color:#228B22">% Connect to the characteristic of a BLE device to collect the</span>
            <span style="color:#228B22">% data sent by the device.</span>
            <span style="color:#228B22">%</span>
            <span style="color:#228B22">% bleObj              - ble connection object</span>
            <span style="color:#228B22">% serviceInput        - Service name or UUID</span>
            <span style="color:#228B22">% characteristicInput - Characteristic name or UUID</span>
            <span style="color:#228B22">%</span>
            <span style="color:#228B22">% Example:</span>
            <span style="color:#228B22">% obj = bleDataCollector(bleObj,"180D","2A37")</span>
            <span style="color:#0000FF">arguments</span>
                bleObj              <span style="color:#A0522D">ble   {mustBeScalarOrEmpty}</span>
                serviceInput        <span style="color:#A0522D">(1,1) {mustBeTextScalar}</span>
                characteristicInput <span style="color:#A0522D">(1,1) {mustBeTextScalar}</span>
            <span style="color:#0000FF">end</span>
            <span style="color:#228B22">% Create BLE characteristic object</span>
            obj.CharObj = characteristic(bleObj,serviceInput,characteristicInput);
            <span style="color:#228B22">% Initialize the callback function to collect the</span>
            <span style="color:#228B22">% characteristic value sent by the BLE device</span>
            obj.CharObj.DataAvailableFcn = (@(src,event)collectCharacteristicValue(obj,src,event));
            <span style="color:#228B22">% Disable characteristic value collection. Enable it on demand</span>
            unsubscribe(obj.CharObj);
<span style="color:#0000FF">end</span>

<span style="color:#0000FF">function</span> data = collectDataForDuration(obj,duration)
            <span style="color:#228B22">% Collect the ble characteristic value for a given duration.</span>
            <span style="color:#228B22">%</span>
            <span style="color:#228B22">% obj      - Object of bleDataCollector class</span>
            <span style="color:#228B22">% duration - Duration for which data needs to be collected</span>
            <span style="color:#228B22">%</span>
            <span style="color:#228B22">% Examples:</span>
            <span style="color:#228B22">% Collect the characteristic values for 5 seconds</span>
            <span style="color:#228B22">% collectDataForDuration(bleDataObj,5)</span>
            <span style="color:#0000FF">arguments</span>
                obj      <span style="color:#A0522D">(1,1) bleDataCollector</span>
                duration <span style="color:#A0522D">(1,1) {mustBePositive}</span>
            <span style="color:#0000FF">end</span>
            <span style="color:#228B22">% Initialize the data to be collected</span>
            data = [];
            <span style="color:#228B22">% Subscribe to the characteristic value notification or</span>
            <span style="color:#228B22">% indication. This will enable the callback function to be</span>
            <span style="color:#228B22">% triggered whenever BLE device has new characteristic value</span>
            subscribe(obj.CharObj);
            <span style="color:#228B22">% Pause till the required data is collected</span>
            pause(duration);
            <span style="color:#228B22">% Disable characteristic value collection after the required</span>
            <span style="color:#228B22">% duration</span>
            unsubscribe(obj.CharObj);
            <span style="color:#228B22">% Return the collected data. This data is the raw</span>
            <span style="color:#228B22">% characteristic value collected from the BLE device. Implement</span>
            <span style="color:#228B22">% additional decoding logic for specific end application</span>
            <span style="color:#228B22">% requirements.</span>
            data = obj.CollectedData;
<span style="color:#0000FF">end</span>
</pre></div><p>Select the characteristic that supports attributes such as <code class="literal">Read</code> and either <code class="literal">Notify</code> or <code class="literal">Indicate</code>. using the <code class="literal">ServiceUUID</code> and <code class="literal">CharacteristicUUID</code> input arguments<code class="literal">.</code> This selection enables you to read the characteristic value upon being notified by the BLE device.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#228B22">% To read a characteristic value on being notified, Choose a</span>
<span style="color:#228B22">% characteristic with "Attributes" - "Read" and ("Notify" or "Indicate")</span>
connectionObj = bleDataCollector(bleObj,allCharacteristics.ServiceUUID(4),allCharacteristics.CharacteristicUUID(4));</pre></div></div></div><p>Use the <code class="literal">collectDataForDuration</code> method to collect the characteristic value for a specified duration and then return the collected data.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#228B22">% Log the characteristic value for 10 seconds</span>
<span style="color:#228B22">% NOTE: The data collected here is the raw characteristic value collected</span>
<span style="color:#228B22">% from the BLE device. Implement additional decoding logic for specific end</span>
<span style="color:#228B22">% application requirements.</span>
collectedData = collectDataForDuration(connectionObj,10);</pre></div></div></div><h3 class="title" id="LogCharDataBLEDeviceMATLABClassExample-4">Plot Characteristic Value</h3><p>Use <code class="literal">plot</code> to plot the collected characteristic value.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#228B22">% Plot the data collected</span>
plot(collectedData);</pre></div></div></div><div class="informalfigure"><div id="d126e39773" class="mediaobject"><p><img src="../../examples/matlab/win64/LogCharDataBLEDeviceMATLABClassExample_01.png" alt="Figure contains an axes object. The axes object contains an object of type line." width="560"></p></div></div><h3 class="title" id="LogCharDataBLEDeviceMATLABClassExample-5"><strong class="emphasis bold">Clean Up</strong></h3><p>After you finish working with the characteristic, clear the <code class="literal">bleDataCollector</code> object and the BLE device connection.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#228B22">% Clear the bleDataCollector object and BLE device connection</span>
clear <span style="color:#A020F0">connectionObj</span> <span style="color:#A020F0">bleObj</span>;
</pre></div></div></div></div></section>
    </div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

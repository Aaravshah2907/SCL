<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Log Characteristic Value from Bluetooth Low Energy Peripheral Device Using Callback Function</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../data-import-and-analysis.html",
          "name": "Data Import and Analysis"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../data-import-and-export.html",
          "name": "Data Import and Export"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../hardware-network-comm.html",
          "name": "Hardware and Network Communication"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 5,

          "item": {
          "@id": "../bluetooth-low-energy-communication.html",
          "name": "Bluetooth Low Energy Communication"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "bluetooth-low-energy-communication"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Log Characteristic Value from Bluetooth Low Energy Peripheral Device Using Callback Function",
          "description": "Access a characteristic of your Bluetooth&#174; Low Energy (BLE) device, create a callback function to read the raw BLE characteristic value for a fixed duration, and log it in a text file.",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "identifier": "matlab.LogCharDataBLEDeviceCallbackFuncExample",
          "name": "LogCharDataBLEDeviceCallbackFuncExample",
          "url": "log-BLE-using-callback-example.html"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/LogCharDataBLEDeviceCallbackFuncExample')"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "LogCharDataBLEDeviceCallbackFuncExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="ug">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="other">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This example shows how to access a characteristic of your Bluetooth&#174; Low Energy (BLE) device, create a callback function to read the raw BLE characteristic value for a fixed duration, and log it in a text file."><meta xmlns="http://www.w3.org/1999/xhtml" content="../../includes/product/images/doc_center/DefaultImage.png" itemprop="thumbnailUrl">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../data-import-and-analysis.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Data Import and Analysis</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../data-import-and-export.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Data Import and Export</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../hardware-network-comm.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Hardware and Network Communication</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../bluetooth-low-energy-communication.html?s_tid=CRUX_lftnav" itemprop="url" id="mw_fa1455ff-3f58-4b72-b4ef-ebc7bfb38995"><span itemprop="title">Bluetooth Low Energy Communication</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item"><a href="#responsive_offcanvas">Log Characteristic Value from Bluetooth Low Energy Peripheral Device Using Callback Function</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#LogCharDataBLEDeviceCallbackFuncExample-1" class="nav-link intrnllnk">Required Hardware</a></li><li class="nav-item"><a href="#LogCharDataBLEDeviceCallbackFuncExample-2" class="nav-link intrnllnk">Discover and Connect to BLE Device</a></li><li class="nav-item"><a href="#LogCharDataBLEDeviceCallbackFuncExample-3" class="nav-link intrnllnk">Retrieve Characteristic Value</a></li><li class="nav-item"><a href="#LogCharDataBLEDeviceCallbackFuncExample-4" class="nav-link intrnllnk">Create and Execute Callback Function</a></li><li class="nav-item"><a href="#LogCharDataBLEDeviceCallbackFuncExample-5" class="nav-link intrnllnk">Clean Up</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=bluetooth-low-energy-communication&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=bluetooth-low-energy-communication&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=bluetooth-low-energy-communication&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=bluetooth-low-energy-communication&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=bluetooth-low-energy-communication&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=bluetooth-low-energy-communication&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-topic">
<section><h1 class="r2025b" itemprop="title content" id="mw_abc2c1d0-7a5d-4672-ab61-a31e87800786">Log Characteristic Value from Bluetooth Low Energy Peripheral Device Using Callback Function</h1><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/LogCharDataBLEDeviceCallbackFuncExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-LogCharDataBLEDeviceCallbackFuncExample"><meta itemprop="exampletitle" content="Log Characteristic Value from Bluetooth Low Energy Peripheral Device Using Callback Function"></div><span id="LogCharDataBLEDeviceCallbackFuncExample" class="anchor_target"></span><p class="shortdesc">This example shows how to access a characteristic of your Bluetooth&#174; Low Energy (BLE) device, create a callback function to read the raw BLE characteristic value for a fixed duration, and log it in a text file.</p><div class="procedure"><h3 class="title" id="LogCharDataBLEDeviceCallbackFuncExample-1">Required Hardware</h3><p>Any BLE device with characteristics that supports attributes such as <code class="literal">Read</code> and either <code class="literal">Notify</code> or <code class="literal">Indicate</code>. For more details see, <a href="../ref/matlabshared.blelib.characteristic.html#mw_cee8631e-5668-476a-8f18-9798f7a0da54" data-docid="matlab_ref#mw_cee8631e-5668-476a-8f18-9798f7a0da54" class="a">Attributes</a>. This example uses Arduino&#174; Nano 33 BLE hardware.</p><h3 class="title" id="LogCharDataBLEDeviceCallbackFuncExample-2"><strong class="emphasis bold">Discover and Connect to BLE Device</strong></h3><p>First, check that the BLE device supports connections by finding it in MATLAB&#174;. The <a href="../ref/blelist.html" data-docid="matlab_ref#mw_03c56391-dbd0-4413-abef-78b8bbf0f5b4" class="a"><code class="olink">blelist</code></a> function scans advertising BLE peripheral devices that are advertising indications.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>blelist</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>Run bluetoothlist to search for nearby Bluetooth classic devices.
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans=<span class="emphasis"><em>29×5 table</em></span>
    Index          Name              Address        RSSI    Advertisement
    _____    _________________    ______________    ____    _____________

      1      ""                   "2693A0535E04"    -19      1×1 struct  
      2      ""                   "3A136453F9FD"    -37      1×1 struct  
      3      "Mambo_560253"       "E014F6303DFD"    -38      1×1 struct  
      4      ""                   "229CC4005139"    -55      1×1 struct  
      5      ""                   "3745017A158B"    -56      1×1 struct  
      6      ""                   "26864404E2D7"    -58      1×1 struct  
      7      "WaveGen"            "42162F5C6B30"    -58      1×1 struct  
      8      ""                   "10EBD9CAA72B"    -60      1×1 struct  
      9      ""                   "1DD7C49A016F"    -61      1×1 struct  
     10      ""                   "35E69990D1D3"    -61      1×1 struct  
     11      "vineethnArduino"    "7C9EBD3ACC32"    -64      1×1 struct  
     12      ""                   "2EF9235E31A2"    -68      1×1 struct  
     13      ""                   "55ACCE12E59D"    -68      1×1 struct  
     14      ""                   "E07F70DE320F"    -68      1×1 struct  
     15      ""                   "21F3C3B77DDD"    -69      1×1 struct  
     16      ""                   "7638FEDD33A4"    -69      1×1 struct  
      &#x22EE;

</pre></div></div></div><p>Once you find the device in MATLAB, connect to it by calling <a href="../ref/ble.html" data-docid="matlab_ref#mw_499cc8b8-1504-4246-a067-c860ab1a01be" class="a"><code class="olink">ble</code></a>. Specify the name of the device if it has a unique name, or specify the device address. This example uses the device address.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>bleObj = ble(<span style="color:#A020F0">"42162F5C6B30"</span>);</pre></div></div></div><h3 class="title" id="LogCharDataBLEDeviceCallbackFuncExample-3">Retrieve Characteristic Value</h3><p>Retrieve all the available characteristics of the BLE device.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>allCharacteristics = bleObj.Characteristics;</pre></div></div></div><p>Create a characteristic object using the <code class="literal">ServiceUUID</code> and <code class="literal">CharacteristicUUID </code>input arguments. Select the characteristic that supports attributes such as <code class="literal">Read</code> and either <code class="literal">Notify</code> or <code class="literal">Indicate</code>. This enables you to read the characteristic value upon being notified by the BLE device.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>charObj = characteristic(bleObj,allCharacteristics.ServiceUUID(4),allCharacteristics.CharacteristicUUID(4));</pre></div></div></div><p>Subscribe to the selected characteristic to enable notifications or indications. This selection enables the callback function to be triggered whenever a new characteristic value sent by the BLE device.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>subscribe(charObj);</pre></div></div></div><p>Create a log file to store the characteristic value available at the BLE device.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>fileID = fopen(<span style="color:#A020F0">"rawBLEData.txt"</span>,<span style="color:#A020F0">"w+"</span>);</pre></div></div></div><h3 class="title" id="LogCharDataBLEDeviceCallbackFuncExample-4"><strong class="emphasis bold">Create and Execute Callback Function</strong></h3><p>Create a callback function to handle the new data notifications. Name the function <code class="literal">displayCharacteristicData</code> and define it as follows. </p><p>Specify the read mode as <code class="literal">'oldest'</code> instead of <code class="literal">'latest'</code>. Calling the <code class="literal">'latest'</code> data may lead to errors in the callback function caused by the flushing of previous data. Log the timestamp and the data to the file with millisecond precision. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> displayCharacteristicData(src,~,fileID)
<span style="color:#228B22">% After subscribing to the notification or indication of</span>
<span style="color:#228B22">% BLE characteristic value, this callback function will be</span>
<span style="color:#228B22">% triggered each time the BLE device sends new characteristic</span>
<span style="color:#228B22">% data.</span>
[data,timestamp] = read(src,<span style="color:#A020F0">'oldest'</span>);

<span style="color:#228B22">% Store the time stamp with milli second precision</span>
timestamp.Format = <span style="color:#A020F0">'MM/dd/uuuu HH:mm:ss.SSSS'</span>;

<span style="color:#228B22">% Log the timestamp</span>
fprintf(fileID,<span style="color:#A020F0">"\n%s\t"</span>,timestamp);

<span style="color:#228B22">% Log the data</span>
fprintf(fileID,repmat(<span style="color:#A020F0">'%d '</span>,1,length(data)), data);
<span style="color:#0000FF">end</span></pre></div></div></div><p>Initialize the callback function to collect the characteristic value sent by the BLE device.</p><p>Use the <code class="literal">@</code> operator to assign the function handle to the <code class="literal">DataAvailableFcn</code> property of the characteristic object. Use <a href="../matlab_prog/anonymous-functions.html" data-docid="matlab_prog#f4-70115" class="a">Anonymous Functions</a> to pass arguments to your callback in addition to the source and event data arguments passed by MATLAB. Anonymous functions can use any variables that are available in the current workspace. For more details, see <a href="../matlab_oop/listener-callback-functions.html#bu0abkz" data-docid="matlab_oop#bu0abkz" class="a">Additional Arguments for Callback Function</a>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>charObj.DataAvailableFcn = @(src,event)displayCharacteristicData(src,event,fileID);</pre></div></div></div><p>Log the characteristic value for a duration of 10 seconds</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>pause(10);</pre></div></div></div><p>Close the log file.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>fclose(fileID);</pre></div></div></div><p>The text below displays a snippet of the log file. The first column contains the date and time stamp at millisecond precision and the second column contains the corresponding characteristic value.</p><div class="code_responsive"><pre class="programlisting">12/01/2023 20:17:08.0529	3 
12/01/2023 20:17:08.2478	4 
12/01/2023 20:17:08.4578	5 
12/01/2023 20:17:08.6525	1 
12/01/2023 20:17:08.8626	2 
12/01/2023 20:17:09.0424	3 
12/01/2023 20:17:09.2829	4 
12/01/2023 20:17:09.4624	5 
12/01/2023 20:17:09.6428	1 
12/01/2023 20:17:09.8823	2 
12/01/2023 20:17:10.0627	3 
12/01/2023 20:17:10.2427	4 
12/01/2023 20:17:10.4825	5 
12/01/2023 20:17:10.6626	1 
12/01/2023 20:17:10.8429	2 
12/01/2023 20:17:11.0826	3 
12/01/2023 20:17:11.2628	4 
12/01/2023 20:17:11.4428	5 
12/01/2023 20:17:11.6826	1 
12/01/2023 20:17:11.8626	2 
12/01/2023 20:17:12.0426	3 
12/01/2023 20:17:12.2824	4 
12/01/2023 20:17:12.4627	5 
12/01/2023 20:17:12.6428	1 
12/01/2023 20:17:12.8827	2 
12/01/2023 20:17:13.0624	3 
12/01/2023 20:17:13.2426	4 
12/01/2023 20:17:13.4825	5 
12/01/2023 20:17:13.6624	1 
12/01/2023 20:17:13.8427	2 
12/01/2023 20:17:14.0825	3 
12/01/2023 20:17:14.2628	4 
12/01/2023 20:17:14.4427	5 
12/01/2023 20:17:14.6824	1 
12/01/2023 20:17:14.8625	2 
12/01/2023 20:17:15.0428	3 
12/01/2023 20:17:15.2824	4 
12/01/2023 20:17:15.4627	5 
12/01/2023 20:17:15.6424	1 
12/01/2023 20:17:15.8825	2 
12/01/2023 20:17:16.0627	3 
12/01/2023 20:17:16.2424	4 
12/01/2023 20:17:16.4826	5 
12/01/2023 20:17:16.6627	1 
12/01/2023 20:17:16.8427	2 
12/01/2023 20:17:17.0823	3 
12/01/2023 20:17:17.2628	4 
12/01/2023 20:17:17.4426	5 
12/01/2023 20:17:17.6824	1 
12/01/2023 20:17:17.8623	2 
</pre></div><h3 class="title" id="LogCharDataBLEDeviceCallbackFuncExample-5"><strong class="emphasis bold">Clean Up</strong></h3><p>After you finish working with the characteristic, disable notifications using <a href="../ref/matlabshared.blelib.characteristic.unsubscribe.html" data-docid="matlab_ref#mw_75f40872-eb0f-492c-adb8-b042bd11798d" class="a"><code class="olink">unsubscribe</code></a> and set the <code class="literal">DataAvailableFcn</code> property to null.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>unsubscribe(charObj);
charObj.DataAvailableFcn = [];</pre></div></div></div></div></section>
    </div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

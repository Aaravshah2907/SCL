<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Develop Custom Datastore for DICOM Data</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../data-import-and-analysis.html",
          "name": "Data Import and Analysis"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../large-files-and-big-data.html",
          "name": "Large Files and Big Data"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../datastore.html",
          "name": "Datastore"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "datastore"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="con">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="con">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This example shows how to develop a custom datastore that supports writing operations."><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../data-import-and-analysis.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Data Import and Analysis</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../large-files-and-big-data.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Large Files and Big Data</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../datastore.html?s_tid=CRUX_lftnav" itemprop="url" id="buhq8av-1"><span itemprop="title">Datastore</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item"><a href="#responsive_offcanvas">Develop Custom Datastore for DICOM Data</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#mw_df215b6f-b19d-4417-a3c8-0c384db98574" class="nav-link intrnllnk">Developing Custom Datastores</a></li><li class="nav-item"><a href="#mw_cea2107a-7006-4a56-ad9c-78434af46522" class="nav-link intrnllnk">Class Definition</a></li><li class="nav-item"><a href="#mw_bdf27bbe-1fd7-435d-81d3-382b90f0a96a" class="nav-link intrnllnk">Using the DICOMDatastore Class</a></li><li class="nav-item"><a href="#d126e32249" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=datastore&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=datastore&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=datastore&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=datastore&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=datastore&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=datastore&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-topic">
<section><h2 class="title r2025b" itemprop="title content" id="mw_43895003-4a96-48d2-9db6-18e8927639ae">Develop Custom Datastore for DICOM Data</h2><p>This example shows how to develop a custom datastore that supports writing operations. The
      datastore is named <code class="literal">DICOMDatastore</code> because it supports DICOM &#174; (<a href="https://www.dicomstandard.org/" target="_blank">Digital Imaging and Communications in
        Medicine</a>) data, which is an international standard for medical imaging
      information.</p><section><h3 class="title" id="mw_df215b6f-b19d-4417-a3c8-0c384db98574">Developing Custom Datastores</h3><p>The topic <a href="develop-custom-datastore.html" class="a">Develop Custom Datastore</a> describes the general
        process for creating a custom datastore, as well as the specific requirements to add
        different pieces of functionality. There are a variety of superclasses you can subclass from
        depending on what pieces of functionality you need (parallel evaluation, writing operations,
        shuffling, and so on). In particular, you can add support for writing operations by
        subclassing from <a href="../ref/matlab.io.datastore.filewritable-class.html"><code class="class">matlab.io.datastore.FileWritable</code></a>. However, for the broadest set of writing
        functionality, you must also subclass from <a href="../ref/matlab.io.datastore.folderspropertyprovider-class.html"><code class="class">matlab.io.datastore.FoldersPropertyProvider</code></a>, which adds a
          <code class="property">Folders</code> property to the datastore. The complete requirements to add
        writing support to a custom datastore are covered in <a href="develop-custom-datastore.html#mw_d1efeeb4-11aa-49ea-92bc-8747aad30392" class="a">Add Support for Writing Data</a>.</p></section><section><h3 class="title" id="mw_cea2107a-7006-4a56-ad9c-78434af46522">Class Definition</h3><p>This table contains code and explanations for the <code class="literal">DICOMDatastore</code>
        class.</p><div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="50%"><col class="tcol2" width="50%"></colgroup><tbody><tr><td>
                <div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">classdef</span> DICOMDatastore &lt; matlab.io.Datastore &amp; <span style="color:#0000FF">...</span>
                          matlab.io.datastore.FileWritable &amp; <span style="color:#0000FF">...</span>
                          matlab.io.datastore.FoldersPropertyProvider 
                          </pre></div></div></div>
              </td><td><p><strong class="emphasis bold">Class
                    Header</strong></p><p><code class="class">DICOMDatastore</code> inherits from <a href="../ref/matlab.io.datastore-class.html"><code class="class">Datastore</code></a> for basic functionality, as well as from <a href="../ref/matlab.io.datastore.filewritable-class.html"><code class="class">FileWritable</code></a> and <a href="../ref/matlab.io.datastore.folderspropertyprovider-class.html"><code class="class">FoldersPropertyProvider</code></a> to enable file writing
                capabilities.</p></td></tr><tr><td>
                <div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>    properties
        Files <span style="color:#A020F0">matlab.io.datastore.FileSet</span>
    <span style="color:#0000FF">end</span></pre></div></div></div>
              </td><td><p><strong class="emphasis bold">Public
                    Properties</strong></p><p><code class="class">DICOMDatastore</code> defines a public
                    <code class="property">Files</code> property that is a <code class="object">FileSet</code> object.
                    <code class="class">DICOMDatastore</code> inherits a <code class="property">Folders</code> property
                  from <code class="class">FoldersPropertyProvider</code>, so that property does not need to be
                  initialized.</p></td></tr><tr><td>
                <div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>    properties (Constant)
        SupportedOutputFormats = <span style="color:#0000FF">...</span>
          [matlab.io.datastore.ImageDatastore.SupportedOutputFormats, <span style="color:#A020F0">"dcm"</span>];
        DefaultOutputFormat = <span style="color:#A020F0">"dcm"</span>;
    <span style="color:#0000FF">end</span></pre></div></div></div>
              </td><td><p><code class="class">DICOMDatastore</code> defines
                    <code class="property">SupportedOutputFormats</code> and
                    <code class="property">DefaultOutputFormat</code> as constant properties with default
                  values. <code class="literal">"dcm"</code> is a custom format for DICOM data.</p></td></tr><tr><td>
                <div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>    methods(Access = public)</pre></div></div></div>
                <div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>        <span style="color:#0000FF">function</span> myds = DICOMDatastore(location)
            <span style="color:#228B22">% The class constructor to set properties of the datastore. </span>
            myds.Files = matlab.io.datastore.FileSet(location, <span style="color:#0000FF">...</span>
                <span style="color:#A020F0">"IncludeSubfolders"</span>, true);
            populateFoldersFromLocation(myds,location);
            reset(myds);
        <span style="color:#0000FF">end</span></pre></div></div></div>
              </td><td><p><strong class="emphasis bold">Public Methods</strong></p><p>The public
                  methods section defines common datastore methods that the class uses to manipulate
                  data. Public methods are externally accessible, so class users of
                    <code class="class">DICOMDatastore</code> can call these methods (in addition to other
                  public methods inherited from the superclasses).</p><p>The constructor
                    <code class="function">DICOMDatastore</code> creates a new
                    <code class="object">DICOMDatastore</code> object by setting values for the
                    <code class="property">Files</code> and <code class="property">Folders</code> properties.</p>
<div class="itemizedlist"><ul><li><p>Use <code class="class">FileSet</code> to set the value of the
                          <code class="property">Files</code> property.</p></li><li><p>Use the <a href="../ref/matlab.io.datastore.folderspropertyprovider.populatefoldersfromlocation.html"><code class="method">populateFoldersFromLocation</code></a> method of
                          <code class="class">FoldersPropertyProvider</code> to set the value of the
                          <code class="property">Folders</code> property.</p></li></ul></div><p>
</p></td></tr><tr><td>
                <div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>        <span style="color:#0000FF">function</span> tf = hasdata(myds)
            <span style="color:#228B22">%HASDATA   Returns true if more data is available.</span>
            <span style="color:#228B22">%   Return logical scalar indicating availability of data.</span>
            <span style="color:#228B22">%   This method should be called before calling read. This</span>
            <span style="color:#228B22">%   is an abstract method and must be implemented by the</span>
            <span style="color:#228B22">%   subclasses. hasdata is used in conjunction with read to</span>
            <span style="color:#228B22">%   read all the data within the datastore.</span>
            tf = hasNextFile(myds.Files);
        <span style="color:#0000FF">end</span></pre></div></div></div>
              </td><td rowspan="4"><p>The <a href="../ref/matlab.io.datastore.hasdata.html"><code class="method">hasdata</code></a>, <a href="../ref/matlab.io.datastore.read.html"><code class="method">read</code></a>, <a href="../ref/matlab.io.datastore.reset.html"><code class="method">reset</code></a>, and <a href="../ref/matlab.io.datastore.progress.html"><code class="method">progress</code></a> methods define the infrastructure for the datastore to work
                  with small chunks of data at a time. These are abstract methods that must be
                  implemented by the subclass.</p></td></tr><tr><td>
                <div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>        <span style="color:#0000FF">function</span> [data, info] = read(myds)
            <span style="color:#228B22">%READ   Read data and information about the extracted data.</span>
            <span style="color:#228B22">%   Return the data extracted from the datastore in the</span>
            <span style="color:#228B22">%   appropriate form for this datastore. Also return</span>
            <span style="color:#228B22">%   information about where the data was extracted from in</span>
            <span style="color:#228B22">%   the datastore. Both the outputs are required to be</span>
            <span style="color:#228B22">%   returned from the read method and can be of any type.</span>
            <span style="color:#228B22">%   info is recommended to be a struct with information</span>
            <span style="color:#228B22">%   about the chunk of data read. data represents the</span>
            <span style="color:#228B22">%   underlying class of tall, if tall is created on top of</span>
            <span style="color:#228B22">%   this datastore. This is an abstract method and must be</span>
            <span style="color:#228B22">%   implemented by the subclasses.</span>
            
            <span style="color:#228B22">% In this example, the read method reads data from the</span>
            <span style="color:#228B22">% datastore using a custom reader function, MyFileReader,</span>
            <span style="color:#228B22">% which takes the resolved filenames as input.</span>
            <span style="color:#0000FF">if</span> ~hasdata(myds)
                error(<span style="color:#A020F0">"No more data to read.\nUse reset method to "</span> <span style="color:#0000FF">...</span>
                    + <span style="color:#A020F0">"reset the datastore to the start of the data. Before "</span> <span style="color:#0000FF">...</span>
                    + <span style="color:#A020F0">"calling the read method, check if data is available "</span> <span style="color:#0000FF">...</span>
                    + <span style="color:#A020F0">"to read by using the hasdata method."</span>);
            <span style="color:#0000FF">end</span>

            file = nextfile(myds.Files);
            <span style="color:#0000FF">try</span>
                data = dicomread(file.Filename);
            <span style="color:#0000FF">catch</span> ME
                error(<span style="color:#A020F0">"%s has failed"</span>, file.FileName);
            <span style="color:#0000FF">end</span>

            info.FileSize = size(data);
            info.Filename = file.Filename;
        <span style="color:#0000FF">end</span></pre></div></div></div>
              </td></tr><tr><td>
                <div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>        <span style="color:#0000FF">function</span> reset(myds)
            <span style="color:#228B22">%RESET   Reset to the start of the data.</span>
            <span style="color:#228B22">%   Reset the datastore to the state where no data has been</span>
            <span style="color:#228B22">%   read from it. This is an abstract method and must be</span>
            <span style="color:#228B22">%   implemented by the subclasses.</span>
            
            <span style="color:#228B22">% In this example, the datastore is reset to point to the</span>
            <span style="color:#228B22">% first file (and first partition) in the datastore.</span>
            reset(myds.Files);
        <span style="color:#0000FF">end</span></pre></div></div></div>
              </td></tr><tr><td>
                <div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>        <span style="color:#0000FF">function</span> frac = progress(myds)
            <span style="color:#228B22">%PROGRESS   Percentage of consumed data between 0.0 and 1.0.</span>
            <span style="color:#228B22">%   Return fraction between 0.0 and 1.0 indicating progress as a</span>
            <span style="color:#228B22">%   double. The provided example implementation returns the</span>
            <span style="color:#228B22">%   ratio of the index of the current file from FileSet</span>
            <span style="color:#228B22">%   to the number of files in FileSet. A simpler</span>
            <span style="color:#228B22">%   implementation can be used here that returns a 1.0 when all</span>
            <span style="color:#228B22">%   the data has been read from the datastore, and 0.0</span>
            <span style="color:#228B22">%   otherwise.</span>
            <span style="color:#228B22">%</span>
            <span style="color:#228B22">%   See also matlab.io.Datastore, read, hasdata, reset, readall,</span>
            <span style="color:#228B22">%   preview.</span>
            frac = progress(myds.Files);
        <span style="color:#0000FF">end</span></pre></div></div></div>
                <div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>    <span style="color:#0000FF">end</span></pre></div></div></div>
              </td></tr><tr><td>
                <div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>methods(Access = protected)</pre></div></div></div>
                <div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>        <span style="color:#0000FF">function</span> dsCopy = copyElement(myds)
            <span style="color:#228B22">%COPYELEMENT   Create a deep copy of the datastore</span>
            <span style="color:#228B22">%   Create a deep copy of the datastore. We need to call</span>
            <span style="color:#228B22">%   copy on the datastore's property FileSet because it is</span>
            <span style="color:#228B22">%   a handle object. Creating a deep copy allows methods</span>
            <span style="color:#228B22">%   such as readall and preview, which call the copy method,</span>
            <span style="color:#228B22">%   to remain stateless.</span>
            dsCopy = copyElement@matlab.mixin.Copyable(myds);
            dsCopy.Files = copy(myds.Files);
        <span style="color:#0000FF">end</span></pre></div></div></div>
              </td><td><p><strong class="emphasis bold">Protected Methods</strong></p><p>Protected
                  methods redefine methods that were inherited by the class, and they are only
                  accessible to <code class="class">DICOMDatastore</code>. For more information, see <a href="../matlab_oop/modifying-superclass-methods-and-properties.html" class="a">Modify Inherited Methods</a>.</p><p>The protected
                    <code class="method">copyElement</code> method is required whenever <code class="class">FileSet</code>
                  is used to define properties. The <code class="method">copyElement</code> method allows
                  methods such as <code class="method">readall</code> and <code class="method">preview</code> to remain
                  stateless.</p></td></tr><tr><td>
                <div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>        <span style="color:#0000FF">function</span> tf = write(myds, data, writeInfo, outFmt, varargin)
            <span style="color:#0000FF">if</span> outFmt == <span style="color:#A020F0">"dcm"</span>
                dicomwrite(data, writeInfo.SuggestedOutputName, varargin{:});
            <span style="color:#0000FF">else</span>
                write@matlab.io.datastore.FileWritable(myds, data, <span style="color:#0000FF">...</span>
                    writeInfo, outFmt, varargin{:});
            <span style="color:#0000FF">end</span>
            tf = true;
        <span style="color:#0000FF">end</span></pre></div></div></div>
              </td><td><p>The protected <a href="../ref/matlab.io.datastore.filewritable.write.html"><code class="method">write</code></a>
                  method writes out chunks of data. Since <code class="class">DICOMDatastore</code> supports
                    <code class="class">ImageDatastore</code> formats as well as the custom format
                    <code class="literal">"dcm"</code>, the <code class="method">write</code> method uses different
                  functions to write the data depending on the output format.</p></td></tr><tr><td>
                <div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>        <span style="color:#0000FF">function</span> files = getFiles(myds)
            files = myds.Files.FileInfo.Filename;
        <span style="color:#0000FF">end</span></pre></div></div></div>
                <div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>    <span style="color:#0000FF">end</span></pre></div></div></div>
              </td><td><p>The protected <a href="../ref/matlab.io.datastore.filewritable.getfiles.html"><code class="method">getFiles</code></a> method is necessary since <code class="class">DICOMDatastore</code> uses
                    <code class="object">FileSet</code> objects for the <code class="property">Files</code> property.
                  The <code class="property">Files</code> property is generally required to return a
                    <code class="literal">cellstr</code>, so the <code class="method">getFiles</code> method uses the
                    <code class="object">FileSet</code> object to generate a <code class="literal">cellstr</code> of the
                  file paths.</p></td></tr><tr><td>
                <div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">end</span></pre></div></div></div>
              </td><td><p>End the <code class="literal">classdef</code> section.</p></td></tr></tbody></table></div><p><a href="#" onclick="return toggleexpander('d126e32199_block','d126e32199_expandable_text');"><img style="border:0;" id="d126e32199_expandable_text" src="../../includes/product/images/doc_center/arrow_right.gif"></a>&nbsp;<a href="#" onclick="return toggleexpander('d126e32199_block','d126e32199_expandable_text');">Expand for Class Code</a></p><div class="expander" style="display:none; padding-left:4px;" id="d126e32199_block"><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">classdef</span> DICOMDatastore &lt;   matlab.io.Datastore &amp; <span style="color:#0000FF">...</span>
                            matlab.io.datastore.FileWritable &amp; <span style="color:#0000FF">...</span>
                            matlab.io.datastore.FoldersPropertyProvider
    <span style="color:#0000FF">properties</span>
        Files <span style="color:#A0522D">matlab.io.datastore.FileSet</span>
    <span style="color:#0000FF">end</span>
    
    <span style="color:#0000FF">properties</span> (Constant)
        SupportedOutputFormats = <span style="color:#0000FF">...</span>
            [matlab.io.datastore.ImageDatastore.SupportedOutputFormats, <span style="color:#A020F0">"dcm"</span>];
        DefaultOutputFormat = <span style="color:#A020F0">"dcm"</span>;
    <span style="color:#0000FF">end</span>
    
    <span style="color:#0000FF">methods</span>(Access = public)
        <span style="color:#0000FF">function</span> myds = DICOMDatastore(location)
            <span style="color:#228B22">% The class constructor to set properties of the datastore. </span>
            myds.Files = matlab.io.datastore.FileSet(location, <span style="color:#0000FF">...</span>
                <span style="color:#A020F0">"IncludeSubfolders"</span>, true);
            populateFoldersFromLocation(myds,location);
            reset(myds);
        <span style="color:#0000FF">end</span>
        
        <span style="color:#0000FF">function</span> tf = hasdata(myds)
            <span style="color:#228B22">%HASDATA   Returns true if more data is available.</span>
            <span style="color:#228B22">%   Return logical scalar indicating availability of data.</span>
            <span style="color:#228B22">%   This method should be called before calling read. This</span>
            <span style="color:#228B22">%   is an abstract method and must be implemented by the</span>
            <span style="color:#228B22">%   subclasses. hasdata is used in conjunction with read to</span>
            <span style="color:#228B22">%   read all the data within the datastore.</span>
            tf = hasNextFile(myds.Files);
        <span style="color:#0000FF">end</span>
        
        <span style="color:#0000FF">function</span> [data, info] = read(myds)
            <span style="color:#228B22">%READ   Read data and information about the extracted data.</span>
            <span style="color:#228B22">%   Return the data extracted from the datastore in the</span>
            <span style="color:#228B22">%   appropriate form for this datastore. Also return</span>
            <span style="color:#228B22">%   information about where the data was extracted from in</span>
            <span style="color:#228B22">%   the datastore. Both the outputs are required to be</span>
            <span style="color:#228B22">%   returned from the read method and can be of any type.</span>
            <span style="color:#228B22">%   info is recommended to be a struct with information</span>
            <span style="color:#228B22">%   about the chunk of data read. data represents the</span>
            <span style="color:#228B22">%   underlying class of tall, if tall is created on top of</span>
            <span style="color:#228B22">%   this datastore. This is an abstract method and must be</span>
            <span style="color:#228B22">%   implemented by the subclasses.</span>
            
            <span style="color:#228B22">% In this example, the read method reads data from the</span>
            <span style="color:#228B22">% datastore using a custom reader function, MyFileReader,</span>
            <span style="color:#228B22">% which takes the resolved filenames as input.</span>
            <span style="color:#0000FF">if</span> ~hasdata(myds)
                error(<span style="color:#A020F0">"No more data to read.\nUse reset method to "</span> <span style="color:#0000FF">...</span>
                    + <span style="color:#A020F0">"reset the datastore to the start of the data. Before "</span> <span style="color:#0000FF">...</span>
                    + <span style="color:#A020F0">"calling the read method, check if data is available "</span> <span style="color:#0000FF">...</span>
                    + <span style="color:#A020F0">"to read by using the hasdata method."</span>);
            <span style="color:#0000FF">end</span>
            
            file = nextfile(myds.Files);
            <span style="color:#0000FF">try</span>
                data = dicomread(file.Filename);
            <span style="color:#0000FF">catch</span> ME
                error(<span style="color:#A020F0">"%s has failed"</span>, file.FileName);
            <span style="color:#0000FF">end</span>
            
            info.FileSize = size(data);
            info.Filename = file.Filename;
        <span style="color:#0000FF">end</span>
        
        <span style="color:#0000FF">function</span> reset(myds)
            <span style="color:#228B22">%RESET   Reset to the start of the data.</span>
            <span style="color:#228B22">%   Reset the datastore to the state where no data has been</span>
            <span style="color:#228B22">%   read from it. This is an abstract method and must be</span>
            <span style="color:#228B22">%   implemented by the subclasses.</span>
            
            <span style="color:#228B22">% In this example, the datastore is reset to point to the</span>
            <span style="color:#228B22">% first file (and first partition) in the datastore.</span>
            reset(myds.Files);
        <span style="color:#0000FF">end</span>
        
        <span style="color:#0000FF">function</span> frac = progress(myds)
            <span style="color:#228B22">%PROGRESS   Percentage of consumed data between 0.0 and 1.0.</span>
            <span style="color:#228B22">%   Return fraction between 0.0 and 1.0 indicating progress as a</span>
            <span style="color:#228B22">%   double. The provided example implementation returns the</span>
            <span style="color:#228B22">%   ratio of the index of the current file from FileSet</span>
            <span style="color:#228B22">%   to the number of files in FileSet. A simpler</span>
            <span style="color:#228B22">%   implementation can be used here that returns a 1.0 when all</span>
            <span style="color:#228B22">%   the data has been read from the datastore, and 0.0</span>
            <span style="color:#228B22">%   otherwise.</span>
            <span style="color:#228B22">%</span>
            <span style="color:#228B22">%   See also matlab.io.Datastore, read, hasdata, reset, readall,</span>
            <span style="color:#228B22">%   preview.</span>
            frac = progress(myds.Files);
        <span style="color:#0000FF">end</span>
    <span style="color:#0000FF">end</span>
    
    <span style="color:#0000FF">methods</span>(Access = protected)
        <span style="color:#0000FF">function</span> dsCopy = copyElement(myds)
            <span style="color:#228B22">%COPYELEMENT   Create a deep copy of the datastore</span>
            <span style="color:#228B22">%   Create a deep copy of the datastore. We need to call</span>
            <span style="color:#228B22">%   copy on the datastore's property FileSet because it is</span>
            <span style="color:#228B22">%   a handle object. Creating a deep copy allows methods</span>
            <span style="color:#228B22">%   such as readall and preview, which call the copy method,</span>
            <span style="color:#228B22">%   to remain stateless.</span>
            dsCopy = copyElement@matlab.mixin.Copyable(myds);
            dsCopy.Files = copy(myds.Files);
        <span style="color:#0000FF">end</span>
        
        <span style="color:#0000FF">function</span> tf = write(myds, data, writeInfo, outFmt, varargin)
            <span style="color:#0000FF">if</span> outFmt == <span style="color:#A020F0">"dcm"</span>
                dicomwrite(data, writeInfo.SuggestedOutputName, varargin{:});
            <span style="color:#0000FF">else</span>
                write@matlab.io.datastore.FileWritable(myds, data, <span style="color:#0000FF">...</span>
                    writeInfo, outFmt, varargin{:});
            <span style="color:#0000FF">end</span>
            tf = true;
        <span style="color:#0000FF">end</span>
        
        <span style="color:#0000FF">function</span> files = getFiles(myds)
            files = myds.Files.FileInfo.Filename;
        <span style="color:#0000FF">end</span>
    <span style="color:#0000FF">end</span>
<span style="color:#0000FF">end</span></pre></div></div></div></div></section><section><h3 class="title" id="mw_bdf27bbe-1fd7-435d-81d3-382b90f0a96a">Using the <code class="class">DICOMDatastore</code> Class</h3><p>After you implement the <code class="class">DICOMDatastore</code> class, you can use the constructor
        to create a new <code class="object">DICOMDatastore</code> object that references the location of a set
        of DICOM files. For example, if you have DICOM files in the folder
          <code class="literal">C:\Data\DICOM\series-000001\</code>:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>ds = DICOMDatastore(<span style="color:#A020F0">"C:\Data\DICOM\series-000001"</span>)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ds = 

  DICOMDatastore with properties:

                     Files: [1×1 matlab.io.datastore.FileSet]
    SupportedOutputFormats: ["png"    "jpg"    "jpeg"    "tif"    "tiff"    "dcm"]
       DefaultOutputFormat: "dcm"
                   Folders: {'C:\Data\DICOM\series-000001'}</pre></div></div></div><p>Class users of <code class="object">DICOMDatastore</code> have access to these public
        methods:<div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>methods(ds)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>Methods for class DICOMDatastore:

DICOMDatastore   copy      isPartitionable  preview    read     reset      writeall         
combine          hasdata   isShuffleable    progress   readall  transform        

Methods of DICOMDatastore inherited from handle.</pre></div></div></div></p><p>In particular, with support for <code class="method">writeall</code>, you can write the files to a
        new
        location:<div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>writeall(ds,<span style="color:#A020F0">"C:\Data2\DICOM\"</span>)</pre></div></div></div>This
        command creates copies of the datastore files in the folder
          <code class="literal">C:\Data2\DICOM\series-000001</code>.</p><p>For general information on authoring classes in MATLAB<sup>&#x00AE;</sup>, see <a href="../object-oriented-programming.html" class="a">Classes</a>.</p></section>
      <h2 id="d126e32249">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/matlab.io.datastore-class.html"><span itemprop="name"><code class="class">matlab.io.Datastore</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/matlab.io.datastore.filewritable-class.html"><span itemprop="name"><code class="class">matlab.io.datastore.FileWritable</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/matlab.io.datastore.folderspropertyprovider-class.html"><span itemprop="name"><code class="class">matlab.io.datastore.FoldersPropertyProvider</code></span></a></span></p>
      <h3 id="d126e32261">Topics</h3><ul class="list-unstyled"><li><a href="develop-custom-datastore.html" class="a">Develop Custom Datastore</a></li><li><a href="testing-guidelines-for-custom-datastores.html" class="a">Testing Guidelines for Custom Datastores</a></li></ul>
      
    </section>
    </div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>ichol</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../sparse-matrices.html",
          "name": "Sparse Matrices"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "sparse-matrices"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExtendedCapabilities",

        "itemListElement":
        [
{
          "@type": "ListItem",
          "position": 1,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "distributedarrays",
          "value": "limited"

        }
          },
{
          "@type": "ListItem",
          "position": 2,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "threadsupport",
          "value": "full"

        }
          }
        ]
        }
        </script>
<meta xmlns="http://www.w3.org/1999/xhtml" name="chunktype" content="refpage"><meta xmlns="http://www.w3.org/1999/xhtml" name="refentity" itemprop="refentity" content="function:ichol"><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="fcn">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ref/function">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This MATLAB function performs the incomplete Cholesky factorization of A with zero-fill."><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "refentry";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../sparse-matrices.html?s_tid=CRUX_lftnav" itemprop="url" id="sparse-matrices"><span itemprop="title">Sparse Matrices</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item notranslate"><a href="#responsive_offcanvas"><span class="refname">ichol</span></a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-refentry">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li><a href="#mw_b4527298-7529-4816-bb69-9b1f98b21cbf" class="intrnllnk">Syntax</a></li><li class="nav-item"><a href="#description" class="nav-link intrnllnk">Description</a></li><li class="nav-item"><a href="#mw_5dffb6b5-01c2-4a5e-8abe-56118eca3689" class="nav-link intrnllnk">Examples</a><ul class="nav"><li class="nav-item"><a href="#mw_c2aec2c2-5495-4c7a-bed6-c082e5908856" class="nav-link intrnllnk">Incomplete Cholesky Factorization</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_28cfe5ad-4bcd-40fd-80a7-00010d47c2ae" class="nav-link intrnllnk">Using <code class="literal">ichol</code> as a Preconditioner</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_73bdfb2b-1a2b-4818-bb33-c7132c7ce45d" class="nav-link intrnllnk">Using the <code class="literal">diagcomp</code> Option</a></li></ul></li><li class="nav-item"><a href="#mw_41e1534d-ef29-4252-bfe3-b6213d15ee54" class="nav-link intrnllnk">Input Arguments</a><ul class="nav"><li class="nav-item"><a href="#mw_0ffec19e-20b8-4a92-b414-8a265e5060d7" class="nav-link intrnllnk">A</a></li><li class="nav-item"><a href="#mw_b1e10f55-a0c7-4d70-aedf-32ce0761ac96" class="nav-link intrnllnk">options</a></li></ul></li><li class="nav-item"><a href="#mw_750ef15e-16ea-4e10-b004-35d707afc875" class="nav-link intrnllnk">Tips</a></li><li><a href="#References" class="intrnllnk">References</a></li><li class="nav-item"><a href="#refsect-extended-capabilities" class="nav-link intrnllnk">Extended Capabilities</a></li><li class="nav-item"><a href="#mw_5b57a2c9-b1a9-4412-b48a-1557e687767e" class="nav-link intrnllnk">Version History</a><ul class="nav"><li class="nav-item"><a href="#mw_56e7b2e3-7fba-4ee6-bc1e-64e9e2f94436" class="nav-link intrnllnk">Specify single-precision sparse input argument</a></li></ul></li><li class="nav-item"><a href="#bsvw41x_seealso" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=sparse-matrices&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=sparse-matrices&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=sparse-matrices&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=sparse-matrices&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=sparse-matrices&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=sparse-matrices&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-ref-function"><div class="function_ref"><span id="bsvw41x" class="anchor_target"></span><h1 class="r2025b notranslate" itemprop="title"><span class="refname">ichol</span></h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">Incomplete Cholesky factorization</p><div class="switch"><a href="javascript:void(0);" id="expandAllPage" data-allexpanded="true1">collapse all in page</a></div></div></div>
<span id="mw_b4527298-7529-4816-bb69-9b1f98b21cbf" class="anchor_target"></span><div class="ref_sect"><h2 id="mw_b4527298-7529-4816-bb69-9b1f98b21cbf">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><div class="code_responsive"><code class="synopsis"><a href="#d126e840856" class="intrnllnk">L = ichol(A)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e840875" class="intrnllnk">L = ichol(A,options)</a></code></div></div></div></div><div class="clear"></div><span id="mw_6a2eb1ee-b83f-48bf-ade4-9f16811bd96c" class="anchor_target"></span><h2 id="description">Description</h2><div class="descriptions"><div class="cshsummary" id="csh_bsvw41x"><div class="description_module"><div class="description_element"><div class="code_responsive"><p><span id="d126e840856" itemprop="syntax"><code class="synopsis"><code class="argument">L</code> = ichol(<a href="#mw_0ffec19e-20b8-4a92-b414-8a265e5060d7" class="intrnllnk"><code class="argument">A</code></a>)</code></span> performs the
        incomplete Cholesky factorization of <code class="argument">A</code> with zero-fill.
          <code class="argument">A</code> must be a sparse square matrix.</p></div><p class="syntax_example"><a href="ichol.html#mw_c2aec2c2-5495-4c7a-bed6-c082e5908856" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e840875" itemprop="syntax"><code class="synopsis"><code class="argument">L</code> = ichol(<a href="#mw_0ffec19e-20b8-4a92-b414-8a265e5060d7" class="intrnllnk"><code class="argument">A</code></a>,<a href="#mw_b1e10f55-a0c7-4d70-aedf-32ce0761ac96" class="intrnllnk"><code class="argument">options</code></a>)</code></span>
        performs the incomplete Cholesky factorization of <code class="argument">A</code> with options
        specified by the structure <code class="argument">options</code>.</p><p>By default, <code class="function">ichol</code> references the lower triangle of
          <code class="literal">A</code> and produces lower triangular factors.</p></div><p class="syntax_example"><a href="ichol.html#mw_28cfe5ad-4bcd-40fd-80a7-00010d47c2ae" class="intrnllnk">example</a></p></div></div></div></div><div class="clear"></div><div class="examples"><h2 id="mw_5dffb6b5-01c2-4a5e-8abe-56118eca3689">Examples</h2><div class="expandableContent" id="expandableExamples"><p class="switch"><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true3">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_c2aec2c2-5495-4c7a-bed6-c082e5908856"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_c2aec2c2-5495-4c7a-bed6-c082e5908856" data-bs-target="#expand_accordion_body_mw_c2aec2c2-5495-4c7a-bed6-c082e5908856" aria-controls="expand_accordion_body_mw_c2aec2c2-5495-4c7a-bed6-c082e5908856" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_c2aec2c2-5495-4c7a-bed6-c082e5908856">Incomplete Cholesky Factorization</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_c2aec2c2-5495-4c7a-bed6-c082e5908856" aria-labelledby="expand_accordion_heading_mw_c2aec2c2-5495-4c7a-bed6-c082e5908856" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/IncompleteCholeskyFactorizationExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Incomplete Cholesky Factorization",
          "description": "Generates an incomplete Cholesky factorization.",
          "thumbnailURL": "../../examples/matlab/win64/IncompleteCholeskyFactorizationExample_02.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "ichol.html"

        },
          "identifier": "matlab.IncompleteCholeskyFactorizationExample",
          "name": "IncompleteCholeskyFactorizationExample",
          "url": "ichol.html#mw_c2aec2c2-5495-4c7a-bed6-c082e5908856"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/IncompleteCholeskyFactorizationExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "IncompleteCholeskyFactorizationExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">This example generates an incomplete Cholesky factorization.</p><p>Start with a symmetric positive definite matrix, <code class="literal">A</code>:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>N = 100;
A = delsq(numgrid(<span style="color:#A020F0">'S'</span>,N));</pre></div></div></div><p><code class="literal">A</code> is the two-dimensional, five-point discrete negative Laplacian on a 100-by-100 square grid with Dirichlet boundary conditions. The size of <code class="literal">A</code> is <code class="literal">98*98 = 9604</code> (not 10000 as the borders of the grid are used to impose the Dirichlet conditions).</p><p>The no-fill incomplete Cholesky factorization is a factorization which contains only nonzeros in the same position as <code class="literal">A</code> contains nonzeros. This factorization is extremely cheap to compute. Although the product <code class="literal">L*L'</code> is typically very different from <code class="literal">A</code>, the product <code class="literal">L*L'</code> will match <code class="literal">A</code> on its pattern up to round-off.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>L = ichol(A);
norm(A-L*L',<span style="color:#A020F0">'fro'</span>)./norm(A,<span style="color:#A020F0">'fro'</span>)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans = 
0.0916
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>norm(A-(L*L').*spones(A),<span style="color:#A020F0">'fro'</span>)./norm(A,<span style="color:#A020F0">'fro'</span>)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans = 
4.9606e-17
</pre></div></div></div><p><code class="literal">ichol</code> may also be used to generate incomplete Cholesky factorizations with threshold dropping. As the drop tolerance decreases, the factor tends to get more dense and the product <code class="literal">L*L'</code> tends to be a better approximation of <code class="literal">A</code>. The following plots show the relative error of the incomplete factorization plotted against the drop tolerance as well as the ratio of the density of the incomplete factors to the density of the complete Cholesky factor.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>n = size(A,1);
ntols = 20;
droptol = logspace(-8,0,ntols);
nrm = zeros(1,ntols);
nz = zeros(1,ntols);
nzComplete = nnz(chol(A,<span style="color:#A020F0">'lower'</span>));
<span style="color:#0000FF">for</span> k = 1:ntols
    L = ichol(A,struct(<span style="color:#A020F0">'type'</span>,<span style="color:#A020F0">'ict'</span>,<span style="color:#A020F0">'droptol'</span>,droptol(k)));
    nz(k) = nnz(L);
    nrm(k) = norm(A-L*L',<span style="color:#A020F0">'fro'</span>)./norm(A,<span style="color:#A020F0">'fro'</span>);
<span style="color:#0000FF">end</span>
figure
loglog(droptol,nrm,<span style="color:#A020F0">'LineWidth'</span>,2)
title(<span style="color:#A020F0">'Drop tolerance vs norm(A-L*L'',''fro'')./norm(A,''fro'')'</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e840965" class="mediaobject"><p><img src="../../examples/matlab/win64/IncompleteCholeskyFactorizationExample_01.png" alt="Figure contains an axes object. The axes object with title Drop tolerance vs norm(A-L*L','fro')./norm(A,'fro') contains an object of type line." width="560"></p></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>figure
semilogx(droptol,nz./nzComplete,<span style="color:#A020F0">'LineWidth'</span>,2)
title(<span style="color:#A020F0">'Drop tolerance vs fill ratio ichol/chol'</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e840972" class="mediaobject"><p><img src="../../examples/matlab/win64/IncompleteCholeskyFactorizationExample_02.png" alt="Figure contains an axes object. The axes object with title Drop tolerance vs fill ratio ichol/chol contains an object of type line." width="560"></p></div></div><p>The relative error is typically on the same order as the drop tolerance, although this is not guaranteed.</p><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-IncompleteCholeskyFactorizationExample"><meta itemprop="exampletitle" content="Incomplete Cholesky Factorization"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_28cfe5ad-4bcd-40fd-80a7-00010d47c2ae"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_28cfe5ad-4bcd-40fd-80a7-00010d47c2ae" data-bs-target="#expand_accordion_body_mw_28cfe5ad-4bcd-40fd-80a7-00010d47c2ae" aria-controls="expand_accordion_body_mw_28cfe5ad-4bcd-40fd-80a7-00010d47c2ae" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_28cfe5ad-4bcd-40fd-80a7-00010d47c2ae">Using <code class="literal">ichol</code> as a Preconditioner</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_28cfe5ad-4bcd-40fd-80a7-00010d47c2ae" aria-labelledby="expand_accordion_heading_mw_28cfe5ad-4bcd-40fd-80a7-00010d47c2ae" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/UsingIcholAsAPreconditionerExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Using ichol as a Preconditioner",
          "description": "Use an incomplete Cholesky factorization as a preconditioner to improve convergence.",
          "thumbnailURL": "../../examples/matlab/win64/UsingIcholAsAPreconditionerExample_02.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "ichol.html"

        },
          "identifier": "matlab.UsingIcholAsAPreconditionerExample",
          "name": "UsingIcholAsAPreconditionerExample",
          "url": "ichol.html#mw_28cfe5ad-4bcd-40fd-80a7-00010d47c2ae"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/UsingIcholAsAPreconditionerExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "UsingIcholAsAPreconditionerExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">This example shows how to use an incomplete Cholesky factorization as a preconditioner to improve convergence.</p><p>Create a symmetric positive definite matrix, <code class="literal">A</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>N = 100;
A = delsq(numgrid(<span style="color:#A020F0">'S'</span>,N));</pre></div></div></div><p>Create an incomplete Cholesky factorization as a preconditioner for <code class="literal">pcg</code>. Use a constant vector as the right hand side. As a baseline, execute <code class="literal">pcg</code> without a preconditioner.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>b = ones(size(A,1),1);
tol = 1e-6;
maxit = 100;
[x0,fl0,rr0,it0,rv0] = pcg(A,b,tol,maxit);</pre></div></div></div><p>Note that <code class="literal">fl0 = 1</code> indicating that <code class="literal">pcg</code> did not drive the relative residual to the requested tolerance in the maximum allowed iterations. Try the no-fill incomplete Cholesky factorization as a preconditioner.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>L1 = ichol(A);
[x1,fl1,rr1,it1,rv1] = pcg(A,b,tol,maxit,L1,L1');</pre></div></div></div><p><code class="literal">fl1 = 0</code>, indicating that <code class="literal">pcg</code> converged to the requested tolerance and did so in 59 iterations (the value of <code class="literal">it1</code>). Since this matrix is a discretized Laplacian, however, using modified incomplete Cholesky can create a better preconditioner. A modified incomplete Cholesky factorization constructs an approximate factorization that preserves the action of the operator on the constant vector. That is, <code class="literal">norm(A*e-L*(L'*e))</code> will be approximately zero for <code class="literal">e = ones(size(A,2),1)</code> even though <code class="literal">norm(A-L*L','fro')/norm(A,'fro')</code> is not close to zero. It is not necessary to specify type for this syntax since <code class="literal">nofill</code> is the default, but it is good practice.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>options.type = <span style="color:#A020F0">'nofill'</span>;
options.michol = <span style="color:#A020F0">'on'</span>;
L2 = ichol(A,options);
e = ones(size(A,2),1);
norm(A*e-L2*(L2'*e))</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans = 
3.7983e-14
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[x2,fl2,rr2,it2,rv2] = pcg(A,b,tol,maxit,L2,L2');</pre></div></div></div><p><code class="literal">pcg</code> converges (<code class="literal">fl2 = 0</code>) but in only 38 iterations. Plotting all three convergence histories shows the convergence.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>semilogy(0:maxit,rv0./norm(b),<span style="color:#A020F0">'b.'</span>);
hold <span style="color:#A020F0">on</span>
semilogy(0:it1,rv1./norm(b),<span style="color:#A020F0">'r.'</span>);
semilogy(0:it2,rv2./norm(b),<span style="color:#A020F0">'k.'</span>);
legend(<span style="color:#A020F0">'No Preconditioner'</span>,<span style="color:#A020F0">'IC(0)'</span>,<span style="color:#A020F0">'MIC(0)'</span>);</pre></div></div></div><div class="informalfigure"><div id="d126e841054" class="mediaobject"><p><img src="../../examples/matlab/win64/UsingIcholAsAPreconditionerExample_01.png" alt="Figure contains an axes object. The axes object contains 3 objects of type line. One or more of the lines displays its values using only markers These objects represent No Preconditioner, IC(0), MIC(0)." width="560"></p></div></div><p>The plot shows that the modified incomplete Cholesky preconditioner creates a much faster convergence. </p><p>You can also try incomplete Cholesky factorizations with threshold dropping. The following plot shows convergence of <code class="literal">pcg</code> with preconditioners constructed with various drop tolerances.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>L3 = ichol(A, struct(<span style="color:#A020F0">'type'</span>,<span style="color:#A020F0">'ict'</span>,<span style="color:#A020F0">'droptol'</span>,1e-1));
[x3,fl3,rr3,it3,rv3] = pcg(A,b,tol,maxit,L3,L3');
L4 = ichol(A, struct(<span style="color:#A020F0">'type'</span>,<span style="color:#A020F0">'ict'</span>,<span style="color:#A020F0">'droptol'</span>,1e-2));
[x4,fl4,rr4,it4,rv4] = pcg(A,b,tol,maxit,L4,L4');
L5 = ichol(A, struct(<span style="color:#A020F0">'type'</span>,<span style="color:#A020F0">'ict'</span>,<span style="color:#A020F0">'droptol'</span>,1e-3));
[x5,fl5,rr5,it5,rv5] = pcg(A,b,tol,maxit,L5,L5'); 

figure
semilogy(0:maxit,rv0./norm(b),<span style="color:#A020F0">'b-'</span>,<span style="color:#A020F0">'linewidth'</span>,2);
hold <span style="color:#A020F0">on</span>
semilogy(0:it3,rv3./norm(b),<span style="color:#A020F0">'b-.'</span>,<span style="color:#A020F0">'linewidth'</span>,2);
semilogy(0:it4,rv4./norm(b),<span style="color:#A020F0">'b--'</span>,<span style="color:#A020F0">'linewidth'</span>,2);
semilogy(0:it5,rv5./norm(b),<span style="color:#A020F0">'b:'</span>,<span style="color:#A020F0">'linewidth'</span>,2);
legend(<span style="color:#A020F0">'No Preconditioner'</span>,<span style="color:#A020F0">'ICT(1e-1)'</span>,<span style="color:#A020F0">'ICT(1e-2)'</span>, <span style="color:#0000FF">...</span>
   <span style="color:#A020F0">'ICT(1e-3)'</span>,<span style="color:#A020F0">'Location'</span>,<span style="color:#A020F0">'SouthEast'</span>);</pre></div></div></div><div class="informalfigure"><div id="d126e841066" class="mediaobject"><p><img src="../../examples/matlab/win64/UsingIcholAsAPreconditionerExample_02.png" alt="Figure contains an axes object. The axes object contains 4 objects of type line. These objects represent No Preconditioner, ICT(1e-1), ICT(1e-2), ICT(1e-3)." width="560"></p></div></div><p>Note the incomplete Cholesky preconditioner constructed with drop tolerance <code class="literal">1e-2</code> is denoted as <code class="literal">ICT(1e-2)</code>. </p><p>As with the zero-fill incomplete Cholesky, the threshold dropping factorization can benefit from modification (i.e. <code class="literal">options.michol = 'on'</code>) since the matrix arises from an elliptic partial differential equation. As with <code class="literal">MIC(0)</code>, the modified threshold based dropping incomplete Cholesky will preserve the action of the preconditioner on constant vectors, that is <code class="literal">norm(A*e-L*(L'*e))</code> will be approximately zero.</p><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-UsingIcholAsAPreconditionerExample"><meta itemprop="exampletitle" content="Using ichol as a Preconditioner"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_73bdfb2b-1a2b-4818-bb33-c7132c7ce45d"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_73bdfb2b-1a2b-4818-bb33-c7132c7ce45d" data-bs-target="#expand_accordion_body_mw_73bdfb2b-1a2b-4818-bb33-c7132c7ce45d" aria-controls="expand_accordion_body_mw_73bdfb2b-1a2b-4818-bb33-c7132c7ce45d" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_73bdfb2b-1a2b-4818-bb33-c7132c7ce45d">Using the <code class="literal">diagcomp</code> Option</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_73bdfb2b-1a2b-4818-bb33-c7132c7ce45d" aria-labelledby="expand_accordion_heading_mw_73bdfb2b-1a2b-4818-bb33-c7132c7ce45d" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/UsingTheDiagcompOptionExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Using the diagcomp Option",
          "description": "Illustrates the use of the diagcomp option of ichol.",
          "thumbnailURL": "../../examples/matlab/win64/UsingTheDiagcompOptionExample_01.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "ichol.html"

        },
          "identifier": "matlab.UsingTheDiagcompOptionExample",
          "name": "UsingTheDiagcompOptionExample",
          "url": "ichol.html#mw_73bdfb2b-1a2b-4818-bb33-c7132c7ce45d"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/UsingTheDiagcompOptionExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "UsingTheDiagcompOptionExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">This example illustrates the use of the <code class="literal">diagcomp</code> option of <code class="literal">ichol</code>. </p><p>Incomplete Cholesky factorizations of positive definite matrices do not always exist. The following code constructs a random symmetric positive definite matrix and attempts to solve a linear system using <code class="literal">pcg</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>S = rng(<span style="color:#A020F0">'default'</span>);
A = sprandsym(1000,1e-2,1e-4,1);
rng(S);
b = full(sum(A,2));
[x0,fl0,rr0,it0,rv0] = pcg(A,b,1e-6,100);</pre></div></div></div><p>Since convergence is not attained, try to construct an incomplete Cholesky preconditioner.</p><div class="code_responsive"><pre id="d126e841119" class="programlisting">L = ichol(A,struct(<span style="color:#A020F0">'type'</span>,<span style="color:#A020F0">'ict'</span>,<span style="color:#A020F0">'droptol'</span>,1e-3));
</pre></div><div class="code_responsive"><pre class="programlisting">Error using ichol
Encountered nonpositive pivot.
</pre></div><p>If <code class="literal">ichol</code> breaks down as above, you can use the <code class="literal">diagcomp</code> option to construct a shifted incomplete Cholesky factorization. That is, instead of constructing <code class="literal">L</code> such that <code class="literal">L*L'</code> approximates <code class="literal">A</code>, <code class="literal">ichol</code> with diagonal compensation constructs <code class="literal">L</code> such that <code class="literal">L*L'</code> approximates <code class="literal">M = A + alpha*diag(diag(A))</code> without explicitly forming <code class="literal">M</code>. As incomplete factorizations always exist for diagonally dominant matrices, <code class="literal">alpha</code> can be found to make <code class="literal">M</code> diagonally dominant.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>alpha = max(sum(abs(A),2)./diag(A))-2</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>alpha = 
62.9341
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>L1 = ichol(A, struct(<span style="color:#A020F0">'type'</span>,<span style="color:#A020F0">'ict'</span>,<span style="color:#A020F0">'droptol'</span>,1e-3,<span style="color:#A020F0">'diagcomp'</span>,alpha));
[x1,fl1,rr1,it1,rv1] = pcg(A,b,1e-6,100,L1,L1');</pre></div></div></div><p>Here, <code class="literal">pcg</code> still fails to converge to the desired tolerance within the desired number of iterations, but as the plot below shows, convergence is better for <code class="literal">pcg</code> with this preconditioner than with no preconditioner. Choosing a smaller <code class="literal">alpha</code> may help. With some experimentation, we can settle on an appropriate value for <code class="literal">alpha</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>alpha = .1;
L2 = ichol(A, struct(<span style="color:#A020F0">'type'</span>,<span style="color:#A020F0">'ict'</span>,<span style="color:#A020F0">'droptol'</span>,1e-3,<span style="color:#A020F0">'diagcomp'</span>,alpha));
[x2,fl2,rr2,it2,rv2] = pcg(A,b,1e-6,100,L2,L2');</pre></div></div></div><p>Now, <code class="literal">pcg</code> converges and a plot can show the convergence histories with each preconditioner.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>semilogy(0:100,rv0./norm(b),<span style="color:#A020F0">'b.'</span>);
hold <span style="color:#A020F0">on</span>;
semilogy(0:100,rv1./norm(b),<span style="color:#A020F0">'r.'</span>);
semilogy(0:it2,rv2./norm(b),<span style="color:#A020F0">'k.'</span>);
legend(<span style="color:#A020F0">'No Preconditioner'</span>,<span style="color:#A020F0">'\alpha \approx 63'</span>,<span style="color:#A020F0">'\alpha = .1'</span>);
xlabel(<span style="color:#A020F0">'Iteration Number'</span>);
ylabel(<span style="color:#A020F0">'Relative Residual'</span>);</pre></div></div></div><div class="informalfigure"><div id="d126e841176" class="mediaobject"><p><img src="../../examples/matlab/win64/UsingTheDiagcompOptionExample_01.png" alt="Figure contains an axes object. The axes object with xlabel Iteration Number, ylabel Relative Residual contains 3 objects of type line. One or more of the lines displays its values using only markers These objects represent No Preconditioner, \alpha \approx 63, \alpha = .1." width="560"></p></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-UsingTheDiagcompOptionExample"><meta itemprop="exampletitle" content="Using the diagcomp Option"></div></div></div></div><div class="ref_sect"><h2 id="mw_41e1534d-ef29-4252-bfe3-b6213d15ee54">Input Arguments</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="mw_41e1534d-ef29-4252-bfe3-b6213d15ee54_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="mw_0ffec19e-20b8-4a92-b414-8a265e5060d7"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_0ffec19e-20b8-4a92-b414-8a265e5060d7" data-bs-target="#expand_accordion_body_mw_0ffec19e-20b8-4a92-b414-8a265e5060d7" aria-controls="expand_accordion_body_mw_0ffec19e-20b8-4a92-b414-8a265e5060d7" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_A" class="anchor_target"></span><h3 id="mw_0ffec19e-20b8-4a92-b414-8a265e5060d7"><code itemprop="name">A</code> &#8212; <span itemprop="purpose">Input matrix</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">sparse square matrix</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_0ffec19e-20b8-4a92-b414-8a265e5060d7" aria-labelledby="expand_accordion_heading_mw_0ffec19e-20b8-4a92-b414-8a265e5060d7" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_0ffec19e-20b8-4a92-b414-8a265e5060d7"><p>Input matrix, specified as a sparse square matrix.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code><br/>
<strong>Complex Number Support: </strong>Yes</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="mw_b1e10f55-a0c7-4d70-aedf-32ce0761ac96"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_b1e10f55-a0c7-4d70-aedf-32ce0761ac96" data-bs-target="#expand_accordion_body_mw_b1e10f55-a0c7-4d70-aedf-32ce0761ac96" aria-controls="expand_accordion_body_mw_b1e10f55-a0c7-4d70-aedf-32ce0761ac96" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_options" class="anchor_target"></span><h3 id="mw_b1e10f55-a0c7-4d70-aedf-32ce0761ac96"><code itemprop="name">options</code> &#8212; <span itemprop="purpose">Cholesky factorization options</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">structure</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_b1e10f55-a0c7-4d70-aedf-32ce0761ac96" aria-labelledby="expand_accordion_heading_mw_b1e10f55-a0c7-4d70-aedf-32ce0761ac96" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_b1e10f55-a0c7-4d70-aedf-32ce0761ac96"><p>Cholesky factorization options, specified as a structure with up to five
              fields:</p>
<div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="16%"><col class="tcol2" width="42%"><col class="tcol3" width="42%"></colgroup><thead><tr><th>Field Name</th><th>Summary</th><th>Description</th></tr></thead><tbody><tr><td><code class="literal">type</code></td><td>Type of factorization</td><td><p>Indicates which flavor of incomplete Cholesky to perform. Valid
                        values of this field are <code class="literal">'nofill'</code> and
                          <code class="literal">'ict'</code>. The <code class="literal">'nofill'</code> variant performs
                          <em class="firstterm">incomplete Cholesky with zero-fill</em>
                          (<code class="literal">IC(0)</code>). The <code class="literal">'ict'</code> variant
                          performs<em class="firstterm"> incomplete Cholesky with threshold
                          dropping</em> (ICT). The default value is
                          <code class="literal">'nofill'</code>.</p></td></tr><tr><td><code class="literal">droptol</code></td><td>Drop tolerance when type is <code class="literal">'ict'</code></td><td><p>Nonnegative scalar used as a drop tolerance when performing ICT.
                        Elements which are smaller in magnitude than a local drop tolerance are
                        dropped from the resulting factor except for the diagonal element which is
                        never dropped. The local drop tolerance at step <code class="literal">j</code> of the
                        factorization is <code class="literal">norm(A(j:end,j),1)*droptol</code>.
                          <code class="literal">'droptol'</code> is ignored if <code class="literal">'type'</code> is
                          <code class="literal">'nofill'</code>. The default value is
                        <code class="literal">0</code>.</p></td></tr><tr><td><code class="literal">michol</code></td><td>Indicates whether to perform modified incomplete Cholesky</td><td><p>Indicates whether or not <em class="firstterm">modified incomplete
                          Cholesky</em> (MIC) is performed. The field may be
                          <code class="literal">'on'</code> or <code class="literal">'off'</code>. When performing MIC,
                        the diagonal is compensated for dropped elements to enforce the relationship
                          <code class="literal">A*e = L*L'*e</code> where
                          <code class="literal">e&nbsp;=&nbsp;ones(size(A,2),1)</code>. The default value is
                          <code class="literal">'off'</code>.</p></td></tr><tr><td><code class="literal">diagcomp</code></td><td>Perform compensated incomplete Cholesky with the specified
                      coefficient</td><td><p>Real nonnegative scalar used as a global diagonal shift
                          <code class="literal">alpha</code> in forming the incomplete Cholesky factor. That
                        is, instead of performing incomplete Cholesky on <code class="literal">A</code>, the
                        factorization of <code class="literal">A + alpha*diag(diag(A))</code> is formed. The
                        default value is <code class="literal">0</code>.</p></td></tr><tr><td><code class="literal">shape</code></td><td>Determines which triangle is referenced and returned</td><td><p>Valid values are <code class="literal">'upper'</code> and
                          <code class="literal">'lower'</code>. If <code class="literal">'upper'</code> is specified,
                        only the upper triangle of <code class="literal">A</code> is referenced and
                          <code class="literal">R</code> is constructed such that <code class="literal">A</code> is
                        approximated by <code class="literal">R'*R</code>. If <code class="literal">'lower'</code> is
                        specified, only the lower triangle of <code class="literal">A</code> is referenced and
                          <code class="literal">L</code> is constructed such that <code class="literal">A</code> is
                        approximated by <code class="literal">L*L'</code>. The default value is
                          <code class="literal">'lower'</code>.</p></td></tr></tbody></table></div><p>
</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">options.type = 'nofill'; options.michol = 'on'; L =
              ichol(A,options);</code></p></div></div></div></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="mw_750ef15e-16ea-4e10-b004-35d707afc875">Tips</h2><div class="itemizedlist"><ul><li><p>The factor given by this routine may be useful as a preconditioner for a system of
          linear equations being solved by iterative methods such as <a href="pcg.html"><code class="function">pcg</code></a> or <a href="minres.html"><code class="function">minres</code></a>.</p></li><li><p><code class="function">ichol</code> works only for sparse square matrices.</p></li></ul></div></div><div class="bibliography"><h2 id="References">References</h2><div id="mw_ce0a113c-996d-4433-9657-2b6b89582658" class="bibliomixed"><p>[1] Saad, Yousef.
      Preconditioning Techniques. <em class="citetitle">Iterative Methods for Sparse Linear
        Systems</em>. PWS Publishing Company, 1996.</p></div><div id="mw_395c7929-9281-40b5-818d-73eb3a6be860" class="bibliomixed"><p>[2] Manteuffel, T.A. An
      incomplete factorization technique for positive definite linear systems.
        <em class="citetitle">Math. Comput.</em> 34, 473&#8211;497, 1980.</p></div></div><div class="ref_sect"><h2 id="refsect-extended-capabilities">Extended Capabilities</h2><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink">expand all</a></p><div id="accordion_refsect-extended-capabilities" role="tablist" aria-multiselectable="true"><span id="mw_1db9846a-fc57-45d3-8930-fb9083860512" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="bsvw41x" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_bsvw41x_threadsupport" aria-controls="expand_body_bsvw41x_threadsupport" class="accordion-button collapsed" aria-expanded="false"><h3 id="bsvw41x_threadsupport">Thread-Based Environment<br/> <span class=" remove_bold add_font_color_general">Run code in the background using MATLAB&#174; <code class="function">backgroundPool</code> or accelerate code with Parallel Computing Toolbox&#8482; <code class="function">ThreadPool</code>.</span></h3></button></div><div id="expand_body_bsvw41x_threadsupport" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>This function fully supports thread-based environments. For
                more information, see <a href="../matlab_prog/run-functions-on-threads.html" class="a">Run MATLAB Functions in Thread-Based Environment</a>.</p></div></div></div></div></div><span id="mw_00e2a165-6407-43c5-97c4-9bf2fee0bf1f" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="bsvw41x" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_bsvw41x_distributedarrays" aria-controls="expand_body_bsvw41x_distributedarrays" class="accordion-button collapsed" aria-expanded="false"><h3 id="bsvw41x_distributedarrays">Distributed Arrays<br/> <span class=" remove_bold add_font_color_general">Partition large arrays across the combined memory of your cluster using Parallel Computing Toolbox&#8482;.</span></h3></button></div><div id="expand_body_bsvw41x_distributedarrays" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>Usage notes and limitations:</p><div class="itemizedlist"><ul><li><p>If you specify the <code class="literal">type</code> field of <code class="argument">options</code>, it
            must be <code class="literal">'nofill'</code>.</p></li><li><p><code class="argument">A</code> must be real symmetric or complex hermitian.</p></li></ul></div><p>For more information, see <a href="../../parallel-computing/run-matlab-functions-with-distributed-arrays.html" class="a">Run MATLAB Functions with Distributed Arrays</a><span role="cross_prod"> (Parallel Computing Toolbox)</span>.</p></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="mw_5b57a2c9-b1a9-4412-b48a-1557e687767e">Version History</h2><strong>Introduced in R2011a</strong><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink">expand all</a></p><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_mw_56e7b2e3-7fba-4ee6-bc1e-64e9e2f94436" aria-controls="expand_body_mw_56e7b2e3-7fba-4ee6-bc1e-64e9e2f94436" class="accordion-button collapsed" aria-expanded="false"><h3 id="mw_56e7b2e3-7fba-4ee6-bc1e-64e9e2f94436">R2025a: <span class="remove_bold">Specify single-precision sparse input argument</span></h3></button></div><div id="expand_body_mw_56e7b2e3-7fba-4ee6-bc1e-64e9e2f94436" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>You can specify the input matrix <code class="argument">A</code> as single precision. If
          <code class="argument">A</code> is <code class="class">single</code>, the output arguments are also
          <code class="class">single</code>.</p></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="bsvw41x_seealso">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="ilu.html"><span itemprop="name"><code class="function">ilu</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="chol.html"><span itemprop="name"><code class="function">chol</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="pcg.html"><span itemprop="name"><code class="function">pcg</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="minres.html"><span itemprop="name"><code class="function">minres</code></span></a></span></p><div class="examples_container"><h3 class="remove_border">Topics</h3><div itemprop="content"><ul class="list-unstyled"><li><a href="../math/sparse-matrix-operations.html" class="a">Sparse Matrix Operations</a></li><li><a href="../math/iterative-methods-for-linear-systems.html" class="a">Iterative Methods for Linear Systems</a></li></ul></div></div></div>
    </div></div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright"> 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

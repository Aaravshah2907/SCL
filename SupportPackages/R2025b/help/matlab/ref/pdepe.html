<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>pdepe</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../numerical-integration-and-differential-equations.html",
          "name": "Numerical Integration and Differential Equations"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../partial-differential-equations.html",
          "name": "1-D Partial Differential Equations"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "partial-differential-equations"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExtendedCapabilities",

        "itemListElement":
        [
{
          "@type": "ListItem",
          "position": 1,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "threadsupport",
          "value": "full"

        }
          }
        ]
        }
        </script>
<meta xmlns="http://www.w3.org/1999/xhtml" name="chunktype" content="refpage"><meta xmlns="http://www.w3.org/1999/xhtml" name="refentity" itemprop="refentity" content="function:pdepe"><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="fcn">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ref/function">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This MATLAB function solves a system of parabolic and elliptic PDEs with one spatial variable x and time t."><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "refentry";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../numerical-integration-and-differential-equations.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Numerical Integration and Differential Equations</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../partial-differential-equations.html?s_tid=CRUX_lftnav" itemprop="url" id="partial-differential-equations"><span itemprop="title">1-D Partial Differential Equations</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item notranslate"><a href="#responsive_offcanvas"><span class="refname">pdepe</span></a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-refentry">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li><a href="#mw_c9c194d3-17be-4f4a-8a75-426e200397ec" class="intrnllnk">Syntax</a></li><li class="nav-item"><a href="#description" class="nav-link intrnllnk">Description</a></li><li class="nav-item"><a href="#mw_281ecc1d-ba35-440c-950f-60b2afe69d2a" class="nav-link intrnllnk">Examples</a><ul class="nav"><li class="nav-item"><a href="#mw_7d27054d-ec6e-40dc-a28d-64736d23f2f4" class="nav-link intrnllnk">Solve Heat Equation in Cylindrical Coordinates</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_f13a2184-7def-4cb5-9ac1-b78f1f6299a9" class="nav-link intrnllnk">Solve Oscillatory PDE with Event Logging</a></li></ul></li><li class="nav-item"><a href="#mw_e68f2ac9-79e3-4dc0-8158-8162e8e04295" class="nav-link intrnllnk">Input Arguments</a><ul class="nav"><li class="nav-item"><a href="#mw_bf53ae0b-d53a-47fc-81dc-ee63671697a8" class="nav-link intrnllnk">m</a></li><li class="nav-item"><a href="#mw_ca773a23-ccd3-45fc-9eb0-0982f085f21d" class="nav-link intrnllnk">pdefun</a></li><li class="nav-item"><a href="#mw_dbdef752-2363-43aa-94c6-6c2242a43406" class="nav-link intrnllnk">icfun</a></li><li class="nav-item"><a href="#mw_5ccaac8a-d9a6-484d-8859-2ff9fc7e8913" class="nav-link intrnllnk">bcfun</a></li><li class="nav-item"><a href="#mw_39f0a244-6853-4b5a-b45c-ef17928a7175" class="nav-link intrnllnk">xmesh</a></li><li class="nav-item"><a href="#mw_86a8dc7c-372b-421b-8082-2b459cb51733" class="nav-link intrnllnk">tspan</a></li><li class="nav-item"><a href="#mw_fd83f736-3df0-47ab-a9dc-ccee879d4a20" class="nav-link intrnllnk">options</a></li></ul></li><li class="nav-item"><a href="#mw_cd924e90-b42c-4a68-95ba-5b1f6071a3ef" class="nav-link intrnllnk">Output Arguments</a><ul class="nav"><li class="nav-item"><a href="#mw_97daf312-0f43-4fa2-afb6-c67a624631e6" class="nav-link intrnllnk">sol</a></li><li class="nav-item"><a href="#mw_1d6a06c5-b21c-41fd-a48d-022846dfa03e" class="nav-link intrnllnk">tsol</a></li><li class="nav-item"><a href="#mw_811e78fa-f773-48eb-8187-2fca70fc4707" class="nav-link intrnllnk">sole</a></li><li class="nav-item"><a href="#mw_d8a046b9-0637-4a3e-ade9-87d7956f89e8" class="nav-link intrnllnk">te</a></li><li class="nav-item"><a href="#mw_4a5c0bbc-c204-4a84-91bf-545a7b767e0b" class="nav-link intrnllnk">ie</a></li></ul></li><li class="nav-item"><a href="#mw_077c5e49-ee92-4c2b-a988-c17d8d564362" class="nav-link intrnllnk">Tips</a></li><li class="nav-item"><a href="#mw_01a7b8de-21cb-4df2-83a9-4009baa257d2" class="nav-link intrnllnk">Algorithms</a></li><li><a href="#References" class="intrnllnk">References</a></li><li class="nav-item"><a href="#refsect-extended-capabilities" class="nav-link intrnllnk">Extended Capabilities</a></li><li class="nav-item"><a href="#mw_7a4eeb41-a1c2-4408-af40-5b8838576b71" class="nav-link intrnllnk">Version History</a><ul class="nav"><li class="nav-item"><a href="#mw_43647ea2-6604-4796-907b-1035714317ff" class="nav-link intrnllnk">Specify output function and other <code class="function">odeset</code> options</a></li></ul></li><li class="nav-item"><a href="#f93-998620_seealso" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=partial-differential-equations&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=partial-differential-equations&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=partial-differential-equations&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=partial-differential-equations&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=partial-differential-equations&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=partial-differential-equations&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-ref-function"><div class="function_ref"><span id="f93-998620" class="anchor_target"></span><h1 class="r2025b notranslate" itemprop="title"><span class="refname">pdepe</span></h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">Solve 1-D parabolic and elliptic PDEs</p><div class="switch"><a href="javascript:void(0);" id="expandAllPage" data-allexpanded="true1">collapse all in page</a></div></div></div>
<span id="mw_c9c194d3-17be-4f4a-8a75-426e200397ec" class="anchor_target"></span><div class="ref_sect"><h2 id="mw_c9c194d3-17be-4f4a-8a75-426e200397ec">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><div class="code_responsive"><code class="synopsis"><a href="#d126e1300683" class="intrnllnk">sol = pdepe(m,pdefun,icfun,bcfun,xmesh,tspan)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1300728" class="intrnllnk">sol = pdepe(m,pdefun,icfun,bcfun,xmesh,tspan,options)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1300764" class="intrnllnk">[sol,tsol,sole,te,ie] = pdepe(m,pdefun,icfun,bcfun,xmesh,tspan,options)</a></code></div></div></div></div><div class="clear"></div><span id="mw_5564019d-2ded-4809-8214-ac0641d4dcdd" class="anchor_target"></span><h2 id="description">Description</h2><div class="descriptions"><div class="cshsummary" id="csh_f93-998620"><div class="description_module"><div class="description_element"><div class="code_responsive"><p><span id="d126e1300683" itemprop="syntax"><code class="synopsis"><a href="#mw_97daf312-0f43-4fa2-afb6-c67a624631e6" class="intrnllnk"><code class="argument">sol</code></a> = pdepe(<a href="#mw_bf53ae0b-d53a-47fc-81dc-ee63671697a8" class="intrnllnk"><code class="argument">m</code></a>,<a href="#mw_ca773a23-ccd3-45fc-9eb0-0982f085f21d" class="intrnllnk"><code class="argument">pdefun</code></a>,<a href="#mw_dbdef752-2363-43aa-94c6-6c2242a43406" class="intrnllnk"><code class="argument">icfun</code></a>,<a href="#mw_5ccaac8a-d9a6-484d-8859-2ff9fc7e8913" class="intrnllnk"><code class="argument">bcfun</code></a>,<a href="#mw_39f0a244-6853-4b5a-b45c-ef17928a7175" class="intrnllnk"><code class="argument">xmesh</code></a>,<a href="#mw_86a8dc7c-372b-421b-8082-2b459cb51733" class="intrnllnk"><code class="argument">tspan</code></a>)</code></span>
        solves a system of parabolic and elliptic PDEs with one spatial variable
          <em class="varname">x</em> and time <em class="varname">t</em>. At least one equation must be
        parabolic. The scalar <code class="literal">m</code> represents the symmetry of the problem (slab,
        cylindrical, or spherical). The equations being solved are coded in
          <code class="argument">pdefun</code>, the initial value is coded in <code class="argument">icfun</code>, and
        the boundary conditions are coded in <code class="argument">bcfun</code>. The ordinary differential
        equations (ODEs) resulting from discretization in space are integrated to obtain approximate
        solutions at the times specified in <code class="argument">tspan</code>. The
          <code class="function">pdepe</code> function returns values of the solution on a mesh provided in
          <code class="argument">xmesh</code>.</p></div><p class="syntax_example"><a href="pdepe.html#mw_7d27054d-ec6e-40dc-a28d-64736d23f2f4" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e1300728" itemprop="syntax"><code class="synopsis"><a href="#mw_97daf312-0f43-4fa2-afb6-c67a624631e6" class="intrnllnk"><code class="argument">sol</code></a> = pdepe(<a href="#mw_bf53ae0b-d53a-47fc-81dc-ee63671697a8" class="intrnllnk"><code class="argument">m</code></a>,<a href="#mw_ca773a23-ccd3-45fc-9eb0-0982f085f21d" class="intrnllnk"><code class="argument">pdefun</code></a>,<a href="#mw_dbdef752-2363-43aa-94c6-6c2242a43406" class="intrnllnk"><code class="argument">icfun</code></a>,<a href="#mw_5ccaac8a-d9a6-484d-8859-2ff9fc7e8913" class="intrnllnk"><code class="argument">bcfun</code></a>,<a href="#mw_39f0a244-6853-4b5a-b45c-ef17928a7175" class="intrnllnk"><code class="argument">xmesh</code></a>,<a href="#mw_86a8dc7c-372b-421b-8082-2b459cb51733" class="intrnllnk"><code class="argument">tspan</code></a>,<a href="#mw_fd83f736-3df0-47ab-a9dc-ccee879d4a20" class="intrnllnk"><code class="argument">options</code></a>)</code></span>
        also uses the integration settings defined by <code class="literal">options</code>, which is created
        using the <code class="function">odeset</code> function. For example, use the
          <code class="property">AbsTol</code> and <code class="property">RelTol</code> options to specify absolute
        and relative error tolerances.</p></div><p class="syntax_example"><a href="pdepe.html#mw_f13a2184-7def-4cb5-9ac1-b78f1f6299a9" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e1300764" itemprop="syntax"><code class="synopsis">[<a href="#mw_97daf312-0f43-4fa2-afb6-c67a624631e6" class="intrnllnk"><code class="argument">sol</code></a>,<a href="#mw_1d6a06c5-b21c-41fd-a48d-022846dfa03e" class="intrnllnk"><code class="argument">tsol</code></a>,<a href="#mw_811e78fa-f773-48eb-8187-2fca70fc4707" class="intrnllnk"><code class="argument">sole</code></a>,<a href="#mw_d8a046b9-0637-4a3e-ade9-87d7956f89e8" class="intrnllnk"><code class="argument">te</code></a>,<a href="#mw_4a5c0bbc-c204-4a84-91bf-545a7b767e0b" class="intrnllnk"><code class="argument">ie</code></a>] = pdepe(<a href="#mw_bf53ae0b-d53a-47fc-81dc-ee63671697a8" class="intrnllnk"><code class="argument">m</code></a>,<a href="#mw_ca773a23-ccd3-45fc-9eb0-0982f085f21d" class="intrnllnk"><code class="argument">pdefun</code></a>,<a href="#mw_dbdef752-2363-43aa-94c6-6c2242a43406" class="intrnllnk"><code class="argument">icfun</code></a>,<a href="#mw_5ccaac8a-d9a6-484d-8859-2ff9fc7e8913" class="intrnllnk"><code class="argument">bcfun</code></a>,<a href="#mw_39f0a244-6853-4b5a-b45c-ef17928a7175" class="intrnllnk"><code class="argument">xmesh</code></a>,<a href="#mw_86a8dc7c-372b-421b-8082-2b459cb51733" class="intrnllnk"><code class="argument">tspan</code></a>,<a href="#mw_fd83f736-3df0-47ab-a9dc-ccee879d4a20" class="intrnllnk"><code class="argument">options</code></a>)</code></span>
        also finds where functions of <span class="inlineequation">(<em class="varname">t</em>,<em class="varname">u</em>(<em class="varname">x</em>,<em class="varname">t</em>))</span>, called event functions, are zero. In the output, <code class="argument">te</code>
        is the time of the event, <code class="argument">sole</code> is the solution at the time of the
        event, and <code class="argument">ie</code> is the index of the triggered event.
          <code class="argument">tsol</code> is a column vector of times specified in
          <code class="argument">tspan</code>, prior to the first terminal event.</p><p>For each event function, specify whether the integration is to terminate at a zero and
        whether the direction of the zero-crossing matters. Do this by setting the
          <code class="property">Events</code> option of <code class="function">odeset</code> to a function, such as
          <code class="literal">@myEventFcn</code>, and creating a corresponding function:
          [<code class="literal">value</code>,<code class="literal">isterminal</code>,<code class="literal">direction</code>] =
          <code class="literal">myEventFcn</code>(<code class="literal">m</code>,<code class="literal">t</code>,<code class="literal">xmesh</code>,<code class="literal">umesh</code>).
        The <code class="literal">xmesh</code> input contains the spatial mesh and <code class="literal">umesh</code> is
        the solution at the mesh points.</p></div><p class="syntax_example"><a href="pdepe.html#mw_f13a2184-7def-4cb5-9ac1-b78f1f6299a9" class="intrnllnk">example</a></p></div></div></div></div><div class="clear"></div><div class="examples"><h2 id="mw_281ecc1d-ba35-440c-950f-60b2afe69d2a">Examples</h2><div class="expandableContent" id="expandableExamples"><p class="switch"><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true3">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_7d27054d-ec6e-40dc-a28d-64736d23f2f4"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_7d27054d-ec6e-40dc-a28d-64736d23f2f4" data-bs-target="#expand_accordion_body_mw_7d27054d-ec6e-40dc-a28d-64736d23f2f4" aria-controls="expand_accordion_body_mw_7d27054d-ec6e-40dc-a28d-64736d23f2f4" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_7d27054d-ec6e-40dc-a28d-64736d23f2f4">Solve Heat Equation in Cylindrical Coordinates</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_7d27054d-ec6e-40dc-a28d-64736d23f2f4" aria-labelledby="expand_accordion_heading_mw_7d27054d-ec6e-40dc-a28d-64736d23f2f4" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/SolveHeatEqnInCylCoordsExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Solve Heat Equation in Cylindrical Coordinates",
          "description": "Solve the heat equation in cylindrical coordinates using pdepe, and plot the solution.",
          "thumbnailURL": "../../examples/matlab/win64/SolveHeatEqnInCylCoordsExample_02.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "pdepe.html"

        },
          "identifier": "matlab.SolveHeatEqnInCylCoordsExample",
          "name": "SolveHeatEqnInCylCoordsExample",
          "url": "pdepe.html#mw_7d27054d-ec6e-40dc-a28d-64736d23f2f4"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/SolveHeatEqnInCylCoordsExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "SolveHeatEqnInCylCoordsExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Solve the heat equation in cylindrical coordinates using <code class="literal">pdepe</code>, and plot the solution.</p><p>In cylindrical coordinates with angular symmetry the heat equation is</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">t</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mi mathvariant="italic">x</mi></mrow></mfrac><mfrac><mrow><mo>∂</mo></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>.</mo></mrow></math></p></div><p></p><p>The equation is defined for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mn>0</mn><mo>≤</mo><mi mathvariant="italic">x</mi><mo>≤</mo><mn>1</mn></mrow></math></span> at times <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">t</mi><mo>≥</mo><mn>0</mn></mrow></math></span>. The initial condition is defined in terms of the bessel function <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">J</mi></mrow><mrow><mn>0</mn></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi></mrow><mo>)</mo></mrow></mrow></math></span> and its first zero <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">n</mi><mo>=</mo><mn>2</mn><mo>.</mo><mn>404825557695773</mn></mrow></math></span> as</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">u</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mn>0</mn></mrow><mo>)</mo></mrow><mo>=</mo><msub><mrow><mi mathvariant="italic">J</mi></mrow><mrow><mn>0</mn></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="normal">nx</mi></mrow><mo>)</mo></mrow><mo>.</mo></mrow></math></p></div><p></p><p>Since this problem is in cylindrical coordinates (<code class="literal">m = 1</code>), <code class="literal">pdepe</code> automatically enforces the symmetry condition at <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi><mo>=</mo><mn>0</mn></mrow></math></span>. The right boundary condition is</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">u</mi><mrow><mo>(</mo><mrow><mn>1</mn><mo>,</mo><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow><mo>=</mo><msub><mrow><mi mathvariant="italic">J</mi></mrow><mrow><mn>0</mn></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="italic">n</mi></mrow><mo>)</mo></mrow><msup><mrow><mi mathvariant="italic">e</mi></mrow><mrow><mo>-</mo><msup><mrow><mi mathvariant="italic">n</mi></mrow><mrow><mn>2</mn></mrow></msup><mi mathvariant="italic">t</mi></mrow></msup><mo>.</mo></mrow></math></p></div><p></p><p>The initial and boundary conditions are selected to be consistent with the analytic solution to the problem,</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">u</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow><mo>=</mo><msub><mrow><mi mathvariant="italic">J</mi></mrow><mrow><mn>0</mn></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="normal">nx</mi></mrow><mo>)</mo></mrow><msup><mrow><mi mathvariant="italic">e</mi></mrow><mrow><mo>-</mo><msup><mrow><mi mathvariant="italic">n</mi></mrow><mrow><mn>2</mn></mrow></msup><mi mathvariant="italic">t</mi></mrow></msup><mo>.</mo></mrow></math></p></div><p></p><p>To solve this equation in MATLAB&#174;, you need to code the equation, initial conditions, and boundary conditions, then select a suitable solution mesh before calling the solver <code class="literal">pdepe</code>. You either can include the required functions as local functions at the end of a file (as done here), or save them as separate, named files in a directory on the MATLAB path.</p><div class="procedure"><span id="SolveHeatEqnInCylCoordsExample-1" class="anchor_target"></span><p class="title" id="SolveHeatEqnInCylCoordsExample-1"><b>Code Equation</b></p><p>Before you can code the equation, you need to rewrite it in a form that the <code class="literal">pdepe</code> solver expects. The standard form that <code class="literal">pdepe</code> expects is</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">c</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">t</mi></mrow></mfrac><mo>=</mo><msup><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mo>-</mo><mi mathvariant="italic">m</mi></mrow></msup><mfrac><mrow><mo>∂</mo></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac><mrow><mo>(</mo><mrow><msup><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mi mathvariant="italic">m</mi></mrow></msup><mi mathvariant="italic">f</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow><mo>+</mo><mi mathvariant="italic">s</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>.</mo></mrow></math></p></div><p></p><p>Written in this form, the PDE becomes</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">t</mi></mrow></mfrac><mo>=</mo><msup><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup><mfrac><mrow><mo>∂</mo></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac><mrow><mo>(</mo><mrow><msup><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>1</mn></mrow></msup><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow></mrow></math></p></div><p></p><p>With the equation in the proper form you can read off the relevant terms:</p><div class="itemizedlist"><ul><li><p><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">m</mi><mo>=</mo><mn>1</mn></mrow></math></span></p></li><li><p><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">c</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>=</mo><mn>1</mn></mrow></math></span></p></li><li><p><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">f</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow></math></span></p></li><li><p><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">s</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn></mrow></math></span></p></li></ul></div><p>Now you can create a function to code the equation. The function should have the signature <code class="literal">[c,f,s] = heatcyl(x,t,u,dudx)</code>:</p><div class="itemizedlist"><ul><li><p><code class="literal">x</code> is the independent spatial variable.</p></li><li><p><code class="literal">t</code> is the independent time variable.</p></li><li><p><code class="literal">u</code> is the dependent variable being differentiated with respect to <code class="literal">x</code> and <code class="literal">t</code>.</p></li><li><p><code class="literal">dudx</code> is the partial spatial derivative <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mo>∂</mo><mi mathvariant="italic">u</mi><mo>/</mo><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></math></span>.</p></li><li><p>The outputs <code class="literal">c</code>, <code class="literal">f</code>, and <code class="literal">s</code> correspond to coefficients in the standard PDE equation form expected by <code class="literal">pdepe</code>. These coefficients are coded in terms of the input variables <code class="literal">x</code>, <code class="literal">t</code>, <code class="literal">u</code>, and <code class="literal">dudx</code>.</p></li></ul></div><p>As a result, the equation in this example can be represented by the function:</p><div class="code_responsive"><pre id="d126e1301438" class="programlisting"><span style="color:#0000FF">function</span> [c,f,s] = heatcyl(x,t,u,dudx)
c = 1;
f = dudx;
s = 0;
<span style="color:#0000FF">end</span>
</pre></div><p>(Note: All functions are included as local functions at the end of the example.)</p><span id="SolveHeatEqnInCylCoordsExample-2" class="anchor_target"></span><p class="title" id="SolveHeatEqnInCylCoordsExample-2"><b>Code Initial Conditions</b></p><p>Next, write a function that returns the initial condition. The initial condition is applied at the first time value <code class="literal">tspan(1)</code>. The function should have the signature <code class="literal">u0 = heatic(x)</code>.</p><p>The corresponding function for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">u</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mn>0</mn></mrow><mo>)</mo></mrow><mo>=</mo><msub><mrow><mi mathvariant="italic">J</mi></mrow><mrow><mn>0</mn></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="normal">nx</mi></mrow><mo>)</mo></mrow></mrow></math></span> is</p><div class="code_responsive"><pre id="d126e1301479" class="programlisting"><span style="color:#0000FF">function</span> u0 = heatic(x)
n = 2.404825557695773;
u0 = besselj(0,n*x);
<span style="color:#0000FF">end</span>
</pre></div><span id="SolveHeatEqnInCylCoordsExample-3" class="anchor_target"></span><p class="title" id="SolveHeatEqnInCylCoordsExample-3"><b>Code Boundary Conditions</b></p><p>Now, write a function that evaluates the boundary condition</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true"><mi mathvariant="italic">u</mi><mrow><mo>(</mo><mrow><mn>1</mn><mo>,</mo><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow><mo>=</mo><msub><mrow><mi mathvariant="italic">J</mi></mrow><mrow><mn>0</mn></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="italic">n</mi></mrow><mo>)</mo></mrow><msup><mrow><mi mathvariant="italic">e</mi></mrow><mrow><mo>-</mo><msup><mrow><mi mathvariant="italic">n</mi></mrow><mrow><mn>2</mn></mrow></msup><mi mathvariant="italic">t</mi></mrow></msup><mo>.</mo></math></p></div><p></p><p>Since this problem is in cylindrical coordinates (<code class="literal">m = 1</code>), <code class="literal">pdepe</code> automatically enforces the symmetry condition at <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi><mo>=</mo><mn>0</mn></mrow></math></span>, so you do not need to specify a left boundary condition.</p><p>For problems posed on the interval <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">a</mi><mo>≤</mo><mi mathvariant="italic">x</mi><mo>≤</mo><mi mathvariant="italic">b</mi></mrow></math></span>, the boundary conditions apply for all <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">t</mi></mrow></math></span> and either <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi><mo>=</mo><mi mathvariant="italic">a</mi></mrow></math></span> or <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi><mo>=</mo><mi mathvariant="italic">b</mi></mrow></math></span>. The standard form for the boundary conditions expected by the solver is</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">p</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi></mrow><mo>)</mo></mrow><mo>+</mo><mi mathvariant="italic">q</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow><mi mathvariant="italic">f</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn><mo>.</mo></mrow></math></p></div><p></p><p>Written in this form, the boundary conditions for the partial derivatives of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">u</mi></mrow></math></span> need to be expressed in terms of the flux <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">f</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow></mrow></math></span>. So the right boundary condition for this problem is</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">u</mi><mrow><mo>(</mo><mrow><mn>1</mn><mo>,</mo><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow><mo>-</mo><msub><mrow><mi mathvariant="italic">J</mi></mrow><mrow><mn>0</mn></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="italic">n</mi></mrow><mo>)</mo></mrow><msup><mrow><mi mathvariant="italic">e</mi></mrow><mrow><mo>-</mo><msup><mrow><mi mathvariant="italic">n</mi></mrow><mrow><mn>2</mn></mrow></msup><mi mathvariant="italic">t</mi></mrow></msup><mo>+</mo><mn>0</mn><mo>⋅</mo><mi mathvariant="italic">f</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn><mo>.</mo></mrow></math></p></div><p></p><p>The boundary function should have the function signature <code class="literal">[pl,ql,pr,qr] = heatbc(xl,ul,xr,ur,t)</code>:</p><div class="itemizedlist"><ul><li><p>The inputs <code class="literal">xl</code> and <code class="literal">ul</code> correspond to <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">u</mi></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi></mrow></math></span> for the left boundary.</p></li><li><p>The inputs <code class="literal">xr</code> and <code class="literal">ur</code> correspond to <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">u</mi></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi></mrow></math></span> for the right boundary.</p></li><li><p><code class="literal">t</code> is the independent time variable.</p></li><li><p>The outputs <code class="literal">pl</code> and <code class="literal">ql</code> correspond to <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">p</mi></mrow><mrow><mi mathvariant="italic">L</mi></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi></mrow><mo>)</mo></mrow></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">q</mi></mrow><mrow><mi mathvariant="italic">L</mi></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow></mrow></math></span> for the left boundary (<span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi><mo>=</mo><mn>0</mn></mrow></math></span> for this problem).</p></li><li><p>The outputs <code class="literal">pr</code> and <code class="literal">qr</code> correspond to <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">p</mi></mrow><mrow><mi mathvariant="italic">R</mi></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi></mrow><mo>)</mo></mrow></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">q</mi></mrow><mrow><mi mathvariant="italic">R</mi></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow></mrow></math></span> for the right boundary (<span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi><mo>=</mo><mn>1</mn></mrow></math></span> for this problem).</p></li></ul></div><p> The boundary conditions in this example are represented by the function:</p><div class="code_responsive"><pre id="d126e1301907" class="programlisting"><span style="color:#0000FF">function</span> [pl,ql,pr,qr] = heatbc(xl,ul,xr,ur,t)
n = 2.404825557695773;
pl = 0; <span style="color:#228B22">%ignored by solver since m=1</span>
ql = 0; <span style="color:#228B22">%ignored by solver since m=1</span>
pr = ur-besselj(0,n)*exp(-n^2*t);
qr = 0; 
<span style="color:#0000FF">end</span>
</pre></div><span id="SolveHeatEqnInCylCoordsExample-4" class="anchor_target"></span><p class="title" id="SolveHeatEqnInCylCoordsExample-4"><b>Select Solution Mesh</b></p><p>Before solving the equation you need to specify the mesh points <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mrow><mo>(</mo><mrow><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">x</mi></mrow><mo>)</mo></mrow></mrow></math></span> at which you want <code class="literal">pdepe</code> to evaluate the solution. Specify the points as vectors <code class="literal">t</code> and <code class="literal">x</code>. The vectors <code class="literal">t</code> and <code class="literal">x</code> play different roles in the solver. In particular, the cost and accuracy of the solution depend strongly on the length of the vector <code class="literal">x</code>. However, the computation is much less sensitive to the values in the vector <code class="literal">t</code>.</p><p>For this problem, use a mesh with 25 equally spaced points in the spatial interval [0,1] for both <code class="literal">x</code> and <code class="literal">t</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>x = linspace(0,1,25);
t = linspace(0,1,25);</pre></div></div></div><span id="SolveHeatEqnInCylCoordsExample-5" class="anchor_target"></span><p class="title" id="SolveHeatEqnInCylCoordsExample-5"><b>Solve Equation</b></p><p>Finally, solve the equation using the symmetry <code class="literal">m</code>, the PDE equation, the initial conditions, the boundary conditions, and the meshes for <code class="literal">x</code> and <code class="literal">t</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>m = 1;
sol = pdepe(m,@heatcyl,@heatic,@heatbc,x,t);</pre></div></div></div><p><code class="literal">pdepe</code> returns the solution in a 3-D array <code class="literal">sol</code>, where <code class="literal">sol(i,j,k)</code> approximates the <code class="literal">k</code>th component of the solution <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">u</mi></mrow><mrow><mi mathvariant="italic">k</mi></mrow></msub></mrow></math></span> evaluated at <code class="literal">t(i)</code> and <code class="literal">x(j)</code>. The size of <code class="literal">sol</code> is <code class="literal">length(t)</code>-by-<code class="literal">length(x)</code>-by-<code class="literal">length(u0)</code>, since <code class="literal">u0</code> specifies an initial condition for each solution component. For this problem, <code class="literal">u</code> has only one component, so <code class="literal">sol</code> is a 25-by-25 matrix, but in general you can extract the <code class="literal">k</code>th solution component with the command <code class="literal">u = sol(:,:,k)</code>.</p><p>Extract the first solution component from <code class="literal">sol</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>u = sol(:,:,1);</pre></div></div></div><span id="SolveHeatEqnInCylCoordsExample-6" class="anchor_target"></span><p class="title" id="SolveHeatEqnInCylCoordsExample-6"><b>Plot Solution</b></p><p>Create a surface plot of the solution. Since the problem is posed with cylindrical coordinates on a disc, the <code class="literal">x</code> values show the temperature on the disc some distance from the center, and the <code class="literal">t</code> values show how the temperature at a particular location changes over time.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>surf(x,t,u)
xlabel(<span style="color:#A020F0">"x"</span>)
ylabel(<span style="color:#A020F0">"t"</span>)
zlabel(<span style="color:#A020F0">"u(x,t)"</span>)
view([150 25])</pre></div></div></div><div class="informalfigure"><div id="d126e1302022" class="mediaobject"><p><img src="../../examples/matlab/win64/SolveHeatEqnInCylCoordsExample_01.png" alt="Figure contains an axes object. The axes object with xlabel x, ylabel t contains an object of type surface." width="560"></p></div></div><p>Plot the temperature change at the center (<span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi><mo>=</mo><mn>0</mn></mrow></math></span>) of the disc.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>plot(t,sol(:,1))
xlabel(<span style="color:#A020F0">"Time"</span>)
ylabel(<span style="color:#A020F0">"Temperature u(0,t)"</span>)
title(<span style="color:#A020F0">"Temperature change at center of disc"</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e1302039" class="mediaobject"><p><img src="../../examples/matlab/win64/SolveHeatEqnInCylCoordsExample_02.png" alt="Figure contains an axes object. The axes object with title Temperature change at center of disc, xlabel Time, ylabel Temperature u(0,t) contains an object of type line." width="560"></p></div></div><span id="SolveHeatEqnInCylCoordsExample-7" class="anchor_target"></span><p class="title" id="SolveHeatEqnInCylCoordsExample-7"><b>Local Functions</b></p><p>Listed here are the local helper functions that the PDE solver <code class="literal">pdepe</code> calls to calculate the solution. Alternatively, you can save these functions as their own files in a directory on the MATLAB path.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> [c,f,s] = heatcyl(x,t,u,dudx)
c = 1;
f = dudx;
s = 0;
<span style="color:#0000FF">end</span>
<span style="color:#228B22">%----------------------------------------------</span>
<span style="color:#0000FF">function</span> u0 = heatic(x)
n = 2.404825557695773;
u0 = besselj(0,n*x);
<span style="color:#0000FF">end</span>
<span style="color:#228B22">%----------------------------------------------</span>
<span style="color:#0000FF">function</span> [pl,ql,pr,qr] = heatbc(xl,ul,xr,ur,t)
n = 2.404825557695773;
pl = 0; <span style="color:#228B22">%ignored by solver since m=1</span>
ql = 0; <span style="color:#228B22">%ignored by solver since m=1</span>
pr = ur-besselj(0,n)*exp(-n^2*t);
qr = 0; 
<span style="color:#0000FF">end</span>
<span style="color:#228B22">%----------------------------------------------</span></pre></div></div></div></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-SolveHeatEqnInCylCoordsExample"><meta itemprop="exampletitle" content="Solve Heat Equation in Cylindrical Coordinates"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_f13a2184-7def-4cb5-9ac1-b78f1f6299a9"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_f13a2184-7def-4cb5-9ac1-b78f1f6299a9" data-bs-target="#expand_accordion_body_mw_f13a2184-7def-4cb5-9ac1-b78f1f6299a9" aria-controls="expand_accordion_body_mw_f13a2184-7def-4cb5-9ac1-b78f1f6299a9" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_f13a2184-7def-4cb5-9ac1-b78f1f6299a9">Solve Oscillatory PDE with Event Logging</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_f13a2184-7def-4cb5-9ac1-b78f1f6299a9" aria-labelledby="expand_accordion_heading_mw_f13a2184-7def-4cb5-9ac1-b78f1f6299a9" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/SolvePDEWithEventsExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Solve Oscillatory PDE with Event Logging",
          "description": "Solve a partial differential equation and use an event function to log zero-crossings in the oscillatory solution.",
          "thumbnailURL": "../../examples/matlab/win64/SolvePDEWithEventsExample_02.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "pdepe.html"

        },
          "identifier": "matlab.SolvePDEWithEventsExample",
          "name": "SolvePDEWithEventsExample",
          "url": "pdepe.html#mw_f13a2184-7def-4cb5-9ac1-b78f1f6299a9"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/SolvePDEWithEventsExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "SolvePDEWithEventsExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Solve a partial differential equation and use an event function to log zero-crossings in the oscillatory solution.</p><p>Consider the equation</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mfrac><mrow><mn>1</mn></mrow><mrow><mi mathvariant="italic">x</mi></mrow></mfrac><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">t</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mo>∂</mo></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac><mrow><mo>(</mo><mrow><mfrac><mrow><mn>1</mn></mrow><mrow><mi mathvariant="italic">t</mi></mrow></mfrac><mi mathvariant="italic">u</mi></mrow><mo>)</mo></mrow><mo>.</mo></mrow></math></p></div><p></p><p>The equation is defined for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mn>0</mn><mo>≤</mo><mi mathvariant="italic">x</mi><mo>≤</mo><mn>1</mn></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">t</mi><mo>≥</mo><mn mathvariant="normal">0</mn><mo>.</mo><mn>1</mn></mrow></math></span>. The initial condition is</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">u</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mn>0</mn><mo>.</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>=</mo><mn>1</mn><mo>.</mo></mrow></math></p></div><p></p><p>The boundary conditions are</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">u</mi><mrow><mo>(</mo><mrow><mn>0</mn><mo>,</mo><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow><mo>=</mo><mn>1</mn><mo>,</mo></mrow></math></p></div><p></p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">u</mi><mrow><mo>(</mo><mrow><mn>1</mn><mo>,</mo><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow><mo>=</mo><mi mathvariant="normal">cos</mi><mrow><mo>(</mo><mrow><mi>π</mi><mtext> </mtext><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow><mo>.</mo></mrow></math></p></div><p></p><p>Additionally, the zero-crossings of the solution are of interest.</p><p>To solve this equation in MATLAB, you need to code the equation, initial conditions, boundary conditions, and event function, then select a suitable solution mesh before calling the solver <code class="literal">pdepe</code>. You either can include the required functions as local functions at the end of a file (as done here), or save them as separate, named files in a directory on the MATLAB path.</p><div class="procedure"><span id="SolvePDEWithEventsExample-1" class="anchor_target"></span><p class="title" id="SolvePDEWithEventsExample-1"><b>Code Equation</b></p><p>Before you can code the equation, you need to rewrite it in a form that the <code class="literal">pdepe</code> solver expects. The standard form that <code class="literal">pdepe</code> expects is</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">c</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">t</mi></mrow></mfrac><mo>=</mo><msup><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mo>-</mo><mi mathvariant="italic">m</mi></mrow></msup><mfrac><mrow><mo>∂</mo></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac><mrow><mo>(</mo><mrow><msup><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mi mathvariant="italic">m</mi></mrow></msup><mi mathvariant="italic">f</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow><mo>+</mo><mi mathvariant="italic">s</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>.</mo></mrow></math></p></div><p></p><p>The PDE equation is already in this form:</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true"><mfrac><mrow><mn>1</mn></mrow><mrow><mi mathvariant="italic">x</mi></mrow></mfrac><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">t</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mo>∂</mo></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac><mrow><mo>(</mo><mrow><mfrac><mrow><mn>1</mn></mrow><mrow><mi mathvariant="italic">t</mi></mrow></mfrac><mi mathvariant="italic">u</mi></mrow><mo>)</mo></mrow><mo>.</mo></math></p></div><p></p><p>So you can read off the relevant terms:</p><div class="itemizedlist"><ul><li><p><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">m</mi><mo>=</mo><mn>0</mn></mrow></math></span></p></li><li><p><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">c</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mi mathvariant="italic">x</mi></mrow></mfrac></mrow></math></span></p></li><li><p><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">f</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mi mathvariant="italic">t</mi></mrow></mfrac><mi mathvariant="italic">u</mi></mrow></math></span></p></li><li><p><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">s</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn></mrow></math></span></p></li></ul></div><p>Now you can create a function to code the equation. The function should have the signature <code class="literal">[c,f,s] = oscpde(x,t,u,dudx)</code>:</p><div class="itemizedlist"><ul><li><p><code class="literal">x</code> is the independent spatial variable.</p></li><li><p><code class="literal">t</code> is the independent time variable.</p></li><li><p><code class="literal">u</code> is the dependent variable being differentiated with respect to <code class="literal">x</code> and <code class="literal">t</code>.</p></li><li><p><code class="literal">dudx</code> is the partial spatial derivative <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mo>∂</mo><mi mathvariant="italic">u</mi><mo>/</mo><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></math></span>.</p></li><li><p>The outputs <code class="literal">c</code>, <code class="literal">f</code>, and <code class="literal">s</code> correspond to coefficients in the standard PDE equation form expected by <code class="literal">pdepe</code>. These coefficients are coded in terms of the input variables <code class="literal">x</code>, <code class="literal">t</code>, <code class="literal">u</code>, and <code class="literal">dudx</code>.</p></li></ul></div><p>As a result, the equation in this example can be represented by the function:</p><div class="code_responsive"><pre id="d126e1302539" class="programlisting"><span style="color:#0000FF">function</span> [c,f,s] = oscpde(x,t,u,dudx)
c = 1/x;
f = u/t;
s = 0;
<span style="color:#0000FF">end</span>
</pre></div><p>(Note: All functions are included as local functions at the end of the example.)</p><span id="SolvePDEWithEventsExample-2" class="anchor_target"></span><p class="title" id="SolvePDEWithEventsExample-2"><b>Code Initial Conditions</b></p><p>Next, write a function that returns the initial condition. The initial condition is applied at the first time value <code class="literal">tspan(1)</code>. The function should have the signature <code class="literal">u0 = oscic(x)</code>.</p><p>The corresponding function for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">u</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mn>0</mn><mo>.</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>=</mo><mn>1</mn></mrow></math></span> is</p><div class="code_responsive"><pre id="d126e1302571" class="programlisting"><span style="color:#0000FF">function</span> u0 = oscic(x)
u0 = 1;
<span style="color:#0000FF">end</span>
</pre></div><span id="SolvePDEWithEventsExample-3" class="anchor_target"></span><p class="title" id="SolvePDEWithEventsExample-3"><b>Code Boundary Conditions</b></p><p>Now, write a function that evaluates the boundary conditions</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">u</mi><mrow><mo>(</mo><mrow><mn>0</mn><mo>,</mo><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow><mo>=</mo><mn>1</mn><mo>,</mo></mrow></math></p></div><p></p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">u</mi><mrow><mo>(</mo><mrow><mn>1</mn><mo>,</mo><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow><mo>=</mo><mi mathvariant="normal">cos</mi><mrow><mo>(</mo><mrow><mi>π</mi><mtext> </mtext><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow><mo>.</mo></mrow></math></p></div><p></p><p>For problems posed on the interval <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">a</mi><mo>≤</mo><mi mathvariant="italic">x</mi><mo>≤</mo><mi mathvariant="italic">b</mi></mrow></math></span>, the boundary conditions apply for all <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">t</mi></mrow></math></span> and either <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi><mo>=</mo><mi mathvariant="italic">a</mi></mrow></math></span> or <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi><mo>=</mo><mi mathvariant="italic">b</mi></mrow></math></span>. The standard form for the boundary conditions expected by the solver is</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">p</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi></mrow><mo>)</mo></mrow><mo>+</mo><mi mathvariant="italic">q</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow><mi mathvariant="italic">f</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn><mo>.</mo></mrow></math></p></div><p></p><p>Written in this form, the boundary conditions for this problem become</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">u</mi><mrow><mo>(</mo><mrow><mn>0</mn><mo>,</mo><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow><mo>-</mo><mn>1</mn><mo>+</mo><mn>0</mn><mo>⋅</mo><mi mathvariant="italic">f</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn><mo>,</mo></mrow></math></p></div><p></p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">u</mi><mrow><mo>(</mo><mrow><mn>1</mn><mo>,</mo><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow><mo>-</mo><mi mathvariant="normal">cos</mi><mrow><mo>(</mo><mrow><mi>π</mi><mtext> </mtext><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow><mo>+</mo><mn>0</mn><mo>⋅</mo><mi mathvariant="italic">f</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn><mo>.</mo></mrow></math></p></div><p></p><p>The boundary function should have the function signature <code class="literal">[pl,ql,pr,qr] = oscbc(xl,ul,xr,ur,t)</code>:</p><div class="itemizedlist"><ul><li><p>The inputs <code class="literal">xl</code> and <code class="literal">ul</code> correspond to <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">u</mi></mrow></math></span> for the left boundary.</p></li><li><p>The inputs <code class="literal">xr</code> and <code class="literal">ur</code> correspond to <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">u</mi></mrow></math></span> for the right boundary.</p></li><li><p><code class="literal">t</code> is the independent time variable.</p></li><li><p>The outputs <code class="literal">pl</code> and <code class="literal">ql</code> correspond to <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">p</mi></mrow><mrow><mi mathvariant="italic">L</mi></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi></mrow><mo>)</mo></mrow></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">q</mi></mrow><mrow><mi mathvariant="italic">L</mi></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow></mrow></math></span> for the left boundary (<span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi><mo>=</mo><mn>0</mn></mrow></math></span> for this problem).</p></li><li><p>The outputs <code class="literal">pr</code> and <code class="literal">qr</code> correspond to <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">p</mi></mrow><mrow><mi mathvariant="italic">R</mi></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi></mrow><mo>)</mo></mrow></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">q</mi></mrow><mrow><mi mathvariant="italic">R</mi></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow></mrow></math></span> for the right boundary (<span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi><mo>=</mo><mn>1</mn></mrow></math></span> for this problem).</p></li></ul></div><p> The boundary conditions in this example are represented by the function:</p><div class="code_responsive"><pre id="d126e1302983" class="programlisting"><span style="color:#0000FF">function</span> [pl,ql,pr,qr] = oscbc(xl,ul,xr,ur,t)
pl = ul - 1;
ql = 0;
pr = ur - cos(pi*t);
qr = 0;
<span style="color:#0000FF">end</span>
</pre></div><span id="SolvePDEWithEventsExample-4" class="anchor_target"></span><p class="title" id="SolvePDEWithEventsExample-4"><b>Code Event Function</b></p><p>Use an event function to log the zero-crossings of the solution in the integration. The event function has a function signature of <code class="literal">[value,isterminal,direction] = pdevents(m,t,xmesh,umesh)</code>:</p><div class="itemizedlist"><ul><li><p><code class="literal">m</code> is the coordinate symmetry specified as the first input to <code class="literal">pdepe</code>.</p></li><li><p><code class="literal">t</code> is the current time (a scalar).</p></li><li><p><code class="literal">xmesh</code> is the spatial mesh.</p></li><li><p><code class="literal">umesh</code> contains the solution at the mesh points.</p></li><li><p><code class="literal">value</code> is an equation of interest, usually expressed in terms of the solution <code class="literal">umesh</code>. When <code class="literal">value</code> equals 0, an event occurs.</p></li><li><p><code class="literal">isterminal</code> specifies whether an event stops the integration. If <code class="literal">isterminal</code> is 0, events are logged but the integration does not stop. If <code class="literal">isterminal</code> is 1, then the integration stops when an event occurs.</p></li><li><p><code class="literal">direction</code> specifies the direction of zero crossing. If 1, only zero-crossings with a positive slope trigger an event. If -1, the zero-crossings must have a negative slope. If 0, then any zero-crossing triggers an event.</p></li></ul></div><p>At each time in the integration, the solver calls the event function to check for zero crossings. To log all zero crossings, <code class="literal">value</code> should look for changes in sign in the solution vector <code class="literal">umesh</code>. Specify <code class="literal">isterminal</code> and <code class="literal">direction</code> as vectors of zeros with the same size, since the events in this example are not terminal and the zero-crossings can occur with any slope.</p><p>The event function for this problem is</p><div class="code_responsive"><pre id="d126e1303041" class="programlisting"><span style="color:#0000FF">function</span> [value,isterminal,direction] = pdevents(m,t,xmesh,umesh)
value = umesh;
isterminal = zeros(size(umesh));
direction = zeros(size(umesh));
<span style="color:#0000FF">end</span>
</pre></div><span id="SolvePDEWithEventsExample-5" class="anchor_target"></span><p class="title" id="SolvePDEWithEventsExample-5"><b>Select Solution Mesh</b></p><p>Before solving the equation you need to specify the mesh points <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mrow><mo>(</mo><mrow><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">x</mi></mrow><mo>)</mo></mrow></mrow></math></span> at which you want <code class="literal">pdepe</code> to evaluate the solution. For this problem, use a fine mesh of 50 points in the intervals <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mn>0</mn><mo>≤</mo><mi mathvariant="italic">x</mi><mo>≤</mo><mn>1</mn></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mn>0</mn><mo>.</mo><mn>1</mn><mo>≤</mo><mi mathvariant="italic">t</mi><mo>≤</mo><mn>1</mn></mrow></math></span>. A fine mesh gives good resolution of the oscillatory solution.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>x = linspace(0,1,50);
t = linspace(0.1,pi,50);</pre></div></div></div><span id="SolvePDEWithEventsExample-6" class="anchor_target"></span><p class="title" id="SolvePDEWithEventsExample-6"><b>Solve Equation</b></p><p>Finally, solve the equation using the symmetry <code class="literal">m</code>, the PDE equation, the initial conditions, the boundary conditions, the event function, and the meshes for <code class="literal">x</code> and <code class="literal">t</code>. Use <code class="literal">odeset</code> to create an options structure that references the events function, and pass in the  structure as the last input argument to <code class="literal">pdepe</code>. Specify five output arguments to return information from both the event function and the solver:</p><div class="itemizedlist"><ul><li><p><code class="literal">sol</code> is the solution computed by <code class="literal">pdepe</code>.</p></li><li><p><code class="literal">tsol</code> is a vector of times before a terminal event. <code class="literal">tsol</code> is equal to <code class="literal">t</code> when no events are terminal.</p></li><li><p><code class="literal">sole</code> is the solution at the time of each event.</p></li><li><p><code class="literal">te</code> is the time of each event.</p></li><li><p><code class="literal">ie</code> is the index of each event. Since <code class="literal">values = umesh</code> in the event function, <code class="literal">ie</code> gives the indices of <code class="literal">umesh</code> that triggered an event at each time step.</p></li></ul></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>m = 0;
options = odeset(Events=@pdevents);
[sol,tsol,sole,te,ie] = pdepe(m,@oscpde,@oscic,@oscbc,x,t,options);</pre></div></div></div><p>Extract the solution as a matrix <code class="literal">u</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>u = sol(:,:,1);</pre></div></div></div><span id="SolvePDEWithEventsExample-7" class="anchor_target"></span><p class="title" id="SolvePDEWithEventsExample-7"><b>Plot Solution</b></p><p>Create a surface plot of the solution and view the plot from above.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>surf(x,t,u)
view(2)</pre></div></div></div><div class="informalfigure"><div id="d126e1303147" class="mediaobject"><p><img src="../../examples/matlab/win64/SolvePDEWithEventsExample_01.png" alt="Figure contains an axes object. The axes object contains an object of type surface." width="560"></p></div></div><p>Plot the points where events occurred, with a surface <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">f</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn></mrow></math></span> for reference. The output index vector <code class="literal">ie</code> is useful to pick out the event locations. The expression <code class="literal">x(ie)'</code> gives the x-values where events occurred, and the expression <code class="literal">sole(x==x(ie)')</code> gives the corresponding solution values.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>view([39 30])
xlabel(<span style="color:#A020F0">"x"</span>)
ylabel(<span style="color:#A020F0">"t"</span>)
zlabel(<span style="color:#A020F0">"u(x,t)"</span>)
hold <span style="color:#A020F0">on</span>
plot3(x(ie)',te,sole(x==x(ie)'),<span style="color:#A020F0">'r*'</span>)
surf(x,t,zeros(size(u)),EdgeColor=<span style="color:#A020F0">"flat"</span>)
hold <span style="color:#A020F0">off</span></pre></div></div></div><div class="informalfigure"><div id="d126e1303179" class="mediaobject"><p><img src="../../examples/matlab/win64/SolvePDEWithEventsExample_02.png" alt="Figure contains an axes object. The axes object with xlabel x, ylabel t contains 3 objects of type surface, line. One or more of the lines displays its values using only markers" width="560"></p></div></div><span id="SolvePDEWithEventsExample-8" class="anchor_target"></span><p class="title" id="SolvePDEWithEventsExample-8"><b>Local Functions</b></p><p>Listed here are the local helper functions that the PDE solver pdepe calls to calculate the solution. Alternatively, you can save these functions as their own files in a directory on the MATLAB path.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> [c,f,s] = oscpde(x,t,u,dudx)
c = 1/x;
f = u/t;
s = 0;
<span style="color:#0000FF">end</span>
<span style="color:#228B22">%----------------------------------------------</span>
<span style="color:#0000FF">function</span> u0 = oscic(x)
u0 = 1;
<span style="color:#0000FF">end</span>
<span style="color:#228B22">%----------------------------------------------</span>
<span style="color:#0000FF">function</span> [pl,ql,pr,qr] = oscbc(xl,ul,xr,ur,t)
pl = ul - 1;
ql = 0;
pr = ur - cos(pi*t);
qr = 0;
<span style="color:#0000FF">end</span>
<span style="color:#228B22">%----------------------------------------------</span>
<span style="color:#0000FF">function</span> [value, isterminal, direction] = pdevents(m,t,xmesh,umesh)
value = umesh;
isterminal = zeros(size(umesh));
direction = zeros(size(umesh));
<span style="color:#0000FF">end</span>
<span style="color:#228B22">%----------------------------------------------</span></pre></div></div></div></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-SolvePDEWithEventsExample"><meta itemprop="exampletitle" content="Solve Oscillatory PDE with Event Logging"></div></div></div></div><div class="ref_sect"><h2 id="mw_e68f2ac9-79e3-4dc0-8158-8162e8e04295">Input Arguments</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="mw_e68f2ac9-79e3-4dc0-8158-8162e8e04295_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="mw_bf53ae0b-d53a-47fc-81dc-ee63671697a8"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_bf53ae0b-d53a-47fc-81dc-ee63671697a8" data-bs-target="#expand_accordion_body_mw_bf53ae0b-d53a-47fc-81dc-ee63671697a8" aria-controls="expand_accordion_body_mw_bf53ae0b-d53a-47fc-81dc-ee63671697a8" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_m" class="anchor_target"></span><h3 id="mw_bf53ae0b-d53a-47fc-81dc-ee63671697a8"><code itemprop="name">m</code> &#8212; <span itemprop="purpose">Symmetry constant</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue"><code class="literal">0</code></span> | <span itemprop="inputvalue"><code class="literal">1</code></span> | <span itemprop="inputvalue"><code class="literal">2</code></span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_bf53ae0b-d53a-47fc-81dc-ee63671697a8" aria-labelledby="expand_accordion_heading_mw_bf53ae0b-d53a-47fc-81dc-ee63671697a8" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_bf53ae0b-d53a-47fc-81dc-ee63671697a8"><p>Symmetry constant, specified as one of the values in this table.
              <code class="literal">m</code> specifies the type of problem in the equations specified by
              <a href="#mw_ca773a23-ccd3-45fc-9eb0-0982f085f21d" class="intrnllnk"><code class="argument">pdefun</code></a>. Once you rewrite the equations in the form expected by
              <code class="function">pdepe</code>, you can read the value of <code class="literal">m</code> from the
              equation.</p>
<div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="33%"><col class="tcol2" width="33%"><col class="tcol3" width="33%"></colgroup><thead><tr><th>Value</th><th>Description</th><th>Laplacian of flux</th></tr></thead><tbody><tr><td><p><code class="literal">0</code></p></td><td><p>1-D Cartesian coordinates with no symmetry</p></td><td><span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-16px" display="block"><mrow><mi>Δ</mi><mi>f</mi><mo>=</mo><mfrac><mrow><msup><mo>∂</mo><mn>2</mn></msup><mi>f</mi></mrow><mrow><mo>∂</mo><msup><mi>x</mi><mn>2</mn></msup></mrow></mfrac></mrow></math></span></span></td></tr><tr><td><p><code class="literal">1</code></p></td><td><p>2-D Cylindrical coordinates with azimuthal angular
                      symmetry</p></td><td><p><span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-20px" display="block"><mrow><mi>Δ</mi><mi>f</mi><mo>=</mo><mfrac><mn>1</mn><mi>ρ</mi></mfrac><mfrac><mo>∂</mo><mrow><mo>∂</mo><mi>ρ</mi></mrow></mfrac><mrow><mo>(</mo><mrow><mi>ρ</mi><mfrac><mrow><mo>∂</mo><mi>f</mi></mrow><mrow><mo>∂</mo><mi>ρ</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>+</mo><mfrac><mn>1</mn><mrow><msup><mi>ρ</mi><mn>2</mn></msup></mrow></mfrac><mfrac><mrow><msup><mo>∂</mo><mn>2</mn></msup><mi>f</mi></mrow><mrow><mo>∂</mo><msup><mi>φ</mi><mn>2</mn></msup></mrow></mfrac></mrow></math></span></span>,</p><p>where <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-16px" display="block"><mrow><mfrac><mrow><mo>∂</mo><mi>f</mi></mrow><mrow><mo>∂</mo><mi>φ</mi></mrow></mfrac><mo>=</mo><mn>0</mn></mrow></math></span></span> (azimuthal symmetry).</p></td></tr><tr><td><p><code class="literal">2</code></p></td><td><p>3-D Spherical coordinates with azimuthal and zenith angular
                        symmetries</p></td><td><p><span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-19px" display="block"><mrow><mi>Δ</mi><mi>f</mi><mo>=</mo><mfrac><mn>1</mn><mrow><msup><mi>r</mi><mn>2</mn></msup></mrow></mfrac><mfrac><mo>∂</mo><mrow><mo>∂</mo><mi>r</mi></mrow></mfrac><mrow><mo>(</mo><mrow><msup><mi>r</mi><mn>2</mn></msup><mfrac><mrow><mo>∂</mo><mi>f</mi></mrow><mrow><mo>∂</mo><mi>r</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>+</mo><mfrac><mn>1</mn><mrow><msup><mi>r</mi><mn>2</mn></msup><mi>sin</mi><mi>θ</mi></mrow></mfrac><mfrac><mo>∂</mo><mrow><mo>∂</mo><mi>θ</mi></mrow></mfrac><mrow><mo>(</mo><mrow><mi>sin</mi><mi>θ</mi><mfrac><mrow><mo>∂</mo><mi>f</mi></mrow><mrow><mo>∂</mo><mi>θ</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>+</mo><mfrac><mn>1</mn><mrow><msup><mi>r</mi><mn>2</mn></msup><msup><mrow><mi>sin</mi></mrow><mn>2</mn></msup><mi>θ</mi></mrow></mfrac><mfrac><mrow><msup><mo>∂</mo><mn>2</mn></msup><mi>f</mi></mrow><mrow><mo>∂</mo><msup><mi>φ</mi><mn>2</mn></msup></mrow></mfrac></mrow></math></span></span>,</p><p>where <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-19px" display="block"><mrow><mfrac><mrow><mo>∂</mo><mi>f</mi></mrow><mrow><mo>∂</mo><mi>θ</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mo>∂</mo><mi>f</mi></mrow><mrow><mo>∂</mo><mi>φ</mi></mrow></mfrac><mo>=</mo><mn>0</mn></mrow></math></span></span> (azimuthal and zenith angular symmetries).</p></td></tr></tbody></table></div><p>
When <code class="literal">m &gt; 0</code>, <code class="function">pdepe</code> requires the
            left spatial boundary <em class="varname">a</em> to be ≥ 0, and it imposes the left boundary
            condition automatically to account for the coordinate discontinuity at the origin. In
            that case, <code class="function">pdepe</code> ignores any specified left boundary conditions in
              <code class="function">bcfun</code>.</p></div></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="mw_ca773a23-ccd3-45fc-9eb0-0982f085f21d"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_ca773a23-ccd3-45fc-9eb0-0982f085f21d" data-bs-target="#expand_accordion_body_mw_ca773a23-ccd3-45fc-9eb0-0982f085f21d" aria-controls="expand_accordion_body_mw_ca773a23-ccd3-45fc-9eb0-0982f085f21d" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_pdefun" class="anchor_target"></span><h3 id="mw_ca773a23-ccd3-45fc-9eb0-0982f085f21d"><code itemprop="name">pdefun</code> &#8212; <span itemprop="purpose">PDE function for equations</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">function handle</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_ca773a23-ccd3-45fc-9eb0-0982f085f21d" aria-labelledby="expand_accordion_heading_mw_ca773a23-ccd3-45fc-9eb0-0982f085f21d" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_ca773a23-ccd3-45fc-9eb0-0982f085f21d"><p>PDE function for equations, specified as a function handle that defines the
            coefficients of the PDE.</p><p><code class="literal">pdefun</code> encodes the coefficients for PDEs of the form</p><div id="d126e1303323" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-17px" display="block"><mrow><mi>c</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi>u</mi></mrow><mrow><mo>∂</mo><mi>x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mfrac><mrow><mo>∂</mo><mi>u</mi></mrow><mrow><mo>∂</mo><mi>t</mi></mrow></mfrac><mo>=</mo><msup><mi>x</mi><mrow><mo>−</mo><mi>m</mi></mrow></msup><mfrac><mo>∂</mo><mrow><mo>∂</mo><mi>x</mi></mrow></mfrac><mrow><mo>(</mo><mrow><msup><mi>x</mi><mi>m</mi></msup><mi>f</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi>u</mi></mrow><mrow><mo>∂</mo><mi>x</mi></mrow></mfrac></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow><mo>+</mo><mi>s</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi>u</mi></mrow><mrow><mo>∂</mo><mi>x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>.</mo></mrow></math></p></div></div><p>The terms in the equation are:</p><div class="itemizedlist"><ul><li><p><span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-19px" display="block"><mrow><mi>f</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi>u</mi></mrow><mrow><mo>∂</mo><mi>x</mi></mrow></mfrac></mrow><mo>)</mo></mrow></mrow></math></span></span> is a flux term.</p></li><li><p><span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-19px" display="block"><mrow><mi>s</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi>u</mi></mrow><mrow><mo>∂</mo><mi>x</mi></mrow></mfrac></mrow><mo>)</mo></mrow></mrow></math></span></span> is a source term.</p></li><li><p>The coupling of the partial derivatives with respect to time is restricted to
                multiplication by a diagonal matrix <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-19px" display="block"><mrow><mi>c</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi>u</mi></mrow><mrow><mo>∂</mo><mi>x</mi></mrow></mfrac></mrow><mo>)</mo></mrow></mrow></math></span></span>. The diagonal elements of this matrix are either zero or positive.
                An element that is zero corresponds to an elliptic equation, and all other elements
                correspond to parabolic equations. There must be at least one parabolic equation. An
                element of <em class="varname">c</em> that corresponds to a parabolic equation can vanish
                at isolated values of <em class="varname">x</em> if those values of <em class="varname">x</em>
                are mesh points.</p></li><li><p>Discontinuities in <em class="varname">c</em> and <em class="varname">s</em> due to material
                interfaces are permitted provided that a mesh point is placed at each
                interface.</p></li></ul></div><p>The PDEs hold for <span class="inlineequation"><em class="varname">t</em><sub>0</sub> ≤ <em class="varname">t</em> ≤
                    <em class="varname">t<sub>f</sub></em></span> and <span class="inlineequation"><em class="varname">a</em> ≤ <em class="varname">x</em> ≤
                <em class="varname">b</em></span>. The values <code class="literal">tspan(1)</code> and
              <code class="literal">tspan(end)</code> correspond to
              <em class="varname">t</em><sub>0</sub> and
              <em class="varname">t<sub>f</sub></em>, while <code class="literal">xmesh(1)</code> and
              <code class="literal">xmesh(end)</code> correspond to <em class="varname">a</em> and
              <em class="varname">b</em>. The interval <span class="inlineequation">[<em class="varname">a</em>,<em class="varname">b</em>]</span> must be finite. <a href="#mw_bf53ae0b-d53a-47fc-81dc-ee63671697a8" class="intrnllnk"><code class="argument">m</code></a> can be 0, 1, or 2,
            corresponding to slab, cylindrical, or spherical symmetry, respectively. If <span class="inlineequation"><em class="varname">m</em> &gt; 0</span>, then <em class="varname">a</em> must be ≥ 0. </p>
            <h4 class="descriptionsect">Coding the Equation</h4>
            <p>Write a function <code class="literal">pdefun</code> that calculates the values of the
              coefficients <em class="varname">c</em>, <em class="varname">f</em>, and <em class="varname">s</em>. Use
              the function
              signature<div class="code_responsive"><pre class="programlisting">[c,f,s] = pdefun(x,t,u,dudx)</pre></div></p>
            <p>The input arguments to <code class="literal">pdefun</code> are scalars <code class="literal">x</code>
              and <code class="literal">t</code> and vectors <code class="literal">u</code> and <code class="literal">dudx</code>.
              The vector <code class="literal">u</code> approximates the solution <em class="varname">u</em>, and
                <code class="literal">dudx</code> approximates its partial derivative with respect to
                <em class="varname">x</em>. The output arguments <code class="literal">c</code>,
                <code class="literal">f</code>, and <code class="literal">s</code> are column vectors with a number of
              elements equal to the number of equations. <code class="literal">c</code> stores the diagonal
              elements of the matrix <em class="varname">c</em>.</p>
          
            <h4 class="descriptionsect">Example</h4>
            <p>The heat equation <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-16px" display="block"><mrow><mfrac><mrow><mo>∂</mo><mi>u</mi></mrow><mrow><mo>∂</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><msup><mo>∂</mo><mn>2</mn></msup><mi>u</mi></mrow><mrow><mo>∂</mo><msup><mi>x</mi><mn>2</mn></msup></mrow></mfrac></mrow></math></span></span> can be rewritten in the form expected by the solver as </p>
            <div id="d126e1303490" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-19px" display="block"><mrow><mn>1</mn><mtext> </mtext><mo>·</mo><mtext> </mtext><mfrac><mrow><mo>∂</mo><mi>u</mi></mrow><mrow><mo>∂</mo><mi>t</mi></mrow></mfrac><mo>=</mo><msup><mi>x</mi><mn>0</mn></msup><mfrac><mo>∂</mo><mrow><mo>∂</mo><mi>x</mi></mrow></mfrac><mrow><mo>(</mo><mrow><msup><mi>x</mi><mn>0</mn></msup><mfrac><mrow><mo>∂</mo><mi>u</mi></mrow><mrow><mo>∂</mo><mi>x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>.</mo></mrow></math></p></div></div>
            <p>In this form you can read off the value of the coefficients as <span class="inlineequation"><em class="varname">m</em> = 0</span>, <span class="inlineequation"><em class="varname">c</em> = 1</span>, <span class="inlineequation"><em class="varname">f</em> =
                  ∂<em class="varname">u</em>/∂<em class="varname">x</em></span>, and <span class="inlineequation"><em class="varname">s</em> = 0</span>. The function for this equation is:</p>
            <div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> [c,f,s] = heatpde(x,t,u,dudx)  
  c = 1;
  f = dudx;
  s = 0;
<span style="color:#0000FF">end</span>
</pre></div></div></div>
          </div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">function_handle</code></p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="mw_dbdef752-2363-43aa-94c6-6c2242a43406"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_dbdef752-2363-43aa-94c6-6c2242a43406" data-bs-target="#expand_accordion_body_mw_dbdef752-2363-43aa-94c6-6c2242a43406" aria-controls="expand_accordion_body_mw_dbdef752-2363-43aa-94c6-6c2242a43406" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_icfun" class="anchor_target"></span><h3 id="mw_dbdef752-2363-43aa-94c6-6c2242a43406"><code itemprop="name">icfun</code> &#8212; <span itemprop="purpose">Initial condition function</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">function handle</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_dbdef752-2363-43aa-94c6-6c2242a43406" aria-labelledby="expand_accordion_heading_mw_dbdef752-2363-43aa-94c6-6c2242a43406" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_dbdef752-2363-43aa-94c6-6c2242a43406"><p>Initial condition function, specified as a function handle that defines the initial
            condition.</p><p>For <em class="varname">t</em> = <em class="varname">t</em><sub>0</sub> and all
              <em class="varname">x</em>, the solution components satisfy initial conditions of the form</p>
<div id="d126e1303556" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><mi>u</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><msub><mi>t</mi><mn>0</mn></msub></mrow><mo>)</mo></mrow><mo>=</mo><msub><mi>u</mi><mn>0</mn></msub><mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mo>.</mo></mrow></math></p></div></div><p></p>
            <h4 class="descriptionsect">Coding the Initial Condition</h4>
            <p>Write a function <code class="literal">icfun</code> that defines the initial conditions. Use
              the function signature:<div class="code_responsive"><pre class="programlisting">function u0 = icfun(x)</pre></div></p>
            <p>When called with an argument <code class="literal">x</code>, the function
                <code class="literal">icfun</code> evaluates and returns the initial values of the solution
              components at <code class="literal">x</code> in the column vector <code class="literal">u0</code>. The
              number of elements in <code class="literal">u0</code> is equal to the number of
              equations.</p>
          
            <h4 class="descriptionsect">Example</h4>
            <p>The constant initial condition <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-9px" display="block"><mrow><mi>u</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mn>0</mn></mrow><mo>)</mo></mrow><mo>=</mo><mn>1</mn><mo>/</mo><mn>2</mn></mrow></math></span></span> corresponds to this function:</p>
            <div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> u0 = heatic(x)
  u0 = 0.5;
<span style="color:#0000FF">end</span>
</pre></div></div></div>
          </div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">function_handle</code></p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="mw_5ccaac8a-d9a6-484d-8859-2ff9fc7e8913"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_5ccaac8a-d9a6-484d-8859-2ff9fc7e8913" data-bs-target="#expand_accordion_body_mw_5ccaac8a-d9a6-484d-8859-2ff9fc7e8913" aria-controls="expand_accordion_body_mw_5ccaac8a-d9a6-484d-8859-2ff9fc7e8913" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_bcfun" class="anchor_target"></span><h3 id="mw_5ccaac8a-d9a6-484d-8859-2ff9fc7e8913"><code itemprop="name">bcfun</code> &#8212; <span itemprop="purpose">Boundary condition function</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">function handle</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_5ccaac8a-d9a6-484d-8859-2ff9fc7e8913" aria-labelledby="expand_accordion_heading_mw_5ccaac8a-d9a6-484d-8859-2ff9fc7e8913" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_5ccaac8a-d9a6-484d-8859-2ff9fc7e8913"><p>Boundary condition function, specified as a function handle that defines the
            boundary conditions.</p><p>For all <em class="varname">t</em> and either <em class="varname">x</em> = <em class="varname">a</em>
            or <em class="varname">x</em> = <em class="varname">b</em>, the solution components satisfy a
            boundary condition of the form</p><div id="d126e1303636" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-16px" display="block"><mrow><mi>p</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>u</mi></mrow><mo>)</mo></mrow><mo>+</mo><mi>q</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>t</mi></mrow><mo>)</mo></mrow><mi>f</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi>u</mi></mrow><mrow><mo>∂</mo><mi>x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>=</mo><mn>0.</mn></mrow></math></p></div></div><p>Elements of <em class="varname">q</em> are either zero or never zero. Note that the
            boundary conditions are expressed in terms of the flux <em class="varname">f</em> rather than
              ∂<em class="varname">u</em>/∂<em class="varname">x</em>. Also, of the two coefficients, only
              <em class="varname">p</em> can depend on <em class="varname">u</em>.</p>
            <h4 class="descriptionsect">Coding the Boundary Conditions</h4>
            <p>Write a function <code class="literal">bcfun</code> that defines the terms
                <em class="varname">p</em> and <em class="varname">q</em> of the boundary conditions. Use the
              function signature
              <div class="code_responsive"><pre class="programlisting">function [pl,ql,pr,qr] = bcfun(xl,ul,xr,ur,t)
</pre></div></p>
            <p></p>
<div class="itemizedlist"><ul><li><p><code class="literal">ul</code> is the approximate solution at the left boundary
                      <code class="literal">xl = a</code>, and <code class="literal">ur</code> is the approximate
                    solution at the right boundary <code class="literal">xr = b</code>.</p></li><li><p><code class="literal">pl</code> and <code class="literal">ql</code> are column vectors
                    corresponding to <em class="varname">p</em> and <em class="varname">q</em> evaluated at
                      <code class="literal">xl</code>. Similarly, <code class="literal">pr</code> and
                      <code class="literal">qr</code> correspond to <code class="literal">xr</code>.</p></li><li><p>The number of elements in the outputs <code class="literal">pl</code>,
                      <code class="literal">ql</code>, <code class="literal">pr</code>, and <code class="literal">qr</code> is
                    equal to the number of equations.</p></li></ul></div><p>
 When <span class="inlineequation"><em class="varname">m</em> &gt; 0</span> and <span class="inlineequation"><em class="varname">a</em> = 0</span>, boundedness of the solution near <span class="inlineequation"><em class="varname">x</em> = 0</span> requires that the flux <em class="varname">f</em> vanish at <span class="inlineequation"><em class="varname">a</em> = 0</span>. <code class="function">pdepe</code> imposes this boundary condition
              automatically, and it ignores values returned in <code class="literal">pl</code> and
                <code class="literal">ql</code>.</p>
          
            <h4 class="descriptionsect">Example</h4>
            <p>Consider the boundary conditions <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-9px" display="block"><mrow><mi>u</mi><mrow><mo>(</mo><mrow><mn>0</mn><mo>,</mo><mi>t</mi></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn><mo>,</mo><mtext> </mtext><mtext> </mtext><mtext> </mtext><mi>u</mi><mrow><mo>(</mo><mrow><mn>1</mn><mo>,</mo><mi>t</mi></mrow><mo>)</mo></mrow><mo>=</mo><mn>1</mn></mrow></math></span></span> on the interval <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-4px" display="block"><mrow><mn>0</mn><mo>≤</mo><mi>x</mi><mo>≤</mo><mn>1</mn></mrow></math></span></span>. In the form expected by the solver, the boundary conditions
              are</p>
            <div id="d126e1303763" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-43px" display="block"><mtable columnalign="left"><mtr><mtd><mi>u</mi><mrow><mo>(</mo><mrow><mn>0</mn><mo>,</mo><mi>t</mi></mrow><mo>)</mo></mrow><mo>+</mo><mn>0</mn><mtext> </mtext><mo>·</mo><mtext> </mtext><mi>f</mi><mrow><mo>(</mo><mrow><mn>0</mn><mo>,</mo><mi>t</mi><mo>,</mo><mi>u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi>u</mi></mrow><mrow><mo>∂</mo><mi>x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn><mo>,</mo></mtd></mtr><mtr><mtd><mi>u</mi><mrow><mo>(</mo><mrow><mn>1</mn><mo>,</mo><mi>t</mi></mrow><mo>)</mo></mrow><mo>−</mo><mn>1</mn><mo>+</mo><mn>0</mn><mtext> </mtext><mo>·</mo><mtext> </mtext><mi>f</mi><mrow><mo>(</mo><mrow><mn>0</mn><mo>,</mo><mi>t</mi><mo>,</mo><mi>u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi>u</mi></mrow><mrow><mo>∂</mo><mi>x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>=</mo><mn>0.</mn></mtd></mtr></mtable></math></p></div></div>
            <p>In this form it is clear that both <em class="varname">q</em> terms are zero. The
                <em class="varname">p</em> terms are nonzero to reflect the values of
              <em class="varname">u</em>.  The corresponding function is</p>
            <div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> [pl,ql,pr,qr] = heatbc(xl,ul,xr,ur,t)
  pl = ul;
  ql = 0;
  pr = ur - 1;
  qr = 0;
<span style="color:#0000FF">end</span>
</pre></div></div></div>
          </div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">function_handle</code></p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="mw_39f0a244-6853-4b5a-b45c-ef17928a7175"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_39f0a244-6853-4b5a-b45c-ef17928a7175" data-bs-target="#expand_accordion_body_mw_39f0a244-6853-4b5a-b45c-ef17928a7175" aria-controls="expand_accordion_body_mw_39f0a244-6853-4b5a-b45c-ef17928a7175" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_xmesh" class="anchor_target"></span><h3 id="mw_39f0a244-6853-4b5a-b45c-ef17928a7175"><code itemprop="name">xmesh</code> &#8212; <span itemprop="purpose">Spatial mesh</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">vector</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_39f0a244-6853-4b5a-b45c-ef17928a7175" aria-labelledby="expand_accordion_heading_mw_39f0a244-6853-4b5a-b45c-ef17928a7175" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_39f0a244-6853-4b5a-b45c-ef17928a7175"><p>Spatial mesh, specified as a vector <code class="literal">[x0 x1 ... xn]</code> specifying the
            points at which a numerical solution is requested for every value in
              <code class="literal">tspan</code>. Second-order approximations to the solution are made on the
            mesh specified in <code class="literal">xmesh</code>.  <code class="function">pdepe</code> does
              <span class="emphasis"><em>not</em></span> select the mesh in <em class="varname">x</em> automatically. You
            must provide an appropriate fixed mesh in <code class="literal">xmesh</code>.</p><p>The elements of <code class="literal">xmesh</code> must satisfy <code class="literal">x0 &lt; x1 &lt; ...
              &lt; xn</code>. Generally, it is best to use closely spaced mesh points where the
            solution changes rapidly. The length of <code class="literal">xmesh</code> must be
              <code class="literal">&gt;=3</code>, and the computational cost of the solution depends strongly on
            the length of <code class="literal">xmesh</code>. </p><p>For problems with discontinuities, you should place mesh points at the
            discontinuities so that the problem is smooth within each subinterval. However, when <span class="inlineequation"><em class="varname">m</em> &gt; 0</span> , it is not necessary to use a fine mesh near <span class="inlineequation"><em class="varname">x</em> = 0</span> to account for the coordinate singularity.</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">xmesh = linspace(0,5,25)</code> uses a spatial mesh of 25 points
            between 0 and 5.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code></p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="mw_86a8dc7c-372b-421b-8082-2b459cb51733"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_86a8dc7c-372b-421b-8082-2b459cb51733" data-bs-target="#expand_accordion_body_mw_86a8dc7c-372b-421b-8082-2b459cb51733" aria-controls="expand_accordion_body_mw_86a8dc7c-372b-421b-8082-2b459cb51733" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_tspan" class="anchor_target"></span><h3 id="mw_86a8dc7c-372b-421b-8082-2b459cb51733"><code itemprop="name">tspan</code> &#8212; <span itemprop="purpose">Time span of integration</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">vector</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_86a8dc7c-372b-421b-8082-2b459cb51733" aria-labelledby="expand_accordion_heading_mw_86a8dc7c-372b-421b-8082-2b459cb51733" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_86a8dc7c-372b-421b-8082-2b459cb51733"><p>Time span of integration, specified as a vector <code class="literal">[t0 t1 ... tf]</code>
            specifying the points at which a solution is requested for every value in
              <code class="literal">xmesh</code>. The <code class="function">pdepe</code> function performs the time
            integration with an ODE solver that selects both the time step and the formula
            dynamically. The elements of <code class="literal">tspan</code> merely specify where you want
            answers, and the computational cost of the solution therefore depends only weakly on the
            length of <code class="literal">tspan</code>.</p><p>The elements of <code class="literal">tspan</code> must satisfy <code class="literal">t0 &lt; t1 &lt; ...
              &lt; tf</code>. The length of <code class="literal">tspan</code> must be
              <code class="literal">&gt;=3</code>.</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">tspan = linspace(0,5,5)</code> uses five time points between 0
            and 5.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code></p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="mw_fd83f736-3df0-47ab-a9dc-ccee879d4a20"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_fd83f736-3df0-47ab-a9dc-ccee879d4a20" data-bs-target="#expand_accordion_body_mw_fd83f736-3df0-47ab-a9dc-ccee879d4a20" aria-controls="expand_accordion_body_mw_fd83f736-3df0-47ab-a9dc-ccee879d4a20" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_options" class="anchor_target"></span><h3 id="mw_fd83f736-3df0-47ab-a9dc-ccee879d4a20"><code itemprop="name">options</code> &#8212; <span itemprop="purpose">Options structure</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">structure array</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_fd83f736-3df0-47ab-a9dc-ccee879d4a20" aria-labelledby="expand_accordion_heading_mw_fd83f736-3df0-47ab-a9dc-ccee879d4a20" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_fd83f736-3df0-47ab-a9dc-ccee879d4a20"><p>Options structure, specified as a structure array. Use the <a href="odeset.html"><code class="function">odeset</code></a> function to create or modify the options structure. You can set any
            of the options in <code class="function">odeset</code>, but <code class="function">pdepe</code> overrides
            the following options when solving the PDE: </p>
<div class="itemizedlist"><ul><li><p><code class="argument">Mass</code></p></li><li><p><code class="argument">MStateDependence</code></p></li><li><p><code class="argument">MvPattern</code></p></li><li><p><code class="argument">MassSingular</code></p></li><li><p><code class="argument">Jacobian</code></p></li><li><p><code class="argument">JPattern</code></p></li><li><p><code class="argument">Vectorized</code></p></li></ul></div><p>
</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">options = odeset(RelTol=1e-5)</code> specifies a relative error
            tolerance of <code class="literal">1e-5</code>.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">struct</code></p></div></div></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="mw_cd924e90-b42c-4a68-95ba-5b1f6071a3ef">Output Arguments</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="mw_cd924e90-b42c-4a68-95ba-5b1f6071a3ef_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_97daf312-0f43-4fa2-afb6-c67a624631e6" data-bs-target="#expand_accordion_body_mw_97daf312-0f43-4fa2-afb6-c67a624631e6" aria-controls="expand_accordion_body_mw_97daf312-0f43-4fa2-afb6-c67a624631e6" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_sol" class="anchor_target"></span><h3 id="mw_97daf312-0f43-4fa2-afb6-c67a624631e6"><code class="name">sol</code> &#8212; Solution array<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">3-D array</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_97daf312-0f43-4fa2-afb6-c67a624631e6" aria-labelledby="expand_accordion_heading_mw_97daf312-0f43-4fa2-afb6-c67a624631e6" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_97daf312-0f43-4fa2-afb6-c67a624631e6"><p>Solution array, returned as a 3-D array.</p><p><code class="function">pdepe</code> returns the solution as a multidimensional array.
                <em class="varname">u<sub>i</sub></em>&nbsp;=&nbsp;<code class="literal">ui</code>&nbsp;=&nbsp;<code class="literal">sol</code>(<code class="literal">:</code>,<code class="literal">:</code>,<code class="literal">i</code>)
            is an approximation to the <code class="literal">i</code>th component of the solution vector
              <em class="varname">u</em>. The element
              <code class="literal">ui</code>(<code class="literal">j</code>,<code class="literal">k</code>) =
              <code class="literal">sol</code>(<code class="literal">j</code>,<code class="literal">k</code>,<code class="literal">i</code>)
            approximates <em class="varname">u<sub>i</sub></em> at
              (<em class="varname">t</em>,<em class="varname">x</em>)&nbsp;=&nbsp;(<code class="literal">tspan</code>(<code class="literal">j</code>),<code class="literal">xmesh</code>(<code class="literal">k</code>)).</p><p><code class="literal">ui</code> =
              <code class="literal">sol</code>(<code class="literal">j</code>,<code class="literal">:</code>,<code class="literal">i</code>)
            approximates component <code class="literal">i</code> of the solution at time
              <code class="literal">tspan</code>(<code class="literal">j</code>) and mesh points
              <code class="literal">xmesh(:)</code>. Use <code class="function">pdeval</code> to compute the
            approximation and its partial derivative
              ∂<em class="varname">u<sub>i</sub></em>/∂<em class="varname">x</em> at points not
            included in <code class="literal">xmesh</code>. See <a href="pdeval.html"><code class="function">pdeval</code></a> for details.</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_1d6a06c5-b21c-41fd-a48d-022846dfa03e" data-bs-target="#expand_accordion_body_mw_1d6a06c5-b21c-41fd-a48d-022846dfa03e" aria-controls="expand_accordion_body_mw_1d6a06c5-b21c-41fd-a48d-022846dfa03e" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_tsol" class="anchor_target"></span><h3 id="mw_1d6a06c5-b21c-41fd-a48d-022846dfa03e"><code class="name">tsol</code> &#8212; Solution times<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">column vector</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_1d6a06c5-b21c-41fd-a48d-022846dfa03e" aria-labelledby="expand_accordion_heading_mw_1d6a06c5-b21c-41fd-a48d-022846dfa03e" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_1d6a06c5-b21c-41fd-a48d-022846dfa03e"><p>Solution times, returned as a column vector of times specified in
              <code class="literal">tspan</code> that are prior to the first terminal event.</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_811e78fa-f773-48eb-8187-2fca70fc4707" data-bs-target="#expand_accordion_body_mw_811e78fa-f773-48eb-8187-2fca70fc4707" aria-controls="expand_accordion_body_mw_811e78fa-f773-48eb-8187-2fca70fc4707" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_sole" class="anchor_target"></span><h3 id="mw_811e78fa-f773-48eb-8187-2fca70fc4707"><code class="name">sole</code> &#8212; Solution at time of events<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">array</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_811e78fa-f773-48eb-8187-2fca70fc4707" aria-labelledby="expand_accordion_heading_mw_811e78fa-f773-48eb-8187-2fca70fc4707" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_811e78fa-f773-48eb-8187-2fca70fc4707"><p>Solution at time of events, returned as an array. The event times in
              <code class="literal">te</code> correspond to solutions returned in <code class="literal">sole</code>, and
              <code class="literal">ie</code> specifies which event occurred.</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_d8a046b9-0637-4a3e-ade9-87d7956f89e8" data-bs-target="#expand_accordion_body_mw_d8a046b9-0637-4a3e-ade9-87d7956f89e8" aria-controls="expand_accordion_body_mw_d8a046b9-0637-4a3e-ade9-87d7956f89e8" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_te" class="anchor_target"></span><h3 id="mw_d8a046b9-0637-4a3e-ade9-87d7956f89e8"><code class="name">te</code> &#8212; Time of events<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">column vector</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_d8a046b9-0637-4a3e-ade9-87d7956f89e8" aria-labelledby="expand_accordion_heading_mw_d8a046b9-0637-4a3e-ade9-87d7956f89e8" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_d8a046b9-0637-4a3e-ade9-87d7956f89e8"><p>Time of events, returned as a column vector. The event times in
              <code class="literal">te</code> correspond to solutions returned in <code class="literal">sole</code>, and
              <code class="literal">ie</code> specifies which event occurred.</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_4a5c0bbc-c204-4a84-91bf-545a7b767e0b" data-bs-target="#expand_accordion_body_mw_4a5c0bbc-c204-4a84-91bf-545a7b767e0b" aria-controls="expand_accordion_body_mw_4a5c0bbc-c204-4a84-91bf-545a7b767e0b" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_ie" class="anchor_target"></span><h3 id="mw_4a5c0bbc-c204-4a84-91bf-545a7b767e0b"><code class="name">ie</code> &#8212; Index of triggered event function<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">column vector</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_4a5c0bbc-c204-4a84-91bf-545a7b767e0b" aria-labelledby="expand_accordion_heading_mw_4a5c0bbc-c204-4a84-91bf-545a7b767e0b" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_4a5c0bbc-c204-4a84-91bf-545a7b767e0b"><p>Index of triggered event function, returned as a column vector. The event times in
              <code class="literal">te</code> correspond to solutions returned in <code class="literal">sole</code>, and
              <code class="literal">ie</code> specifies which event occurred.</p></div></div></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="mw_077c5e49-ee92-4c2b-a988-c17d8d564362">Tips</h2><div class="itemizedlist"><ul><li><p>If <code class="literal">uji = sol(j,:,i)</code> approximates component <code class="literal">i</code> of
          the solution at time <code class="literal">tspan(j)</code> and mesh points <code class="literal">xmesh</code>,
          then <a href="pdeval.html"><code class="function">pdeval</code></a> evaluates the approximation and its
          partial derivative ∂<em class="varname">u<sub>i</sub></em>/∂<em class="varname">x</em> at
          the array of points <code class="literal">xout</code> and returns them in <code class="literal">uout</code>
          and <code class="literal">duoutdx</code>: <code class="literal">[uout,duoutdx] =
            pdeval(m,xmesh,uji,xout)</code>. The <code class="function">pdeval</code> function  evaluates
          the partial derivative <span class="inlineequation">∂<em class="varname">u<sub>i</sub></em>/∂<em class="varname">x</em></span> rather than the flux. The flux is continuous, but at a material
          interface the partial derivative may have a jump.</p></li></ul></div></div><div class="ref_sect"><h2 id="mw_01a7b8de-21cb-4df2-83a9-4009baa257d2">Algorithms</h2><p>The time integration is done with the <a href="ode15s.html"><code class="function">ode15s</code></a> solver. <code class="function">pdepe</code> exploits the capabilities of
        <code class="function">ode15s</code> for solving the differential-algebraic equations that arise when
      the PDE contains elliptic equations, and for handling Jacobians with a specified sparsity
      pattern.</p><p>After discretization, elliptic equations give rise to algebraic equations. If the elements
      of the initial-conditions vector that correspond to elliptic equations are not consistent with
      the discretization, <code class="function">pdepe</code> tries to adjust them before beginning the time
      integration. For this reason, the solution returned for the initial time may have a
      discretization error comparable to that at any other time. If the mesh is sufficiently fine,
        <code class="function">pdepe</code> can find consistent initial conditions close to the given ones.
      If <code class="function">pdepe</code> displays a message that it has difficulty finding consistent
      initial conditions, try refining the mesh. No adjustment is necessary for elements of the
      initial conditions vector that correspond to parabolic equations. </p></div><div class="bibliography"><h2 id="References">References</h2><div id="mw_ff45b469-c72f-4926-9978-3ed93595f14d" class="bibliomixed"><p>[1] Skeel, R. D. and M. Berzins, "A
      Method for the Spatial Discretization of Parabolic Equations in One Space Variable,"
        <em class="citetitle">SIAM Journal on Scientific and Statistical Computing</em>, Vol. 11, 1990,
      pp.1&#8211;32. </p></div></div><div class="ref_sect"><h2 id="refsect-extended-capabilities">Extended Capabilities</h2><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink">expand all</a></p><div id="accordion_refsect-extended-capabilities" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="f93-998620" class="anchor_target"></span><div class="accordion-header"><h3 id="f93-998620_threadsupport">Thread-Based Environment<br/> <span class=" remove_bold add_font_color_general">Run code in the background using MATLAB&#174; <code class="function">backgroundPool</code> or accelerate code with Parallel Computing Toolbox&#8482; <code class="function">ThreadPool</code>.</span></h3></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="mw_7a4eeb41-a1c2-4408-af40-5b8838576b71">Version History</h2><strong>Introduced before R2006a</strong><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink">expand all</a></p><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_mw_43647ea2-6604-4796-907b-1035714317ff" aria-controls="expand_body_mw_43647ea2-6604-4796-907b-1035714317ff" class="accordion-button collapsed" aria-expanded="false"><h3 id="mw_43647ea2-6604-4796-907b-1035714317ff">R2025a: <span class="remove_bold">Specify output function and other <code class="function">odeset</code> options</span></h3></button></div><div id="expand_body_mw_43647ea2-6604-4796-907b-1035714317ff" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>You can now specify all <code class="function">odeset</code> options, including the output
        function, when using the <code class="function">pdepe</code> function. However,
          <code class="function">pdepe</code> overrides some options when defining the PDE to solve. See
          <a href="pdepe.html#mw_fd83f736-3df0-47ab-a9dc-ccee879d4a20" class="intrnllnk"><code class="argument">options</code></a> for
        more details.</p><p>Previously, <code class="function">pdepe</code> supported only the <code class="argument">RelTol</code>,
          <code class="argument">AbsTol</code>, <code class="argument">NormControl</code>,
          <code class="argument">InitialStep</code>, <code class="argument">MaxStep</code>, and
          <code class="argument">Events</code> options.</p></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="f93-998620_seealso">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="pdeval.html"><span itemprop="name"><code class="function">pdeval</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="ode15s.html"><span itemprop="name"><code class="function">ode15s</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="odeset.html"><span itemprop="name"><code class="function">odeset</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="odeget.html"><span itemprop="name"><code class="function">odeget</code></span></a></span></p><div class="examples_container"><h3 class="remove_border">Topics</h3><div itemprop="content"><ul class="list-unstyled"><li><a href="../math/partial-differential-equations.html" class="a">Solving Partial Differential Equations</a></li><li><a href="../math/solve-single-pde.html" class="a">Solve Single PDE</a></li><li><a href="../math/solve-system-of-pdes.html" class="a">Solve System of PDEs</a></li></ul></div></div></div>
    </div></div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

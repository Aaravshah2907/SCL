<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>eigs</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../linear-algebra.html",
          "name": "Linear Algebra"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../sparse-matrices.html",
          "name": "Sparse Matrices"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "linear-algebra",
        "sparse-matrices"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExtendedCapabilities",

        "itemListElement":
        [
{
          "@type": "ListItem",
          "position": 1,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "distributedarrays",
          "value": "limited"

        }
          },
{
          "@type": "ListItem",
          "position": 2,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "threadsupport",
          "value": "full"

        }
          }
        ]
        }
        </script>
<meta xmlns="http://www.w3.org/1999/xhtml" name="chunktype" content="refpage"><meta xmlns="http://www.w3.org/1999/xhtml" name="refentity" itemprop="refentity" content="function:eigs"><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="fcn">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ref/function">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This MATLAB function returns a vector of the six largest magnitude eigenvalues of matrix A."><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "refentry";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../linear-algebra.html?s_tid=CRUX_lftnav" itemprop="url" id="linear-algebra"><span itemprop="title">Linear Algebra</span></a></li></ul><ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li><a href="../mathematics.html?s_tid=CRUX_lftnav">Mathematics</a></li><li><a href="../sparse-matrices.html?s_tid=CRUX_lftnav" id="sparse-matrices">Sparse Matrices</a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item notranslate"><a href="#responsive_offcanvas"><span class="refname">eigs</span></a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-refentry">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li><a href="#d126e471130" class="intrnllnk">Syntax</a></li><li class="nav-item"><a href="#description" class="nav-link intrnllnk">Description</a></li><li class="nav-item"><a href="#bu2_q3e-4" class="nav-link intrnllnk">Examples</a><ul class="nav"><li class="nav-item"><a href="#bu3ze_j" class="nav-link intrnllnk">Largest Eigenvalues of Sparse Matrix</a></li></ul><ul class="nav"><li class="nav-item"><a href="#bu2_wlt" class="nav-link intrnllnk">Smallest Eigenvalues of Sparse Matrix</a></li></ul><ul class="nav"><li class="nav-item"><a href="#bu304hs" class="nav-link intrnllnk">Eigenvalues Using Function Handle</a></li></ul><ul class="nav"><li class="nav-item"><a href="#bu2_wqv" class="nav-link intrnllnk">Types of Eigenvalues</a></li></ul><ul class="nav"><li class="nav-item"><a href="#bu3793t" class="nav-link intrnllnk">Difference Between <code class="literal">'smallestabs'</code> and <code class="literal">'smallestreal'</code> Eigenvalues</a></li></ul><ul class="nav"><li class="nav-item"><a href="#bu2_xa9-1" class="nav-link intrnllnk">Sigma Value Near Eigenvalue</a></li></ul><ul class="nav"><li class="nav-item"><a href="#bu3ze9y" class="nav-link intrnllnk">Eigenvalues of Permuted Cholesky Factor</a></li></ul></li><li class="nav-item"><a href="#bu2_q3e-2" class="nav-link intrnllnk">Input Arguments</a><ul class="nav"><li class="nav-item"><a href="#bu2_q3e-A" class="nav-link intrnllnk">A</a></li><li class="nav-item"><a href="#bu2_q3e-B" class="nav-link intrnllnk">B</a></li><li class="nav-item"><a href="#bu2_q3e-k" class="nav-link intrnllnk">k</a></li><li class="nav-item"><a href="#bu2_q3e-sigma" class="nav-link intrnllnk">sigma</a></li><li class="nav-item"><a href="#bu2_q3e-opts" class="nav-link intrnllnk">opts</a></li><li class="nav-item"><a href="#bu2_q3e-Afun" class="nav-link intrnllnk">Afun</a></li><li class="nav-item"><a href="#bu2_q3e-n" class="nav-link intrnllnk">n</a></li></ul></li><li class="nav-item"><a href="#namevaluepairs" class="nav-link intrnllnk">Name-Value Arguments</a><ul class="nav"><li class="nav-item"><a href="#d126e472051" class="nav-link intrnllnk">General Options</a><ul><li class="nav-item"><a href="#d126e472055" class="nav-link intrnllnk">Tolerance</a></li><li class="nav-item"><a href="#d126e472081" class="nav-link intrnllnk">MaxIterations</a></li><li class="nav-item"><a href="#d126e472107" class="nav-link intrnllnk">SubspaceDimension</a></li><li class="nav-item"><a href="#d126e472159" class="nav-link intrnllnk">StartVector</a></li><li class="nav-item"><a href="#d126e472203" class="nav-link intrnllnk">FailureTreatment</a></li><li class="nav-item"><a href="#d126e472306" class="nav-link intrnllnk">Display</a></li></ul></li></ul><ul class="nav"><li class="nav-item"><a href="#d126e472347" class="nav-link intrnllnk">Options for <code class="literal">Afun</code></a><ul><li class="nav-item"><a href="#d126e472353" class="nav-link intrnllnk">IsFunctionSymmetric</a></li></ul></li></ul><ul class="nav"><li class="nav-item"><a href="#d126e472406" class="nav-link intrnllnk">Options for generalized eigenvalue problem <code class="literal">A*V =
                    B*V*D</code></a><ul><li class="nav-item"><a href="#d126e472412" class="nav-link intrnllnk">IsCholesky</a></li><li class="nav-item"><a href="#d126e472472" class="nav-link intrnllnk">CholeskyPermutation</a></li><li class="nav-item"><a href="#d126e472518" class="nav-link intrnllnk">IsSymmetricDefinite</a></li></ul></li></ul></li><li class="nav-item"><a href="#bu2_q3e-3" class="nav-link intrnllnk">Output Arguments</a><ul class="nav"><li class="nav-item"><a href="#bu2_q3e-d" class="nav-link intrnllnk">d</a></li><li class="nav-item"><a href="#bu2_q3e-V" class="nav-link intrnllnk">V</a></li><li class="nav-item"><a href="#bu2_q3e-D" class="nav-link intrnllnk">D</a></li><li class="nav-item"><a href="#bu2_q3e-flag" class="nav-link intrnllnk">flag</a></li></ul></li><li class="nav-item"><a href="#bu2_xjs-5" class="nav-link intrnllnk">Tips</a></li><li><a href="#References" class="intrnllnk">References</a></li><li class="nav-item"><a href="#refsect-extended-capabilities" class="nav-link intrnllnk">Extended Capabilities</a></li><li class="nav-item"><a href="#mw_53a91f0d-10fc-4417-875c-53ea9f7b5596" class="nav-link intrnllnk">Version History</a><ul class="nav"><li class="nav-item"><a href="#mw_905721a0-7559-45b7-8284-648587509db5" class="nav-link intrnllnk">Specify single-precision input arguments</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_ca37536b-4789-49e9-a5e4-5df54eb95c1c" class="nav-link intrnllnk">Behavior and algorithm change</a></li></ul></li><li class="nav-item"><a href="#bu2_q3e_seealso" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=linear-algebra&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=linear-algebra&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=linear-algebra&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=linear-algebra&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=linear-algebra&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=linear-algebra&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-ref-function"><div class="function_ref"><span id="bu2_q3e" class="anchor_target"></span><h1 class="r2025b notranslate" itemprop="title"><span class="refname">eigs</span></h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">Subset of eigenvalues and eigenvectors</p><div class="switch"><a href="javascript:void(0);" id="expandAllPage" data-allexpanded="true1">collapse all in page</a></div></div></div>
<div class="ref_sect"><h2 id="d126e471130">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><div class="code_responsive"><code class="synopsis"><a href="#d126e471139" class="intrnllnk">d = eigs(A)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e471159" class="intrnllnk">d = eigs(A,k)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e471179" class="intrnllnk">d = eigs(A,k,sigma)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e471207" class="intrnllnk">d = eigs(A,k,sigma,Name,Value)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e471228" class="intrnllnk">d = eigs(A,k,sigma,opts)</a></code></div></div><div class="syntax_signature_module"><div class="code_responsive"><code class="synopsis"><a href="#d126e471251" class="intrnllnk">d = eigs(A,B,<span class="argument_placeholder">___</span>)</a></code></div></div><div class="syntax_signature_module"><div class="code_responsive"><code class="synopsis"><a href="#d126e471281" class="intrnllnk">d = eigs(Afun,n,<span class="argument_placeholder">___</span>)</a></code></div></div><div class="syntax_signature_module"><div class="code_responsive"><code class="synopsis"><a href="#d126e471317" class="intrnllnk">[V,D] =
eigs(<span class="argument_placeholder">___</span>)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e471340" class="intrnllnk">[V,D,flag]
= eigs(<span class="argument_placeholder">___</span>)</a></code></div></div></div></div><div class="clear"></div><span id="bu2_q3e-1" class="anchor_target"></span><h2 id="description">Description</h2><div class="descriptions"><div class="cshsummary" id="csh_bu2_q3e"><div class="description_module"><span id="bu5xcpg" class="anchor_target"></span>
<div class="description_element"><div class="code_responsive"><p><span id="d126e471139" itemprop="syntax"><code class="synopsis"><a href="#bu2_q3e-d" class="intrnllnk"><code class="argument">d</code></a> = eigs(<a href="#bu2_q3e-A" class="intrnllnk"><code class="argument">A</code></a>)</code></span> returns a vector of
                    the six largest magnitude eigenvalues of matrix <code class="literal">A</code>. This is
                    most useful when computing all of the eigenvalues with <code class="function">eig</code>
                    is computationally expensive, such as with large sparse matrices.</p></div><p class="syntax_example"><a href="eigs.html#bu3ze_j" class="intrnllnk">example</a></p></div>
<div class="description_element"><div class="code_responsive"><p><span id="d126e471159" itemprop="syntax"><code class="synopsis"><a href="#bu2_q3e-d" class="intrnllnk"><code class="argument">d</code></a> = eigs(<a href="#bu2_q3e-A" class="intrnllnk"><code class="argument">A</code></a>,<a href="#bu2_q3e-k" class="intrnllnk"><code class="argument">k</code></a>)</code></span> returns
the <code class="literal">k</code> largest magnitude eigenvalues.</p></div><p class="syntax_example"><a href="eigs.html#bu3ze_j" class="intrnllnk">example</a></p></div>
<div class="description_element"><div class="code_responsive"><p><span id="d126e471179" itemprop="syntax"><code class="synopsis"><a href="#bu2_q3e-d" class="intrnllnk"><code class="argument">d</code></a> = eigs(<a href="#bu2_q3e-A" class="intrnllnk"><code class="argument">A</code></a>,<a href="#bu2_q3e-k" class="intrnllnk"><code class="argument">k</code></a>,<a href="#bu2_q3e-sigma" class="intrnllnk"><code class="argument">sigma</code></a>)</code></span>
                    returns <code class="literal">k</code> eigenvalues based on the value of
                        <code class="literal">sigma</code>. For example,
                        <code class="literal">eigs(A,k,'smallestabs')</code> returns the <code class="literal">k</code>
                    smallest magnitude eigenvalues.</p></div><p class="syntax_example"><a href="eigs.html#bu2_wlt" class="intrnllnk">example</a></p></div>
            <div class="description_element"><div class="code_responsive"><p><span id="d126e471207" itemprop="syntax"><code class="synopsis"><a href="#bu2_q3e-d" class="intrnllnk"><code class="argument">d</code></a> = eigs(<a href="#bu2_q3e-A" class="intrnllnk"><code class="argument">A</code></a>,<a href="#bu2_q3e-k" class="intrnllnk"><code class="argument">k</code></a>,<a href="#bu2_q3e-sigma" class="intrnllnk"><code class="argument">sigma</code></a>,<a href="#namevaluepairarguments" class="intrnllnk"><code class="argument">Name,Value</code></a>)</code></span>
                    specifies additional options with one or more name-value pair arguments. For
                    example, <code class="literal">eigs(A,k,sigma,'Tolerance',1e-3)</code> adjusts the
                    convergence tolerance for the algorithm.</p></div></div>
<div class="description_element"><div class="code_responsive"><p><span id="d126e471228" itemprop="syntax"><code class="synopsis"><a href="#bu2_q3e-d" class="intrnllnk"><code class="argument">d</code></a> = eigs(<a href="#bu2_q3e-A" class="intrnllnk"><code class="argument">A</code></a>,<a href="#bu2_q3e-k" class="intrnllnk"><code class="argument">k</code></a>,<a href="#bu2_q3e-sigma" class="intrnllnk"><code class="argument">sigma</code></a>,<a href="#bu2_q3e-opts" class="intrnllnk"><code class="argument">opts</code></a>)</code></span>
                    specifies options using a structure.</p></div><p class="syntax_example"><a href="eigs.html#bu2_wqv" class="intrnllnk">example</a></p></div>
</div><div class="description_module"><span id="bu5xcpn" class="anchor_target"></span>
<div class="description_element"><div class="code_responsive"><p><span id="d126e471251" itemprop="syntax"><code class="synopsis"><a href="#bu2_q3e-d" class="intrnllnk"><code class="argument">d</code></a> = eigs(<a href="#bu2_q3e-A" class="intrnllnk"><code class="argument">A</code></a>,<a href="#bu2_q3e-B" class="intrnllnk"><code class="argument">B</code></a>,<span class="argument_placeholder">___</span>)</code></span>
                    solves the generalized eigenvalue problem <code class="literal">A*V = B*V*D</code>. You
                    can optionally specify <code class="literal">k</code>, <code class="literal">sigma</code>,
                        <code class="literal">opts</code>, or name-value pairs as additional input
                    arguments.</p></div><p class="syntax_example"><a href="eigs.html#bu3ze9y" class="intrnllnk">example</a></p></div>
</div><div class="description_module"><span id="bu5xcps" class="anchor_target"></span>
<div class="description_element"><div class="code_responsive"><p><span id="d126e471281" itemprop="syntax"><code class="synopsis"><a href="#bu2_q3e-d" class="intrnllnk"><code class="argument">d</code></a> = eigs(<a href="#bu2_q3e-Afun" class="intrnllnk"><code class="argument">Afun</code></a>,<a href="#bu2_q3e-n" class="intrnllnk"><code class="argument">n</code></a>,<span class="argument_placeholder">___</span>)</code></span>
                    specifies a function handle <code class="literal">Afun</code> instead of a matrix. The
                    second input <code class="literal">n</code> gives the size of matrix <code class="literal">A</code>
                    used in <code class="literal">Afun</code>. You can optionally specify
                    <code class="literal">B</code>, <code class="literal">k</code>, <code class="literal">sigma</code>,
                        <code class="literal">opts</code>, or name-value pairs as additional input
                    arguments.</p></div></div>
</div><div class="description_module"><span id="bu5xcpx" class="anchor_target"></span>
<div class="description_element"><div class="code_responsive"><p><span id="d126e471317" itemprop="syntax"><code class="synopsis">[<a href="#bu2_q3e-V" class="intrnllnk"><code class="argument">V</code></a>,<a href="#bu2_q3e-D" class="intrnllnk"><code class="argument">D</code></a>] =
eigs(<span class="argument_placeholder">___</span>)</code></span> returns diagonal matrix <code class="literal">D</code> containing
the eigenvalues on the main diagonal, and matrix <code class="literal">V</code> whose
columns are the corresponding eigenvectors. You can use any of the
input argument combinations in previous syntaxes.</p></div><p class="syntax_example"><a href="eigs.html#bu3ze9y" class="intrnllnk">example</a></p></div>
<div class="description_element"><div class="code_responsive"><p><span id="d126e471340" itemprop="syntax"><code class="synopsis">[<a href="#bu2_q3e-V" class="intrnllnk"><code class="argument">V</code></a>,<a href="#bu2_q3e-D" class="intrnllnk"><code class="argument">D</code></a>,<a href="#bu2_q3e-flag" class="intrnllnk"><code class="argument">flag</code></a>]
= eigs(<span class="argument_placeholder">___</span>)</code></span> also returns a convergence flag.
If <code class="literal">flag</code> is <code class="literal">0</code>, then all the eigenvalues
converged.</p></div><p class="syntax_example"><a href="eigs.html#bu3ze9y" class="intrnllnk">example</a></p></div>
</div></div></div><div class="clear"></div><div class="examples"><h2 id="bu2_q3e-4">Examples</h2><div class="expandableContent" id="expandableExamples"><p class="switch"><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true3">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_bu3ze_j"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu3ze_j" data-bs-target="#expand_accordion_body_bu3ze_j" aria-controls="expand_accordion_body_bu3ze_j" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="bu3ze_j">Largest Eigenvalues of Sparse Matrix</h3></button></div><div role="tabpanel" id="expand_accordion_body_bu3ze_j" aria-labelledby="expand_accordion_heading_bu3ze_j" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/LargestEigenvaluesOfSparseMatrixExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Largest Eigenvalues of Sparse Matrix",
          "description": "The matrix A = delsq(numgrid('C',15)) is a symmetric positive definite matrix with eigenvalues reasonably well-distributed in the interval (0 8). Compute the six largest magnitude eigenvalues.",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "eigs.html"

        },
          "identifier": "matlab.LargestEigenvaluesOfSparseMatrixExample",
          "name": "LargestEigenvaluesOfSparseMatrixExample",
          "url": "eigs.html#bu3ze_j"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/LargestEigenvaluesOfSparseMatrixExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "LargestEigenvaluesOfSparseMatrixExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">The matrix <code class="literal">A = delsq(numgrid('C',15))</code> is a symmetric positive definite matrix with eigenvalues reasonably well-distributed in the interval (0 8). Compute the six largest magnitude eigenvalues. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>A = delsq(numgrid(<span style="color:#A020F0">'C'</span>,15));
d = eigs(A)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>d = <span class="emphasis"><em>6×1</em></span>

    7.8666
    7.7324
    7.6531
    7.5213
    7.4480
    7.3517

</pre></div></div></div><p>Specify a second input to compute a specific number of the largest eigenvalues.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>d = eigs(A,3)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>d = <span class="emphasis"><em>3×1</em></span>

    7.8666
    7.7324
    7.6531

</pre></div></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-LargestEigenvaluesOfSparseMatrixExample"><meta itemprop="exampletitle" content="Largest Eigenvalues of Sparse Matrix"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_bu2_wlt"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu2_wlt" data-bs-target="#expand_accordion_body_bu2_wlt" aria-controls="expand_accordion_body_bu2_wlt" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="bu2_wlt">Smallest Eigenvalues of Sparse Matrix</h3></button></div><div role="tabpanel" id="expand_accordion_body_bu2_wlt" aria-labelledby="expand_accordion_heading_bu2_wlt" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/SmallestEigenvaluesOfSparseMatrixExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Smallest Eigenvalues of Sparse Matrix",
          "description": "The matrix A = delsq(numgrid('C',15)) is a symmetric positive definite matrix with eigenvalues reasonably well-distributed in the interval (0 8). Compute the five smallest eigenvalues.",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "eigs.html"

        },
          "identifier": "matlab.SmallestEigenvaluesOfSparseMatrixExample",
          "name": "SmallestEigenvaluesOfSparseMatrixExample",
          "url": "eigs.html#bu2_wlt"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/SmallestEigenvaluesOfSparseMatrixExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "SmallestEigenvaluesOfSparseMatrixExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">The matrix <code class="literal">A = delsq(numgrid('C',15))</code> is a symmetric positive definite matrix with eigenvalues reasonably well-distributed in the interval (0 8). Compute the five smallest eigenvalues.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>A = delsq(numgrid(<span style="color:#A020F0">'C'</span>,15));  
d = eigs(A,5,<span style="color:#A020F0">'smallestabs'</span>)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>d = <span class="emphasis"><em>5×1</em></span>

    0.1334
    0.2676
    0.3469
    0.4787
    0.5520

</pre></div></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-SmallestEigenvaluesOfSparseMatrixExample"><meta itemprop="exampletitle" content="Smallest Eigenvalues of Sparse Matrix"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_bu304hs"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu304hs" data-bs-target="#expand_accordion_body_bu304hs" aria-controls="expand_accordion_body_bu304hs" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="bu304hs">Eigenvalues Using Function Handle</h3></button></div><div role="tabpanel" id="expand_accordion_body_bu304hs" aria-labelledby="expand_accordion_heading_bu304hs" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/EigenvaluesUsingFunctionHandleExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Eigenvalues Using Function Handle",
          "description": "Create a 1500-by-1500 random sparse matrix with a 25% approximate density of nonzero elements.",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "eigs.html"

        },
          "identifier": "matlab.EigenvaluesUsingFunctionHandleExample",
          "name": "EigenvaluesUsingFunctionHandleExample",
          "url": "eigs.html#bu304hs"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/EigenvaluesUsingFunctionHandleExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "EigenvaluesUsingFunctionHandleExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Create a 1500-by-1500 random sparse matrix with a 25% approximate density of nonzero elements.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>n = 1500;
A = sprand(n,n,0.25);</pre></div></div></div><p>Find the LU factorization of the matrix, returning a permutation vector <code class="literal">p</code> that satisfies <code class="literal">A(p,:) = L*U</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[L,U,p] = lu(A,<span style="color:#A020F0">'vector'</span>);</pre></div></div></div><p>Create a function handle <code class="literal">Afun</code> that accepts a vector input <code class="literal">x</code> and uses the results of the LU decomposition to, in effect, return <code class="literal">A\x</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>Afun = @(x) U\(L\(x(p)));</pre></div></div></div><p>Calculate the six smallest magnitude eigenvalues using <code class="literal">eigs</code> with the function handle <code class="literal">Afun</code>. The second input is the size of <code class="literal">A</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>d = eigs(Afun,1500,6,<span style="color:#A020F0">'smallestabs'</span>)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>d = <span class="emphasis"><em>6×1 complex</em></span>

   0.1423 + 0.0000i
   0.4859 + 0.0000i
  -0.3323 - 0.3881i
  -0.3323 + 0.3881i
   0.1019 - 0.5381i
   0.1019 + 0.5381i

</pre></div></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-EigenvaluesUsingFunctionHandleExample"><meta itemprop="exampletitle" content="Eigenvalues Using Function Handle"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_bu2_wqv"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu2_wqv" data-bs-target="#expand_accordion_body_bu2_wqv" aria-controls="expand_accordion_body_bu2_wqv" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="bu2_wqv">Types of Eigenvalues</h3></button></div><div role="tabpanel" id="expand_accordion_body_bu2_wqv" aria-labelledby="expand_accordion_heading_bu2_wqv" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/TypesOfEigenvaluesExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Types of Eigenvalues",
          "description": "West0479 is a real-valued 479-by-479 sparse matrix with both real and complex pairs of conjugate eigenvalues.",
          "thumbnailURL": "../../examples/matlab/win64/TypesOfEigenvaluesExample_04.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "eigs.html"

        },
          "identifier": "matlab.TypesOfEigenvaluesExample",
          "name": "TypesOfEigenvaluesExample",
          "url": "eigs.html#bu2_wqv"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/TypesOfEigenvaluesExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "TypesOfEigenvaluesExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc"><code class="literal">west0479</code> is a real-valued 479-by-479 sparse matrix with both real and complex pairs of conjugate eigenvalues. </p><p>Load the <code class="literal">west0479</code> matrix, then compute and plot all of the eigenvalues using <code class="literal">eig</code>. Since the eigenvalues are complex, <code class="literal">plot</code> automatically uses the real parts as the x-coordinates and the imaginary parts as the y-coordinates.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>load <span style="color:#A020F0">west0479</span>
A = west0479;
d = eig(full(A));
plot(d,<span style="color:#A020F0">'+'</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e473020" class="mediaobject"><p><img src="../../examples/matlab/win64/TypesOfEigenvaluesExample_01.png" alt="Figure contains an axes object. The axes contains a line object which displays its values using only markers." width="560"></p></div></div><p>The eigenvalues are clustered along the real line (x-axis), particularly near the origin.</p><p><code class="literal">eigs</code> has several options for <code class="literal">sigma</code> that can pick out the largest or smallest eigenvalues of varying types. Compute and plot some eigenvalues for each of the available options for <code class="literal">sigma</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>figure
plot(d, <span style="color:#A020F0">'+'</span>)
hold <span style="color:#A020F0">on</span>
la = eigs(A,6,<span style="color:#A020F0">'largestabs'</span>);
plot(la,<span style="color:#A020F0">'ro'</span>)
sa = eigs(A,6,<span style="color:#A020F0">'smallestabs'</span>);
plot(sa,<span style="color:#A020F0">'go'</span>)
hold <span style="color:#A020F0">off</span>
legend(<span style="color:#A020F0">'All eigenvalues'</span>,<span style="color:#A020F0">'Largest magnitude'</span>,<span style="color:#A020F0">'Smallest magnitude'</span>)
xlabel(<span style="color:#A020F0">'Real axis'</span>)
ylabel(<span style="color:#A020F0">'Imaginary axis'</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e473035" class="mediaobject"><p><img src="../../examples/matlab/win64/TypesOfEigenvaluesExample_02.png" alt="Figure contains an axes object. The axes object with xlabel Real axis, ylabel Imaginary axis contains 3 objects of type line. One or more of the lines displays its values using only markers These objects represent All eigenvalues, Largest magnitude, Smallest magnitude." width="560"></p></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>figure
plot(d, <span style="color:#A020F0">'+'</span>)
hold <span style="color:#A020F0">on</span>
ber = eigs(A,4,<span style="color:#A020F0">'bothendsreal'</span>);
plot(ber,<span style="color:#A020F0">'r^'</span>)
bei = eigs(A,4,<span style="color:#A020F0">'bothendsimag'</span>);
plot(bei,<span style="color:#A020F0">'g^'</span>)
hold <span style="color:#A020F0">off</span>
legend(<span style="color:#A020F0">'All eigenvalues'</span>,<span style="color:#A020F0">'Both ends real'</span>,<span style="color:#A020F0">'Both ends imaginary'</span>)
xlabel(<span style="color:#A020F0">'Real axis'</span>)
ylabel(<span style="color:#A020F0">'Imaginary axis'</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e473042" class="mediaobject"><p><img src="../../examples/matlab/win64/TypesOfEigenvaluesExample_03.png" alt="Figure contains an axes object. The axes object with xlabel Real axis, ylabel Imaginary axis contains 3 objects of type line. One or more of the lines displays its values using only markers These objects represent All eigenvalues, Both ends real, Both ends imaginary." width="560"></p></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>figure
plot(d, <span style="color:#A020F0">'+'</span>)
hold <span style="color:#A020F0">on</span>
lr = eigs(A,3,<span style="color:#A020F0">'largestreal'</span>);
plot(lr,<span style="color:#A020F0">'ro'</span>)
sr = eigs(A,3,<span style="color:#A020F0">'smallestreal'</span>);
plot(sr,<span style="color:#A020F0">'go'</span>)
li = eigs(A,3,<span style="color:#A020F0">'largestimag'</span>,<span style="color:#A020F0">'SubspaceDimension'</span>,45);
plot(li,<span style="color:#A020F0">'m^'</span>)
si = eigs(A,3,<span style="color:#A020F0">'smallestimag'</span>,<span style="color:#A020F0">'SubspaceDimension'</span>,45);
plot(si,<span style="color:#A020F0">'c^'</span>)
hold <span style="color:#A020F0">off</span>
legend(<span style="color:#A020F0">'All eigenvalues'</span>,<span style="color:#A020F0">'Largest real'</span>,<span style="color:#A020F0">'Smallest real'</span>,<span style="color:#A020F0">'Largest imaginary'</span>,<span style="color:#A020F0">'Smallest imaginary'</span>)
xlabel(<span style="color:#A020F0">'Real axis'</span>)
ylabel(<span style="color:#A020F0">'Imaginary axis'</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e473050" class="mediaobject"><p><img src="../../examples/matlab/win64/TypesOfEigenvaluesExample_04.png" alt="Figure contains an axes object. The axes object with xlabel Real axis, ylabel Imaginary axis contains 5 objects of type line. One or more of the lines displays its values using only markers These objects represent All eigenvalues, Largest real, Smallest real, Largest imaginary, Smallest imaginary." width="560"></p></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-TypesOfEigenvaluesExample"><meta itemprop="exampletitle" content="Types of Eigenvalues"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_bu3793t"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu3793t" data-bs-target="#expand_accordion_body_bu3793t" aria-controls="expand_accordion_body_bu3793t" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="bu3793t">Difference Between <code class="literal">'smallestabs'</code> and <code class="literal">'smallestreal'</code> Eigenvalues</h3></button></div><div role="tabpanel" id="expand_accordion_body_bu3793t" aria-labelledby="expand_accordion_heading_bu3793t" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/DifferenceBetweenSaAndSmEigenvaluesExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Difference Between 'smallestabs' and 'smallestreal' Eigenvalues",
          "description": "Create a symmetric positive definite sparse matrix.",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "eigs.html"

        },
          "identifier": "matlab.DifferenceBetweenSaAndSmEigenvaluesExample",
          "name": "DifferenceBetweenSaAndSmEigenvaluesExample",
          "url": "eigs.html#bu3793t"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/DifferenceBetweenSaAndSmEigenvaluesExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "DifferenceBetweenSaAndSmEigenvaluesExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Create a symmetric positive definite sparse matrix.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>A = delsq(numgrid(<span style="color:#A020F0">'C'</span>, 150));</pre></div></div></div><p>Compute the six smallest real eigenvalues using <code class="literal">'smallestreal'</code>, which employs a Krylov method using <code class="literal">A</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>tic
d = eigs(A, 6, <span style="color:#A020F0">'smallestreal'</span>)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>d = <span class="emphasis"><em>6×1</em></span>

    0.0013
    0.0025
    0.0033
    0.0045
    0.0052
    0.0063

</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>toc</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>Elapsed time is 3.546209 seconds.
</pre></div></div></div><p>Compute the same eigenvalues using <code class="literal">'smallestabs'</code>, which employs a Krylov method using the inverse of <code class="literal">A</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>tic
dsm = eigs(A, 6, <span style="color:#A020F0">'smallestabs'</span>)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>dsm = <span class="emphasis"><em>6×1</em></span>

    0.0013
    0.0025
    0.0033
    0.0045
    0.0052
    0.0063

</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>toc</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>Elapsed time is 0.475066 seconds.
</pre></div></div></div><p>The eigenvalues are clustered near zero. The <code class="literal">'smallestreal'</code> computation struggles to converge using <code class="literal">A</code> since the gap between the eigenvalues is so small. Conversely, the <code class="literal">'smallestabs'</code> option uses the inverse of <code class="literal">A</code>, and therefore the inverse of the eigenvalues of <code class="literal">A</code>, which have a much larger gap and are therefore easier to compute. This improved performance comes at the cost of factorizing <code class="literal">A</code>, which is not necessary with <code class="literal">'smallestreal'</code>.</p><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-DifferenceBetweenSaAndSmEigenvaluesExample"><meta itemprop="exampletitle" content="Difference Between 'smallestabs' and 'smallestreal' Eigenvalues"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_bu2_xa9-1"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu2_xa9-1" data-bs-target="#expand_accordion_body_bu2_xa9-1" aria-controls="expand_accordion_body_bu2_xa9-1" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="bu2_xa9-1">Sigma Value Near Eigenvalue</h3></button></div><div role="tabpanel" id="expand_accordion_body_bu2_xa9-1" aria-labelledby="expand_accordion_heading_bu2_xa9-1" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/RepeatedEigenvaluesOfSymmetricPositiveDefiniteSparseMatrExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Sigma Value Near Eigenvalue",
          "description": "Compute eigenvalues near a numeric sigma value that is nearly equal to an eigenvalue.",
          "thumbnailURL": "../../examples/matlab/win64/RepeatedEigenvaluesOfSymmetricPositiveDefiniteSparseMatrExample_01.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "eigs.html"

        },
          "identifier": "matlab.RepeatedEigenvaluesOfSymmetricPositiveDefiniteSparseMatrExample",
          "name": "RepeatedEigenvaluesOfSymmetricPositiveDefiniteSparseMatrExample",
          "url": "eigs.html#bu2_xa9-1"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/RepeatedEigenvaluesOfSymmetricPositiveDefiniteSparseMatrExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "RepeatedEigenvaluesOfSymmetricPositiveDefiniteSparseMatrExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Compute eigenvalues near a numeric <code class="literal">sigma</code> value that is nearly equal to an eigenvalue.</p><p>The matrix <code class="literal">A = delsq(numgrid('C',30))</code> is a symmetric positive definite matrix of size 632 with eigenvalues reasonably well-distributed in the interval (0 8), but with 18 eigenvalues repeated at 4.0. To calculate some eigenvalues near 4.0, it is reasonable to try the function call <code class="literal">eigs(A,20,4.0)</code>. However, this call computes the largest eigenvalues of the inverse of <code class="literal">A - 4.0*I</code>, where <code class="literal">I</code> is an identity matrix. Because 4.0 is an eigenvalue of <code class="literal">A</code>, this matrix is singular and therefore does not have an inverse. <code class="literal">eigs</code> fails and produces an error message. The numeric value of <code class="literal">sigma</code> cannot be exactly equal to an eigenvalue. Instead, you must use a value of <code class="literal">sigma</code> that is near but not equal to 4.0 to find those eigenvalues. </p><p>Compute all of the eigenvalues using <code class="literal">eig</code>, and the 20 eigenvalues closest to 4 - 1e-6 using <code class="literal">eigs</code> to compare results. Plot the eigenvalues calculated with each method.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>A = delsq(numgrid(<span style="color:#A020F0">'C'</span>,30)); 
sigma = 4 - 1e-6;
d = eig(A);
D = sort(eigs(A,20,sigma));</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>plot(d(307:326),<span style="color:#A020F0">'ks'</span>)
hold <span style="color:#A020F0">on</span>
plot(D,<span style="color:#A020F0">'k+'</span>)
hold <span style="color:#A020F0">off</span>
legend(<span style="color:#A020F0">'eig(A)'</span>,<span style="color:#A020F0">'eigs(A,20,sigma)'</span>) 
title(<span style="color:#A020F0">'18 Repeated Eigenvalues of A'</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e473184" class="mediaobject"><p><img src="../../examples/matlab/win64/RepeatedEigenvaluesOfSymmetricPositiveDefiniteSparseMatrExample_01.png" alt="Figure contains an axes object. The axes object with title 18 Repeated Eigenvalues of A contains 2 objects of type line. One or more of the lines displays its values using only markers These objects represent eig(A), eigs(A,20,sigma)." width="560"></p></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-RepeatedEigenvaluesOfSymmetricPositiveDefiniteSparseMatrExample"><meta itemprop="exampletitle" content="Sigma Value Near Eigenvalue"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_bu3ze9y"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu3ze9y" data-bs-target="#expand_accordion_body_bu3ze9y" aria-controls="expand_accordion_body_bu3ze9y" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="bu3ze9y">Eigenvalues of Permuted Cholesky Factor</h3></button></div><div role="tabpanel" id="expand_accordion_body_bu3ze9y" aria-labelledby="expand_accordion_heading_bu3ze9y" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/EigenvaluesOfPermutedCholeskyFactorExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Eigenvalues of Permuted Cholesky Factor",
          "description": "Create sparse random matrices A and B that both have low densities of nonzero elements.",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "eigs.html"

        },
          "identifier": "matlab.EigenvaluesOfPermutedCholeskyFactorExample",
          "name": "EigenvaluesOfPermutedCholeskyFactorExample",
          "url": "eigs.html#bu3ze9y"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/EigenvaluesOfPermutedCholeskyFactorExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "EigenvaluesOfPermutedCholeskyFactorExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Create sparse random matrices <code class="literal">A</code> and <code class="literal">B</code> that both have low densities of nonzero elements.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>B = sprandn(1e3,1e3,0.001) + speye(1e3); 
B = B'*B; 
A = sprandn(1e3,1e3,0.005); 
A = A+A';</pre></div></div></div><p>Find the Cholesky decomposition of matrix <code class="literal">B</code>, using three outputs to return the permutation vector <code class="literal">s</code> and test value <code class="literal">p</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[R,p,s] = chol(B,<span style="color:#A020F0">'vector'</span>);
p</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>p = 
0
</pre></div></div></div><p>Since <code class="literal">p</code> is zero, <code class="literal">B</code> is a symmetric positive definite matrix that satisfies <code class="literal">B(s,s) = R'*R</code>.</p><p>Calculate the six largest magnitude eigenvalues and eigenvectors of the generalized eigenvalue problem involving <code class="literal">A</code> and <code class="literal">R</code>. Since <code class="literal">R</code> is the Cholesky factor of <code class="literal">B</code>, specify <code class="literal">'IsCholesky'</code> as <code class="literal">true</code>. Furthermore, since <code class="literal">B(s,s) = R'*R</code> and thus <code class="literal">R = chol(B(s,s))</code>, use the permutation vector <code class="literal">s</code> as the value of <code class="literal">'CholeskyPermutation'</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[V,D,flag] = eigs(A,R,6,<span style="color:#A020F0">'largestabs'</span>,<span style="color:#A020F0">'IsCholesky'</span>,true,<span style="color:#A020F0">'CholeskyPermutation'</span>,s);
flag</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>flag = 
0
</pre></div></div></div><p>Since <code class="literal">flag</code> is zero, all of the eigenvalues converged. </p><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-EigenvaluesOfPermutedCholeskyFactorExample"><meta itemprop="exampletitle" content="Eigenvalues of Permuted Cholesky Factor"></div></div></div></div><div class="ref_sect"><h2 id="bu2_q3e-2">Input Arguments</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="bu2_q3e-2_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="bu2_q3e-A"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu2_q3e-A" data-bs-target="#expand_accordion_body_bu2_q3e-A" aria-controls="expand_accordion_body_bu2_q3e-A" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_A" class="anchor_target"></span><h3 id="bu2_q3e-A"><code itemprop="name">A</code> &#8212; <span itemprop="purpose">Input matrix</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">matrix</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_bu2_q3e-A" aria-labelledby="expand_accordion_heading_bu2_q3e-A" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_bu2_q3e-A"><p>Input matrix, specified as a square matrix. <code class="literal">A</code> is
typically, but not always, a large and sparse matrix.</p><p>If <code class="literal">A</code> is symmetric, then <code class="function">eigs</code> uses a specialized
                        algorithm for that case. If <code class="literal">A</code> is
                            <span class="emphasis"><em>nearly</em></span> symmetric, then consider using <code class="literal">A =
                            (A+A')/2</code> to make <code class="literal">A</code> symmetric before calling
                            <code class="function">eigs</code>. This ensures that <code class="function">eigs</code>
                        calculates real eigenvalues instead of complex ones.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code><br/>
<strong>Complex Number Support: </strong>Yes</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="bu2_q3e-B"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu2_q3e-B" data-bs-target="#expand_accordion_body_bu2_q3e-B" aria-controls="expand_accordion_body_bu2_q3e-B" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_B" class="anchor_target"></span><h3 id="bu2_q3e-B"><code itemprop="name">B</code> &#8212; <span itemprop="purpose">Input matrix</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">matrix</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_bu2_q3e-B" aria-labelledby="expand_accordion_heading_bu2_q3e-B" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_bu2_q3e-B"><p>Input matrix, specified as a square matrix of the same size as <code class="literal">A</code>. When
                            <code class="literal">B</code> is specified, <code class="literal">eigs</code> solves the
                        generalized eigenvalue problem <code class="literal">A*V = B*V*D</code>.</p><p>If <code class="literal">B</code> is symmetric positive definite, then <code class="function">eigs</code> uses a
                        specialized algorithm for that case. If <code class="literal">B</code> is
                            <span class="emphasis"><em>nearly</em></span> symmetric positive definite, then consider
                        using <code class="literal">B = (B+B')/2</code> to make <code class="literal">B</code> symmetric
                        before calling <code class="function">eigs</code>.</p><p>When <code class="literal">A</code> is scalar, you can specify <code class="literal">B</code>
                        as an empty matrix <code class="literal">eigs(A,[],k)</code> to solve the standard
                        eigenvalue problem and disambiguate between <code class="literal">B</code> and
                            <code class="literal">k</code>.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code><br/>
<strong>Complex Number Support: </strong>Yes</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="bu2_q3e-k"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu2_q3e-k" data-bs-target="#expand_accordion_body_bu2_q3e-k" aria-controls="expand_accordion_body_bu2_q3e-k" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_k" class="anchor_target"></span><h3 id="bu2_q3e-k"><code itemprop="name">k</code> &#8212; <span itemprop="purpose">Number of eigenvalues to compute</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">scalar</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_bu2_q3e-k" aria-labelledby="expand_accordion_heading_bu2_q3e-k" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_bu2_q3e-k"><p>Number of eigenvalues to compute, specified as a positive scalar integer. If
                            <code class="literal">k</code> is larger than <code class="literal">size(A,2)</code>, then
                            <code class="function">eigs</code> uses the maximum valid value <code class="literal">k =
                            size(A,2)</code> instead.</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">eigs(A,2)</code> returns the two largest
eigenvalues of <code class="literal">A</code>.</p></div></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="bu2_q3e-sigma"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu2_q3e-sigma" data-bs-target="#expand_accordion_body_bu2_q3e-sigma" aria-controls="expand_accordion_body_bu2_q3e-sigma" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_sigma" class="anchor_target"></span><h3 id="bu2_q3e-sigma"><code itemprop="name">sigma</code> &#8212; <span itemprop="purpose">Type of eigenvalues</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue defaultvalue"><code class="literal">'largestabs'</code></span> (default) | <span itemprop="inputvalue"><code class="literal">'smallestabs'</code></span> | <span itemprop="inputvalue"><code class="literal">'largestreal'</code></span> | <span itemprop="inputvalue"><code class="literal">'smallestreal'</code></span> | <span itemprop="inputvalue"><code class="literal">'bothendsreal'</code></span> | <span itemprop="inputvalue"><code class="literal">'largestimag'</code></span> | <span itemprop="inputvalue"><code class="literal">'smallestimag'</code></span> | <span itemprop="inputvalue"><code class="literal">'bothendsimag'</code></span> | <span itemprop="inputvalue">scalar</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_bu2_q3e-sigma" aria-labelledby="expand_accordion_heading_bu2_q3e-sigma" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_bu2_q3e-sigma"><p>Type of eigenvalues, specified as one of the values in the table. </p><div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="33%"><col class="tcol2" width="33%"><col class="tcol3" width="33%"></colgroup><thead><tr><th>
                                        <p>sigma</p>
                                    </th><th>
                                        <p>Description</p>
                                    </th><th>sigma (R2017a and earlier)</th></tr></thead><tbody><tr><td>
                                        <p>scalar (real or complex, including 0)</p>
                                    </td><td>
                                        <p>The eigenvalues closest to the number
                                                <code class="literal">sigma</code>. </p>
                                    </td><td>No change</td></tr><tr><td>
                                        <p><code class="literal">'largestabs'</code> (default)</p>
                                    </td><td>
                                        <p>Largest magnitude.</p>
                                    </td><td><code class="literal">'lm'</code>
                                    </td></tr><tr><td>
                                        <p><code class="literal">'smallestabs'</code></p>
                                    </td><td>
                                        <p>Smallest magnitude. Same as <code class="literal">sigma =
                                                0</code>.</p>
                                    </td><td><code class="literal">'sm'</code>
                                    </td></tr><tr><td>
                                        <p><code class="literal">'largestreal'</code></p>
                                    </td><td>
                                        <p>Largest real.</p>
                                    </td><td><code class="literal">'lr'</code>, <code class="literal">'la'</code></td></tr><tr><td>
                                        <p><code class="literal">'smallestreal'</code></p>
                                    </td><td>
                                        <p>Smallest real.</p>
                                    </td><td><code class="literal">'sr'</code>, <code class="literal">'sa'</code></td></tr><tr><td>
                                        <p><code class="literal">'bothendsreal'</code></p>
                                    </td><td>
                                        <p>Both ends, with <code class="literal">k/2</code> values with
                                            largest and smallest real part respectively (one more
                                            from high end if <code class="literal">k</code> is odd).</p>
                                    </td><td><code class="literal">'be'</code></td></tr></tbody></table></div><p>For <strong class="emphasis bold">nonsymmetric problems</strong>,
                            <code class="literal">sigma</code> also can be:</p><div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="33%"><col class="tcol2" width="33%"><col class="tcol3" width="33%"></colgroup><thead><tr><th>
                                        <p>sigma</p>
                                    </th><th>
                                        <p>Description</p>
                                    </th><th>sigma (R2017a and earlier)</th></tr></thead><tbody><tr><td>
                                        <p><code class="literal">'largestimag'</code></p>
                                    </td><td>
                                        <p>Largest imaginary part.</p>
                                    </td><td><code class="literal">'li'</code> if <code class="literal">A</code> is
                                        complex.</td></tr><tr><td>
                                        <p><code class="literal">'smallestimag'</code></p>
                                    </td><td>
                                        <p>Smallest imaginary part.</p>
                                    </td><td><code class="literal">'si'</code> if <code class="literal">A</code> is
                                        complex.</td></tr><tr><td>
                                        <p><code class="literal">'bothendsimag'</code></p>
                                    </td><td>
                                        <p>Both ends, with <code class="literal">k/2</code> values with
                                            largest and smallest imaginary part (one more from high
                                            end if <code class="literal">k</code> is odd).</p>
                                    </td><td><code class="literal">'li'</code> if <code class="literal">A</code> is
                                        real.</td></tr></tbody></table></div><p class="description_valueexample"><strong>Example: </strong><code class="literal">eigs(A,k,1)</code> returns the <code class="literal">k</code> eigenvalues
closest to 1.</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">eigs(A,k,'smallestabs')</code> returns the <code class="literal">k</code> smallest
                        magnitude eigenvalues.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code> | <code itemprop="datatype">char</code> | <code itemprop="datatype">string</code></p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="bu2_q3e-opts"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu2_q3e-opts" data-bs-target="#expand_accordion_body_bu2_q3e-opts" aria-controls="expand_accordion_body_bu2_q3e-opts" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_opts" class="anchor_target"></span><h3 id="bu2_q3e-opts"><code itemprop="name">opts</code> &#8212; <span itemprop="purpose">Options structure</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">structure</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_bu2_q3e-opts" aria-labelledby="expand_accordion_heading_bu2_q3e-opts" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_bu2_q3e-opts"><p>Options structure, specified as a structure containing one or more of the fields in this
                        table.</p><div class="alert alert-info d-inline-block"><span class="alert_icon icon-alert-info-reverse"></span><p class="alert_heading"><strong>Note</strong></p><p>Use of the options structure to specify options is not recommended.
                            Use name-value pairs instead.</p></div><div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="33%"><col class="tcol2" width="33%"><col class="tcol3" width="34%"></colgroup><thead><tr><th>Option Field</th><th>Description</th><th>Name-Value Pair</th></tr></thead><tbody><tr><td><code class="literal">issym</code></td><td><p>Symmetry of <code class="literal">Afun</code> matrix.</p></td><td><code class="literal">'IsFunctionSymmetric'</code></td></tr><tr><td><code class="literal">tol</code></td><td><p>Convergence tolerance.</p></td><td><code class="literal">'Tolerance'</code></td></tr><tr><td><code class="literal">maxit</code></td><td><p>Maximum number of iterations.</p></td><td><code class="literal">'MaxIterations'</code></td></tr><tr><td><code class="literal">p</code></td><td><p>Number of Lanczos basis vectors.</p></td><td><code class="literal">'SubspaceDimension'</code></td></tr><tr><td><code class="literal">v0</code></td><td><p>Starting vector.</p></td><td><code class="literal">'StartVector'</code></td></tr><tr><td><code class="literal">disp</code></td><td><p>Diagnostic information display level.</p></td><td><code class="literal">'Display'</code></td></tr><tr><td><code class="literal">fail</code></td><td>Treatment of nonconverged eigenvalues in the
                                        output.</td><td><code class="literal">'FailureTreatment'</code></td></tr><tr><td><code class="literal">spdB</code></td><td>Is <code class="literal">B</code> symmetric positive
                                        definite?</td><td><code class="literal">'IsSymmetricDefinite'</code></td></tr><tr><td><code class="literal">cholB</code></td><td><p>Is <code class="literal">B</code> the Cholesky factor <code class="literal">chol(B)</code>?</p></td><td><code class="literal">'IsCholesky'</code></td></tr><tr><td><code class="literal">permB</code></td><td><p>Specify the permutation vector <code class="literal">permB</code> if
sparse <code class="literal">B</code> is really <code class="literal">chol(B(permB,permB))</code>.</p></td><td><code class="literal">'CholeskyPermutation'</code></td></tr></tbody></table></div><p class="description_valueexample"><strong>Example: </strong><code class="literal">opts.issym = 1, opts.tol = 1e-10</code> creates
a structure with values set for the fields <code class="literal">issym</code> and <code class="literal">tol</code>.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">struct</code></p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="bu2_q3e-Afun"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu2_q3e-Afun" data-bs-target="#expand_accordion_body_bu2_q3e-Afun" aria-controls="expand_accordion_body_bu2_q3e-Afun" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_Afun" class="anchor_target"></span><h3 id="bu2_q3e-Afun"><code itemprop="name">Afun</code> &#8212; <span itemprop="purpose">Matrix function</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">function handle</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_bu2_q3e-Afun" aria-labelledby="expand_accordion_heading_bu2_q3e-Afun" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_bu2_q3e-Afun"><p>Matrix function, specified as a function handle. The function <code class="literal">y = Afun(x)</code>
                        must return the proper value depending on the <code class="literal">sigma</code> input:</p>
<div class="itemizedlist"><ul><li><p><code class="literal">A*x</code> &#8212; If <code class="literal">sigma</code> is
                                    unspecified or any text option other than
                                        <code class="literal">'smallestabs'</code>.</p></li><li><p><code class="literal">A\x</code> &#8212; If <code class="literal">sigma</code> is
                                        <code class="literal">0</code> or
                                    <code class="literal">'smallestabs'</code>.</p></li><li><p><code class="literal">(A-sigma*I)\x</code> &#8212; If
                                        <code class="literal">sigma</code> is a nonzero scalar (for standard
                                    eigenvalue problem).</p></li><li><p><code class="literal">(A-sigma*B)\x</code> &#8212; If
                                        <code class="literal">sigma</code> is a nonzero scalar (for
                                    generalized eigenvalue problem).</p></li></ul></div><p>
</p><p>For example, the following <code class="literal">Afun</code> works when calling <code class="literal">eigs</code>
                        with <code class="literal">sigma = 'smallestabs'</code>:</p><div class="code_responsive"><pre class="programlisting">[L,U,p] = lu(A,'vector');
Afun = @(x) U\(L\(x(p)));
d = eigs(Afun,100,6,'smallestabs')</pre></div><p>For a generalized eigenvalue problem, add matrix <code class="literal">B</code> as
follows (<code class="literal">B</code> cannot be represented by a function
handle):</p><div class="code_responsive"><pre class="programlisting">d = eigs(Afun,100,B,6,'smallestabs')</pre></div><p><code class="literal">A</code> is assumed to be nonsymmetric unless
                            <code class="literal">'IsFunctionSymmetric'</code> (or
                            <code class="literal">opts.issym</code>) specifies otherwise. Setting
                            <code class="literal">'IsFunctionSymmetric'</code> to <code class="literal">true</code>
                        ensures that <code class="function">eigs</code> calculates real eigenvalues instead
                        of complex ones.</p><p>For information on how to provide additional parameters to the
                            <code class="literal">Afun</code> function, see <a href="../math/parameterizing-functions.html" class="a">Parameterizing Functions</a>.</p><div class="alert alert-info d-inline-block"><span class="alert_icon icon-alert-info-reverse"></span><p class="alert_heading"><strong>Tip</strong></p><p>Call <code class="function">eigs</code> with the <code class="literal">'Display'</code>
                            option turned on to see what output is expected from
                                <code class="literal">Afun</code>.</p></div></div></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="bu2_q3e-n"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu2_q3e-n" data-bs-target="#expand_accordion_body_bu2_q3e-n" aria-controls="expand_accordion_body_bu2_q3e-n" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_n" class="anchor_target"></span><h3 id="bu2_q3e-n"><code itemprop="name">n</code> &#8212; <span itemprop="purpose">Size of square matrix represented by <code class="literal">Afun</code></span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">scalar</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_bu2_q3e-n" aria-labelledby="expand_accordion_heading_bu2_q3e-n" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_bu2_q3e-n"><p>Size of square matrix <code class="literal">A</code> that is represented by
                            <code class="literal">Afun</code>, specified as a positive scalar integer.</p></div></div></div></div></div></div></div></div></div></div></div><div class="ref_sect"><span id="namevaluepairarguments" class="anchor_target"></span><h2 id="namevaluepairs">Name-Value Arguments</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="false">expand all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="d126e472029_accordion-group" role="tablist" aria-multiselectable="true"><div class="namevaluecontainer"><p class="neqvpair_boilerplate">Specify optional pairs of arguments as
      <code class="argument">Name1=Value1,...,NameN=ValueN</code>, where <code class="literal">Name</code> is
      the argument name and <code class="literal">Value</code> is the corresponding value.
      Name-value arguments must appear after other arguments, but the order of the
      pairs does not matter.
    </p><p class="nvpaircompat_boilerplate"><span class="emphasis"><em>
      Before R2021a, use commas to separate each name and value, and enclose</em></span> 
      <code class="literal">Name</code> <span class="emphasis"><em>in quotes.</em></span>
    </p><p><span class="example_desc"><strong>Example: </strong><code class="literal">d =
                    eigs(A,k,sigma,'Tolerance',1e-10,'MaxIterations',100)</code> loosens the
                convergence tolerance and uses fewer iterations.</span></p></div><div class="ref_sect"><h3 class="mw-doc-parametersgrp" id="d126e472051">General Options</h3><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="false">expand all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="d126e472051_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NameValuePairInputArgument" itemid="d126e472055"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_d126e472055" data-bs-target="#expand_accordion_body_d126e472055" aria-controls="expand_accordion_body_d126e472055" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="inputarg_Tolerance" class="anchor_target"></span><h3 id="d126e472055"><code itemprop="name">Tolerance</code> &#8212; <span itemprop="purpose">Convergence tolerance</span><br/>
<span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue defaultvalue"><code class="literal">1e-14</code></span> (default) | <span itemprop="inputvalue">positive real scalar</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_d126e472055" aria-labelledby="expand_accordion_heading_d126e472055" class="accordion-collapse collapse"><div class="accordion-body"><div class="cshsummary" id="csh_bu2_q3e-2"><p>Convergence tolerance, specified as the comma-separated pair
                            consisting of <code class="literal">'Tolerance'</code> and a positive real numeric
                            scalar.</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">s =
                            eigs(A,k,sigma,'Tolerance',1e-3)</code></p></div></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NameValuePairInputArgument" itemid="d126e472081"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_d126e472081" data-bs-target="#expand_accordion_body_d126e472081" aria-controls="expand_accordion_body_d126e472081" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="inputarg_MaxIterations" class="anchor_target"></span><h3 id="d126e472081"><code itemprop="name">MaxIterations</code> &#8212; <span itemprop="purpose">Maximum number of algorithm iterations</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue defaultvalue"><code class="literal">300</code></span> (default) | <span itemprop="inputvalue">positive integer</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_d126e472081" aria-labelledby="expand_accordion_heading_d126e472081" class="accordion-collapse collapse"><div class="accordion-body"><div class="cshsummary" id="csh_bu2_q3e-2"><p>Maximum number of algorithm iterations, specified as the
                            comma-separated pair consisting of <code class="literal">'MaxIterations'</code>
                            and a positive integer.</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">d =
                            eigs(A,k,sigma,'MaxIterations',350)</code></p></div></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NameValuePairInputArgument" itemid="d126e472107"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_d126e472107" data-bs-target="#expand_accordion_body_d126e472107" aria-controls="expand_accordion_body_d126e472107" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="inputarg_SubspaceDimension" class="anchor_target"></span><h3 id="d126e472107"><code itemprop="name">SubspaceDimension</code> &#8212; <span itemprop="purpose">Maximum size of Krylov subspace</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue defaultvalue"><code class="literal">max(2*k,20)</code></span> (default) | <span itemprop="inputvalue">nonnegative integer</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_d126e472107" aria-labelledby="expand_accordion_heading_d126e472107" class="accordion-collapse collapse"><div class="accordion-body"><div class="cshsummary" id="csh_bu2_q3e-2"><p>Maximum size of Krylov subspace, specified as the comma-separated pair
                            consisting of <code class="literal">'SubspaceDimension'</code> and a nonnegative
                            integer. The <code class="literal">'SubspaceDimension'</code> value must be
                            greater than or equal to <code class="literal">k + 1</code> for real symmetric
                            problems, and <code class="literal">k + 2</code> otherwise, where
                                <code class="literal">k</code> is the number of eigenvalues.</p><p>The recommended value is <code class="literal">p &gt;= 2*k</code>, or for real
                            nonsymmetric problems, <code class="literal">p &gt;= 2*k+1</code>. If you do not
                            specify a <code class="literal">'SubspaceDimension'</code> value, then the default
                            algorithm uses at least <code class="literal">20</code> Lanczos vectors.</p><p>For problems where <code class="function">eigs</code> fails to converge,
                            increasing the value of <code class="literal">'SubspaceDimension'</code> can
                            improve the convergence behavior. However, increasing the value too much
                            can cause memory issues.</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">d =
                            eigs(A,k,sigma,'SubspaceDimension',25)</code></p></div></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NameValuePairInputArgument" itemid="d126e472159"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_d126e472159" data-bs-target="#expand_accordion_body_d126e472159" aria-controls="expand_accordion_body_d126e472159" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="inputarg_StartVector" class="anchor_target"></span><h3 id="d126e472159"><code itemprop="name">StartVector</code> &#8212; <span itemprop="purpose">Initial starting vector</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue defaultvalue">random vector</span> (default) | <span itemprop="inputvalue">vector</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_d126e472159" aria-labelledby="expand_accordion_heading_d126e472159" class="accordion-collapse collapse"><div class="accordion-body"><div class="cshsummary" id="csh_bu2_q3e-2"><p>Initial starting vector, specified as the comma-separated pair
                            consisting of <code class="literal">'StartVector'</code> and a numeric
                            vector.</p><p>The primary reason to specify a different random starting vector is
                            when you want to control the random number stream used to generate the
                            vector.</p><div class="alert alert-info d-inline-block"><span class="alert_icon icon-alert-info-reverse"></span><p class="alert_heading"><strong>Note</strong></p><p><code class="function">eigs</code> selects the starting vectors in a
                                reproducible manner using a private random number stream. Changing
                                the random number seed does <span class="emphasis"><em>not</em></span> affect the
                                starting vector.</p></div><p class="description_valueexample"><strong>Example: </strong><code class="literal">d =
                                eigs(A,k,sigma,'StartVector',randn(m,1))</code> uses a random
                            starting vector that draws values from the global random number
                            stream.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code></p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NameValuePairInputArgument" itemid="d126e472203"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_d126e472203" data-bs-target="#expand_accordion_body_d126e472203" aria-controls="expand_accordion_body_d126e472203" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="inputarg_FailureTreatment" class="anchor_target"></span><h3 id="d126e472203"><code itemprop="name">FailureTreatment</code> &#8212; <span itemprop="purpose">Treatment of nonconverged eigenvalues</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue defaultvalue"><code class="literal">'replacenan'</code></span> (default) | <span itemprop="inputvalue"><code class="literal">'keep'</code></span> | <span itemprop="inputvalue"><code class="literal">'drop'</code></span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_d126e472203" aria-labelledby="expand_accordion_heading_d126e472203" class="accordion-collapse collapse"><div class="accordion-body"><div class="cshsummary" id="csh_bu2_q3e-2"><p>Treatment of nonconverged eigenvalues, specified as the
                            comma-separated pair consisting of <code class="literal">'FailureTreatment'</code>
                            and one of the options: <code class="literal">'replacenan'</code>,
                                <code class="literal">'keep'</code>, or <code class="literal">'drop'</code>.</p><p>The value of <code class="literal">'FailureTreatment'</code> determines how
                                <code class="function">eigs</code> displays nonconverged eigenvalues in the
                            output.</p><div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="50%"><col class="tcol2" width="50%"></colgroup><thead><tr><th>
                                            <p>Option</p>
                                        </th><th>
                                            <p>Affect on output</p>
                                        </th></tr></thead><tbody><tr><td>
                                            <p><code class="literal">'replacenan'</code></p>
                                        </td><td>
                                            <p>Replace nonconverged eigenvalues with
                                                  <code class="literal">NaN</code> values.</p>
                                        </td></tr><tr><td>
                                            <p><code class="literal">'keep'</code></p>
                                        </td><td>
                                            <p>Include nonconverged eigenvalues in the
                                                output.</p>
                                        </td></tr><tr><td>
                                            <p><code class="literal">'drop'</code></p>
                                        </td><td>
                                            <p>Remove nonconverged eigenvalues from the output.
                                                This option can result in <code class="function">eigs</code>
                                                returning fewer eigenvalues than requested.</p>
                                        </td></tr></tbody></table></div><p class="description_valueexample"><strong>Example: </strong><code class="literal">d =
                                eigs(A,k,sigma,'FailureTreatment','drop')</code> removes
                            nonconverged eigenvalues from the output.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">char</code> | <code itemprop="datatype">string</code></p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NameValuePairInputArgument" itemid="d126e472306"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_d126e472306" data-bs-target="#expand_accordion_body_d126e472306" aria-controls="expand_accordion_body_d126e472306" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="inputarg_Display" class="anchor_target"></span><h3 id="d126e472306"><code itemprop="name">Display</code> &#8212; <span itemprop="purpose">Toggle for diagnostic information display</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue defaultvalue"><code class="literal">false</code> or
                            <code class="literal">0</code></span> (default) | <span itemprop="inputvalue"><code class="literal">true</code> or <code class="literal">1</code></span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_d126e472306" aria-labelledby="expand_accordion_heading_d126e472306" class="accordion-collapse collapse"><div class="accordion-body"><div class="cshsummary" id="csh_bu2_q3e-2"><p>Toggle for diagnostic information display, specified as the
                            comma-separated pair consisting of <code class="literal">'Display'</code> and a
                            numeric or logical <code class="literal">1</code> (<code class="literal">true</code>) or
                                <code class="literal">0</code> (<code class="literal">false</code>). Specify a value of
                                <code class="literal">true</code> or <code class="literal">1</code> to turn on the
                            display of diagnostic information during the calculation.</p></div></div></div></div></div></div></div></div></div></div></div><div class="ref_sect"><h3 class="mw-doc-parametersgrp" id="d126e472347">Options for <code class="literal">Afun</code></h3><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="false">expand all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="d126e472347_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NameValuePairInputArgument" itemid="d126e472353"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_d126e472353" data-bs-target="#expand_accordion_body_d126e472353" aria-controls="expand_accordion_body_d126e472353" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="inputarg_IsFunctionSymmetric" class="anchor_target"></span><h3 id="d126e472353"><code itemprop="name">IsFunctionSymmetric</code> &#8212; <span itemprop="purpose">Symmetry of <code class="literal">Afun</code> matrix</span><br/>
<span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue"><code class="literal">true</code> or <code class="literal">1</code></span> | <span itemprop="inputvalue"><code class="literal">false</code> or <code class="literal">0</code></span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_d126e472353" aria-labelledby="expand_accordion_heading_d126e472353" class="accordion-collapse collapse"><div class="accordion-body"><div class="cshsummary" id="csh_bu2_q3e-2"><p>Symmetry of <code class="literal">Afun</code> matrix, specified as the
                            comma-separated pair consisting of
                                <code class="literal">'IsFunctionSymmetric'</code> and a numeric or logical
                                <code class="literal">1</code> (<code class="literal">true</code>) or
                                <code class="literal">0</code> (<code class="literal">false</code>).</p><p>This option specifies whether the matrix that <code class="literal">Afun</code>
                            applies to its input vector is symmetric. Specify a value of
                                <code class="literal">true</code> or <code class="literal">1</code> to indicate that
                                <code class="function">eigs</code> should use a specialized algorithm for the
                            symmetric matrix and return real eigenvalues.</p></div></div></div></div></div></div></div></div></div></div></div><div class="ref_sect"><h3 class="mw-doc-parametersgrp" id="d126e472406">Options for generalized eigenvalue problem <code class="literal">A*V =                     B*V*D</code></h3><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="false">expand all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="d126e472406_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NameValuePairInputArgument" itemid="d126e472412"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_d126e472412" data-bs-target="#expand_accordion_body_d126e472412" aria-controls="expand_accordion_body_d126e472412" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="inputarg_IsCholesky" class="anchor_target"></span><h3 id="d126e472412"><code itemprop="name">IsCholesky</code> &#8212; <span itemprop="purpose">Cholesky decomposition toggle for <code class="literal">B</code></span><br/>
<span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue"><code class="literal">true</code> or <code class="literal">1</code></span> | <span itemprop="inputvalue"><code class="literal">false</code> or <code class="literal">0</code></span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_d126e472412" aria-labelledby="expand_accordion_heading_d126e472412" class="accordion-collapse collapse"><div class="accordion-body"><div class="cshsummary" id="csh_bu2_q3e-2"><p>Cholesky decomposition toggle for <code class="literal">B</code>, specified as
                            the comma-separated pair consisting of <code class="literal">'IsCholesky'</code>
                            and a numeric or logical <code class="literal">1</code> (<code class="literal">true</code>)
                            or <code class="literal">0</code> (<code class="literal">false</code>).</p><p>This option specifies whether the input for matrix
                                <code class="literal">B</code> in the call <code class="literal">eigs(A,B,___)</code> is
                            actually the Cholesky factor <code class="literal">R</code> produced by <code class="literal">R
                                = chol(B)</code>.</p><div class="alert alert-info d-inline-block"><span class="alert_icon icon-alert-info-reverse"></span><p class="alert_heading"><strong>Note</strong></p><p>Do not use this option if <code class="literal">sigma</code> is
                                    <code class="literal">'smallestabs'</code> or a numeric scalar.</p></div></div></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NameValuePairInputArgument" itemid="d126e472472"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_d126e472472" data-bs-target="#expand_accordion_body_d126e472472" aria-controls="expand_accordion_body_d126e472472" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="inputarg_CholeskyPermutation" class="anchor_target"></span><h3 id="d126e472472"><code itemprop="name">CholeskyPermutation</code> &#8212; <span itemprop="purpose">Cholesky permutation vector</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue defaultvalue"><code class="literal">1:n</code></span> (default) | <span itemprop="inputvalue">vector</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_d126e472472" aria-labelledby="expand_accordion_heading_d126e472472" class="accordion-collapse collapse"><div class="accordion-body"><div class="cshsummary" id="csh_bu2_q3e-2"><p>Cholesky permutation vector, specified as the comma-separated pair
                            consisting of <code class="literal">'CholeskyPermutation'</code> and a numeric
                            vector. Specify the permutation vector <code class="literal">permB</code> if
                            sparse matrix <code class="literal">B</code> is reordered before factorization
                            according to <code class="literal">chol(B(permB,permB))</code>.</p><p>You also can use the three-output syntax of <code class="function">chol</code>
                            for sparse matrices to directly obtain <code class="literal">permB</code> with
                                <code class="literal">[R,p,permB] = chol(B,'vector')</code>.</p><div class="alert alert-info d-inline-block"><span class="alert_icon icon-alert-info-reverse"></span><p class="alert_heading"><strong>Note</strong></p><p>Do not use this option if <code class="literal">sigma</code> is
                                    <code class="literal">'smallestabs'</code> or a numeric scalar.</p></div></div></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NameValuePairInputArgument" itemid="d126e472518"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_d126e472518" data-bs-target="#expand_accordion_body_d126e472518" aria-controls="expand_accordion_body_d126e472518" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="inputarg_IsSymmetricDefinite" class="anchor_target"></span><h3 id="d126e472518"><code itemprop="name">IsSymmetricDefinite</code> &#8212; <span itemprop="purpose">Symmetric-positive-definiteness toggle for                         <code class="literal">B</code></span><br/>
<span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue"><code class="literal">true</code> or <code class="literal">1</code></span> | <span itemprop="inputvalue"><code class="literal">false</code> or <code class="literal">0</code></span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_d126e472518" aria-labelledby="expand_accordion_heading_d126e472518" class="accordion-collapse collapse"><div class="accordion-body"><div class="cshsummary" id="csh_bu2_q3e-2"><p>Symmetric-positive-definiteness toggle for <code class="literal">B</code>,
                            specified as the comma-separated pair consisting of
                                <code class="literal">'IsSymmetricDefinite'</code> and a numeric or logical
                                <code class="literal">1</code> (<code class="literal">true</code>) or
                                <code class="literal">0</code> (<code class="literal">false</code>). Specify
                                <code class="literal">true</code> or <code class="literal">1</code> when you know that
                                <code class="literal">B</code> is symmetric positive definite, that is, it is
                            a symmetric matrix with strictly positive eigenvalues.</p><p>If <code class="literal">B</code> is symmetric positive semi-definite (some
                            eigenvalues are zero), then specifying
                                <code class="literal">'IsSymmetricDefinite'</code> as <code class="literal">true</code>
                            or <code class="literal">1</code> forces <code class="function">eigs</code> to use the same
                            specialized algorithm that it uses when <code class="literal">B</code> is
                            symmetric positive definite.</p><div class="alert alert-info d-inline-block"><span class="alert_icon icon-alert-info-reverse"></span><p class="alert_heading"><strong>Note</strong></p><p>To use this option, the value of <code class="literal">sigma</code> must be
                                numeric or <code class="literal">'smallestabs'</code>.</p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="bu2_q3e-3">Output Arguments</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="bu2_q3e-3_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu2_q3e-d" data-bs-target="#expand_accordion_body_bu2_q3e-d" aria-controls="expand_accordion_body_bu2_q3e-d" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_d" class="anchor_target"></span><h3 id="bu2_q3e-d"><code class="name">d</code> &#8212; Eigenvalues<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">column vector</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_bu2_q3e-d" aria-labelledby="expand_accordion_heading_bu2_q3e-d" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_bu2_q3e-d"><p>Eigenvalues, returned as a column vector. <code class="literal">d</code> is sorted differently depending
                        on the value of <code class="literal">sigma</code>.</p><div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="50%"><col class="tcol2" width="50%"></colgroup><thead><tr><th>
                                        <p>Value of <code class="literal">sigma</code></p>
                                    </th><th>
                                        <p>Output sorting</p>
                                    </th></tr></thead><tbody><tr><td>
                                        <p><code class="literal">'largestabs'</code></p>
                                    </td><td>
                                        <p>Descending order by magnitude</p>
                                    </td></tr><tr><td>
                                        <p><code class="literal">'largestreal'</code></p>
                                    </td><td>
                                        <p>Descending order by real part</p>
                                    </td></tr><tr><td>
                                        <p><code class="literal">'largestimag'</code></p>
                                    </td><td>
                                        <p>Descending order by imaginary part</p>
                                    </td></tr><tr><td>
                                        <p><code class="literal">'smallestabs'</code></p>
                                    </td><td>
                                        <p>Ascending order by magnitude</p>
                                    </td></tr><tr><td>
                                        <p><code class="literal">'smallestreal'</code></p>
                                        <p><code class="literal">'bothendsreal'</code></p>
                                    </td><td>
                                        <p>Ascending order by real part</p>
                                    </td></tr><tr><td>
                                        <p><code class="literal">'smallestimag'</code></p>
                                    </td><td>
                                        <p>Ascending order by imaginary part</p>
                                    </td></tr><tr><td>
                                        <p><code class="literal">'bothendsimag'</code></p>
                                    </td><td>
                                        <p>Descending order by absolute value of imaginary
                                            part</p>
                                    </td></tr></tbody></table></div></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu2_q3e-V" data-bs-target="#expand_accordion_body_bu2_q3e-V" aria-controls="expand_accordion_body_bu2_q3e-V" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_V" class="anchor_target"></span><h3 id="bu2_q3e-V"><code class="name">V</code> &#8212; Eigenvectors<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">matrix</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_bu2_q3e-V" aria-labelledby="expand_accordion_heading_bu2_q3e-V" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_bu2_q3e-V"><p>Eigenvectors, returned as a matrix. The columns in <code class="literal">V</code> correspond to the
                        eigenvalues along the diagonal of <code class="literal">D</code>. The form and
                        normalization of <code class="literal">V</code> depends on the combination of input
                        arguments:</p><div class="itemizedlist"><ul><li><p><code class="literal">[V,D] = eigs(A)</code> returns matrix
                                    <code class="literal">V</code>, whose columns are the right eigenvectors
                                of <code class="literal">A</code> such that <code class="literal">A*V = V*D</code>. The
                                eigenvectors in <code class="literal">V</code> are normalized so that the
                                2-norm of each is 1.</p><p>If <code class="literal">A</code> is symmetric, then the eigenvectors,
                                    <code class="literal">V</code>, are orthonormal.</p></li><li><p><code class="literal">[V,D] = eigs(A,B)</code> returns <code class="literal">V</code>
                                as a matrix whose columns are the generalized right eigenvectors
                                that satisfy <code class="literal">A*V = B*V*D</code>. The 2-norm of each
                                eigenvector is not necessarily 1.</p><p>If <code class="literal">B</code> is symmetric positive definite, then the
                                eigenvectors in <code class="literal">V</code> are normalized so that the
                                    <code class="literal">B</code>-norm of each is 1. If <code class="literal">A</code>
                                is also symmetric, then the eigenvectors are
                                <code class="literal">B</code>-orthonormal.</p></li></ul></div><p>Different machines, releases of MATLAB<sup>&#x00AE;</sup>, or parameters (such as the starting vector and subspace
                        dimension) can produce different eigenvectors that are still numerically accurate:</p>
<div class="itemizedlist"><ul><li><p>For real eigenvectors, the sign of the eigenvectors can
                                    change.</p></li><li><p>For complex eigenvectors, the eigenvectors can be multiplied
                                    by any complex number of magnitude 1.</p></li><li><p>For a multiple eigenvalue, its eigenvectors can be recombined
                                    through linear combinations. For example, if <span class="inlineequation"><em class="varname">A</em><em class="varname">x</em> =
                                                <em class="varname">λ</em><em class="varname">x</em></span> and <span class="inlineequation"><em class="varname">A</em><em class="varname">y</em> =
                                                <em class="varname">λ</em><em class="varname">y</em></span>, then <span class="inlineequation"><em class="varname">A</em>(<em class="varname">x</em>+<em class="varname">y</em>)
                                            =
                                                <em class="varname">λ</em>(<em class="varname">x</em>+<em class="varname">y</em>)</span>, so <span class="inlineequation"><em class="varname">x</em>+<em class="varname">y</em></span> also is an eigenvector of
                                    <em class="varname">A</em>.</p></li></ul></div><p>
</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu2_q3e-D" data-bs-target="#expand_accordion_body_bu2_q3e-D" aria-controls="expand_accordion_body_bu2_q3e-D" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_D" class="anchor_target"></span><h3 id="bu2_q3e-D"><code class="name">D</code> &#8212; Eigenvalue matrix<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">matrix</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_bu2_q3e-D" aria-labelledby="expand_accordion_heading_bu2_q3e-D" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_bu2_q3e-D"><p>Eigenvalue matrix, returned as a diagonal matrix with the eigenvalues
on the main diagonal.</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu2_q3e-flag" data-bs-target="#expand_accordion_body_bu2_q3e-flag" aria-controls="expand_accordion_body_bu2_q3e-flag" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_flag" class="anchor_target"></span><h3 id="bu2_q3e-flag"><code class="name">flag</code> &#8212; Convergence flag<br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><code class="literal">0</code> | <code class="literal">1</code></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_bu2_q3e-flag" aria-labelledby="expand_accordion_heading_bu2_q3e-flag" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_bu2_q3e-flag"><p>Convergence flag, returned as <code class="literal">0</code> or <code class="literal">1</code>. A value of
                            <code class="literal">0</code> indicates that all the eigenvalues converged.
                        Otherwise, not all of the eigenvalues converged.</p><p>Use of this convergence flag output suppresses warnings about failed
                        convergence.</p></div></div></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="bu2_xjs-5">Tips</h2><div class="itemizedlist"><ul><li><p><code class="function">eigs</code> generates the default starting vector using a private random number
                    stream to ensure reproducibility across runs. Setting the random number
                    generator state using <a href="rng.html"><code class="function">rng</code></a> before calling
                        <code class="function">eigs</code> does not affect the output.</p></li><li><p>Using <code class="literal">eigs</code> is not the most efficient way to find a few eigenvalues of
                    small, dense matrices. For such problems, it might be quicker to use
                        <code class="literal">eig(full(A))</code>. For example, finding three eigenvalues in a
                    500-by-500 matrix is a relatively small problem that is easily handled with
                        <code class="literal">eig</code>.</p></li><li><p>If <code class="function">eigs</code> fails to converge for a given matrix, increase the number of
                    Lanczos basis vectors by increasing the value of
                        <code class="literal">'SubspaceDimension'</code>. As secondary options, adjusting the
                    maximum number of iterations, <code class="literal">'MaxIterations'</code>, and the
                    convergence tolerance, <code class="literal">'Tolerance'</code>, also can help with
                    convergence behavior.</p></li></ul></div></div><div class="bibliography"><h2 id="References">References</h2><div id="mw_f5c36b50-e42e-437f-9ae0-1630fa7efb7e" class="bibliomixed"><p>[1] Stewart, G.W. "A Krylov-Schur
            Algorithm for Large Eigenproblems." <em class="citetitle">SIAM Journal of Matrix Analysis and
                Applications</em>. Vol. 23, Issue 3, 2001, pp. 601&#8211;614.</p></div><div id="d126e473433" class="bibliomixed"><p>[2] Lehoucq, R.B., D.C. Sorenson, and C. Yang. <em class="citetitle">ARPACK Users'
                Guide</em>. Philadelphia, PA: SIAM, 1998.</p></div></div><div class="ref_sect"><h2 id="refsect-extended-capabilities">Extended Capabilities</h2><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink">expand all</a></p><div id="accordion_refsect-extended-capabilities" role="tablist" aria-multiselectable="true"><span id="mw_3a602fd6-99a6-4f2d-a3f1-261c774a6aa1" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="bu2_q3e" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_bu2_q3e_threadsupport" aria-controls="expand_body_bu2_q3e_threadsupport" class="accordion-button collapsed" aria-expanded="false"><h3 id="bu2_q3e_threadsupport">Thread-Based Environment<br/> <span class=" remove_bold add_font_color_general">Run code in the background using MATLAB&#174; <code class="function">backgroundPool</code> or accelerate code with Parallel Computing Toolbox&#8482; <code class="function">ThreadPool</code>.</span></h3></button></div><div id="expand_body_bu2_q3e_threadsupport" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>This function fully supports thread-based environments. For
                more information, see <a href="../matlab_prog/run-functions-on-threads.html" class="a">Run MATLAB Functions in Thread-Based Environment</a>.</p></div></div></div></div></div><span id="mw_0c034a35-357b-4150-8d0d-4f38745243bd" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="bu2_q3e" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_bu2_q3e_distributedarrays" aria-controls="expand_body_bu2_q3e_distributedarrays" class="accordion-button collapsed" aria-expanded="false"><h3 id="bu2_q3e_distributedarrays">Distributed Arrays<br/> <span class=" remove_bold add_font_color_general">Partition large arrays across the combined memory of your cluster using Parallel Computing Toolbox&#8482;.</span></h3></button></div><div id="expand_body_bu2_q3e_distributedarrays" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>Usage notes and limitations:</p><div class="itemizedlist"><ul><li><p>Input matrices <code class="literal">A</code> and <code class="literal">B</code> must be of
                        type <code class="literal">double</code>.</p></li></ul></div><p>For more information, see <a href="../../parallel-computing/run-matlab-functions-with-distributed-arrays.html" class="a">Run MATLAB Functions with Distributed Arrays</a><span role="cross_prod"> (Parallel Computing Toolbox)</span>.</p></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="mw_53a91f0d-10fc-4417-875c-53ea9f7b5596">Version History</h2><strong>Introduced before R2006a</strong><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink">expand all</a></p><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_mw_905721a0-7559-45b7-8284-648587509db5" aria-controls="expand_body_mw_905721a0-7559-45b7-8284-648587509db5" class="accordion-button collapsed" aria-expanded="false"><h3 id="mw_905721a0-7559-45b7-8284-648587509db5">R2025a: <span class="remove_bold">Specify single-precision input arguments</span></h3></button></div><div id="expand_body_mw_905721a0-7559-45b7-8284-648587509db5" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>You can specify these arguments as single precision:</p>
<div class="itemizedlist"><ul><li><p><code class="argument">A</code>, <code class="argument">B</code> &#8212; Input matrices</p></li><li><p><code class="argument">sigma</code> &#8212; Type of eigenvalues</p></li><li><p><code class="argument">StartVector</code> &#8212; Initial starting vector</p></li></ul></div><p>
</p><p>If you specify <code class="argument">A</code>, <code class="argument">B</code>, or
                    <code class="argument">StartVector</code> as single precision, the function computes in
                single precision and returns outputs of type <code class="class">single</code>.</p><p>If you specify only the matrix function <code class="argument">Afun</code> and the matrix
                size <code class="argument">n</code> as inputs, the outputs of <code class="function">eigs</code> are
                of the same precision as the output of <code class="argument">Afun</code>. If you also
                specify either <code class="argument">B</code> or <code class="argument">StartVector</code> as
                    <code class="class">single</code>, then the output of <code class="argument">Afun</code> must also be
                    <code class="class">single</code>.</p></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_mw_ca37536b-4789-49e9-a5e4-5df54eb95c1c" aria-controls="expand_body_mw_ca37536b-4789-49e9-a5e4-5df54eb95c1c" class="accordion-button collapsed" aria-expanded="false"><h3 id="mw_ca37536b-4789-49e9-a5e4-5df54eb95c1c">R2017b: <span class="remove_bold">Behavior and algorithm change</span><span class="icon-alert-warning icon_alert_color"></span></h3></button></div><div id="expand_body_mw_ca37536b-4789-49e9-a5e4-5df54eb95c1c" class="accordion-collapse collapsed collapse"><div class="accordion-body"><div class="itemizedlist"><ul><li><p><strong class="emphasis bold">Changes to sorting order of output</strong></p><p><code class="function">eigs</code> now sorts the output according to the value of
                            <code class="literal">sigma</code>. For example, the command
                            <code class="literal">eigs(A,k,'largestabs')</code> produces <code class="literal">k</code>
                        eigenvalues sorted in descending order by magnitude.</p><p>Previously, the sorting order of the output produced by
                            <code class="function">eigs</code> was not guaranteed.</p></li><li><p><strong class="emphasis bold">Reproducibility</strong></p><p>Calling <code class="function">eigs</code> multiple times in succession now
                        produces the same result. Set <code class="literal">'StartVector'</code> to a random
                        vector to change this behavior.</p></li><li><p><strong class="emphasis bold">Display</strong></p><p>A display value of <code class="literal">2</code> no longer returns timing
                        information. Instead, <code class="function">eigs</code> treats a value of
                            <code class="literal">2</code> the same as a value of <code class="literal">1</code>. Also,
                        the messages shown by the <code class="literal">'Display'</code> option have changed.
                        The new messages show the residual in each iteration, instead of the Ritz
                        values.</p></li></ul></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="bu2_q3e_seealso">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="eig.html"><span itemprop="name"><code class="function">eig</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="svds.html"><span itemprop="name"><code class="function">svds</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="cdf2rdf.html"><span itemprop="name"><code class="function">cdf2rdf</code></span></a></span></p></div>
    </div></div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

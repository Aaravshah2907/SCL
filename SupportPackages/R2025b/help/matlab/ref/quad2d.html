<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>quad2d</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../numerical-integration-and-differential-equations.html",
          "name": "Numerical Integration and Differential Equations"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../numerical-integration-and-differentiation.html",
          "name": "Numerical Integration and Differentiation"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "numerical-integration-and-differentiation"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExtendedCapabilities",

        "itemListElement":
        [
{
          "@type": "ListItem",
          "position": 1,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "codegen",
          "value": "limited"

        }
          }
        ]
        }
        </script>
<meta xmlns="http://www.w3.org/1999/xhtml" name="chunktype" content="refpage"><meta xmlns="http://www.w3.org/1999/xhtml" name="refentity" itemprop="refentity" content="function:quad2d"><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="fcn">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ref/function">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This MATLAB function approximates the integral of fun(x,y) over the planar region a≤x≤b and c(x)≤y≤d(x)."><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "refentry";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../numerical-integration-and-differential-equations.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Numerical Integration and Differential Equations</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../numerical-integration-and-differentiation.html?s_tid=CRUX_lftnav" itemprop="url" id="numerical-integration-and-differentiation"><span itemprop="title">Numerical Integration and Differentiation</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item notranslate"><a href="#responsive_offcanvas"><span class="refname">quad2d</span></a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-refentry">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li><a href="#d126e1433461" class="intrnllnk">Syntax</a></li><li class="nav-item"><a href="#description" class="nav-link intrnllnk">Description</a></li><li class="nav-item"><a href="#brxh2kz-1_1" class="nav-link intrnllnk">Examples</a><ul class="nav"><li class="nav-item"><a href="#btig9bh-1" class="nav-link intrnllnk">Evaluate Double Integral</a></li></ul><ul class="nav"><li class="nav-item"><a href="#btig9bh-2" class="nav-link intrnllnk">Integrand with Singularity on Integration Boundary</a></li></ul><ul class="nav"><li class="nav-item"><a href="#bu94bxr" class="nav-link intrnllnk">Limitations of <code class="literal">quad2d</code></a></li></ul></li><li class="nav-item"><a href="#d126e1433848" class="nav-link intrnllnk">Input Arguments</a><ul class="nav"><li class="nav-item"><a href="#d126e1433852" class="nav-link intrnllnk">fun</a></li><li class="nav-item"><a href="#d126e1433891" class="nav-link intrnllnk">a,b</a></li><li class="nav-item"><a href="#d126e1433925" class="nav-link intrnllnk">c,d</a></li></ul></li><li class="nav-item"><a href="#namevaluepairs" class="nav-link intrnllnk">Name-Value Arguments</a><ul class="nav"><li class="nav-item"><a href="#d126e1433999" class="nav-link intrnllnk">AbsTol</a></li><li class="nav-item"><a href="#d126e1434043" class="nav-link intrnllnk">RelTol</a></li><li class="nav-item"><a href="#d126e1434087" class="nav-link intrnllnk">MaxFunEvals</a></li><li class="nav-item"><a href="#d126e1434118" class="nav-link intrnllnk">FailurePlot</a></li><li class="nav-item"><a href="#d126e1434165" class="nav-link intrnllnk">Singular</a></li></ul></li><li class="nav-item"><a href="#d126e1434210" class="nav-link intrnllnk">Output Arguments</a><ul class="nav"><li class="nav-item"><a href="#d126e1434214" class="nav-link intrnllnk">q</a></li><li class="nav-item"><a href="#d126e1434231" class="nav-link intrnllnk">E</a></li></ul></li><li><a href="#References" class="intrnllnk">References</a></li><li class="nav-item"><a href="#refsect-extended-capabilities" class="nav-link intrnllnk">Extended Capabilities</a></li><li class="nav-item"><a href="#brxh2kz_vh" class="nav-link intrnllnk">Version History</a></li><li class="nav-item"><a href="#brxh2kz_seealso" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=numerical-integration-and-differentiation&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=numerical-integration-and-differentiation&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=numerical-integration-and-differentiation&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=numerical-integration-and-differentiation&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=numerical-integration-and-differentiation&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=numerical-integration-and-differentiation&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-ref-function"><div class="function_ref"><span id="brxh2kz" class="anchor_target"></span><h1 class="r2025b notranslate" itemprop="title"><span class="refname">quad2d</span></h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">Numerically evaluate double integral &#8212; tiled method</p><div class="switch"><a href="javascript:void(0);" id="expandAllPage" data-allexpanded="true1">collapse all in page</a></div></div></div>
<div class="ref_sect"><h2 id="d126e1433461">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><div class="code_responsive"><code class="synopsis"><a href="#d126e1433468" class="intrnllnk">q = quad2d(fun,a,b,c,d)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1433503" class="intrnllnk">q = quad2d(fun,a,b,c,d,Name,Value)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1433530" class="intrnllnk">[q,E] = quad2d(<span class="argument_placeholder">___</span>)</a></code></div></div></div></div><div class="clear"></div><h2 id="description">Description</h2><div class="descriptions"><div class="cshsummary" id="csh_brxh2kz"><div class="description_module"><div class="description_element"><div class="code_responsive"><p><span id="d126e1433468" itemprop="syntax"><code class="synopsis"><a href="#d126e1434214" class="intrnllnk"><code class="argument">q</code></a> = quad2d(<a href="#d126e1433852" class="intrnllnk"><code class="argument">fun</code></a>,<a href="#d126e1433891" class="intrnllnk"><code class="argument">a,b</code></a>,<a href="#d126e1433925" class="intrnllnk"><code class="argument">c,d</code></a>)</code></span>
                approximates the integral of <code class="literal">fun(x,y)</code> over the planar region <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-4px" display="block"><mrow><mi>a</mi><mo>≤</mo><mi>x</mi><mo>≤</mo><mi>b</mi></mrow></math></span></span> and <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-7px" display="block"><mrow><mi>c</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>≤</mo><mi>y</mi><mo>≤</mo><mi>d</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></math></span></span>. The bounds <code class="literal">c</code> and <code class="literal">d</code> can each
                be scalars or function handles.</p></div><p class="syntax_example"><a href="quad2d.html#btig9bh-1" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e1433503" itemprop="syntax"><code class="synopsis"><a href="#d126e1434214" class="intrnllnk"><code class="argument">q</code></a> = quad2d(<a href="#d126e1433852" class="intrnllnk"><code class="argument">fun</code></a>,<a href="#d126e1433891" class="intrnllnk"><code class="argument">a,b</code></a>,<a href="#d126e1433925" class="intrnllnk"><code class="argument">c,d</code></a>,<a href="#namevaluepairarguments" class="intrnllnk"><code class="argument">Name,Value</code></a>)</code></span>
                specifies additional options with one or more <code class="literal">Name,Value</code> pair
                arguments. For example, you can specify <code class="literal">'AbsTol'</code> and
                    <code class="literal">'RelTol'</code> to adjust the error thresholds that the algorithm
                must satisfy.</p></div><p class="syntax_example"><a href="quad2d.html#bu94bxr" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e1433530" itemprop="syntax"><code class="synopsis">[<a href="#d126e1434214" class="intrnllnk"><code class="argument">q</code></a>,<a href="#d126e1434231" class="intrnllnk"><code class="argument">E</code></a>] = quad2d(<span class="argument_placeholder">___</span>)</code></span>
                also returns an approximate upper bound on the absolute error, <span class="inlineequation"><em class="varname">E</em> = | <em class="varname">q</em> - <em class="varname">I</em>
                        |</span>, where <em class="varname">I</em> is the exact value of the
                integral.</p></div></div></div></div></div><div class="clear"></div><div class="examples"><h2 id="brxh2kz-1_1">Examples</h2><div class="expandableContent" id="expandableExamples"><p class="switch"><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true3">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_btig9bh-1"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_btig9bh-1" data-bs-target="#expand_accordion_body_btig9bh-1" aria-controls="expand_accordion_body_btig9bh-1" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="btig9bh-1">Evaluate Double Integral</h3></button></div><div role="tabpanel" id="expand_accordion_body_btig9bh-1" aria-labelledby="expand_accordion_heading_btig9bh-1" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/EvaluateDoubleIntegralExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Evaluate Double Integral",
          "description": "Integrate",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "quad2d.html"

        },
          "identifier": "matlab.EvaluateDoubleIntegralExample",
          "name": "EvaluateDoubleIntegralExample",
          "url": "quad2d.html#btig9bh-1"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/EvaluateDoubleIntegralExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "EvaluateDoubleIntegralExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Integrate </p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>y</mi><mi mathvariant="normal">sin</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><mi>x</mi><mi mathvariant="normal">cos</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></math></p></div><p></p><p>over <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mo>-</mo><mi>π</mi><mo stretchy="false">≤</mo><mi>x</mi><mo stretchy="false">≤</mo><mn>2</mn><mi>π</mi></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mn>0</mn><mo stretchy="false">≤</mo><mi>y</mi><mo stretchy="false">≤</mo><mi>π</mi></mrow></math></span>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>fun = @(x,y) y.*sin(x)+x.*cos(y);
Q = quad2d(fun,pi,2*pi,0,pi)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>Q = 
-9.8696
</pre></div></div></div><p>Compare the result to the true value of the integral, <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mo>-</mo><msup><mrow><mi>π</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></math></span>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>-pi^2</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans = 
-9.8696
</pre></div></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-EvaluateDoubleIntegralExample"><meta itemprop="exampletitle" content="Evaluate Double Integral"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_btig9bh-2"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_btig9bh-2" data-bs-target="#expand_accordion_body_btig9bh-2" aria-controls="expand_accordion_body_btig9bh-2" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="btig9bh-2">Integrand with Singularity on Integration Boundary</h3></button></div><div role="tabpanel" id="expand_accordion_body_btig9bh-2" aria-labelledby="expand_accordion_heading_btig9bh-2" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/IntegrandWithSingularityOnIntegrationBoundaryExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Integrand with Singularity on Integration Boundary",
          "description": "Integrate the function",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "quad2d.html"

        },
          "identifier": "matlab.IntegrandWithSingularityOnIntegrationBoundaryExample",
          "name": "IntegrandWithSingularityOnIntegrationBoundaryExample",
          "url": "quad2d.html#btig9bh-2"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/IntegrandWithSingularityOnIntegrationBoundaryExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "IntegrandWithSingularityOnIntegrationBoundaryExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Integrate the function</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msup><mrow><mo>[</mo><msup><mrow><mo>(</mo><mi>x</mi><mo>+</mo><mi>y</mi><mo>)</mo></mrow><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow></msup><msup><mrow><mo>(</mo><mn>1</mn><mo>+</mo><mi>x</mi><mo>+</mo><mi>y</mi><mo>)</mo></mrow><mrow><mn>2</mn></mrow></msup><mo>]</mo></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup></mrow></math></p></div><p></p><p>over the region <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mn>0</mn><mo stretchy="false">≤</mo><mi>x</mi><mo stretchy="false">≤</mo><mn>1</mn></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mn>0</mn><mo stretchy="false">≤</mo><mi>y</mi><mo stretchy="false">≤</mo><mn>1</mn><mo>-</mo><mi>x</mi></mrow></math></span>. This integrand is infinite at the origin (0,0), which lies on the boundary of the integration region. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>fun = @(x,y) 1./(sqrt(x + y) .* (1 + x + y).^2 );
ymax = @(x) 1 - x;
Q = quad2d(fun,0,1,0,ymax)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>Q = 
0.2854
</pre></div></div></div><p>The true value of the integral is <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>π</mi><mo>/</mo><mn>4</mn><mo>-</mo><mn>1</mn><mo>/</mo><mn>2</mn></mrow></math></span>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>pi/4 - 0.5</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans = 
0.2854
</pre></div></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-IntegrandWithSingularityOnIntegrationBoundaryExample"><meta itemprop="exampletitle" content="Integrand with Singularity on Integration Boundary"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_bu94bxr"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu94bxr" data-bs-target="#expand_accordion_body_bu94bxr" aria-controls="expand_accordion_body_bu94bxr" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="bu94bxr">Limitations of <code class="literal">quad2d</code></h3></button></div><div role="tabpanel" id="expand_accordion_body_bu94bxr" aria-labelledby="expand_accordion_heading_bu94bxr" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/LimitationsOfQuad2dExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Limitations of quad2d",
          "description": "Quad2d begins by mapping the region of integration to a rectangle. Consequently, it may have trouble integrating over a region that does not have four sides or has a side that cannot be mapped smoothly to a straight line. If the integration is unsuccessful, some helpful tactics are leaving Singular set to its default value of true, changing between Cartesian and polar coordinates, or breaking the region of integration into pieces and adding the results of integration over the pieces.",
          "thumbnailURL": "../../examples/matlab/win64/LimitationsOfQuad2dExample_03.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "quad2d.html"

        },
          "identifier": "matlab.LimitationsOfQuad2dExample",
          "name": "LimitationsOfQuad2dExample",
          "url": "quad2d.html#bu94bxr"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/LimitationsOfQuad2dExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "LimitationsOfQuad2dExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc"><code class="literal">quad2d</code> begins by mapping the region of integration to a rectangle. Consequently, it may have trouble integrating over a region that does not have four sides or has a side that cannot be mapped smoothly to a straight line. If the integration is unsuccessful, some helpful tactics are leaving <code class="literal">Singular</code> set to its default value of <code class="literal">true</code>, changing between Cartesian and polar coordinates, or breaking the region of integration into pieces and adding the results of integration over the pieces.</p><p>For instance:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>fun = @(x,y)abs(x.^2 + y.^2 - 0.25);
c = @(x)-sqrt(1 - x.^2);
d = @(x)sqrt(1 - x.^2);
quad2d(fun,-1,1,c,d,<span style="color:#A020F0">'AbsTol'</span>,1e-8,<span style="color:#0000FF">...</span>
    <span style="color:#A020F0">'FailurePlot'</span>,true,<span style="color:#A020F0">'Singular'</span>,false);</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>Warning: Reached the maximum number of function evaluations (2000). The result fails the global error test.
</pre></div></div></div><div class="informalfigure"><div id="d126e1433774" class="mediaobject"><p><img src="../../examples/matlab/win64/LimitationsOfQuad2dExample_01.png" alt="Figure contains an axes object. The axes object with title QUAD2D -- Areas Needing Refinement contains 2002 objects of type patch." width="560"></p></div></div><p>The failure plot shows two areas of difficulty, near the points <code class="literal">(-1,0)</code> and <code class="literal">(1,0)</code> and near the circle <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msup><mrow><mi>x</mi></mrow><mrow><mn>2</mn></mrow></msup><mo>+</mo><msup><mrow><mi>y</mi></mrow><mrow><mn>2</mn></mrow></msup><mo>=</mo><mn>0</mn><mo stretchy="false">.</mo><mn>2</mn><mn>5</mn></mrow></math></span>.</p><p>Changing the value of <code class="literal">Singular</code> to <code class="literal">true</code> will cope with the geometric singularities at <code class="literal">(-1,0)</code> and <code class="literal">(1,0)</code>. The larger shaded areas may need refinement but are probably not areas of difficulty.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>Q = quad2d(fun,-1,1,c,d,<span style="color:#A020F0">'AbsTol'</span>,1e-8, <span style="color:#0000FF">...</span><span style="color:#228B22"> </span>
     <span style="color:#A020F0">'FailurePlot'</span>,true,<span style="color:#A020F0">'Singular'</span>,true);</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>Warning: Reached the maximum number of function evaluations (2000). The result passes the global error test.
</pre></div></div></div><div class="informalfigure"><div id="d126e1433820" class="mediaobject"><p><img src="../../examples/matlab/win64/LimitationsOfQuad2dExample_02.png" alt="Figure contains an axes object. The axes object with title QUAD2D -- Areas Needing Refinement contains 2024 objects of type patch." width="560"></p></div></div><p>From here you can take advantage of symmetry:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>Q = 4*quad2d(fun,0,1,0,d,<span style="color:#A020F0">'Abstol'</span>,1e-8,<span style="color:#0000FF">...</span>
     <span style="color:#A020F0">'Singular'</span>,true,<span style="color:#A020F0">'FailurePlot'</span>,true)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>Q = 
0.9817
</pre></div></div></div><p>However, the code is still working very hard near the singularity. It may not be able to provide higher accuracy:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>Q = 4*quad2d(fun,0,1,0,d,<span style="color:#A020F0">'Abstol'</span>,1e-10,<span style="color:#0000FF">...</span>
     <span style="color:#A020F0">'Singular'</span>,true,<span style="color:#A020F0">'FailurePlot'</span>,true);</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>Warning: Reached the maximum number of function evaluations (2000). The result passes the global error test.
</pre></div></div></div><div class="informalfigure"><div id="d126e1433836" class="mediaobject"><p><img src="../../examples/matlab/win64/LimitationsOfQuad2dExample_03.png" alt="Figure contains an axes object. The axes object with title QUAD2D -- Areas Needing Refinement contains 2011 objects of type patch." width="560"></p></div></div><p>At higher accuracy, a change in coordinates may work better.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>polarfun = @(theta,r) fun(r.*cos(theta),r.*sin(theta)).*r;
Q = 4*quad2d(polarfun,0,pi/2,0,1,<span style="color:#A020F0">'AbsTol'</span>,1e-10);</pre></div></div></div><p>It is best to put the singularity on the boundary by splitting the region of integration into two parts:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>Q1 = 4*quad2d(polarfun,0,pi/2,0,0.5,<span style="color:#A020F0">'AbsTol'</span>,5e-11);
Q2 = 4*quad2d(polarfun,0,pi/2,0.5,1,<span style="color:#A020F0">'AbsTol'</span>,5e-11);
Q = Q1 + Q2;</pre></div></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-LimitationsOfQuad2dExample"><meta itemprop="exampletitle" content="Limitations of quad2d"></div></div></div></div><div class="ref_sect"><h2 id="d126e1433848">Input Arguments</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="d126e1433848_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="d126e1433852"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_d126e1433852" data-bs-target="#expand_accordion_body_d126e1433852" aria-controls="expand_accordion_body_d126e1433852" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_fun" class="anchor_target"></span><h3 id="d126e1433852"><code itemprop="name">fun</code> &#8212; <span itemprop="purpose">Function to integrate</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">function handle</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_d126e1433852" aria-labelledby="expand_accordion_heading_d126e1433852" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_brxh2kz"><p>Function to integrate, specified as a function handle. The function
                            <code class="literal">Z = fun(X,Y)</code> must accept 2-D matrices
                            <code class="literal">X</code> and <code class="literal">Y</code> of the same size and
                        return a matrix <code class="literal">Z</code> of corresponding values. Therefore, the
                        function must be vectorized (that is, you must use elementwise operators
                        such as <code class="literal">.^</code> instead of matrix operators such as
                            <code class="literal">^</code>). The inputs and outputs of the function must be
                        either single or double precision.</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">@(x,y) x.^2 - y.^2</code></p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">function_handle</code></p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="d126e1433891"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_d126e1433891" data-bs-target="#expand_accordion_body_d126e1433891" aria-controls="expand_accordion_body_d126e1433891" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_ab" class="anchor_target"></span><h3 id="d126e1433891"><code itemprop="name">a,b</code> &#8212; <span itemprop="purpose"><em class="varname">x</em> limits of integration</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">scalars</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_d126e1433891" aria-labelledby="expand_accordion_heading_d126e1433891" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_brxh2kz"><p><em class="varname">x</em> limits of integration, specified as scalars.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code><br/>
<strong>Complex Number Support: </strong>Yes</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="d126e1433925"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_d126e1433925" data-bs-target="#expand_accordion_body_d126e1433925" aria-controls="expand_accordion_body_d126e1433925" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_cd" class="anchor_target"></span><h3 id="d126e1433925"><code itemprop="name">c,d</code> &#8212; <span itemprop="purpose"><em class="varname">y</em> limits of integration</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">scalars</span> | <span itemprop="inputvalue">function handles</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_d126e1433925" aria-labelledby="expand_accordion_heading_d126e1433925" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_brxh2kz"><p><em class="varname">y</em> limits of integration, specified as scalars or
                        function handles. Each limit can be specified as a scalar or a function
                        handle. If the limits are specified as function handles, then they are
                        functions of the <em class="varname">x</em> limit of integration <code class="literal">ymin =
                            @x c(x)</code> and <code class="literal">ymax = @(x) d(x)</code>. The function
                        handles <code class="literal">ymin</code> and <code class="literal">ymax</code> must accept
                        matrices and return matrices of the same size with the corresponding values.
                        The inputs and outputs of the functions must be either single or double
                        precision.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code> | <code itemprop="datatype">function_handle</code><br/>
<strong>Complex Number Support: </strong>Yes</p></div></div></div></div></div></div></div></div></div></div><div class="ref_sect"><span id="namevaluepairarguments" class="anchor_target"></span><h2 id="namevaluepairs">Name-Value Arguments</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="d126e1433973_accordion-group" role="tablist" aria-multiselectable="true"><div class="namevaluecontainer"><p class="neqvpair_boilerplate">Specify optional pairs of arguments as
      <code class="argument">Name1=Value1,...,NameN=ValueN</code>, where <code class="literal">Name</code> is
      the argument name and <code class="literal">Value</code> is the corresponding value.
      Name-value arguments must appear after other arguments, but the order of the
      pairs does not matter.
    </p><p class="nvpaircompat_boilerplate"><span class="emphasis"><em>
      Before R2021a, use commas to separate each name and value, and enclose</em></span> 
      <code class="literal">Name</code> <span class="emphasis"><em>in quotes.</em></span>
    </p><p><span class="example_desc"><strong>Example: </strong><code class="literal">quad2d(@(x,y) x.*y.^2, 0, 1, 0, 2, 'AbsTol',1e-3)</code>
                specifies the absolute tolerance for the integration as
                <code class="literal">1e-3</code>.</span></p></div><div class="ref_sect"><div class="expandableContent"><div class="mw_ws_accordion_container"><div class="accordion" id="d126e1433997_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NameValuePairInputArgument" itemid="d126e1433999"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_d126e1433999" data-bs-target="#expand_accordion_body_d126e1433999" aria-controls="expand_accordion_body_d126e1433999" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_AbsTol" class="anchor_target"></span><h3 id="d126e1433999"><code itemprop="name">AbsTol</code> &#8212; <span itemprop="purpose">Absolute error tolerance</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue defaultvalue"><code class="literal">1e-5</code></span> (default) | <span itemprop="inputvalue">scalar</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_d126e1433999" aria-labelledby="expand_accordion_heading_d126e1433999" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_brxh2kz"><p>Absolute error tolerance, specified as the comma-separated pair
                            consisting of <code class="literal">'AbsTol'</code> and a scalar.</p><p><code class="function">quad2d</code> attempts to satisfy <code class="literal">ERRBND &lt;=
                                max(AbsTol,RelTol*|Q|)</code>. This is absolute error control
                            when <code class="literal">|Q|</code> is sufficiently small and relative error
                            control when <code class="literal">|Q|</code> is larger. A default tolerance value
                            is used when a tolerance is not specified. The default value of
                                <code class="literal">AbsTol</code> is 1e-5. The default value of
                                <code class="literal">RelTol</code> is <code class="literal">100*eps(class(Q))</code>.
                            This is also the minimum value of <code class="literal">RelTol</code>. Smaller
                                <code class="literal">RelTol</code> values are automatically increased to the
                            default value.</p></div></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NameValuePairInputArgument" itemid="d126e1434043"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_d126e1434043" data-bs-target="#expand_accordion_body_d126e1434043" aria-controls="expand_accordion_body_d126e1434043" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_RelTol" class="anchor_target"></span><h3 id="d126e1434043"><code itemprop="name">RelTol</code> &#8212; <span itemprop="purpose">Relative error tolerance</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue defaultvalue"><code class="literal">100*eps(class(q))</code></span> (default) | <span itemprop="inputvalue">scalar</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_d126e1434043" aria-labelledby="expand_accordion_heading_d126e1434043" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_brxh2kz"><p>Relative error tolerance, specified as the comma-separated pair
                            consisting of <code class="literal">'RelTol'</code> and a scalar.</p><p><code class="function">quad2d</code> attempts to satisfy <code class="literal">ERRBND &lt;=
                                max(AbsTol,RelTol*|Q|)</code>. This is absolute error control
                            when <code class="literal">|Q|</code> is sufficiently small and relative error
                            control when <code class="literal">|Q|</code> is larger. A default tolerance value
                            is used when a tolerance is not specified. The default value of
                                <code class="literal">AbsTol</code> is 1e-5. The default value of
                                <code class="literal">RelTol</code> is <code class="literal">100*eps(class(Q))</code>.
                            This is also the minimum value of <code class="literal">RelTol</code>. Smaller
                                <code class="literal">RelTol</code> values are automatically increased to the
                            default value.</p></div></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NameValuePairInputArgument" itemid="d126e1434087"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_d126e1434087" data-bs-target="#expand_accordion_body_d126e1434087" aria-controls="expand_accordion_body_d126e1434087" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_MaxFunEvals" class="anchor_target"></span><h3 id="d126e1434087"><code itemprop="name">MaxFunEvals</code> &#8212; <span itemprop="purpose">Maximum number of evaluations of <code class="literal">fun</code></span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue defaultvalue"><code class="literal">2000</code></span> (default) | <span itemprop="inputvalue">scalar</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_d126e1434087" aria-labelledby="expand_accordion_heading_d126e1434087" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_brxh2kz"><p>Maximum number of evaluations of <code class="literal">fun</code>, specified as
                            the comma-separated pair consisting of <code class="literal">'MaxFunEvals'</code>
                            and a scalar. Use this option to limit the number of times
                                <code class="function">quad2d</code> evaluates the function
                                <code class="literal">fun</code>.</p></div></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NameValuePairInputArgument" itemid="d126e1434118"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_d126e1434118" data-bs-target="#expand_accordion_body_d126e1434118" aria-controls="expand_accordion_body_d126e1434118" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_FailurePlot" class="anchor_target"></span><h3 id="d126e1434118"><code itemprop="name">FailurePlot</code> &#8212; <span itemprop="purpose">Toggle to generate failure plot</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue defaultvalue"><code class="literal">false</code> or
                            <code class="literal">0</code></span> (default) | <span itemprop="inputvalue"><code class="literal">true</code> or <code class="literal">1</code></span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_d126e1434118" aria-labelledby="expand_accordion_heading_d126e1434118" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_brxh2kz"><p>Toggle to generate failure plot, specified as the comma-separated pair
                            consisting of <code class="literal">'FailurePlot'</code> and a numeric or logical
                                <code class="literal">1</code> (<code class="literal">true</code>) or
                                <code class="literal">0</code> (<code class="literal">false</code>). Set
                                <code class="literal">FailurePlot</code> to <code class="literal">true</code> or
                                <code class="literal">1</code> to generate a graphical representation of the
                            regions needing further refinement when <code class="literal">MaxFunEvals</code>
                            is reached. No plot is generated if the integration succeeds before
                            reaching <code class="literal">MaxFunEvals</code>. The failure plot contains
                            (generally) 4-sided regions that are mapped to rectangles internally.
                            Clusters of small regions indicate the areas of difficulty in the
                            integration.</p></div></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NameValuePairInputArgument" itemid="d126e1434165"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_d126e1434165" data-bs-target="#expand_accordion_body_d126e1434165" aria-controls="expand_accordion_body_d126e1434165" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_Singular" class="anchor_target"></span><h3 id="d126e1434165"><code itemprop="name">Singular</code> &#8212; <span itemprop="purpose">Toggle to transform boundary singularities</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue defaultvalue"><code class="literal">true</code> or
                            <code class="literal">1</code></span> (default) | <span itemprop="inputvalue"><code class="literal">false</code> or <code class="literal">0</code></span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_d126e1434165" aria-labelledby="expand_accordion_heading_d126e1434165" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_brxh2kz"><p>Toggle to transform boundary singularities, specified as the
                            comma-separated pair consisting of <code class="literal">'Singular'</code> and a
                            numeric or logical <code class="literal">1</code> (<code class="literal">true</code>) or
                                <code class="literal">0</code> (<code class="literal">false</code>). By default,
                                <code class="function">quad2d</code> employs transformations to weaken
                            boundary singularities for better performance. Set
                                <code class="literal">'Singular'</code> to <code class="literal">false</code> or
                                <code class="literal">0</code> to turn these transformations off, which can
                            provide a performance benefit on some smooth problems.</p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="d126e1434210">Output Arguments</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="d126e1434210_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_d126e1434214" data-bs-target="#expand_accordion_body_d126e1434214" aria-controls="expand_accordion_body_d126e1434214" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_q" class="anchor_target"></span><h3 id="d126e1434214"><code class="name">q</code> &#8212; Calculated integral<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">scalar</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_d126e1434214" aria-labelledby="expand_accordion_heading_d126e1434214" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_brxh2kz"><p>Calculated integral, returned as a scalar.</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_d126e1434231" data-bs-target="#expand_accordion_body_d126e1434231" aria-controls="expand_accordion_body_d126e1434231" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_E" class="anchor_target"></span><h3 id="d126e1434231"><code class="name">E</code> &#8212; Error bound<br/>
<span class="add_font_color_general remove_bold"><span class="example_desc">scalar</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_d126e1434231" aria-labelledby="expand_accordion_heading_d126e1434231" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_brxh2kz"><p>Error bound, returned as a scalar. The error bound provides an upper bound
                        on the error between the calculated integral <em class="varname">q</em> and the
                        exact value of the integral <em class="varname">I</em> such that <span class="inlineequation"><em class="varname">E</em> = | <em class="varname">q</em> -
                                    <em class="varname">I</em> |</span>.</p></div></div></div></div></div></div></div></div></div></div><div class="bibliography"><h2 id="References">References</h2><div id="bs9evb0-2" class="bibliomixed"><p>[1] L.F. Shampine, "MATLAB Program for Quadrature in 2D."
                <em class="citetitle">Applied Mathematics and Computation.</em> Vol. 202, Issue 1, 2008,
            pp. 266&#8211;274.</p></div></div><div class="ref_sect"><h2 id="refsect-extended-capabilities">Extended Capabilities</h2><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink">expand all</a></p><div id="accordion_refsect-extended-capabilities" role="tablist" aria-multiselectable="true"><span id="bvl2ifl-1" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="brxh2kz" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_brxh2kz_codegen" aria-controls="expand_body_brxh2kz_codegen" class="accordion-button collapsed" aria-expanded="false"><h3 id="brxh2kz_codegen">C/C++ Code Generation<br/> <span class=" remove_bold add_font_color_general">Generate C and C++ code using MATLAB&#174; Coder&#8482;.</span></h3></button></div><div id="expand_body_brxh2kz_codegen" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>
                <span>Usage notes and limitations:</span>
            </p><p>
                </p>
<div class="itemizedlist"><ul><li><p>Generated code issues a warning if the size of the internal storage
                            arrays is not large enough. If a warning occurs, as a workaround, you
                            can try to divide the region of integration into pieces and sum the
                            integrals over each piece.</p></li></ul></div><p>

            </p></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="brxh2kz_vh">Version History</h2><p><strong>Introduced in R2009a</strong></p></div><div class="ref_sect"><h2 id="brxh2kz_seealso">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="quadgk.html"><span itemprop="name"><code class="function">quadgk</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="integral.html"><span itemprop="name"><code class="function">integral</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="integral2.html"><span itemprop="name"><code class="function">integral2</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="integral3.html"><span itemprop="name"><code class="function">integral3</code></span></a></span></p><div class="examples_container"><h3 class="remove_border">Topics</h3><div itemprop="content"><ul class="list-unstyled"><li><a href="../matlab_prog/anonymous-functions.html" class="a">Anonymous Functions</a></li><li><a href="../matlab_prog/creating-a-function-handle.html" class="a">Create Function Handle</a></li></ul></div></div></div>
    </div></div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

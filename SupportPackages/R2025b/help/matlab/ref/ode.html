<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>ode</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../numerical-integration-and-differential-equations.html",
          "name": "Numerical Integration and Differential Equations"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../ordinary-differential-equations.html",
          "name": "Ordinary Differential Equations"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "ordinary-differential-equations"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script>
<meta xmlns="http://www.w3.org/1999/xhtml" name="chunktype" content="refpage"><meta xmlns="http://www.w3.org/1999/xhtml" name="refentity" itemprop="refentity" content="function:ode"><meta xmlns="http://www.w3.org/1999/xhtml" name="refentity" itemprop="refentity" content="object:ode"><meta xmlns="http://www.w3.org/1999/xhtml" name="refentity" itemprop="refentity" content="object:ode"><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="fcn">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ref/function">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="An ode object defines a system of ordinary differential equations or differential algebraic equations to solve."><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "refentry";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../numerical-integration-and-differential-equations.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Numerical Integration and Differential Equations</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../ordinary-differential-equations.html?s_tid=CRUX_lftnav" itemprop="url" id="ordinary-differential-equations"><span itemprop="title">Ordinary Differential Equations</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item notranslate"><a href="#responsive_offcanvas">ode</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-refentry">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#d126e1220252" class="nav-link intrnllnk">Description</a></li><li class="nav-item"><a href="#mw_2b15aac6-c709-4940-ab5f-32d377d30bdc" class="nav-link intrnllnk">Creation</a><ul class="nav"><li class="nav-item"><a href="#mw_96d93878-a993-4974-8e2e-80bf786bf36b" class="nav-link intrnllnk">Description</a></li></ul></li><li class="nav-item"><a href="#mw_de4ca151-afc1-49ca-ab6c-5faa4e841682" class="nav-link intrnllnk">Properties</a><ul class="nav"><li class="nav-item"><a href="#mw_8322958f-e6ea-4061-8a0e-bf99af1fee25" class="nav-link intrnllnk">Problem Definition</a><ul class="nav"><li class="nav-item"><a href="#mw_8236e1f6-53b1-4e59-9b3a-d60115dc299f" class="nav-link intrnllnk">ODEFcn</a></li><li class="nav-item"><a href="#mw_4e5ea0ee-29a0-48db-97f1-8c8c5b3df809" class="nav-link intrnllnk">InitialTime</a></li><li class="nav-item"><a href="#mw_14f4e3d9-aba8-4f3d-b5cb-276ca6efb15b" class="nav-link intrnllnk">InitialValue</a></li><li class="nav-item"><a href="#mw_82c25b64-f591-4770-abd7-674c294cb2fb" class="nav-link intrnllnk">Parameters</a></li><li class="nav-item"><a href="#mw_4fa451b5-a080-48e5-9406-f7247d0def10" class="nav-link intrnllnk">MassMatrix</a></li></ul></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_e6e8b658-7108-441b-87ad-dc99bbf3473a" class="nav-link intrnllnk">Advanced Problem Definition</a><ul class="nav"><li class="nav-item"><a href="#mw_0934d70d-1280-48bc-8c5f-c3793df4d403" class="nav-link intrnllnk">EquationType</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_cf23892c-3ead-41c8-b61b-8021610e548f" class="nav-link intrnllnk">Jacobian</a></li><li class="nav-item"><a href="#mw_91e08700-6874-41b1-9cf6-e738c20834b2" class="nav-link intrnllnk">EventDefinition</a></li><li class="nav-item"><a href="#mw_f6945c9e-74d1-445f-a89e-c7ef3d68b0d6" class="nav-link intrnllnk">NonNegativeVariables</a></li><li class="nav-item"><a href="#mw_45f915a7-38c9-49f8-b6f0-dacd51c74fa2" class="nav-link intrnllnk">InitialSlope</a></li><li class="nav-item"><a href="#mw_0e78803b-a202-4fc4-aa54-0afbcf2f2ec1" class="nav-link intrnllnk">Sensitivity</a></li><li class="nav-item"><a href="#mw_3b714824-6e15-438f-8894-ee839743ba75" class="nav-link intrnllnk">DelayDefinition</a></li><li class="nav-item"><a href="#mw_38a1c3ce-2ca9-4249-a1d5-6e2a352c2d7d" class="nav-link intrnllnk">SeparateComplexParts</a></li></ul></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_f50792d1-9d0a-4cb9-a7b8-819dc8d4a992" class="nav-link intrnllnk">Solver Control</a><ul class="nav"><li class="nav-item"><a href="#mw_c6c5fc76-3a96-4e41-b8ca-aab381dde9f5" class="nav-link intrnllnk">Solver</a></li><li class="nav-item"><a href="#mw_b3324731-72e8-406c-be27-658d5532a9d8" class="nav-link intrnllnk">SelectedSolver</a></li><li class="nav-item"><a href="#mw_649206c2-3480-4fc2-af28-95f386b19466" class="nav-link intrnllnk">SolverOptions</a></li><li class="nav-item"><a href="#mw_52b5866a-e98c-4171-8d75-ef03b6222705" class="nav-link intrnllnk">AbsoluteTolerance</a></li><li class="nav-item"><a href="#mw_96200053-bf31-4d97-bafa-a211b2186adc" class="nav-link intrnllnk">RelativeTolerance</a></li></ul></li></ul></li><li class="nav-item"><a href="#mw_2f7f0c38-a4d9-4665-b19f-352884f661c8" class="nav-link intrnllnk">Object Functions</a></li><li class="nav-item"><a href="#mw_a7d8f746-69fb-408d-9b33-d15b9c8bc7e5" class="nav-link intrnllnk">Examples</a><ul class="nav"><li class="nav-item"><a href="#mw_ec43c749-72a9-41d6-89c7-cde7b7458556" class="nav-link intrnllnk">Solve Single ODE</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_233556dd-98eb-4db0-9cfa-a2c2f830248d" class="nav-link intrnllnk">Solve Complex ODE</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_0cd92b80-8df9-4493-af9c-9a7e01c35b04" class="nav-link intrnllnk">Specify Jacobian Matrix for Stiff ODE</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_b433527e-3289-4fb2-8282-428b434052e6" class="nav-link intrnllnk">Detect Stiffness When Selecting ODE Solver</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_f36627ec-cfca-43d8-8cb4-1962d408c156" class="nav-link intrnllnk">Solve System of DAEs with Mass Matrix</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_b3779d98-e7f1-4ad8-9b71-cf29412f4542" class="nav-link intrnllnk">Examine Parameter Sensitivity</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_8b9f1e84-f7ab-4482-94e0-1f7ac8eac578" class="nav-link intrnllnk">Use Callback Function to Restart Integration of Bouncing Ball</a></li></ul></li><li class="nav-item"><a href="#mw_83bd1c5b-5b4a-42ab-ae1e-0629673f4024" class="nav-link intrnllnk">Version History</a><ul class="nav"><li class="nav-item"><a href="#mw_947491ff-3699-405d-ae32-f94f26893d21" class="nav-link intrnllnk">Specify single-precision property values</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_6c2bbf4e-e636-48b5-838d-5d8451ea9fa7" class="nav-link intrnllnk">Solve delay differential equations</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_fcee8481-b420-47bb-bb55-a86a29b406ce" class="nav-link intrnllnk">Solve complex-valued ODE functions</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_a498a779-e117-42b1-aee7-39c23c9cd0c1" class="nav-link intrnllnk">Specify ODE as implicit</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_952e51f4-b402-4d93-a447-3992c500d5e2" class="nav-link intrnllnk">Detect stiffness to change ODE solver</a></li></ul></li><li class="nav-item"><a href="#mw_6845404f-8e57-4f36-b119-9193970db6ba_seealso" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-ref"><div class="object_ref"><span id="mw_6845404f-8e57-4f36-b119-9193970db6ba" class="anchor_target"></span><h1 class="r2025b notranslate" itemprop="title">ode</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose" class="add_margin_0">Ordinary differential equations</p><p class="add_margin_0 add_clear_left"><em>Since R2023b</em></p><div class="switch"><a href="javascript:void(0);" id="expandAllPage">expand all in page</a></div></div></div><div class="refsummary" itemprop="content"><h2 id="d126e1220252">Description</h2><div class="cshsummary" id="csh_mw_6845404f-8e57-4f36-b119-9193970db6ba"><div class="shortsummary"><p>An <code class="class">ode</code> object defines a system of ordinary differential equations
      or differential algebraic equations to solve.</p></div><p>You can solve initial value problems of the form <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><mi>y</mi><mo>'</mo><mo>=</mo><mi>f</mi><mrow><mo>(</mo><mrow><mi>t</mi><mo>,</mo><mi>y</mi></mrow><mo>)</mo></mrow></mrow></math></span></span>, <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><mi>f</mi><mrow><mo>(</mo><mrow><mi>t</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>'</mo></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn></mrow></math></span></span>, or problems that involve a mass matrix, <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><mi>M</mi><mrow><mo>(</mo><mrow><mi>t</mi><mo>,</mo><mi>y</mi></mrow><mo>)</mo></mrow><mi>y</mi><mo>'</mo><mo>=</mo><mi>f</mi><mrow><mo>(</mo><mrow><mi>t</mi><mo>,</mo><mi>y</mi></mrow><mo>)</mo></mrow></mrow></math></span></span>.</p><p>Define aspects of the problem using properties of the <code class="class">ode</code> object, such as
        <code class="property">ODEFcn</code>, <code class="property">InitialTime</code>, and
        <code class="property">InitialValue</code>. You can select a specific solver to use, or let
        MATLAB<sup>&#x00AE;</sup> choose an appropriate solver based on properties of the equations. After you
      create an <code class="class">ode</code> object, you can solve the equations using the
        <code class="method">solve</code> or <code class="method">solutionFcn</code> object functions.</p></div></div><div id="mw_2b15aac6-c709-4940-ab5f-32d377d30bdc_div" class="ref_sect createobject"><h2 id="mw_2b15aac6-c709-4940-ab5f-32d377d30bdc">Creation</h2>
<span id="mw_94286dfb-8c5b-40f2-869d-0675fa873163" class="anchor_target"></span><div class="ref_sect"><h3 id="mw_94286dfb-8c5b-40f2-869d-0675fa873163">Syntax</h3><div class="syntax_signature"><div class="syntax_signature_module"><div class="code_responsive"><code class="synopsis"><a href="#d126e1220307" class="intrnllnk">F = ode</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1220322" class="intrnllnk">F = ode(PropertyName=Value)</a></code></div></div></div></div><div class="clear"></div><div id="mw_96d93878-a993-4974-8e2e-80bf786bf36b_div" class="refsect2 description"><h3 id="mw_96d93878-a993-4974-8e2e-80bf786bf36b">Description</h3><div class="description_module"><div class="description_element"><div class="code_responsive"><p><span id="d126e1220307" itemprop="syntax"><code class="synopsis"><code class="argument">F</code> = ode</code></span> creates an <code class="class">ode</code> object
          with default properties.</p></div><p class="syntax_example"><a href="ode.html#mw_ec43c749-72a9-41d6-89c7-cde7b7458556" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e1220322" itemprop="syntax"><code class="synopsis"><code class="argument">F</code> = ode(<a href="#mw_de4ca151-afc1-49ca-ab6c-5faa4e841682" class="intrnllnk"><code class="argument">PropertyName=Value</code></a>)</code></span>
          specifies one or more property values using name-value arguments. For example, you can
          specify the equations to be solved, the initial time for integration, and the value of the
          solution at the initial time using the <code class="property">ODEFcn</code>,
            <code class="property">InitialTime</code>, and <code class="property">InitialValue</code>
          properties.</p></div><p class="syntax_example"><a href="ode.html#mw_8b9f1e84-f7ab-4482-94e0-1f7ac8eac578" class="intrnllnk">example</a></p></div></div></div></div><div class="ref_sect"><h2 id="mw_de4ca151-afc1-49ca-ab6c-5faa4e841682">Properties</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="false">expand all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="mw_de4ca151-afc1-49ca-ab6c-5faa4e841682_accordion-group" role="tablist" aria-multiselectable="true"><div id="mw_8322958f-e6ea-4061-8a0e-bf99af1fee25_div" class="refsect2"><h3 id="mw_8322958f-e6ea-4061-8a0e-bf99af1fee25">Problem Definition</h3><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item " itemscope="" itemprop="property" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/PropertyReference" itemid="mw_8236e1f6-53b1-4e59-9b3a-d60115dc299f"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_8236e1f6-53b1-4e59-9b3a-d60115dc299f" data-bs-target="#expand_accordion_body_mw_8236e1f6-53b1-4e59-9b3a-d60115dc299f" aria-controls="expand_accordion_body_mw_8236e1f6-53b1-4e59-9b3a-d60115dc299f" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="prop_ODEFcn" class="anchor_target"></span><h3 id="mw_8236e1f6-53b1-4e59-9b3a-d60115dc299f"><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/ReferenceEntity" itemprop="refentityobj"><meta itemprop="refentity" content="property:ode.ODEFcn"><code itemprop="name" id="propname_ODEFcn">ODEFcn</code></span> &#8212; <span itemprop="purpose">Equations to solve</span><br/>
<span class="add_font_color_general remove_bold"><span class="example_desc" itemprop="inputvalues"><span itemprop="inputvalue">function handle</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_8236e1f6-53b1-4e59-9b3a-d60115dc299f" aria-labelledby="expand_accordion_heading_mw_8236e1f6-53b1-4e59-9b3a-d60115dc299f" class="accordion-collapse collapse"><div class="accordion-body"><div class="cshsummary" id="csh_mw_8236e1f6-53b1-4e59-9b3a-d60115dc299f"><p>Equations to solve, specified as a function handle that defines the system of
              differential equations to be integrated. The function handle can be an anonymous
              function or a handle to a named function file.</p><div class="itemizedlist"><ul><li><p>The function <code class="literal">dydt = ODEFcn(t,y)</code>, for a scalar
                    <code class="literal">t</code> and a column vector <code class="literal">y</code>, must return a
                  column vector <code class="literal">dydt</code> that corresponds to <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><mi>f</mi><mrow><mo>(</mo><mrow><mi>t</mi><mo>,</mo><mi>y</mi></mrow><mo>)</mo></mrow></mrow></math></span></span>. <code class="property">ODEFcn</code> must accept at least two input
                  arguments, <code class="literal">t</code> and <code class="literal">y</code>, even if one of the
                  arguments is not used in the function. </p></li><li><p>The function <code class="literal">f =
                    ODEFcn(t,y,yp)</code>, when <code class="argument">EquationType</code> is
                    <code class="literal">"fullyimplicit"</code> and for a scalar <code class="literal">t</code> and
                  column vectors <code class="literal">y</code> and <code class="literal">yp</code>, must return a
                  column vector <code class="literal">f</code> that corresponds to <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><mi>f</mi><mrow><mo>(</mo><mrow><mi>t</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>'</mo></mrow><mo>)</mo></mrow></mrow></math></span></span>. <code class="property">ODEFcn</code> must accept at least three input
                  arguments, <code class="literal">t</code>, <code class="literal">y</code>, and <code class="literal">yp</code>,
                  even if one of the arguments is not used in the function. <em> (since R2024b)</em></p></li><li><p>The function <code class="literal">dydt =
                    ODEFcn(t,y,Z)</code>, when <code class="argument">EquationType</code> is
                    <code class="literal">"delay"</code> and for a scalar <code class="literal">t</code>, column vector
                    <code class="literal">y</code>, and matrix <code class="literal">Z</code>, must return a column
                  vector <code class="literal">dydt</code> that corresponds to <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><mi>f</mi><mrow><mo>(</mo><mrow><mi>t</mi><mo>,</mo><mi>y</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>,</mo><mi>y</mi><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><msub><mi>τ</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>,</mo><mn>...</mn><mo>,</mo><mi>y</mi><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><msub><mi>τ</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow></mrow></math></span></span> when the solver is <code class="literal">dde23</code> or <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><mi>f</mi><mrow><mo>(</mo><mrow><mi>t</mi><mo>,</mo><mi>y</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>,</mo><mi>y</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>,</mo><mn>...</mn><mo>,</mo><mi>y</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow></mrow></math></span></span>, for delays <em class="varname">d(j)</em>, when the solver is
                    <code class="literal">ddesd</code>. <code class="property">ODEFcn</code> must accept at least three
                  input arguments, <code class="literal">t</code>, <code class="literal">y</code>, and
                    <code class="literal">Z</code>, even if one of the arguments is not used in the
                  function.<em> (since R2025a)</em></p></li><li><p>The function <code class="literal">yp =
                    ODEFcn(t,y,ydel,ypdel)</code>, when <code class="argument">EquationType</code> is
                    <code class="literal">"delay"</code> and for a scalar <code class="literal">t</code>, column vector
                    <code class="literal">y</code>, and matrices <code class="literal">ydel</code> and
                    <code class="literal">ypdel</code>, must return a column vector <code class="literal">yp</code> that
                  corresponds to <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-9px" display="block"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>t</mi><mo>,</mo><mi>y</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>,</mo><mi>y</mi><mo stretchy="false">(</mo><mi>d</mi><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>,</mo><mn>...</mn><mo>,</mo><mi>y</mi><mo stretchy="false">(</mo><mi>d</mi><msub><mi>y</mi><mi>p</mi></msub><mo stretchy="false">)</mo><mo>,</mo><mi>y</mi><mo>'</mo><mo stretchy="false">(</mo><mi>d</mi><mi>y</mi><msub><mi>p</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>,</mo><mn>...</mn><mo>,</mo><mi>y</mi><mo>'</mo><mo stretchy="false">(</mo><mi>d</mi><mi>y</mi><msub><mi>p</mi><mi>q</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></math></span></span>. <code class="property">ODEFcn</code> must accept at least four
                  arguments, <code class="literal">t</code>, <code class="literal">y</code>, <code class="literal">ydel</code>,
                    <code class="literal">ypdel</code>, even if one of the arguments is not used in the
                  function.<em> (since R2025a)</em></p></li></ul></div><p>To supply parameter values, define <code class="property">ODEFcn</code> as a function that
              accepts three inputs, <code class="literal">dydt = ODEFcn(t,y,p)</code>, four inputs, <code class="literal">f
                = ODEFcn(t,y,yp,p)</code> or <code class="literal">dydt = ODEFun(t,y,Z,p)</code>, or five
              inputs, <code class="literal">yp = ODEFcn(t,y,ydel,ypdel,p)</code>, and then use the
                <code class="property">Parameters</code> property to store parameter values (such as in a
                <code class="literal">struct</code> or <code class="literal">cell</code> array).</p><p>For example, to solve a single equation <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-7px" display="block"><mrow><mi>y</mi><mo>'</mo><mo>=</mo><mn>5</mn><mi>y</mi><mo>−</mo><mn>3</mn></mrow></math></span></span>, you can use the anonymous function <code class="literal">@(t,y)
              5*y-3</code>.</p><p>For a system of equations, the output of <code class="property">ODEFcn</code> is a vector.
              Each element in the vector is the computed value of the right side of one equation.
              For example, consider this system of two equations.</p><div id="d126e1220534" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-17px" display="block"><mtable columnalign="left"><mtr><mtd><mi>y</mi><msub><mo>'</mo><mn>1</mn></msub><mo>=</mo><msub><mi>y</mi><mn>1</mn></msub><mo>+</mo><mn>2</mn><msub><mi>y</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><mi>y</mi><msub><mo>'</mo><mn>2</mn></msub><mo>=</mo><mn>3</mn><msub><mi>y</mi><mn>1</mn></msub><mo>+</mo><mn>2</mn><msub><mi>y</mi><mn>2</mn></msub></mtd></mtr></mtable></math></p></div></div><p>An anonymous function that defines these equations is <code class="literal">@(t,y)
                [y(1)+2*y(2); 3*y(1)+2*y(2)]</code>.</p><p class="description_valueexample"><strong>Example: </strong>
              <code class="literal">F.ODEFcn = @myFcn</code> specifies a handle to a named function file
                <code class="literal">myFcn.m</code> containing the equations.</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">F.ODEFcn = @(t,y) [y(2); -y(1)]</code> specifies an anonymous
              function that defines a system of two equations.</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">F.ODEFcn = @(t,y,yp) [yp(1)-y(2); yp(2)+1]</code> specifies an
              anonymous function that defines a system of two equations.</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">F.ODEFcn = @(t,y,p) 5*y*p(1)-3*p(2)</code> specifies an
              anonymous function for a single equation that uses two parameters.</p></div><p class="datatypelist"><strong>Data Types: </strong><code>function_handle</code></p></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item " itemscope="" itemprop="property" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/PropertyReference" itemid="mw_4e5ea0ee-29a0-48db-97f1-8c8c5b3df809"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_4e5ea0ee-29a0-48db-97f1-8c8c5b3df809" data-bs-target="#expand_accordion_body_mw_4e5ea0ee-29a0-48db-97f1-8c8c5b3df809" aria-controls="expand_accordion_body_mw_4e5ea0ee-29a0-48db-97f1-8c8c5b3df809" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="prop_InitialTime" class="anchor_target"></span><h3 id="mw_4e5ea0ee-29a0-48db-97f1-8c8c5b3df809"><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/ReferenceEntity" itemprop="refentityobj"><meta itemprop="refentity" content="property:ode.InitialTime"><code itemprop="name" id="propname_InitialTime">InitialTime</code></span> &#8212; <span itemprop="purpose">Initial time for integration</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc" itemprop="inputvalues"><span itemprop="inputvalue defaultvalue"><code class="literal">0</code></span> (default) | <span itemprop="inputvalue">real scalar</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_4e5ea0ee-29a0-48db-97f1-8c8c5b3df809" aria-labelledby="expand_accordion_heading_mw_4e5ea0ee-29a0-48db-97f1-8c8c5b3df809" class="accordion-collapse collapse"><div class="accordion-body"><div class="cshsummary" id="csh_mw_4e5ea0ee-29a0-48db-97f1-8c8c5b3df809"><p>Initial time for integration, specified as a real scalar. The value of
                <code class="property">InitialTime</code> is the beginning of the integration interval where
              the initial conditions specified in <code class="property">InitialValue</code> are applied by
              the solver before beginning integration steps.</p><p class="description_valueexample"><strong>Example: </strong>
              <code class="literal">F.InitialTime = 10;</code></p></div><p class="datatypelist"><strong>Data Types: </strong><code>single</code> | <code>double</code></p></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item " itemscope="" itemprop="property" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/PropertyReference" itemid="mw_14f4e3d9-aba8-4f3d-b5cb-276ca6efb15b"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_14f4e3d9-aba8-4f3d-b5cb-276ca6efb15b" data-bs-target="#expand_accordion_body_mw_14f4e3d9-aba8-4f3d-b5cb-276ca6efb15b" aria-controls="expand_accordion_body_mw_14f4e3d9-aba8-4f3d-b5cb-276ca6efb15b" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="prop_InitialValue" class="anchor_target"></span><h3 id="mw_14f4e3d9-aba8-4f3d-b5cb-276ca6efb15b"><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/ReferenceEntity" itemprop="refentityobj"><meta itemprop="refentity" content="property:ode.InitialValue"><code itemprop="name" id="propname_InitialValue">InitialValue</code></span> &#8212; <span itemprop="purpose">Value of solution at <code class="literal">InitialTime</code></span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc" itemprop="inputvalues"><span itemprop="inputvalue">scalar</span> | <span itemprop="inputvalue">vector</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_14f4e3d9-aba8-4f3d-b5cb-276ca6efb15b" aria-labelledby="expand_accordion_heading_mw_14f4e3d9-aba8-4f3d-b5cb-276ca6efb15b" class="accordion-collapse collapse"><div class="accordion-body"><div class="cshsummary" id="csh_mw_14f4e3d9-aba8-4f3d-b5cb-276ca6efb15b"><p>Value of solution at <code class="literal">InitialTime</code>, specified as a scalar or
              vector. <code class="property">InitialValue</code> must be a vector with the same length as the
              output of <code class="property">ODEFcn</code> so that an initial value is specified for each
              equation defined in <code class="property">ODEFcn</code>. The value of
                <code class="property">InitialTime</code> is the beginning of the integration interval where
              the initial conditions specified in <code class="property">InitialValue</code> are applied by
              the solver before beginning integration steps.</p><p class="description_valueexample"><strong>Example: </strong>
              <code class="literal">F.InitialValue = 1;</code></p><p class="description_valueexample"><strong>Example: </strong>
              <code class="literal">F.InitialValue = [1 2 3];</code></p></div><p class="datatypelist"><strong>Data Types: </strong><code>single</code> | <code>double</code><br/>
<strong>Complex Number Support: </strong>Yes</p></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item " itemscope="" itemprop="property" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/PropertyReference" itemid="mw_82c25b64-f591-4770-abd7-674c294cb2fb"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_82c25b64-f591-4770-abd7-674c294cb2fb" data-bs-target="#expand_accordion_body_mw_82c25b64-f591-4770-abd7-674c294cb2fb" aria-controls="expand_accordion_body_mw_82c25b64-f591-4770-abd7-674c294cb2fb" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="prop_Parameters" class="anchor_target"></span><h3 id="mw_82c25b64-f591-4770-abd7-674c294cb2fb"><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/ReferenceEntity" itemprop="refentityobj"><meta itemprop="refentity" content="property:ode.Parameters"><code itemprop="name" id="propname_Parameters">Parameters</code></span> &#8212; <span itemprop="purpose">Equation parameters</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc" itemprop="inputvalues"><span itemprop="inputvalue">array</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_82c25b64-f591-4770-abd7-674c294cb2fb" aria-labelledby="expand_accordion_heading_mw_82c25b64-f591-4770-abd7-674c294cb2fb" class="accordion-collapse collapse"><div class="accordion-body"><div class="cshsummary" id="csh_mw_82c25b64-f591-4770-abd7-674c294cb2fb"><p>Equation parameters, specified as an array of any size or data type. The values
              you store in <code class="property">Parameters</code> can be supplied to any of the functions
              used for the <code class="property">ODEFcn</code>, <code class="property">Jacobian</code>,
                <code class="property">MassMatrix</code>, or <code class="property">EventDefinition</code> properties
              by specifying an extra input argument in the function.</p><p>For instance, you can supply parameter values stored in the
                <code class="property">Parameters</code> property to <code class="property">ODEFcn</code> by
              specifying <code class="property">ODEFcn</code> as a function handle that accepts three inputs,
                <code class="literal">dydt = ODEFcn(t,y,p)</code>. For example, <code class="literal">F.ODEFcn = @(t,y,p)
                5*y*p(1)-3*p(2)</code> specifies an anonymous function for a single equation that
              uses two parameters. If you then specify <code class="literal">F.Parameters = [2 3]</code>, then
                <code class="property">ODEFcn</code> uses the parameter values <code class="literal">p(1) = 2</code>
              and <code class="literal">p(2) = 3</code> whenever the solver calls the function.</p><p class="description_valueexample"><strong>Example: </strong>
              <code class="literal">F.Parameters = [0.1 0.5]</code> specifies two parameter
              values.</p></div><p class="datatypelist"><strong>Data Types: </strong><code>single</code> | <code>double</code><br/>
<strong>Complex Number Support: </strong>Yes</p></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item " itemscope="" itemprop="property" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/PropertyReference" itemid="mw_4fa451b5-a080-48e5-9406-f7247d0def10"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_4fa451b5-a080-48e5-9406-f7247d0def10" data-bs-target="#expand_accordion_body_mw_4fa451b5-a080-48e5-9406-f7247d0def10" aria-controls="expand_accordion_body_mw_4fa451b5-a080-48e5-9406-f7247d0def10" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="prop_MassMatrix" class="anchor_target"></span><h3 id="mw_4fa451b5-a080-48e5-9406-f7247d0def10"><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/ReferenceEntity" itemprop="refentityobj"><meta itemprop="refentity" content="property:ode.MassMatrix"><code itemprop="name" id="propname_MassMatrix">MassMatrix</code></span> &#8212; <span itemprop="purpose">Mass matrix</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc" itemprop="inputvalues"><span itemprop="inputvalue"><code class="object">odeMassMatrix</code> object</span> | <span itemprop="inputvalue">matrix</span> | <span itemprop="inputvalue">function handle</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_4fa451b5-a080-48e5-9406-f7247d0def10" aria-labelledby="expand_accordion_heading_mw_4fa451b5-a080-48e5-9406-f7247d0def10" class="accordion-collapse collapse"><div class="accordion-body"><div class="cshsummary" id="csh_mw_4fa451b5-a080-48e5-9406-f7247d0def10"><p>Mass matrix, specified as an <a href="odemassmatrix.html"><code class="object">odeMassMatrix</code></a> object, matrix, or handle to a function that evaluates the
              mass matrix.</p><p><code class="object">ode</code> objects can represent problems of the form <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><mi>M</mi><mrow><mo>(</mo><mrow><mi>t</mi><mo>,</mo><mi>y</mi></mrow><mo>)</mo></mrow><mtext> </mtext><mi>y</mi><mo>'</mo><mo>=</mo><mi>f</mi><mrow><mo>(</mo><mrow><mi>t</mi><mo>,</mo><mi>y</mi></mrow><mo>)</mo></mrow></mrow></math></span></span>, where <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><mi>M</mi><mrow><mo>(</mo><mrow><mi>t</mi><mo>,</mo><mi>y</mi></mrow><mo>)</mo></mrow></mrow></math></span></span> is a mass matrix that can be full or sparse. The mass matrix encodes
              linear combinations of derivatives on the left side of the equation.</p>
<div class="itemizedlist"><ul><li><p>When the mass matrix is nonsingular, the equation simplifies to <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><mi>y</mi><mo>'</mo><mo>=</mo><msup><mi>M</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mtext> </mtext><mi>f</mi><mrow><mo>(</mo><mrow><mi>t</mi><mo>,</mo><mi>y</mi></mrow><mo>)</mo></mrow></mrow></math></span></span> and the ODE has a solution for any initial value. However, it
                    is often more convenient and natural to express the model in terms of the mass
                    matrix directly using <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><mi>M</mi><mrow><mo>(</mo><mrow><mi>t</mi><mo>,</mo><mi>y</mi></mrow><mo>)</mo></mrow><mtext> </mtext><mi>y</mi><mo>'</mo><mo>=</mo><mi>f</mi><mrow><mo>(</mo><mrow><mi>t</mi><mo>,</mo><mi>y</mi></mrow><mo>)</mo></mrow></mrow></math></span></span>, and avoiding the computation of the matrix inverse reduces
                    the storage and execution time needed to solve the problem.</p></li><li><p>When the mass matrix is singular, then the problem is a system of
                    differential algebraic equations (DAEs). A DAE has a solution only when the
                    initial values are consistent; that is, you must specify the initial slope <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-7px" display="block"><mrow><mi>y</mi><msub><mo>'</mo><mn>0</mn></msub></mrow></math></span></span> using the <code class="property">InitialSlope</code> property such that
                    the initial conditions are all consistent, <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><mi>M</mi><mrow><mo>(</mo><mrow><msub><mi>t</mi><mn>0</mn></msub><mo>,</mo><msub><mi>y</mi><mn>0</mn></msub></mrow><mo>)</mo></mrow><mi>y</mi><msub><mo>'</mo><mn>0</mn></msub><mo>=</mo><mi>f</mi><mrow><mo>(</mo><mrow><msub><mi>t</mi><mn>0</mn></msub><mo>,</mo><msub><mi>y</mi><mn>0</mn></msub></mrow><mo>)</mo></mrow></mrow></math></span></span>. If the specified initial conditions are not consistent with
                    the <code class="property">InitialTime</code>, <code class="property">InitialValue</code>, and
                      <code class="property">MassMatrix</code> properties, then the solver treats them as
                    guesses and attempts to compute consistent values for the initial slopes that
                    are close to the guesses before continuing to solve the problem. For more
                    information, see <a href="../math/solve-differential-algebraic-equations-daes.html" class="a">Solve Differential Algebraic Equations (DAEs)</a>.</p></li></ul></div><p>
</p><p>You can specify the value of the <code class="property">MassMatrix</code> property as:</p>
<div class="itemizedlist"><ul><li><p>An <code class="object">odeMassMatrix</code> object, which represents the mass matrix
                    and its associated properties. You can specify whether the mass matrix is
                    singular or has state dependence.</p></li><li><p>A constant matrix with calculated values for <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><mi>M</mi><mrow><mo>(</mo><mrow><mi>t</mi><mo>,</mo><mi>y</mi></mrow><mo>)</mo></mrow></mrow></math></span></span>.</p></li><li><p>A handle to a function that computes the matrix elements and that accepts
                    two input arguments, <code class="literal">M = Mass(t,y)</code>. To give the function
                    access to parameter values stored in the <code class="property">Parameters</code>
                    property, specify a third input argument in the function definition, <code class="literal">M
                      = Mass(t,y,p)</code>.</p></li></ul></div><p>
If you specify a matrix or function handle, then MATLAB converts it to an <code class="object">odeMassMatrix</code> object.</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">F.MassMatrix = @Mass</code> specifies the function
                <code class="literal">Mass</code> that evaluates the mass matrix.</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">F.MassMatrix = [1 0; -2 1]</code> specifies a constant mass
              matrix.</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">F.MassMatrix =
                odeMassMatrix(MassMatrix=@Mass,StateDependence="strong",SparsityPattern=S)</code>
              specifies a state-dependent mass matrix and the sparsity pattern when the mass matrix
              multiplies a vector.</p></div><p class="datatypelist"><strong>Data Types: </strong><code>single</code> | <code>double</code> | <code>function_handle</code><br/>
<strong>Complex Number Support: </strong>Yes</p></div></div></div></div></div></div><div id="mw_e6e8b658-7108-441b-87ad-dc99bbf3473a_div" class="refsect2"><h3 id="mw_e6e8b658-7108-441b-87ad-dc99bbf3473a">Advanced Problem Definition</h3><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item " itemscope="" itemprop="property" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/PropertyReference" itemid="mw_0934d70d-1280-48bc-8c5f-c3793df4d403"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_0934d70d-1280-48bc-8c5f-c3793df4d403" data-bs-target="#expand_accordion_body_mw_0934d70d-1280-48bc-8c5f-c3793df4d403" aria-controls="expand_accordion_body_mw_0934d70d-1280-48bc-8c5f-c3793df4d403" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="prop_EquationType" class="anchor_target"></span><h3 id="mw_0934d70d-1280-48bc-8c5f-c3793df4d403"><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/ReferenceEntity" itemprop="refentityobj"><meta itemprop="refentity" content="property:ode.EquationType"><code itemprop="name" id="propname_EquationType">EquationType</code></span> &#8212; <span itemprop="purpose">Equation form</span><br/>
<span class="add_font_color_general remove_bold"><span class="example_desc" itemprop="inputvalues"><span itemprop="inputvalue defaultvalue"><code class="literal">"standard"</code></span> (default) | <span itemprop="inputvalue"><code class="literal">"fullyimplicit"</code></span> | <span itemprop="inputvalue"><code class="literal">"delay"</code></span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_0934d70d-1280-48bc-8c5f-c3793df4d403" aria-labelledby="expand_accordion_heading_mw_0934d70d-1280-48bc-8c5f-c3793df4d403" class="accordion-collapse collapse"><div class="accordion-body"><p><em>Since R2024b</em></p><div class="cshsummary" id="csh_mw_0934d70d-1280-48bc-8c5f-c3793df4d403"><p>Equation form, specified as one of these options:</p>
<div class="itemizedlist"><ul><li><p><code class="literal">"standard"</code> for standard ordinary differential equations
                    (ODEs)</p></li><li><p><code class="literal">"fullyimplicit"</code> for implicit ODEs, that is, a system of
                    differential equations of the form <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><mi>f</mi><mrow><mo>(</mo><mrow><mi>t</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>'</mo></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn></mrow></math></span></span>.  If you specify the Jacobian when the
                      <code class="property">EquationType</code> property is
                      <code class="literal">"fullyimplicit"</code>, the Jacobian must be a function handle or
                    cell array.</p></li><li><p><code class="literal">"delay"</code> for delay
                    differential equations (DDEs), that is, a system of differential equations of
                    the form <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><msup><mi>y</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mrow><mo>(</mo><mrow><mi>t</mi><mo>,</mo><mi>y</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>,</mo><mi>y</mi><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><msub><mi>τ</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>,</mo><mn>...</mn><mo>,</mo><mi>y</mi><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><msub><mi>τ</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow></mrow></math></span></span>, <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><msup><mi>y</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mrow><mo>(</mo><mrow><mi>t</mi><mo>,</mo><mi>y</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>,</mo><mi>y</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>,</mo><mn>...</mn><mo>,</mo><mi>y</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow></mrow></math></span></span>, or <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-9px" display="block"><mrow><msup><mi>y</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>t</mi><mo>,</mo><mi>y</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>,</mo><mi>y</mi><mo stretchy="false">(</mo><mi>d</mi><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>,</mo><mn>...</mn><mo>,</mo><mi>y</mi><mo stretchy="false">(</mo><mi>d</mi><msub><mi>y</mi><mi>p</mi></msub><mo stretchy="false">)</mo><mo>,</mo><msup><mi>y</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>d</mi><mi>y</mi><msub><mi>p</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>,</mo><mn>...</mn><mo>,</mo><msup><mi>y</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>d</mi><mi>y</mi><msub><mi>p</mi><mi>q</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></math></span></span>.<em> (since R2025a)</em></p></li></ul></div><p>
</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item " itemscope="" itemprop="property" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/PropertyReference" itemid="mw_cf23892c-3ead-41c8-b61b-8021610e548f"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_cf23892c-3ead-41c8-b61b-8021610e548f" data-bs-target="#expand_accordion_body_mw_cf23892c-3ead-41c8-b61b-8021610e548f" aria-controls="expand_accordion_body_mw_cf23892c-3ead-41c8-b61b-8021610e548f" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="prop_Jacobian" class="anchor_target"></span><h3 id="mw_cf23892c-3ead-41c8-b61b-8021610e548f"><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/ReferenceEntity" itemprop="refentityobj"><meta itemprop="refentity" content="property:ode.Jacobian"><code itemprop="name" id="propname_Jacobian">Jacobian</code></span> &#8212; <span itemprop="purpose">Jacobian matrix</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc" itemprop="inputvalues"><span itemprop="inputvalue"><code class="object">odeJacobian</code> object</span> | <span itemprop="inputvalue">matrix</span> | <span itemprop="inputvalue">cell array</span> | <span itemprop="inputvalue">function handle</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_cf23892c-3ead-41c8-b61b-8021610e548f" aria-labelledby="expand_accordion_heading_mw_cf23892c-3ead-41c8-b61b-8021610e548f" class="accordion-collapse collapse"><div class="accordion-body"><div class="cshsummary" id="csh_mw_cf23892c-3ead-41c8-b61b-8021610e548f"><p>Jacobian matrix, specified as an <a href="odejacobian.html"><code class="object">odeJacobian</code></a>
              object, matrix, cell array, or handle to a function that evaluates the Jacobian. The
              Jacobian is a matrix of partial derivatives of the functions that define the system of
              differential equations.</p><div id="d126e1220968" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-57px" display="block"><mrow><mi>J</mi><mo>=</mo><mfrac><mrow><mo>∂</mo><mi>f</mi></mrow><mrow><mo>∂</mo><mi>y</mi></mrow></mfrac><mo>=</mo><mrow><mo>[</mo><mrow><mtable><mtr><mtd><mrow><mfrac><mrow><mo>∂</mo><msub><mi>f</mi><mn>1</mn></msub></mrow><mrow><mo>∂</mo><msub><mi>y</mi><mn>1</mn></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mfrac><mrow><mo>∂</mo><msub><mi>f</mi><mn>1</mn></msub></mrow><mrow><mo>∂</mo><msub><mi>y</mi><mn>2</mn></msub></mrow></mfrac></mrow></mtd><mtd><mo>&#x22EF;</mo></mtd></mtr><mtr><mtd><mrow><mfrac><mrow><mo>∂</mo><msub><mi>f</mi><mn>2</mn></msub></mrow><mrow><mo>∂</mo><msub><mi>y</mi><mn>1</mn></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mfrac><mrow><mo>∂</mo><msub><mi>f</mi><mn>2</mn></msub></mrow><mrow><mo>∂</mo><msub><mi>y</mi><mn>2</mn></msub></mrow></mfrac></mrow></mtd><mtd><mo>&#x22EF;</mo></mtd></mtr><mtr><mtd><mo>&#x22EE;</mo></mtd><mtd><mo>&#x22EE;</mo></mtd><mtd><mrow/></mtd></mtr></mtable></mrow><mo>]</mo></mrow></mrow></math></p></div></div><p>For stiff ODE problems, providing information about the Jacobian matrix is
              critical for reliability and efficiency of the solver. If you do not provide the
              Jacobian, then the ODE solver approximates it numerically using finite
              differences.</p><p>For large systems of equations where it is not feasible to provide the entire
              analytic Jacobian, you can specify the sparsity pattern of the Jacobian matrix
              instead. The solver uses the sparsity pattern to calculate a sparse Jacobian.</p><p>You can specify the <code class="property">Jacobian</code> property as:</p>
<div class="itemizedlist"><ul><li><p>An <code class="object">odeJacobian</code> object, which can represent either the
                    Jacobian matrix or its sparsity pattern.</p></li><li><p>A constant matrix with calculated values for <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-16px" display="block"><mrow><mfrac><mrow><mo>∂</mo><mi>f</mi></mrow><mrow><mo>∂</mo><mi>y</mi></mrow></mfrac></mrow></math></span></span>.</p></li><li><p>When <code class="argument">EquationType</code>
                    is <code class="literal">"fullyimplicit"</code>, a two-element cell array with calculated
                    values for the constant Jacobian with respect to <code class="literal">y</code> in the
                    first element and <code class="literal">yp</code> in the second element. If you specify
                    one of the elements as <code class="literal">[]</code>, the ODE solver approximates the
                    corresponding Jacobian numerically while taking the provided values in the other
                    element into account.<em> (since R2024b)</em></p></li><li><p>A handle to a function that computes the matrix elements and that accepts
                    two input arguments, <code class="literal">dfdy = Fjac(t,y)</code>. To give the function
                    access to parameter values in the <code class="property">Parameters</code> property,
                    specify a third input argument in the function definition, <code class="literal">dfdy =
                      Fjac(t,y,p)</code>.</p></li><li><p>When <code class="argument">EquationType</code>
                    is <code class="literal">"fullyimplicit"</code>, a handle to a function that computes the
                    matrix elements and that accepts three input arguments, <code class="literal">[dfdy,dfdp] =
                      Fjac(t,y,yp)</code>. To give the function access to parameter values in the
                      <code class="property">Parameters</code> property, specify a fourth input argument in
                    the function definition, <code class="literal">[dfdy,dfdp] = Fjac(t,y,yp,p)</code>.<em> (since R2024b)</em></p></li></ul></div><p>
If you specify a matrix, function handle, or cell array, then
                MATLAB converts it to an <code class="object">odeJacobian</code> object.</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">F.Jacobian = @Fjac</code> specifies the function
                <code class="literal">Fjac</code> that evaluates the Jacobian matrix.</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">F.Jacobian = [0 1; -2 1]</code> specifies a constant Jacobian
              matrix.</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">F.Jacobian = odeJacobian(SparsityPattern=S)</code> specifies
              the Jacobian sparsity pattern using sparse matrix <code class="literal">S</code>.</p></div><p class="datatypelist"><strong>Data Types: </strong><code>single</code> | <code>double</code> | <code>function_handle</code><br/>
<strong>Complex Number Support: </strong>Yes</p></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item " itemscope="" itemprop="property" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/PropertyReference" itemid="mw_91e08700-6874-41b1-9cf6-e738c20834b2"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_91e08700-6874-41b1-9cf6-e738c20834b2" data-bs-target="#expand_accordion_body_mw_91e08700-6874-41b1-9cf6-e738c20834b2" aria-controls="expand_accordion_body_mw_91e08700-6874-41b1-9cf6-e738c20834b2" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="prop_EventDefinition" class="anchor_target"></span><h3 id="mw_91e08700-6874-41b1-9cf6-e738c20834b2"><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/ReferenceEntity" itemprop="refentityobj"><meta itemprop="refentity" content="property:ode.EventDefinition"><code itemprop="name" id="propname_EventDefinition">EventDefinition</code></span> &#8212; <span itemprop="purpose">Events to detect</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc" itemprop="inputvalues"><span itemprop="inputvalue"><code class="object">odeEvent</code> object</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_91e08700-6874-41b1-9cf6-e738c20834b2" aria-labelledby="expand_accordion_heading_mw_91e08700-6874-41b1-9cf6-e738c20834b2" class="accordion-collapse collapse"><div class="accordion-body"><div class="cshsummary" id="csh_mw_91e08700-6874-41b1-9cf6-e738c20834b2"><p>Events to detect, specified as an <a href="odeevent.html"><code class="object">odeEvent</code></a>
              object. Create an <code class="object">odeEvent</code> object to define expressions that trigger
              an event when they cross zero. You can specify the direction of the zero crossing and
              what to do when an event triggers, including the use of a callback function.</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item " itemscope="" itemprop="property" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/PropertyReference" itemid="mw_f6945c9e-74d1-445f-a89e-c7ef3d68b0d6"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_f6945c9e-74d1-445f-a89e-c7ef3d68b0d6" data-bs-target="#expand_accordion_body_mw_f6945c9e-74d1-445f-a89e-c7ef3d68b0d6" aria-controls="expand_accordion_body_mw_f6945c9e-74d1-445f-a89e-c7ef3d68b0d6" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="prop_NonNegativeVariables" class="anchor_target"></span><h3 id="mw_f6945c9e-74d1-445f-a89e-c7ef3d68b0d6"><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/ReferenceEntity" itemprop="refentityobj"><meta itemprop="refentity" content="property:ode.NonNegativeVariables"><code itemprop="name" id="propname_NonNegativeVariables">NonNegativeVariables</code></span> &#8212; <span itemprop="purpose">Nonnegative solution components</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc" itemprop="inputvalues"><span itemprop="inputvalue">scalar index</span> | <span itemprop="inputvalue">vector of indices</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_f6945c9e-74d1-445f-a89e-c7ef3d68b0d6" aria-labelledby="expand_accordion_heading_mw_f6945c9e-74d1-445f-a89e-c7ef3d68b0d6" class="accordion-collapse collapse"><div class="accordion-body"><div class="cshsummary" id="csh_mw_f6945c9e-74d1-445f-a89e-c7ef3d68b0d6"><p> Nonnegative solution components, specified as a scalar index or vector of
              indices. Use the <code class="property">NonNegativeVariables</code> property to specify which
              solutions the solver must keep nonnegative. If <code class="literal">dydt = ODEFcn(t,y)</code>,
              then the indices correspond to elements in the vector <code class="literal">y</code>. For
              example, if you specify a value of <code class="literal">3</code>, then the solver keeps the
              solution component <code class="literal">y(3)</code> nonnegative.</p><div class="alert alert-info d-inline-block"><span class="alert_icon icon-alert-info-reverse"></span><p class="alert_heading"><strong>Note</strong></p><p><code class="literal">NonNegativeVariables</code> is not available for the
                  <code class="function">ode23s</code> solver. Additionally, for <code class="function">ode15s</code>,
                  <code class="function">ode23t</code>, and <code class="function">ode23tb</code> the property is not
                available for problems that have a mass matrix.</p></div><p class="description_valueexample"><strong>Example: </strong><code class="literal">F.NonNegativeVariables = [1 3]</code> specifies that the first
              and third solution components must be kept nonnegative.</p></div><p class="datatypelist"><strong>Data Types: </strong><code>single</code> | <code>double</code> | <code>int8</code> | <code>int16</code> | <code>int32</code> | <code>int64</code> | <code>uint8</code> | <code>uint16</code> | <code>uint32</code> | <code>uint64</code></p></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item " itemscope="" itemprop="property" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/PropertyReference" itemid="mw_45f915a7-38c9-49f8-b6f0-dacd51c74fa2"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_45f915a7-38c9-49f8-b6f0-dacd51c74fa2" data-bs-target="#expand_accordion_body_mw_45f915a7-38c9-49f8-b6f0-dacd51c74fa2" aria-controls="expand_accordion_body_mw_45f915a7-38c9-49f8-b6f0-dacd51c74fa2" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="prop_InitialSlope" class="anchor_target"></span><h3 id="mw_45f915a7-38c9-49f8-b6f0-dacd51c74fa2"><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/ReferenceEntity" itemprop="refentityobj"><meta itemprop="refentity" content="property:ode.InitialSlope"><code itemprop="name" id="propname_InitialSlope">InitialSlope</code></span> &#8212; <span itemprop="purpose">Initial value of <code class="literal">dy/dt</code></span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc" itemprop="inputvalues"><span itemprop="inputvalue">vector</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_45f915a7-38c9-49f8-b6f0-dacd51c74fa2" aria-labelledby="expand_accordion_heading_mw_45f915a7-38c9-49f8-b6f0-dacd51c74fa2" class="accordion-collapse collapse"><div class="accordion-body"><div class="cshsummary" id="csh_mw_45f915a7-38c9-49f8-b6f0-dacd51c74fa2"><p>Initial value of <code class="literal">dy/dt</code>, specified as a vector. Use this
              property with the <code class="function">ode15s</code> and <code class="function">ode23t</code> solvers
              when solving DAEs. The specified vector is the initial slope <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-7px" display="block"><mrow><mi>y</mi><msub><mo>'</mo><mn>0</mn></msub></mrow></math></span></span> such that <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><mi>M</mi><mrow><mo>(</mo><mrow><msub><mi>t</mi><mn>0</mn></msub><mo>,</mo><msub><mi>y</mi><mn>0</mn></msub></mrow><mo>)</mo></mrow><mi>y</mi><msub><mo>'</mo><mn>0</mn></msub><mo>=</mo><mi>f</mi><mrow><mo>(</mo><mrow><msub><mi>t</mi><mn>0</mn></msub><mo>,</mo><msub><mi>y</mi><mn>0</mn></msub></mrow><mo>)</mo></mrow></mrow></math></span></span>. If the specified initial conditions are not consistent with the
                <code class="property">InitialTime</code>, <code class="property">InitialValue</code>, and
                <code class="property">MassMatrix</code> properties, then the solver treats them as guesses
              and attempts to compute consistent values for the initial slopes that are close to the
              guesses before continuing to solve the problem. For more information, see <a href="../math/solve-differential-algebraic-equations-daes.html" class="a">Solve Differential Algebraic Equations (DAEs)</a>.</p></div><p class="datatypelist"><strong>Data Types: </strong><code>single</code> | <code>double</code></p></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item " itemscope="" itemprop="property" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/PropertyReference" itemid="mw_0e78803b-a202-4fc4-aa54-0afbcf2f2ec1"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_0e78803b-a202-4fc4-aa54-0afbcf2f2ec1" data-bs-target="#expand_accordion_body_mw_0e78803b-a202-4fc4-aa54-0afbcf2f2ec1" aria-controls="expand_accordion_body_mw_0e78803b-a202-4fc4-aa54-0afbcf2f2ec1" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="prop_Sensitivity" class="anchor_target"></span><h3 id="mw_0e78803b-a202-4fc4-aa54-0afbcf2f2ec1"><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/ReferenceEntity" itemprop="refentityobj"><meta itemprop="refentity" content="property:ode.Sensitivity"><code itemprop="name" id="propname_Sensitivity">Sensitivity</code></span> &#8212; <span itemprop="purpose">Sensitivity analysis information</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc" itemprop="inputvalues"><span itemprop="inputvalue"><code class="object">odeSensitivity</code> object</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_0e78803b-a202-4fc4-aa54-0afbcf2f2ec1" aria-labelledby="expand_accordion_heading_mw_0e78803b-a202-4fc4-aa54-0afbcf2f2ec1" class="accordion-collapse collapse"><div class="accordion-body"><div class="cshsummary" id="csh_mw_0e78803b-a202-4fc4-aa54-0afbcf2f2ec1"><p>Sensitivity analysis information, specified as an <code class="object">odeSensitivity</code>
              object. The ODE solver performs sensitivity analysis only when the
                <code class="property">Sensitivity</code> property is nonempty. The analysis is with respect
              to the <code class="property">Parameters</code> property, which must be nonempty and numeric.
              See <a href="odesensitivity.html"><code class="object">odeSensitivity</code></a> for more information.</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">F.Sensitivity = odeSensitivity</code> performs sensitivity
              analysis on all parameters.</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">F.Sensitivity = odeSensitivity(ParameterIndices=1:2)</code>
              performs sensitivity analysis on the first two parameters.</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item " itemscope="" itemprop="property" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/PropertyReference" itemid="mw_3b714824-6e15-438f-8894-ee839743ba75"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_3b714824-6e15-438f-8894-ee839743ba75" data-bs-target="#expand_accordion_body_mw_3b714824-6e15-438f-8894-ee839743ba75" aria-controls="expand_accordion_body_mw_3b714824-6e15-438f-8894-ee839743ba75" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="prop_DelayDefinition" class="anchor_target"></span><h3 id="mw_3b714824-6e15-438f-8894-ee839743ba75"><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/ReferenceEntity" itemprop="refentityobj"><meta itemprop="refentity" content="property:ode.DelayDefinition"><code itemprop="name" id="propname_DelayDefinition">DelayDefinition</code></span> &#8212; <span itemprop="purpose">DDE delay information</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc" itemprop="inputvalues"><span itemprop="inputvalue"><code class="object">odeDelay</code> object</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_3b714824-6e15-438f-8894-ee839743ba75" aria-labelledby="expand_accordion_heading_mw_3b714824-6e15-438f-8894-ee839743ba75" class="accordion-collapse collapse"><div class="accordion-body"><p><em>Since R2025a</em></p><div class="cshsummary" id="csh_mw_3b714824-6e15-438f-8894-ee839743ba75"><p>DDE delay information, specified as an <code class="object">odeDelay</code> object. To solve
              a DDE using the ODE solver, you must specify the <code class="property">DelayDefinition</code>
              property. See <a href="matlab.ode.odedelay.html"><code class="object">odeDelay</code></a>
              for more information.</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">F.DelayDefinition = odeDelay(ValueDelay=[2; 1],History=[0.1;
                0.5])</code> specifies a DDE that has solution delays <code class="literal">[2; 1]</code>
              and solution history <code class="literal">[0.1; 0.5]</code>.</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item " itemscope="" itemprop="property" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/PropertyReference" itemid="mw_38a1c3ce-2ca9-4249-a1d5-6e2a352c2d7d"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_38a1c3ce-2ca9-4249-a1d5-6e2a352c2d7d" data-bs-target="#expand_accordion_body_mw_38a1c3ce-2ca9-4249-a1d5-6e2a352c2d7d" aria-controls="expand_accordion_body_mw_38a1c3ce-2ca9-4249-a1d5-6e2a352c2d7d" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="prop_SeparateComplexParts" class="anchor_target"></span><h3 id="mw_38a1c3ce-2ca9-4249-a1d5-6e2a352c2d7d"><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/ReferenceEntity" itemprop="refentityobj"><meta itemprop="refentity" content="property:ode.SeparateComplexParts"><code itemprop="name" id="propname_SeparateComplexParts">SeparateComplexParts</code></span> &#8212; <span itemprop="purpose">Separate complex ODE equation into real and imaginary parts while             solving</span><br/>
<span class="add_font_color_general remove_bold"><span class="example_desc" itemprop="inputvalues"><span itemprop="inputvalue">on/off logical value</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_38a1c3ce-2ca9-4249-a1d5-6e2a352c2d7d" aria-labelledby="expand_accordion_heading_mw_38a1c3ce-2ca9-4249-a1d5-6e2a352c2d7d" class="accordion-collapse collapse"><div class="accordion-body"><p><em>Since R2025a</em></p><div class="cshsummary" id="csh_mw_38a1c3ce-2ca9-4249-a1d5-6e2a352c2d7d"><p>Separate complex ODE equation into real and imaginary parts while solving,
              specified as <code class="literal">"off"</code> or <code class="literal">"on"</code>, or as a numeric or
              logical <code class="literal">1</code> (<code class="literal">true</code>) or <code class="literal">0</code>
                (<code class="literal">false</code>). A value of <code class="literal">"on"</code> is equivalent to
                <code class="literal">true</code>, and <code class="literal">"off"</code> is equivalent to
                <code class="literal">false</code>. Thus, you can use the value of this property as a logical
              value. The value is stored as an on/off logical value of type <a href="matlab.lang.onoffswitchstate-class.html"><code class="class">OnOffSwitchState</code></a>.</p><p>When <code class="argument">SeparateComplexParts</code> is specified as
                <code class="literal">"on"</code>, each variable of the complex ODE equation is split into
              real and imaginary parts while solving and then combined at the end. Use this property
              when the ODE is complex and the selected solver fails or takes a long time to
              converge. Specifying <code class="argument">SeparateComplexParts</code> is especially helpful
              for solving implicit and stiff ODEs where the Jacobian is not specified. For more
              information on how a complex ODE equation is split into real and imaginary parts, see
                <a href="../math/choose-an-ode-solver.html#bu8f_6x" class="a">Complex ODEs</a>.</p></div></div></div></div></div></div></div><div id="mw_f50792d1-9d0a-4cb9-a7b8-819dc8d4a992_div" class="refsect2"><h3 id="mw_f50792d1-9d0a-4cb9-a7b8-819dc8d4a992">Solver Control</h3><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item " itemscope="" itemprop="property" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/PropertyReference" itemid="mw_c6c5fc76-3a96-4e41-b8ca-aab381dde9f5"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_c6c5fc76-3a96-4e41-b8ca-aab381dde9f5" data-bs-target="#expand_accordion_body_mw_c6c5fc76-3a96-4e41-b8ca-aab381dde9f5" aria-controls="expand_accordion_body_mw_c6c5fc76-3a96-4e41-b8ca-aab381dde9f5" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="prop_Solver" class="anchor_target"></span><h3 id="mw_c6c5fc76-3a96-4e41-b8ca-aab381dde9f5"><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/ReferenceEntity" itemprop="refentityobj"><meta itemprop="refentity" content="property:ode.Solver"><code itemprop="name" id="propname_Solver">Solver</code></span> &#8212; <span itemprop="purpose">Solver method</span><br/>
<span class="add_font_color_general remove_bold"><span class="example_desc" itemprop="inputvalues"><span itemprop="inputvalue defaultvalue"><code class="literal">"auto"</code></span> (default) | <span itemprop="inputvalue"><code class="literal">"stiff"</code></span> | <span itemprop="inputvalue"><code class="literal">"nonstiff"</code></span> | <span itemprop="inputvalue">name of a solver</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_c6c5fc76-3a96-4e41-b8ca-aab381dde9f5" aria-labelledby="expand_accordion_heading_mw_c6c5fc76-3a96-4e41-b8ca-aab381dde9f5" class="accordion-collapse collapse"><div class="accordion-body"><div class="cshsummary" id="csh_mw_c6c5fc76-3a96-4e41-b8ca-aab381dde9f5"><p>Solver method, specified as one of the values in this table. To change the solver
              based on specified parameters after creating an <code class="object">ode</code> object, use the
                <a href="ode.selectsolver.html"><code class="function">selectSolver</code></a> function. For example, you can incorporate a stiffness
              detection heuristic when selecting a solver by using the
                <code class="function">selectSolver</code> function with its
                <code class="argument">DetectStiffness</code> name-value argument.</p><div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="50%"><col class="tcol2" width="50%"></colgroup><thead><tr><th>Value</th><th>Description</th></tr></thead><tbody><tr><td><p><code class="literal">"auto"</code></p></td><td><p>Automatically selects a solver based on available problem
                        information and tolerances. The <code class="property">SelectedSolver</code> property
                        shows the currently chosen solver, and the solver choice can change when you
                        update property values of the <code class="object">ode</code> object.</p></td></tr><tr><td><p><code class="literal">"stiff"</code></p></td><td><p>Similar to <code class="literal">"auto"</code> but chooses only from the
                        stiff solvers: <code class="literal">"ode15s"</code>, <code class="literal">"ode23s"</code>,
                          <code class="literal">"ode23t"</code>, <code class="literal">"ode23tb"</code>,
                          <code class="literal">"cvodesstiff"</code>,
                      <code class="literal">"idas"</code>.</p></td></tr><tr><td><p><code class="literal">"nonstiff"</code></p></td><td><p>Similar to <code class="literal">"auto"</code> but chooses only from the
                        nonstiff solvers: <code class="literal">"ode23"</code>, <code class="literal">"ode45"</code>,
                          <code class="literal">"ode78"</code>, <code class="literal">"ode89"</code>,
                          <code class="literal">"ode113"</code>,
                      <code class="literal">"cvodesnonstiff"</code>.</p></td></tr><tr><td><p><code class="literal">"ode23"</code></p></td><td><p>Runge-Kutta (2,3) pair. See <a href="ode23.html"><code class="function">ode23</code></a>.</p></td></tr><tr><td><p><code class="literal">"ode45"</code></p></td><td><p>Runge-Kutta (4,5) pair. See <a href="ode45.html"><code class="function">ode45</code></a>.</p></td></tr><tr><td><p><code class="literal">"ode78"</code></p></td><td><p>Runge-Kutta 8(7) pair with a 7th-order continuous extension. See
                          <a href="ode78.html"><code class="function">ode78</code></a>.</p></td></tr><tr><td><p><code class="literal">"ode89"</code></p></td><td><p>Runge-Kutta 9(8) pair with an 8th-order continuous extension. See
                          <a href="ode89.html"><code class="function">ode89</code></a>.</p></td></tr><tr><td><p><code class="literal">"ode113"</code></p></td><td><p>Variable-step, variable-order (VSVO) solver of orders 1 to 13. See
                          <a href="ode113.html"><code class="function">ode113</code></a>.</p></td></tr><tr><td><p><code class="literal">"ode15s"</code></p></td><td><p>Variable-step, variable-order (VSVO) solver based on the numerical
                        differentiation formulas (NDFs) of orders 1 to 5. See <a href="ode15s.html"><code class="function">ode15s</code></a>.</p></td></tr><tr><td><p><code class="literal">"ode23s"</code></p></td><td><p>Modified Rosenbrock formula of order 2. See <a href="ode23s.html"><code class="function">ode23s</code></a>.</p></td></tr><tr><td><p><code class="literal">"ode23t"</code></p></td><td><p>Trapezoidal rule using a “free” interpolant. See <a href="ode23t.html"><code class="function">ode23t</code></a>.</p></td></tr><tr><td><p><code class="literal">"ode23tb"</code></p></td><td><p>Implicit Runge-Kutta formula with a trapezoidal rule step as its
                        first stage and a backward differentiation formula of order 2 as its second
                        stage. See <a href="ode23tb.html"><code class="function">ode23tb</code></a>.</p></td></tr><tr><td><p><code class="literal">"ode15i"</code><em> (since R2024b)</em></p></td><td><p>Variable-step, variable order (VSVO) solver based on the backward
                        differentiation formulas (BDFs) of orders 1 to 5. See <a href="ode15i.html"><code class="function">ode15i</code></a>.</p></td></tr><tr><td><p><code class="literal">"cvodesnonstiff"</code></p></td><td><p>Variable-step, variable-order (VSVO) solver using Adams-Moulton
                        formulas, with the order varying between 1 and 12. Supports sensitivity
                        analysis. See <a href="https://computing.llnl.gov/projects/sundials/cvode" target="_blank">CVODE</a> and <a href="https://computing.llnl.gov/projects/sundials/cvodes" target="_blank">CVODES</a>.</p></td></tr><tr><td><p><code class="literal">"cvodesstiff"</code></p></td><td><p>Variable-step, variable-order (VSVO) solver using backward
                        differentiation formulas (BDFs) in fixed-leading coefficient form, with
                        order varying between 1 and 5. Supports sensitivity analysis. See <a href="https://computing.llnl.gov/projects/sundials/cvode" target="_blank">CVODE</a> and <a href="https://computing.llnl.gov/projects/sundials/cvodes" target="_blank">CVODES</a>.</p></td></tr><tr><td><p><code class="literal">"idas"</code></p></td><td><p>Variable-order, variable-coefficient solver using backward
                        differentiation formulas (BDFs) in fixed-leading coefficient form, with
                        order varying between 1 and 5. Supports sensitivity analysis. See <a href="https://computing.llnl.gov/projects/sundials/ida" target="_blank">IDA</a>
                        and <a href="https://computing.llnl.gov/projects/sundials/idas" target="_blank">IDAS</a>.</p></td></tr><tr><td><p><code class="literal">"dde23"</code><em> (since R2025a)</em></p></td><td><p>Runge-Kutta (2,3) pair. See <a href="dde23.html"><code class="function">dde23</code></a>.</p></td></tr><tr><td><p><code class="literal">"ddesd"</code><em> (since R2025a)</em></p></td><td><p>Fourth-order Runge-Kutta method. See <a href="ddesd.html"><code class="function">ddesd</code></a>.</p></td></tr><tr><td><p><code class="literal">"ddensd"</code><em> (since R2025a)</em></p></td><td><p>Neutral type delay solver. See <a href="ddensd.html"><code class="function">ddensd</code></a>.</p></td></tr></tbody></table></div></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item " itemscope="" itemprop="property" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/PropertyReference" itemid="mw_b3324731-72e8-406c-be27-658d5532a9d8"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_b3324731-72e8-406c-be27-658d5532a9d8" data-bs-target="#expand_accordion_body_mw_b3324731-72e8-406c-be27-658d5532a9d8" aria-controls="expand_accordion_body_mw_b3324731-72e8-406c-be27-658d5532a9d8" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="prop_SelectedSolver" class="anchor_target"></span><h3 id="mw_b3324731-72e8-406c-be27-658d5532a9d8"><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/ReferenceEntity" itemprop="refentityobj"><meta itemprop="refentity" content="property:ode.SelectedSolver"><code itemprop="name" id="propname_SelectedSolver">SelectedSolver</code></span> &#8212; <span itemprop="purpose">Selected solver</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc" itemprop="inputvalues">Read-only: <span itemprop="inputvalue">name of a solver</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_b3324731-72e8-406c-be27-658d5532a9d8" aria-labelledby="expand_accordion_heading_mw_b3324731-72e8-406c-be27-658d5532a9d8" class="accordion-collapse collapse"><div class="accordion-body"><p>This property is read-only.</p><div class="cshsummary" id="csh_mw_b3324731-72e8-406c-be27-658d5532a9d8"><p>Selected solver, returned as the name of a solver. If the value of
                <code class="property">Solver</code> is <code class="literal">"auto"</code>,
              <code class="literal">"stiff"</code>, or <code class="literal">"nonstiff"</code>, then the
                <code class="object">ode</code> object automatically chooses a solver and sets the value of
                <code class="property">SelectedSolver</code> to the name of the chosen solver. If you
              manually select a solver, then <code class="property">SelectedSolver</code> and
                <code class="property">Solver</code> have the same value.</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item " itemscope="" itemprop="property" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/PropertyReference" itemid="mw_649206c2-3480-4fc2-af28-95f386b19466"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_649206c2-3480-4fc2-af28-95f386b19466" data-bs-target="#expand_accordion_body_mw_649206c2-3480-4fc2-af28-95f386b19466" aria-controls="expand_accordion_body_mw_649206c2-3480-4fc2-af28-95f386b19466" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="prop_SolverOptions" class="anchor_target"></span><h3 id="mw_649206c2-3480-4fc2-af28-95f386b19466"><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/ReferenceEntity" itemprop="refentityobj"><meta itemprop="refentity" content="property:ode.SolverOptions"><code itemprop="name" id="propname_SolverOptions">SolverOptions</code></span> &#8212; <span itemprop="purpose">Solver-specific options</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc" itemprop="inputvalues"><span itemprop="inputvalue"><code class="object">matlab.ode.options.*</code> object</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_649206c2-3480-4fc2-af28-95f386b19466" aria-labelledby="expand_accordion_heading_mw_649206c2-3480-4fc2-af28-95f386b19466" class="accordion-collapse collapse"><div class="accordion-body"><div class="cshsummary" id="csh_mw_649206c2-3480-4fc2-af28-95f386b19466"><p>Solver-specific options, specified as a <code class="object">matlab.ode.options.*</code>
              object. The <code class="object">ode</code> object automatically populates the
                <code class="property">SolverOptions</code> property with an options object appropriate for
              the selected solver. You can check available options for an existing
                <code class="object">ode</code> object with the command
                <code class="literal">properties(F.SolverOptions)</code>. Specify options for the ODE problem
              by changing property values of the <code class="object">matlab.ode.options.*</code> object. For
              example, <code class="literal">F.SolverOptions.OutputFcn = @odeplot</code> specifies an output
              function that the solver calls after each successful time step.</p><p>When the <code class="property">Solver</code> property is <code class="literal">"auto"</code>,
                <code class="literal">"stiff"</code>, or <code class="literal">"nonstiff"</code>, the
                <code class="property">SolverOptions</code> property is read-only.</p><p>This table summarizes the available options for each solver.</p><div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="50%"><col class="tcol2" width="50%"></colgroup><thead><tr><th>Options Object</th><th>Properties</th></tr></thead><tbody><tr><td><p><a href="matlab.ode.options.ode23-properties.html"><code class="object">matlab.ode.options.ODE23 Properties</code></a></p><p><a href="matlab.ode.options.ode45-properties.html"><code class="object">matlab.ode.options.ODE45 Properties</code></a></p><p><a href="matlab.ode.options.ode78-properties.html"><code class="object">matlab.ode.options.ODE78 Properties</code></a></p><p><a href="matlab.ode.options.ode89-properties.html"><code class="object">matlab.ode.options.ODE89 Properties</code></a></p><p><a href="matlab.ode.options.ode113-properties.html"><code class="object">matlab.ode.options.ODE113 Properties</code></a></p></td><td>
                      <div class="itemizedlist"><ul><li><p><code class="property">InitialStep</code></p></li><li><p><code class="property">MaxStep</code></p></li><li><p><code class="property">MinStep</code></p></li><li><p><code class="property">NormControl</code></p></li><li><p><code class="property">OutputFcn</code></p></li><li><p><code class="property">OutputSelection</code></p></li></ul></div>
                    </td></tr><tr><td><p><a href="matlab.ode.options.ode15s-properties.html"><code class="object">matlab.ode.options.ODE15s Properties</code></a></p></td><td>
                      <div class="itemizedlist"><ul><li><p><code class="property">InitialStep</code></p></li><li><p><code class="property">MaxStep</code></p></li><li><p><code class="property">MinStep</code></p></li><li><p><code class="property">NormControl</code></p></li><li><p><code class="property">OutputFcn</code></p></li><li><p><code class="property">OutputSelection</code></p></li><li><p><code class="property">Vectorization</code></p></li><li><p><code class="property">BDF</code></p></li><li><p><code class="property">MaxOrder</code></p></li></ul></div>
                    </td></tr><tr><td><p><a href="matlab.ode.options.ode15i-properties.html"><code class="object">matlab.ode.options.ODE15i Properties</code></a><em> (since R2024b)</em></p></td><td>
                      <div class="itemizedlist"><ul><li><p><code class="property">InitialStep</code></p></li><li><p><code class="property">MaxStep</code></p></li><li><p><code class="property">MinStep</code></p></li><li><p><code class="property">NormControl</code></p></li><li><p><code class="literal"><code class="property">OutputFcn</code></code></p></li><li><p><code class="property">OutputSelection</code></p></li><li><p><code class="property">Vectorization</code></p></li><li><p><code class="property">MaxOrder</code></p></li><li><p><code class="property">ComputeConsistentInitialConditions</code></p></li></ul></div>
                    </td></tr><tr><td><p><a href="matlab.ode.options.ode23s-properties.html"><code class="object">matlab.ode.options.ODE23s Properties</code></a></p><p><a href="matlab.ode.options.ode23t-properties.html"><code class="object">matlab.ode.options.ODE23t Properties</code></a></p><p><a href="matlab.ode.options.ode23tb-properties.html"><code class="object">matlab.ode.options.ODE23tb Properties</code></a></p></td><td>
                      <div class="itemizedlist"><ul><li><p><code class="property">InitialStep</code></p></li><li><p><code class="property">MaxStep</code></p></li><li><p><code class="property">MinStep</code></p></li><li><p><code class="property">NormControl</code></p></li><li><p><code class="property">OutputFcn</code></p></li><li><p><code class="property">OutputSelection</code></p></li><li><p><code class="property">Vectorization</code></p></li></ul></div>
                    </td></tr><tr><td><p><a href="matlab.ode.options.cvodesnonstiff-properties.html"><code class="object">matlab.ode.options.CVODESNonstiff Properties</code></a></p><p><a href="matlab.ode.options.cvodesstiff-properties.html"><code class="object">matlab.ode.options.CVODESStiff Properties</code></a></p><p><a href="matlab.ode.options.idas-properties.html"><code class="object">matlab.ode.options.IDAS Properties</code></a></p></td><td>
                      <div class="itemizedlist"><ul><li><p><code class="property">InitialStep</code></p></li><li><p><code class="property">MaxStep</code></p></li><li><p><code class="property">MaxOrder</code></p></li></ul></div>
                    </td></tr><tr><td><p><a href="matlab.ode.options.dde23-properties.html"><code class="object">matlab.ode.options.DDE23 Properties</code></a><em> (since R2025a)</em></p></td><td>
                      <div class="itemizedlist"><ul><li><p><code class="property">InitialStep</code></p></li><li><p><code class="property">MaxStep</code></p></li><li><p><code class="property">MinStep</code></p></li><li><p><code class="property">NormControl</code></p></li><li><p><code class="property">OutputFcn</code></p></li><li><p><code class="property">OutputSelection</code></p></li><li><p><code class="property">Jumps</code></p></li></ul></div>
                    </td></tr><tr><td><p><a href="matlab.ode.options.ddesd-properties.html"><code class="object">matlab.ode.options.DDESD Properties</code></a><em> (since R2025a)</em></p></td><td>
                      <div class="itemizedlist"><ul><li><p><code class="property">InitialStep</code></p></li><li><p><code class="property">MaxStep</code></p></li><li><p><code class="property">MinStep</code></p></li><li><p><code class="property">NormControl</code></p></li><li><p><code class="property">OutputFcn</code></p></li><li><p><code class="property">OutputSelection</code></p></li></ul></div>
                    </td></tr><tr><td><p><a href="matlab.ode.options.ddensd-properties.html"><code class="object">matlab.ode.options.DDENSD Properties</code></a><em> (since R2025a)</em></p></td><td>
                      <div class="itemizedlist"><ul><li><p><code class="property">InitialStep</code></p></li><li><p><code class="property">MaxStep</code></p></li><li><p><code class="property">MinStep</code></p></li><li><p><code class="property">NormControl</code></p></li><li><p><code class="property">OutputFcn</code></p></li><li><p><code class="property">OutputSelection</code></p></li><li><p><code class="property">ComputeConsistentInitialConditions</code></p></li></ul></div>
                    </td></tr></tbody></table></div></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item " itemscope="" itemprop="property" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/PropertyReference" itemid="mw_52b5866a-e98c-4171-8d75-ef03b6222705"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_52b5866a-e98c-4171-8d75-ef03b6222705" data-bs-target="#expand_accordion_body_mw_52b5866a-e98c-4171-8d75-ef03b6222705" aria-controls="expand_accordion_body_mw_52b5866a-e98c-4171-8d75-ef03b6222705" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="prop_AbsoluteTolerance" class="anchor_target"></span><h3 id="mw_52b5866a-e98c-4171-8d75-ef03b6222705"><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/ReferenceEntity" itemprop="refentityobj"><meta itemprop="refentity" content="property:ode.AbsoluteTolerance"><code itemprop="name" id="propname_AbsoluteTolerance">AbsoluteTolerance</code></span> &#8212; <span itemprop="purpose">Absolute error tolerance</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc" itemprop="inputvalues"><span itemprop="inputvalue defaultvalue"><code class="literal">1e-6</code></span> (default) | <span itemprop="inputvalue">positive scalar</span> | <span itemprop="inputvalue">vector</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_52b5866a-e98c-4171-8d75-ef03b6222705" aria-labelledby="expand_accordion_heading_mw_52b5866a-e98c-4171-8d75-ef03b6222705" class="accordion-collapse collapse"><div class="accordion-body"><div class="cshsummary" id="csh_mw_52b5866a-e98c-4171-8d75-ef03b6222705"><p>Absolute error tolerance, specified as a positive scalar or vector. This tolerance
              is a threshold below which the value of the solution becomes unimportant. If the
              solution <code class="literal">|y|</code> is less than <code class="property">AbsoluteTolerance</code>,
              then the solver does not need to obtain any correct digits in <code class="literal">|y|</code>.
              For this reason, keep in mind the scale of the solution components when setting the
              value of <code class="property">AbsoluteTolerance</code>.</p><p>If <code class="property">AbsoluteTolerance</code> is a vector, then it must be the same
              length as the number of solution components. If <code class="property">AbsoluteTolerance</code>
              is a scalar, then the value applies to all solution components.</p><p>At each step, the ODE solver estimates the local error <code class="literal">e</code> in the
                <code class="literal">i</code>th component of the solution. To be successful, the step must
              have an acceptable error, as determined by both the relative and absolute error
              tolerances:</p><div class="code_responsive"><pre class="programlisting">|e(i)| &lt;= max(RelativeTolerance*abs(y(i)),AbsoluteTolerance(i))</pre></div></div><p class="datatypelist"><strong>Data Types: </strong><code>single</code> | <code>double</code></p></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item " itemscope="" itemprop="property" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/PropertyReference" itemid="mw_96200053-bf31-4d97-bafa-a211b2186adc"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_96200053-bf31-4d97-bafa-a211b2186adc" data-bs-target="#expand_accordion_body_mw_96200053-bf31-4d97-bafa-a211b2186adc" aria-controls="expand_accordion_body_mw_96200053-bf31-4d97-bafa-a211b2186adc" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="prop_RelativeTolerance" class="anchor_target"></span><h3 id="mw_96200053-bf31-4d97-bafa-a211b2186adc"><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/ReferenceEntity" itemprop="refentityobj"><meta itemprop="refentity" content="property:ode.RelativeTolerance"><code itemprop="name" id="propname_RelativeTolerance">RelativeTolerance</code></span> &#8212; <span itemprop="purpose">Relative error tolerance</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc" itemprop="inputvalues"><span itemprop="inputvalue defaultvalue"><code class="literal">1e-3</code></span> (default) | <span itemprop="inputvalue">positive scalar</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_96200053-bf31-4d97-bafa-a211b2186adc" aria-labelledby="expand_accordion_heading_mw_96200053-bf31-4d97-bafa-a211b2186adc" class="accordion-collapse collapse"><div class="accordion-body"><div class="cshsummary" id="csh_mw_96200053-bf31-4d97-bafa-a211b2186adc"><p>Relative error tolerance, specified as a positive scalar. This tolerance measures
              the error relative to the magnitude of each solution component. The relative error
              tolerance controls the number of correct digits in all solution components, except
              those smaller than <code class="property">AbsoluteTolerance</code>.</p><p>At each step, the ODE solver estimates the local error <code class="literal">e</code> in the
                <code class="literal">i</code>th component of the solution. To be successful, the step must
              have an acceptable error, as determined by both the relative and absolute error
              tolerances:</p><div class="code_responsive"><pre class="programlisting">|e(i)| &lt;= max(RelativeTolerance*abs(y(i)),AbsoluteTolerance(i))</pre></div></div><p class="datatypelist"><strong>Data Types: </strong><code>single</code> | <code>double</code></p></div></div></div></div></div></div></div></div></div></div><div id="mw_2f7f0c38-a4d9-4665-b19f-352884f661c8_div" class="refsect1 objectfunctions"><h2 id="mw_2f7f0c38-a4d9-4665-b19f-352884f661c8">Object Functions</h2><div class="doc_classesgroup_container"><div class="table-responsive"><table class="table table-bordered table-condensed"><tbody><tr><td class="term notranslate"><a href="ode.solve.html"><code class="function">solve</code></a></td><td class="description">Solve ODE over interval or at specified points</td></tr><tr><td class="term notranslate"><a href="ode.solutionfcn.html"><code class="function">solutionFcn</code></a></td><td class="description">Construct function that interpolates ODE solution</td></tr><tr><td class="term notranslate"><a href="ode.selectsolver.html"><code class="function">selectSolver</code></a></td><td class="description">Change ODE solver</td></tr></tbody></table></div></div>
</div><div class="examples"><h2 id="mw_a7d8f746-69fb-408d-9b33-d15b9c8bc7e5">Examples</h2><div class="expandableContent" id="expandableExamples"><p class="switch"><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true3">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_ec43c749-72a9-41d6-89c7-cde7b7458556"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_ec43c749-72a9-41d6-89c7-cde7b7458556" data-bs-target="#expand_accordion_body_mw_ec43c749-72a9-41d6-89c7-cde7b7458556" aria-controls="expand_accordion_body_mw_ec43c749-72a9-41d6-89c7-cde7b7458556" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_ec43c749-72a9-41d6-89c7-cde7b7458556">Solve Single ODE</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_ec43c749-72a9-41d6-89c7-cde7b7458556" aria-labelledby="expand_accordion_heading_mw_ec43c749-72a9-41d6-89c7-cde7b7458556" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/SolveSingleODEExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Solve Single ODE",
          "description": "Create an empty ode object, and then specify values for the ODEFcn and InitialValue properties.",
          "thumbnailURL": "../../examples/matlab/win64/SolveSingleODEExample_01.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "ode.html"

        },
          "identifier": "matlab.SolveSingleODEExample",
          "name": "SolveSingleODEExample",
          "url": "ode.html#mw_ec43c749-72a9-41d6-89c7-cde7b7458556"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/SolveSingleODEExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "SolveSingleODEExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Create an empty <code class="literal">ode</code> object, and then specify values for the <code class="literal">ODEFcn</code> and <code class="literal">InitialValue</code> properties.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>F = ode;
F.ODEFcn = @(t,y) 2*t;
F.InitialValue = 0;</pre></div></div></div><p>Check which solver is selected for the problem, and then solve the equation over the time range <code class="literal">[0 10]</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>F.SelectedSolver</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans = 
  SolverID enumeration

    ode45

</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>sol = solve(F,0,10)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>sol = 
  ODEResults with properties:

        Time: [0 0.2500 0.5000 0.7500 1 1.2500 1.5000 1.7500 2 2.2500 2.5000 2.7500 3 3.2500 3.5000 3.7500 4 4.2500 4.5000 4.7500 5 5.2500 5.5000 5.7500 6 6.2500 6.5000 6.7500 7 7.2500 7.5000 7.7500 8 8.2500 8.5000 8.7500 9 9.2500 9.5000 9.7500 10]
    Solution: [0 0.0625 0.2500 0.5625 1.0000 1.5625 2.2500 3.0625 4 5.0625 6.2500 7.5625 9 10.5625 12.2500 14.0625 16 18.0625 20.2500 22.5625 25 27.5625 30.2500 33.0625 36 39.0625 42.2500 45.5625 49 52.5625 56.2500 60.0625 64 68.0625 … ] (1×41 double)

</pre></div></div></div><p>Plot the results.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>plot(sol.Time,sol.Solution,<span style="color:#A020F0">"-o"</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e1222131" class="mediaobject"><p><img src="../../examples/matlab/win64/SolveSingleODEExample_01.png" alt="Figure contains an axes object. The axes object contains an object of type line." width="560"></p></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-SolveSingleODEExample"><meta itemprop="exampletitle" content="Solve Single ODE"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_233556dd-98eb-4db0-9cfa-a2c2f830248d"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_233556dd-98eb-4db0-9cfa-a2c2f830248d" data-bs-target="#expand_accordion_body_mw_233556dd-98eb-4db0-9cfa-a2c2f830248d" aria-controls="expand_accordion_body_mw_233556dd-98eb-4db0-9cfa-a2c2f830248d" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_233556dd-98eb-4db0-9cfa-a2c2f830248d">Solve Complex ODE</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_233556dd-98eb-4db0-9cfa-a2c2f830248d" aria-labelledby="expand_accordion_heading_mw_233556dd-98eb-4db0-9cfa-a2c2f830248d" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/SolveComplexODEExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Solve Complex ODE",
          "description": "Create an ode object that represents the complex ODE y′=yt+2i with initial value 1+i. Specify the ODEFcn, InitialValue, and SeparateComplexParts properties.",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "ode.html"

        },
          "identifier": "matlab.SolveComplexODEExample",
          "name": "SolveComplexODEExample",
          "url": "ode.html#mw_233556dd-98eb-4db0-9cfa-a2c2f830248d"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/SolveComplexODEExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "SolveComplexODEExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Create an <code class="literal">ode</code> object that represents the complex ODE <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mo>′</mo></mrow></msup><mo>=</mo><mi mathvariant="normal">yt</mi><mo>+</mo><mn>2</mn><mi mathvariant="italic">i</mi></mrow></math></span> with initial value <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mn>1</mn><mo>+</mo><mi mathvariant="italic">i</mi></mrow></math></span>. Specify the <code class="literal">ODEFcn</code>, <code class="literal">InitialValue</code>, and <code class="literal">SeparateComplexParts</code> properties.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>F = ode;
F.ODEFcn = @(t,y) y.*t + 2*1i;
F.InitialValue = 1+1i;
F.SeparateComplexParts = <span style="color:#A020F0">"on"</span>;</pre></div></div></div><p>Solve the ODE over the time range <code class="literal">[0 2]</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>sol = solve(F,0,2)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>sol = 
  ODEResults with properties:

        Time: [0 0.0251 0.0502 0.0754 0.1005 0.1505 0.2005 0.2505 0.3005 0.3505 0.4005 0.4505 0.5005 0.5505 0.6005 0.6505 0.7005 0.7505 0.8005 0.8505 0.9005 0.9505 1.0005 1.0505 1.1005 1.1505 1.2005 1.2505 1.3005 1.3505 1.4005 1.4505 … ] (1×45 double)
    Solution: [1.0000 + 1.0000i 1.0003 + 1.0506i 1.0013 + 1.1018i 1.0028 + 1.1538i 1.0051 + 1.2067i 1.0114 + 1.3146i 1.0203 + 1.4267i 1.0319 + 1.5434i 1.0462 + 1.6655i 1.0633 + 1.7937i 1.0835 + 1.9287i 1.1068 + 2.0712i 1.1334 + 2.2223i … ] (1×45 double)

</pre></div></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-SolveComplexODEExample"><meta itemprop="exampletitle" content="Solve Complex ODE"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_0cd92b80-8df9-4493-af9c-9a7e01c35b04"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_0cd92b80-8df9-4493-af9c-9a7e01c35b04" data-bs-target="#expand_accordion_body_mw_0cd92b80-8df9-4493-af9c-9a7e01c35b04" aria-controls="expand_accordion_body_mw_0cd92b80-8df9-4493-af9c-9a7e01c35b04" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_0cd92b80-8df9-4493-af9c-9a7e01c35b04">Specify Jacobian Matrix for Stiff ODE</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_0cd92b80-8df9-4493-af9c-9a7e01c35b04" aria-labelledby="expand_accordion_heading_mw_0cd92b80-8df9-4493-af9c-9a7e01c35b04" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/SpecifyJacobianMatrixForStiffODEExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Specify Jacobian Matrix for Stiff ODE",
          "description": "The Van der Pol oscillator equation is a second-order differential equation. The equation includes a parameter μ, and the equation becomes stiff when the value of μ is large.",
          "thumbnailURL": "../../examples/matlab/win64/SpecifyJacobianMatrixForStiffODEExample_01.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "ode.html"

        },
          "identifier": "matlab.SpecifyJacobianMatrixForStiffODEExample",
          "name": "SpecifyJacobianMatrixForStiffODEExample",
          "url": "ode.html#mw_0cd92b80-8df9-4493-af9c-9a7e01c35b04"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/SpecifyJacobianMatrixForStiffODEExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "SpecifyJacobianMatrixForStiffODEExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">The Van der Pol oscillator equation is a second-order differential equation. The equation includes a parameter <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi>μ</mi></mrow></math></span>, and the equation becomes stiff when the value of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi>μ</mi></mrow></math></span> is large.</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mfrac><mrow><msup><mrow><mi>d</mi></mrow><mrow><mn>2</mn></mrow></msup><mi>x</mi></mrow><mrow><mi>d</mi><msup><mrow><mi>t</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac><mo>-</mo><mi>μ</mi><mrow><mo>(</mo><mn>1</mn><mo>-</mo><msup><mrow><mi>x</mi></mrow><mrow><mn>2</mn></mrow></msup><mo>)</mo></mrow><mfrac><mrow><mi>d</mi><mi>x</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi>x</mi><mo>=</mo><mn>0</mn></mrow></math></p></div><p></p><p>Using the substitutions <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>=</mo><mi mathvariant="italic">x</mi></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>=</mo><mfrac><mrow><mi mathvariant="normal">dx</mi></mrow><mrow><mi mathvariant="normal">dt</mi></mrow></mfrac></mrow></math></span> produces a system of two first-order equations.</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mtable columnalign="left"><mtr><mtd><mrow><mfrac><mrow><mi>d</mi><msub><mrow><mi>y</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><msub><mrow><mi>y</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mfrac><mrow><mi>d</mi><msub><mrow><mi>y</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mi>μ</mi><mrow><mo>(</mo><mn>1</mn><mo>-</mo><msubsup><mrow><mi>y</mi></mrow><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></msubsup><mo>)</mo></mrow><msub><mrow><mi>y</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>-</mo><msub><mrow><mi>y</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></mtd></mtr></mtable></mrow></math></p></div><p></p><p>The Jacobian matrix for these equations is the matrix of partial derivatives of each equation with respect to both <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></math></span>. </p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>J</mi><mo>=</mo><mrow><mo>[</mo><mtable columnalign="center center center"><mtr><mtd><mrow><mfrac><mrow><mo>∂</mo><msub><mrow><mi>f</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mrow><mo>∂</mo><msub><mrow><mi>y</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mfrac><mrow><mo>∂</mo><msub><mrow><mi>f</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mrow><mo>∂</mo><msub><mrow><mi>y</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mfrac></mrow></mtd></mtr><mtr><mtd><mrow><mfrac><mrow><mo>∂</mo><msub><mrow><mi>f</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow><mrow><mo>∂</mo><msub><mrow><mi>y</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mfrac><mrow><mo>∂</mo><msub><mrow><mi>f</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow><mrow><mo>∂</mo><msub><mrow><mi>y</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mfrac></mrow></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable columnalign="center center center"><mtr><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mn>1</mn></mrow></mtd></mtr><mtr><mtd><mrow><mo>-</mo><mn>2</mn><mi>μ</mi><msub><mrow><mi>y</mi></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi>y</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>-</mo><mn>1</mn></mrow></mtd><mtd><mrow><mi>μ</mi><mrow><mo>(</mo><mn>1</mn><mo>-</mo><msubsup><mrow><mi>y</mi></mrow><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></msubsup><mo>)</mo></mrow></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow></math></p></div><p></p><p>Solve the Van der Pol oscillator using <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi>μ</mi><mo>=</mo><mn>1000</mn></mrow></math></span> and initial values of <code class="literal">[2; 0]</code> by creating an <code class="literal">ode</code> object to represent the problem. </p><div class="itemizedlist"><ul><li><p>Store the value of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi>μ</mi></mrow></math></span> in the <code class="literal">Parameters</code> property.</p></li><li><p>Specify the initial values in the <code class="literal">InitialValue</code> property.</p></li><li><p>Specify the system of equations in the <code class="literal">ODEFcn</code> property, specifying three input arguments so that the value for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi>μ</mi></mrow></math></span> is passed to the function.</p></li><li><p>Specify a function that calculates the Jacobian matrix in the <code class="literal">Jacobian</code> property, specifying three input arguments so that the value for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi>μ</mi></mrow></math></span> is passed to the function.</p></li></ul></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>F = ode;
F.Parameters = 1000;
F.InitialValue = [2; 0];
F.ODEFcn = @(t,y,p) [y(2); p(1)*(1-y(1)^2)*y(2)-y(1)];
F.Jacobian = @(t,y,p) [0 1; -2*p(1)*y(1)*y(2)-1  p(1)*(1-y(1)^2)];</pre></div></div></div><p>Display the <code class="literal">ode</code> object. The <code class="literal">SelectedSolver</code> property shows that the <code class="literal">ode15s</code> solver was automatically chosen for this problem.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>F</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>F = 
  ode with properties:

   Problem definition
               ODEFcn: @(t,y,p)[y(2);p(1)*(1-y(1)^2)*y(2)-y(1)]
           Parameters: 1000
          InitialTime: 0
         InitialValue: [2×1 double]
             Jacobian: [1×1 odeJacobian]
         EquationType: standard

   Solver properties
    AbsoluteTolerance: 1.0000e-06
    RelativeTolerance: 1.0000e-03
               Solver: auto
       SelectedSolver: ode15s

  Show all properties


</pre></div></div></div><p>Solve the system of equations over the time interval <code class="literal">[0 3000]</code> by using the <code class="literal">solve</code> method. Plot the first solution component.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>S = solve(F,0,3000);
plot(S.Time,S.Solution(1,:),<span style="color:#A020F0">"-o"</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e1222589" class="mediaobject"><p><img src="../../examples/matlab/win64/SpecifyJacobianMatrixForStiffODEExample_01.png" alt="Figure contains an axes object. The axes object contains an object of type line." width="560"></p></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-SpecifyJacobianMatrixForStiffODEExample"><meta itemprop="exampletitle" content="Specify Jacobian Matrix for Stiff ODE"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_b433527e-3289-4fb2-8282-428b434052e6"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_b433527e-3289-4fb2-8282-428b434052e6" data-bs-target="#expand_accordion_body_mw_b433527e-3289-4fb2-8282-428b434052e6" aria-controls="expand_accordion_body_mw_b433527e-3289-4fb2-8282-428b434052e6" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_b433527e-3289-4fb2-8282-428b434052e6">Detect Stiffness When Selecting ODE Solver</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_b433527e-3289-4fb2-8282-428b434052e6" aria-labelledby="expand_accordion_heading_mw_b433527e-3289-4fb2-8282-428b434052e6" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/DetectStiffnessWhenSelectingODESolverExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Detect Stiffness When Selecting ODE Solver",
          "description": "Create an ode object for the van der Pol equations with mu = 1000 using the built-in function file vdp1000.m. Specify the initial values of y' and y'' as 2 and 0, respectively.",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "ode.html"

        },
          "identifier": "matlab.DetectStiffnessWhenSelectingODESolverExample",
          "name": "DetectStiffnessWhenSelectingODESolverExample",
          "url": "ode.html#mw_b433527e-3289-4fb2-8282-428b434052e6"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/DetectStiffnessWhenSelectingODESolverExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "DetectStiffnessWhenSelectingODESolverExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Create an <code class="literal">ode</code> object for the van der Pol equations with <code class="literal">mu = 1000</code> using the built-in function file <code class="literal">vdp1000.m</code>. Specify the initial values of <code class="literal">y'</code> and <code class="literal">y''</code> as <code class="literal">2</code> and <code class="literal">0</code>, respectively.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>F = ode(ODEFcn=@vdp1000,InitialValue=[2;0])</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>F = 
  ode with properties:

   Problem definition
               ODEFcn: @vdp1000
          InitialTime: 0
         InitialValue: [2×1 double]
         EquationType: standard

   Solver properties
    AbsoluteTolerance: 1.0000e-06
    RelativeTolerance: 1.0000e-03
               Solver: auto
       SelectedSolver: ode45

  Show all properties


</pre></div></div></div><p>The automatically selected solver is <code class="literal">ode45</code>. Solve the ODE system over the time interval <code class="literal">[0 3000]</code>. Measure the time the <code class="literal">ode45</code> solver takes by using <code class="literal">tic</code> and <code class="literal">toc</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>tic
sol45 = solve(F,0,3000);
toc</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>Elapsed time is 17.243319 seconds.
</pre></div></div></div><p>Call the <code class="literal">selectSolver</code> function with the <code class="literal">DetectStiffness</code> name-value argument to choose a solver using a stiffness detection heuristic. Also specify the <code class="literal">IntervalLength</code> name-value argument as <code class="literal">3000</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>F.Solver = selectSolver(F,DetectStiffness=<span style="color:#A020F0">"on"</span>,IntervalLength=3000)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>F = 
  ode with properties:

   Problem definition
               ODEFcn: @vdp1000
          InitialTime: 0
         InitialValue: [2×1 double]
             Jacobian: []
         EquationType: standard

   Solver properties
    AbsoluteTolerance: 1.0000e-06
    RelativeTolerance: 1.0000e-03
               Solver: ode15s

  Show all properties


</pre></div></div></div><p>The selected solver is now <code class="literal">ode15s</code>. Solving the ODE system over the time interval <code class="literal">[0 3000]</code> using the <code class="literal">ode15s</code> solver is faster and more efficient than using the <code class="literal">ode45</code> solver.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>tic
sol15s = solve(F,0,3000);
toc</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>Elapsed time is 0.244035 seconds.
</pre></div></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-DetectStiffnessWhenSelectingODESolverExample"><meta itemprop="exampletitle" content="Detect Stiffness When Selecting ODE Solver"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_f36627ec-cfca-43d8-8cb4-1962d408c156"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_f36627ec-cfca-43d8-8cb4-1962d408c156" data-bs-target="#expand_accordion_body_mw_f36627ec-cfca-43d8-8cb4-1962d408c156" aria-controls="expand_accordion_body_mw_f36627ec-cfca-43d8-8cb4-1962d408c156" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_f36627ec-cfca-43d8-8cb4-1962d408c156">Solve System of DAEs with Mass Matrix</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_f36627ec-cfca-43d8-8cb4-1962d408c156" aria-labelledby="expand_accordion_heading_mw_f36627ec-cfca-43d8-8cb4-1962d408c156" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/SolveSystemOfDAEsWithMassMatrixExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Solve System of DAEs with Mass Matrix",
          "description": "Consider this system of first-order equations.",
          "thumbnailURL": "../../examples/matlab/win64/SolveSystemOfDAEsWithMassMatrixExample_01.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "ode.html"

        },
          "identifier": "matlab.SolveSystemOfDAEsWithMassMatrixExample",
          "name": "SolveSystemOfDAEsWithMassMatrixExample",
          "url": "ode.html#mw_f36627ec-cfca-43d8-8cb4-1962d408c156"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/SolveSystemOfDAEsWithMassMatrixExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "SolveSystemOfDAEsWithMassMatrixExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Consider this system of first-order equations.</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mtable columnalign="left"><mtr><mtd><mrow><msubsup><mrow><mi>y</mi></mrow><mrow><mn>1</mn></mrow><mrow><mo>′</mo></mrow></msubsup><mo>=</mo><msub><mrow><mi>y</mi></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi>y</mi></mrow><mrow><mn>3</mn></mrow></msub><mo>-</mo><msub><mrow><mi>y</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mrow><mi>y</mi></mrow><mrow><mn>2</mn></mrow><mrow><mo>′</mo></mrow></msubsup><mo>=</mo><msub><mrow><mi>y</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>-</mo><mn>1</mn></mrow></mtd></mtr><mtr><mtd><mrow><mn>0</mn><mo>=</mo><msub><mrow><mi>y</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>+</mo><msub><mrow><mi>y</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>+</mo><msub><mrow><mi>y</mi></mrow><mrow><mn>3</mn></mrow></msub></mrow></mtd></mtr></mtable></mrow></math></p></div><p></p><p>The left side of the equations contain time derivatives, <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msubsup><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mi mathvariant="italic">n</mi></mrow><mrow><mo>′</mo></mrow></msubsup><mo>=</mo><mfrac><mrow><msub><mrow><mi mathvariant="normal">dy</mi></mrow><mrow><mi mathvariant="italic">n</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">dt</mi></mrow></mfrac></mrow></math></span>. However, because the derivative for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>3</mn></mrow></msub></mrow></math></span> does not appear in the system, the equations define a system of differential algebraic equations. Rewriting the system in the form <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><mi mathvariant="normal">My</mi></mrow><mrow><mo>′</mo></mrow></msup><mo>=</mo><mi mathvariant="italic">f</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">y</mi></mrow><mo>)</mo></mrow></mrow></math></span> shows a constant, singular mass matrix on the left side.</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mo>[</mo><mtable columnalign="center center center"><mtr><mtd><mrow><mn>1</mn></mrow></mtd><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mn>1</mn></mrow></mtd><mtd><mrow><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mn>0</mn></mrow></mtd></mtr></mtable><mo>]</mo></mrow><munderover accent="true"><mrow><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><msubsup><mrow><mi>y</mi></mrow><mrow><mn>1</mn></mrow><mrow><mo>′</mo></mrow></msubsup></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mrow><mi>y</mi></mrow><mrow><mn>2</mn></mrow><mrow><mo>′</mo></mrow></msubsup></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mrow><mi>y</mi></mrow><mrow><mn>3</mn></mrow><mrow><mo>′</mo></mrow></msubsup></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow><mrow/><mrow><mo stretchy="false">˙</mo></mrow></munderover><mo>=</mo><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><msub><mrow><mi>y</mi></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi>y</mi></mrow><mrow><mn>3</mn></mrow></msub><mo>-</mo><msub><mrow><mi>y</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi>y</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>-</mo><mn>1</mn></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi>y</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>+</mo><msub><mrow><mi>y</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>+</mo><msub><mrow><mi>y</mi></mrow><mrow><mn>3</mn></mrow></msub></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow></math></p></div><p></p><p>Solve the system of equations using the initial values <code class="literal">[1 1 -2]</code> by creating an <code class="literal">ode</code> object to represent the problem.</p><div class="itemizedlist"><ul><li><p>Specify the initial values in the <code class="literal">InitialValue</code> property.</p></li><li><p>Specify the system of equations as an anonymous function in the <code class="literal">ODEFcn</code> property.</p></li><li><p>Use an <code class="literal">odeMassMatrix</code> object to specify the constant, singular mass matrix in the <code class="literal">MassMatrix</code> property.</p></li></ul></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>F = ode;
F.InitialValue = [1 1 -2];
F.ODEFcn = @(t,y) [y(1)*y(3)-y(2); 
                   y(1)-1; 
                   y(1)+y(2)+y(3)];
F.MassMatrix = odeMassMatrix(MassMatrix=[1 0 0; 0 1 0; 0 0 0],Singular=<span style="color:#A020F0">"yes"</span>);</pre></div></div></div><p>Display the ode object. The <code class="literal">SelectedSolver</code> property shows that the <code class="literal">ode15s</code> solver was automatically chosen for this problem.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>F</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>F = 
  ode with properties:

   Problem definition
               ODEFcn: @(t,y)[y(1)*y(3)-y(2);y(1)-1;y(1)+y(2)+y(3)]
          InitialTime: 0
         InitialValue: [1 1 -2]
             Jacobian: []
           MassMatrix: [1×1 odeMassMatrix]
         EquationType: standard

   Solver properties
    AbsoluteTolerance: 1.0000e-06
    RelativeTolerance: 1.0000e-03
               Solver: auto
       SelectedSolver: ode15s

  Show all properties


</pre></div></div></div><p>Solve the system of equations over the time interval <code class="literal">[0 10]</code> by using the <code class="literal">solve</code> method. Plot all three solution components.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>S = solve(F,0,10);
plot(S.Time,S.Solution,<span style="color:#A020F0">"-o"</span>)
legend(<span style="color:#A020F0">"y_1"</span>,<span style="color:#A020F0">"y_2"</span>,<span style="color:#A020F0">"y_3"</span>,Location=<span style="color:#A020F0">"southeast"</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e1223008" class="mediaobject"><p><img src="../../examples/matlab/win64/SolveSystemOfDAEsWithMassMatrixExample_01.png" alt="Figure contains an axes object. The axes object contains 3 objects of type line. These objects represent y_1, y_2, y_3." width="560"></p></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-SolveSystemOfDAEsWithMassMatrixExample"><meta itemprop="exampletitle" content="Solve System of DAEs with Mass Matrix"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_b3779d98-e7f1-4ad8-9b71-cf29412f4542"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_b3779d98-e7f1-4ad8-9b71-cf29412f4542" data-bs-target="#expand_accordion_body_mw_b3779d98-e7f1-4ad8-9b71-cf29412f4542" aria-controls="expand_accordion_body_mw_b3779d98-e7f1-4ad8-9b71-cf29412f4542" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_b3779d98-e7f1-4ad8-9b71-cf29412f4542">Examine Parameter Sensitivity</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_b3779d98-e7f1-4ad8-9b71-cf29412f4542" aria-labelledby="expand_accordion_heading_mw_b3779d98-e7f1-4ad8-9b71-cf29412f4542" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/ParameterSensitivityExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Examine Parameter Sensitivity",
          "description": "Solve an ODE system with two equations and two parameters, and perform sensitivity analysis on the parameters.",
          "thumbnailURL": "../../examples/matlab/win64/ParameterSensitivityExample_02.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "ode.html"

        },
          "identifier": "matlab.ParameterSensitivityExample",
          "name": "ParameterSensitivityExample",
          "url": "ode.html#mw_b3779d98-e7f1-4ad8-9b71-cf29412f4542"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/ParameterSensitivityExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "ParameterSensitivityExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Solve an ODE system with two equations and two parameters, and perform sensitivity analysis on the parameters.</p><p>Create an <code class="literal">ode</code> object to represent this system of equations.</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mtable columnalign="left"><mtr><mtd><mrow><mfrac><mrow><msub><mrow><mi mathvariant="normal">dy</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">dt</mi></mrow></mfrac><mo>=</mo><msub><mrow><mi mathvariant="italic">p</mi></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>-</mo><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mfrac><mrow><msub><mrow><mi mathvariant="normal">dy</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">dt</mi></mrow></mfrac><mo>=</mo><msub><mrow><mo>-</mo><mi mathvariant="italic">p</mi></mrow><mrow><mn>2</mn></mrow></msub><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mtd></mtr></mtable></mrow></math></p></div><p></p><p>Specify the initial conditions as <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub><mrow><mo>(</mo><mrow><mn>0</mn></mrow><mo>)</mo></mrow><mo>=</mo><mn>2</mn></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub><mrow><mo>(</mo><mrow><mn>0</mn></mrow><mo>)</mo></mrow><mo>=</mo><mn>3</mn></mrow></math></span>, and parameter values of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">p</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>=</mo><mn>0</mn><mo>.</mo><mn>05</mn></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">p</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>=</mo><mn>1</mn><mo>.</mo><mn>5</mn></mrow></math></span>. To enable sensitivity analysis of the parameters, set the <code class="literal">Sensitivity</code> property of the <code class="literal">ode</code> object to an <code class="literal">odeSensitivity</code> object.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>p = [0.05 1.5];
F = ode(ODEFcn=@(t,y,p) [p(1)*y(1)-y(2); -p(2)*y(2)], <span style="color:#0000FF">...</span>
        InitialValue=[2 3], <span style="color:#0000FF">...</span>
        Parameters=p, <span style="color:#0000FF">...</span>
        Sensitivity=odeSensitivity)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>F = 
  ode with properties:

   Problem definition
               ODEFcn: @(t,y,p)[p(1)*y(1)-y(2);-p(2)*y(2)]
           Parameters: [0.0500 1.5000]
          InitialTime: 0
         InitialValue: [2 3]
          Sensitivity: [1×1 odeSensitivity]
         EquationType: standard

   Solver properties
    AbsoluteTolerance: 1.0000e-06
    RelativeTolerance: 1.0000e-03
               Solver: auto
       SelectedSolver: cvodesnonstiff

  Show all properties


</pre></div></div></div><p>Because the equations are nonstiff and sensitivity analysis is enabled, the <code class="literal">ode</code> object automatically chooses the <code class="literal">cvodesnonstiff</code> solver for this problem.</p><p>Solve the ODE over the time interval <code class="literal">[0 5]</code>, and plot the solution for each component.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>S = solve(F,0,5)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>S = 
  ODEResults with properties:

           Time: [0 2.9540e-09 2.9543e-05 2.2465e-04 4.1976e-04 0.0024 0.0080 0.0137 0.0245 0.0353 0.0611 0.0869 0.1499 0.2129 0.3169 0.4208 0.5248 0.7204 0.9161 1.1118 1.3075 1.5031 1.6988 1.8945 2.0901 2.2858 2.4815 2.6772 2.8728 … ] (1×40 double)
       Solution: [2×40 double]
    Sensitivity: [2×2×40 double]

</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>plot(S.Time,S.Solution(1,:),<span style="color:#A020F0">"-o"</span>,S.Time,S.Solution(2,:),<span style="color:#A020F0">"-o"</span>)
legend(<span style="color:#A020F0">"y1"</span>,<span style="color:#A020F0">"y2"</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e1223197" class="mediaobject"><p><img src="../../examples/matlab/win64/ParameterSensitivityExample_01.png" alt="Figure contains an axes object. The axes object contains 2 objects of type line. These objects represent y1, y2." width="560"></p></div></div><p>The values in <code class="literal">S.Sensitivity</code> are partial derivatives of the equations with respect to the parameters. To examine the effects of the parameter values during the integration, plot the sensitivity values. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>figure
hold <span style="color:#A020F0">on</span>
plot(S.Time,squeeze(S.Sensitivity(1,1,:)),<span style="color:#A020F0">"-o"</span>)
plot(S.Time,squeeze(S.Sensitivity(1,2,:)),<span style="color:#A020F0">"-o"</span>)
plot(S.Time,squeeze(S.Sensitivity(2,1,:)),<span style="color:#A020F0">"-o"</span>)
plot(S.Time,squeeze(S.Sensitivity(2,2,:)),<span style="color:#A020F0">"-o"</span>)
legend(<span style="color:#A020F0">"p1,eq1"</span>,<span style="color:#A020F0">"p2,eq1"</span>,<span style="color:#A020F0">"p1,eq2"</span>,<span style="color:#A020F0">"p2,eq2"</span>)
hold <span style="color:#A020F0">off</span></pre></div></div></div><div class="informalfigure"><div id="d126e1223208" class="mediaobject"><p><img src="../../examples/matlab/win64/ParameterSensitivityExample_02.png" alt="Figure contains an axes object. The axes object contains 4 objects of type line. These objects represent p1,eq1, p2,eq1, p1,eq2, p2,eq2." width="560"></p></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-ParameterSensitivityExample"><meta itemprop="exampletitle" content="Examine Parameter Sensitivity"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_8b9f1e84-f7ab-4482-94e0-1f7ac8eac578"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_8b9f1e84-f7ab-4482-94e0-1f7ac8eac578" data-bs-target="#expand_accordion_body_mw_8b9f1e84-f7ab-4482-94e0-1f7ac8eac578" aria-controls="expand_accordion_body_mw_8b9f1e84-f7ab-4482-94e0-1f7ac8eac578" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_8b9f1e84-f7ab-4482-94e0-1f7ac8eac578">Use Callback Function to Restart Integration of Bouncing Ball</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_8b9f1e84-f7ab-4482-94e0-1f7ac8eac578" aria-labelledby="expand_accordion_heading_mw_8b9f1e84-f7ab-4482-94e0-1f7ac8eac578" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/BouncingBallEventsExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Use Callback Function to Restart Integration of Bouncing Ball",
          "description": "Consider a ball thrown upward with an initial velocity dy/dt. The ball is subject to acceleration due to gravity aimed downward, so its acceleration is",
          "thumbnailURL": "../../examples/matlab/win64/BouncingBallEventsExample_01.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "ode.html"

        },
          "identifier": "matlab.BouncingBallEventsExample",
          "name": "BouncingBallEventsExample",
          "url": "ode.html#mw_8b9f1e84-f7ab-4482-94e0-1f7ac8eac578"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/BouncingBallEventsExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "BouncingBallEventsExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Consider a ball thrown upward with an initial velocity <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">dy</mi><mo>/</mo><mi mathvariant="normal">dt</mi></mrow></math></span>. The ball is subject to acceleration due to gravity aimed downward, so its acceleration is</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mfrac><mrow><msup><mrow><mi>d</mi></mrow><mrow><mn>2</mn></mrow></msup><mi>y</mi></mrow><mrow><mi>d</mi><msup><mrow><mi>t</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac><mo>=</mo><mo>-</mo><mi>g</mi><mo stretchy="false">.</mo></mrow></math></p></div><p></p><p>Rewriting the equation as a first-order system of equations with the substitutions <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>=</mo><mi mathvariant="italic">y</mi></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>=</mo><mfrac><mrow><mi mathvariant="normal">dy</mi></mrow><mrow><mi mathvariant="normal">dt</mi></mrow></mfrac></mrow></math></span> yields</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mtable columnalign="left"><mtr><mtd><mrow><msubsup><mrow><mi>y</mi></mrow><mrow><mn>1</mn></mrow><mrow><mo>′</mo></mrow></msubsup><mo>=</mo><msub><mrow><mi>y</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mrow><mi>y</mi></mrow><mrow><mn>2</mn></mrow><mrow><mo>′</mo></mrow></msubsup><mo>=</mo><mo>-</mo><mi>g</mi><mo stretchy="false">.</mo></mrow></mtd></mtr></mtable></mrow></math></p></div><p></p><p>Solve the equations for the position <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></math></span> and velocity <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></math></span> of the ball over time. </p><div class="procedure"><span id="mw_6845404f-8e57-4f36-b119-9193970db6ba.BouncingBallEventsExample-1" class="anchor_target"></span><p class="title" id="mw_6845404f-8e57-4f36-b119-9193970db6ba_sep_BouncingBallEventsExample-1"><b>Define Equations and Initial Conditions</b></p><p>Create a function handle for the first-order system of equations that accepts two inputs for <code class="literal">(t,y)</code>. Use the value <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">g</mi><mo>=</mo><mn>9</mn><mo>.</mo><mn>8</mn></mrow></math></span> for the acceleration due to gravity.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>dydt = @(t,y) [y(2); -9.8];</pre></div></div></div><p>Next, create a vector with the initial conditions. The ball starts at position <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>=</mo><mn>3</mn></mrow></math></span> at <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">t</mi><mo>=</mo><mn>0</mn></mrow></math></span> as it is thrown upward with initial velocity <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>=</mo><mn>20</mn></mrow></math></span>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>y0 = [3 20];</pre></div></div></div><span id="mw_6845404f-8e57-4f36-b119-9193970db6ba.BouncingBallEventsExample-2" class="anchor_target"></span><p class="title" id="mw_6845404f-8e57-4f36-b119-9193970db6ba_sep_BouncingBallEventsExample-2"><b>Model Ball Bounces as Events</b></p><p>The ball initially travels upward until the force due to gravity causes it to change direction and head back down to the ground. If you solve the equations without more consideration, then the ball falls back downward forever without striking the ground. Instead, you can use an event function to detect when the position of the ball goes to zero where the ground is located. Because the solution component <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>=</mo><mi mathvariant="italic">y</mi></mrow></math></span> is the position of the ball, the event function tracks the value of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></math></span> so that an event triggers whenever <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>=</mo><mn>0</mn></mrow></math></span>.</p><p>Create a function handle for the event function that accepts two inputs for <code class="literal">(t,y)</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>bounceEvent = @(t,y) y(1);</pre></div></div></div><p>When the ball strikes the ground, its direction changes again as it heads back upwards with a new (smaller) initial velocity. To model this situation, use a callback function along with the event function. When an event triggers, the ODE solver invokes the callback function. The callback function resets the position and initial velocity of the ball so that the integration can restart with the correct initial conditions. When an event occurs, the callback function sets the position <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>=</mo><mn>0</mn></mrow></math></span> and attenuates the velocity by a factor of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mn>0</mn><mo>.</mo><mn>9</mn></mrow></math></span> while reversing its direction back upward. Define a callback function that performs these actions.</p><div class="code_responsive"><pre id="d126e1223478" class="programlisting"><span style="color:#0000FF">function</span> [stop,y] = bounceResponse(t,y)
stop = false;
y(1) = 0;
y(2) = -0.9*y(2);
<span style="color:#0000FF">end</span>
</pre></div><p>(The callback function is included as a local function at the end of the example.)</p><p>Create an <code class="literal">odeEvent</code> object to represent the bouncing ball events. Specify <code class="literal">Direction="descending"</code> so that only events where the position is decreasing are detected. Also, specify <code class="literal">Response="callback"</code> so that the solver invokes the callback function when an event occurs.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>E = odeEvent(EventFcn=bounceEvent, <span style="color:#0000FF">...</span>
             Direction=<span style="color:#A020F0">"descending"</span>, <span style="color:#0000FF">...</span>
             Response=<span style="color:#A020F0">"callback"</span>, <span style="color:#0000FF">...</span>
             CallbackFcn=@bounceResponse)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>E = 
  odeEvent with properties:

       EventFcn: @(t,y)y(1)
      Direction: descending
       Response: callback
    CallbackFcn: @bounceResponse

</pre></div></div></div><span id="mw_6845404f-8e57-4f36-b119-9193970db6ba.BouncingBallEventsExample-3" class="anchor_target"></span><p class="title" id="mw_6845404f-8e57-4f36-b119-9193970db6ba_sep_BouncingBallEventsExample-3"><b>Solve Equations</b></p><p>Create an <code class="literal">ode</code> object for the problem, specifying the equations <code class="literal">dydt</code>, initial conditions <code class="literal">y0</code>, and events <code class="literal">E</code> as property values.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>F = ode(ODEFcn=dydt,InitialValue=y0,EventDefinition=E);</pre></div></div></div><p>Integrate the equations over the time interval <code class="literal">[0 30]</code> by using the <code class="literal">solve</code> method. Specify <code class="literal">Refine=8</code> to generate 8 points per step. The resulting object has properties for the time and solution, and because events are being tracked, the object also displays properties related to the events that triggered during the integration.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>S = solve(F,0,30,Refine=8)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>S = 
  ODEResults with properties:

             Time: [0 0.0038 0.0075 0.0113 0.0151 0.0188 0.0226 0.0264 0.0301 0.0490 0.0678 0.0867 0.1055 0.1243 0.1432 0.1620 0.1809 0.2751 0.3692 0.4634 0.5576 0.6518 0.7460 0.8402 0.9344 1.3094 1.6844 2.0594 2.4344 2.8094 3.1844 … ] (1×468 double)
         Solution: [2×468 double]
        EventTime: [4.2265 8.1607 11.7015 14.8882 17.7563 20.3375 22.6606 24.7514 26.6331 28.3267 29.8509]
    EventSolution: [2×11 double]
       EventIndex: [1 1 1 1 1 1 1 1 1 1 1]

</pre></div></div></div><span id="mw_6845404f-8e57-4f36-b119-9193970db6ba.BouncingBallEventsExample-4" class="anchor_target"></span><p class="title" id="mw_6845404f-8e57-4f36-b119-9193970db6ba_sep_BouncingBallEventsExample-4"><b>Plot Results</b></p><p>Plot the position <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></math></span> of the ball over time, marking the initial position with a green circle and events with red circles.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>plot(S.Time,S.Solution(1,:),<span style="color:#A020F0">"--"</span>)
hold <span style="color:#A020F0">on</span>
plot(S.EventTime,S.EventSolution(1,:),<span style="color:#A020F0">"ro"</span>)
plot(0,y0(1),<span style="color:#A020F0">"go"</span>)
hold <span style="color:#A020F0">off</span>
ylim([0 25])
xlabel(<span style="color:#A020F0">"Time"</span>)
ylabel(<span style="color:#A020F0">"Position y_1"</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e1223536" class="mediaobject"><p><img src="../../examples/matlab/win64/BouncingBallEventsExample_01.png" alt="Figure contains an axes object. The axes object with xlabel Time, ylabel Position y indexOf 1 baseline Position y_1 contains 3 objects of type line. One or more of the lines displays its values using only markers" width="560"></p></div></div><span id="mw_6845404f-8e57-4f36-b119-9193970db6ba.BouncingBallEventsExample-5" class="anchor_target"></span><p class="title" id="mw_6845404f-8e57-4f36-b119-9193970db6ba_sep_BouncingBallEventsExample-5"><b>Local Functions</b></p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> [stop,y] = bounceResponse(t,y)
stop = false;
y(1) = 0;
y(2) = -0.9*y(2);
<span style="color:#0000FF">end</span></pre></div></div></div></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-BouncingBallEventsExample"><meta itemprop="exampletitle" content="Use Callback Function to Restart Integration of Bouncing Ball"></div></div></div></div><div class="ref_sect"><h2 id="mw_83bd1c5b-5b4a-42ab-ae1e-0629673f4024">Version History</h2><strong>Introduced in R2023b</strong><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink">expand all</a></p><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_mw_947491ff-3699-405d-ae32-f94f26893d21" aria-controls="expand_body_mw_947491ff-3699-405d-ae32-f94f26893d21" class="accordion-button collapsed" aria-expanded="false"><h3 id="mw_947491ff-3699-405d-ae32-f94f26893d21">R2025a: <span class="remove_bold">Specify single-precision property values</span></h3></button></div><div id="expand_body_mw_947491ff-3699-405d-ae32-f94f26893d21" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>For properties that accept matrix values, you can now specify single-precision sparse
        matrices. Additionally, for properties that accept function handles, the specified functions
        can now return single-precision outputs. If you specify any property as
          <code class="class">single</code>, the properties of the <code class="object">ODEResults</code> object returned
        by <code class="function">solve</code> and <code class="function">solutionFcn</code> are single. For faster
        computation, specify all property values and function handle outputs using as the same
        precision.</p></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_mw_6c2bbf4e-e636-48b5-838d-5d8451ea9fa7" aria-controls="expand_body_mw_6c2bbf4e-e636-48b5-838d-5d8451ea9fa7" class="accordion-button collapsed" aria-expanded="false"><h3 id="mw_6c2bbf4e-e636-48b5-838d-5d8451ea9fa7">R2025a: <span class="remove_bold">Solve delay differential equations</span></h3></button></div><div id="expand_body_mw_6c2bbf4e-e636-48b5-838d-5d8451ea9fa7" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>You can solve delay differential equations (DDEs) using an <code class="object">ode</code> object
        by specifying the <code class="property">Solver</code> property as <code class="literal">"dde23"</code>,
          <code class="literal">"ddesd"</code>, or <code class="literal">"ddensd"</code> and specifying the
          <code class="property">DelayDefinition</code> property as an <code class="object">odeDelay</code> object. If
        you specify only <code class="property">DelayDefinition</code> and not <code class="property">Solver</code>,
        the <code class="object">ode</code> object automatically selects a solver.</p></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_mw_fcee8481-b420-47bb-bb55-a86a29b406ce" aria-controls="expand_body_mw_fcee8481-b420-47bb-bb55-a86a29b406ce" class="accordion-button collapsed" aria-expanded="false"><h3 id="mw_fcee8481-b420-47bb-bb55-a86a29b406ce">R2025a: <span class="remove_bold">Solve complex-valued ODE functions</span></h3></button></div><div id="expand_body_mw_fcee8481-b420-47bb-bb55-a86a29b406ce" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>You can solve ODEs with complex solution values using the <code class="object">ode</code> object by
        specifying the <code class="property">SeparateComplexParts</code> property as
        <code class="literal">"on"</code>. Specify <code class="property">SeparateComplexParts</code> as
          <code class="literal">"on"</code> when the ODE is complex and the selected solver fails or takes a
        long time to converge. This is especially helpful for solving implicit and stiff ODEs where
        the Jacobian is not specified.</p></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_mw_a498a779-e117-42b1-aee7-39c23c9cd0c1" aria-controls="expand_body_mw_a498a779-e117-42b1-aee7-39c23c9cd0c1" class="accordion-button collapsed" aria-expanded="false"><h3 id="mw_a498a779-e117-42b1-aee7-39c23c9cd0c1">R2024b: <span class="remove_bold">Specify ODE as implicit</span></h3></button></div><div id="expand_body_mw_a498a779-e117-42b1-aee7-39c23c9cd0c1" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>You can now specify the <code class="property">Solver</code> property as
          <code class="literal">"ode15i"</code> for implicit ODEs. Alternatively, you can specify whether your
        ODE is implicit by setting the new <code class="property">EquationType</code> property to
          <code class="literal">"standard"</code> (default) or <code class="literal">"fullyimplicit"</code>.</p><p>If you specify the Jacobian when <code class="property">EquationType</code> is
          <code class="literal">"fullyimplicit"</code>, the Jacobian must be a function handle or cell array.
        Additionally, the <code class="argument">ODEFcn</code> property can accept functions of the form
          <code class="literal">f = ODEFcn(t,y,yp)</code> for implicit ODEs.</p></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_mw_952e51f4-b402-4d93-a447-3992c500d5e2" aria-controls="expand_body_mw_952e51f4-b402-4d93-a447-3992c500d5e2" class="accordion-button collapsed" aria-expanded="false"><h3 id="mw_952e51f4-b402-4d93-a447-3992c500d5e2">R2024b: <span class="remove_bold">Detect stiffness to change ODE solver</span></h3></button></div><div id="expand_body_mw_952e51f4-b402-4d93-a447-3992c500d5e2" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>You can specify parameters to change the solver after creating an <code class="object">ode</code>
        object by using the <a href="ode.selectsolver.html"><code class="function">selectSolver</code></a> object function. For example, you can incorporate a stiffness
        detection heuristic when selecting a solver by using the <code class="function">selectSolver</code>
        function with its <code class="argument">DetectStiffness</code> name-value argument.</p></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="mw_6845404f-8e57-4f36-b119-9193970db6ba_seealso">See Also</h2><h3>Objects</h3><ul class="list-unstyled margined_10"><li><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="odejacobian.html"><span itemprop="name"><code class="object">odeJacobian</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="odemassmatrix.html"><span itemprop="name"><code class="object">odeMassMatrix</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="odeevent.html"><span itemprop="name"><code class="object">odeEvent</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="odesensitivity.html"><span itemprop="name"><code class="object">odeSensitivity</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="matlab.ode.oderesults.html"><span itemprop="name"><code class="object">ODEResults</code></span></a></span></li></ul><h3>Live Editor Tasks</h3><ul class="list-unstyled margined_10"><li><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="solveode.html"><span itemprop="name"><span class="liveeditortask">Solve ODE</span></span></a></span></li></ul><div class="examples_container"><h3 class="remove_border">Topics</h3><div itemprop="content"><ul class="list-unstyled"><li><a href="../math/choose-an-ode-solver.html" class="a">Choose an ODE Solver</a></li><li><a href="../math/sensitivity-analysis-of-epidemic-ode-parameters.html" class="a">Sensitivity Analysis of Epidemic ODE Parameters</a></li></ul></div></div></div>
    </div></div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

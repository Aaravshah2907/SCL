<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>ODEResults</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../numerical-integration-and-differential-equations.html",
          "name": "Numerical Integration and Differential Equations"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../ordinary-differential-equations.html",
          "name": "Ordinary Differential Equations"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "ordinary-differential-equations"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script>
<meta xmlns="http://www.w3.org/1999/xhtml" name="chunktype" content="refpage"><meta xmlns="http://www.w3.org/1999/xhtml" name="refentity" itemprop="refentity" content="object:matlab.ode.ODEResults"><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="fcn">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ref/function">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="ODEResults objects store the solution information from the integration of an ode object."><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "refentry";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../numerical-integration-and-differential-equations.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Numerical Integration and Differential Equations</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../ordinary-differential-equations.html?s_tid=CRUX_lftnav" itemprop="url" id="ordinary-differential-equations"><span itemprop="title">Ordinary Differential Equations</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item notranslate"><a href="#responsive_offcanvas">ODEResults</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-refentry">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#d126e1227944" class="nav-link intrnllnk">Description</a></li><li class="nav-item"><a href="#mw_e354d4d3-cc8d-4bf6-bf63-c09a244128f4" class="nav-link intrnllnk">Creation</a></li><li class="nav-item"><a href="#mw_2c8f1ad0-bd63-488f-bcf5-8bb1261a4e7c" class="nav-link intrnllnk">Properties</a><ul class="nav"><li class="nav-item"><a href="#mw_c46e3463-c806-4954-9c56-f7403ea37e42" class="nav-link intrnllnk">Standard Results</a><ul class="nav"><li class="nav-item"><a href="#mw_b4cff9d5-354a-403f-8dbe-bc087567d228" class="nav-link intrnllnk">Time</a></li><li class="nav-item"><a href="#mw_7d8ef465-8e58-4605-be60-b2688790edc3" class="nav-link intrnllnk">Solution</a></li></ul></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_0340a71a-54d8-45e3-9bc3-e22a8d33083a" class="nav-link intrnllnk">Event Results</a><ul class="nav"><li class="nav-item"><a href="#mw_79bbab12-99b4-4b7d-ad23-0ef7ab182ef8" class="nav-link intrnllnk">EventTime</a></li><li class="nav-item"><a href="#mw_95ef3180-5817-43e7-95ce-b0e11df31472" class="nav-link intrnllnk">EventSolution</a></li><li class="nav-item"><a href="#mw_28bed1ea-d57e-4ed6-bb8f-29ec66bbd60b" class="nav-link intrnllnk">EventIndex</a></li></ul></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_130b2c2a-5b20-4be0-870b-16cff8148642" class="nav-link intrnllnk">Sensitivity Analysis</a><ul class="nav"><li class="nav-item"><a href="#mw_71177ba1-d8b0-420c-8941-644c2e594134" class="nav-link intrnllnk">Sensitivity</a></li><li class="nav-item"><a href="#mw_0d96a215-1218-4627-bc14-5353a73fc3a4" class="nav-link intrnllnk">EventSensitivity</a></li></ul></li></ul></li><li class="nav-item"><a href="#mw_b20f2d48-1847-463c-9067-6773e3f9b338" class="nav-link intrnllnk">Examples</a><ul class="nav"><li class="nav-item"><a href="#mw_b6f19642-afba-4525-8ee7-3ab3076c0bda" class="nav-link intrnllnk">Solve Single ODE</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_36feb7b8-a525-463d-a937-d7b145ab6dd4" class="nav-link intrnllnk">Interpolate ODE Solution Outside of Original Interval</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_217afd8e-8013-4cca-9adc-22f158e6c6f7" class="nav-link intrnllnk">Examine Parameter Sensitivity</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_7347c528-0107-4ef7-9e3b-e3adcc3cb47f" class="nav-link intrnllnk">Use Callback Function to Restart Integration of Bouncing Ball</a></li></ul></li><li class="nav-item"><a href="#mw_c07cd0ce-01bd-4542-a385-1b4525c08fcc_vh" class="nav-link intrnllnk">Version History</a></li><li class="nav-item"><a href="#mw_c07cd0ce-01bd-4542-a385-1b4525c08fcc_seealso" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-ref"><div class="object_ref"><span id="mw_c07cd0ce-01bd-4542-a385-1b4525c08fcc" class="anchor_target"></span><h1 class="r2025b notranslate" itemprop="title">ODEResults</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose" class="add_margin_0">Results of ODE integration</p><p class="add_margin_0 add_clear_left"><em>Since R2023b</em></p><div class="switch"><a href="javascript:void(0);" id="expandAllPage">expand all in page</a></div></div></div><div class="refsummary" itemprop="content"><h2 id="d126e1227944">Description</h2><div class="cshsummary" id="csh_mw_c07cd0ce-01bd-4542-a385-1b4525c08fcc"><div class="shortsummary"><p><code class="object">ODEResults</code> objects store the solution information from the
      integration of an <code class="object">ode</code> object. The <code class="method">solve</code> and
        <code class="method">solutionFcn</code> object functions of <code class="object">ode</code> can return
        <code class="object">ODEResults</code> objects.</p></div><p>You can use the <code class="property">Time</code> and <code class="property">Solution</code> properties of
      an <code class="object">ODEResults</code> object to extract or plot the integration results. </p>
<div class="itemizedlist"><ul><li><p>If events are being tracked (that is, the <code class="object">ode</code> object has a nonempty
              <code class="property">EventDefinition</code> property), then the
              <code class="property">EventTime</code>, <code class="property">EventSolution</code>, and
              <code class="property">EventIndex</code> properties contain information related to events that
            triggered during the integration. See <a href="odeevent.html"><code class="object">odeEvent</code></a> for
            more information on detecting events during the solution process.</p></li><li><p>If sensitivity analysis is performed (that is, the <code class="object">ode</code> object has a
            nonempty <code class="property">Sensitivity</code> property), then the
              <code class="property">Sensitivity</code> property contains partial derivative values of the
            equations taken with respect to parameters. If events are also being tracked, then the
              <code class="property">EventSensitivity</code> property contains sensitivity values at the time
            of each event. See <a href="odesensitivity.html"><code class="object">odeSensitivity</code></a> for more information on performing sensitivity
            analysis.</p></li></ul></div><p>
</p><p>All properties of <code class="object">ODEResults</code> objects are read-only. You can index into
      the properties to extract their values with the syntax <code class="literal">data =
      obj.property</code>.</p></div></div><div id="mw_e354d4d3-cc8d-4bf6-bf63-c09a244128f4_div" class="ref_sect createobject"><h2 id="mw_e354d4d3-cc8d-4bf6-bf63-c09a244128f4">Creation</h2><p>Use <a href="ode.solve.html"><code class="function">solve</code></a> or
        <a href="ode.solutionfcn.html"><code class="function">solutionFcn</code></a> to
      integrate an <a href="ode.html"><code class="object">ode</code></a> object and
      create an <code class="object">ODEResults</code> object. For example, <code class="literal">S =
        solve(F,0,10)</code> creates an <code class="object">ODEResults</code> object
      <code class="literal">S</code>.</p></div><div class="ref_sect"><h2 id="mw_2c8f1ad0-bd63-488f-bcf5-8bb1261a4e7c">Properties</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="false">expand all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="mw_2c8f1ad0-bd63-488f-bcf5-8bb1261a4e7c_accordion-group" role="tablist" aria-multiselectable="true"><div id="mw_c46e3463-c806-4954-9c56-f7403ea37e42_div" class="refsect2"><h3 id="mw_c46e3463-c806-4954-9c56-f7403ea37e42">Standard Results</h3><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item " itemscope="" itemprop="property" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/PropertyReference" itemid="mw_b4cff9d5-354a-403f-8dbe-bc087567d228"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_b4cff9d5-354a-403f-8dbe-bc087567d228" data-bs-target="#expand_accordion_body_mw_b4cff9d5-354a-403f-8dbe-bc087567d228" aria-controls="expand_accordion_body_mw_b4cff9d5-354a-403f-8dbe-bc087567d228" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="prop_Time" class="anchor_target"></span><h3 id="mw_b4cff9d5-354a-403f-8dbe-bc087567d228"><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/ReferenceEntity" itemprop="refentityobj"><meta itemprop="refentity" content="property:matlab.ode.ODEResults.Time"><code itemprop="name" id="propname_Time">Time</code></span> &#8212; <span itemprop="purpose">Evaluation points</span><br/>
<span class="add_font_color_general remove_bold"><span class="example_desc" itemprop="inputvalues">Read-only: <span itemprop="inputvalue">row vector</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_b4cff9d5-354a-403f-8dbe-bc087567d228" aria-labelledby="expand_accordion_heading_mw_b4cff9d5-354a-403f-8dbe-bc087567d228" class="accordion-collapse collapse"><div class="accordion-body"><p>This property is read-only.</p><div class="cshsummary" id="csh_mw_b4cff9d5-354a-403f-8dbe-bc087567d228"><p>Evaluation points, returned as a row vector. Typically, the independent variable
              in an ODE problem is time, but the independent variable can represent other quantities
              as well.</p><div class="itemizedlist"><ul><li><p>If you solve the ODE problem using a time range with two elements <code class="literal">[t0
                    tf]</code>, then <code class="property">Time</code> contains the internal step values
                  chosen by the solver.</p></li><li><p>If you solve the ODE problem using a vector of times <code class="literal">[t0 t1 t2 ...
                    tf]</code>, then <code class="property">Time</code> contains the same values.</p></li></ul></div></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item " itemscope="" itemprop="property" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/PropertyReference" itemid="mw_7d8ef465-8e58-4605-be60-b2688790edc3"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_7d8ef465-8e58-4605-be60-b2688790edc3" data-bs-target="#expand_accordion_body_mw_7d8ef465-8e58-4605-be60-b2688790edc3" aria-controls="expand_accordion_body_mw_7d8ef465-8e58-4605-be60-b2688790edc3" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="prop_Solution" class="anchor_target"></span><h3 id="mw_7d8ef465-8e58-4605-be60-b2688790edc3"><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/ReferenceEntity" itemprop="refentityobj"><meta itemprop="refentity" content="property:matlab.ode.ODEResults.Solution"><code itemprop="name" id="propname_Solution">Solution</code></span> &#8212; <span itemprop="purpose">Solution at evaluation points</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc" itemprop="inputvalues">Read-only: <span itemprop="inputvalue">matrix</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_7d8ef465-8e58-4605-be60-b2688790edc3" aria-labelledby="expand_accordion_heading_mw_7d8ef465-8e58-4605-be60-b2688790edc3" class="accordion-collapse collapse"><div class="accordion-body"><p>This property is read-only.</p><div class="cshsummary" id="csh_mw_7d8ef465-8e58-4605-be60-b2688790edc3"><p>Solution at evaluation points, returned as a matrix. Each row
                <code class="literal">Solution(i,:)</code> is the complete solution for one component, and
              each column <code class="literal">Solution(:,j)</code> is the solution of all components at the
              corresponding evaluation point <code class="literal">Time(j)</code>.</p></div></div></div></div></div></div></div><div id="mw_0340a71a-54d8-45e3-9bc3-e22a8d33083a_div" class="refsect2"><h3 id="mw_0340a71a-54d8-45e3-9bc3-e22a8d33083a">Event Results</h3><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item " itemscope="" itemprop="property" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/PropertyReference" itemid="mw_79bbab12-99b4-4b7d-ad23-0ef7ab182ef8"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_79bbab12-99b4-4b7d-ad23-0ef7ab182ef8" data-bs-target="#expand_accordion_body_mw_79bbab12-99b4-4b7d-ad23-0ef7ab182ef8" aria-controls="expand_accordion_body_mw_79bbab12-99b4-4b7d-ad23-0ef7ab182ef8" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="prop_EventTime" class="anchor_target"></span><h3 id="mw_79bbab12-99b4-4b7d-ad23-0ef7ab182ef8"><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/ReferenceEntity" itemprop="refentityobj"><meta itemprop="refentity" content="property:matlab.ode.ODEResults.EventTime"><code itemprop="name" id="propname_EventTime">EventTime</code></span> &#8212; <span itemprop="purpose">Time when events triggered</span><br/>
<span class="add_font_color_general remove_bold"><span class="example_desc" itemprop="inputvalues">Read-only: <span itemprop="inputvalue">row vector</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_79bbab12-99b4-4b7d-ad23-0ef7ab182ef8" aria-labelledby="expand_accordion_heading_mw_79bbab12-99b4-4b7d-ad23-0ef7ab182ef8" class="accordion-collapse collapse"><div class="accordion-body"><p>This property is read-only.</p><div class="cshsummary" id="csh_mw_79bbab12-99b4-4b7d-ad23-0ef7ab182ef8"><p>Time when events triggered, returned as a row vector.
                <code class="literal">EventSolution(:,j)</code> contains the solution of all variables at time
                <code class="literal">EventTime(j)</code>, and <code class="literal">EventIndex(j)</code> indicates
              which event triggered.</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item " itemscope="" itemprop="property" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/PropertyReference" itemid="mw_95ef3180-5817-43e7-95ce-b0e11df31472"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_95ef3180-5817-43e7-95ce-b0e11df31472" data-bs-target="#expand_accordion_body_mw_95ef3180-5817-43e7-95ce-b0e11df31472" aria-controls="expand_accordion_body_mw_95ef3180-5817-43e7-95ce-b0e11df31472" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="prop_EventSolution" class="anchor_target"></span><h3 id="mw_95ef3180-5817-43e7-95ce-b0e11df31472"><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/ReferenceEntity" itemprop="refentityobj"><meta itemprop="refentity" content="property:matlab.ode.ODEResults.EventSolution"><code itemprop="name" id="propname_EventSolution">EventSolution</code></span> &#8212; <span itemprop="purpose">Solution at time of events</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc" itemprop="inputvalues">Read-only: <span itemprop="inputvalue">matrix</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_95ef3180-5817-43e7-95ce-b0e11df31472" aria-labelledby="expand_accordion_heading_mw_95ef3180-5817-43e7-95ce-b0e11df31472" class="accordion-collapse collapse"><div class="accordion-body"><p>This property is read-only.</p><div class="cshsummary" id="csh_mw_95ef3180-5817-43e7-95ce-b0e11df31472"><p>Solution at time of events, returned as a matrix.
                <code class="property">EventSolution</code> has a number of columns equal to
                <code class="literal">numel(EventTime)</code>, and the same number of rows as
                <code class="property">Solution</code>. <code class="literal">EventSolution(:,j)</code> contains the
              solution of all variables at time <code class="literal">EventTime(j)</code>, and
                <code class="literal">EventIndex(j)</code> indicates which event triggered.</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item " itemscope="" itemprop="property" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/PropertyReference" itemid="mw_28bed1ea-d57e-4ed6-bb8f-29ec66bbd60b"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_28bed1ea-d57e-4ed6-bb8f-29ec66bbd60b" data-bs-target="#expand_accordion_body_mw_28bed1ea-d57e-4ed6-bb8f-29ec66bbd60b" aria-controls="expand_accordion_body_mw_28bed1ea-d57e-4ed6-bb8f-29ec66bbd60b" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="prop_EventIndex" class="anchor_target"></span><h3 id="mw_28bed1ea-d57e-4ed6-bb8f-29ec66bbd60b"><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/ReferenceEntity" itemprop="refentityobj"><meta itemprop="refentity" content="property:matlab.ode.ODEResults.EventIndex"><code itemprop="name" id="propname_EventIndex">EventIndex</code></span> &#8212; <span itemprop="purpose">Index of triggered events</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc" itemprop="inputvalues">Read-only: <span itemprop="inputvalue">row vector</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_28bed1ea-d57e-4ed6-bb8f-29ec66bbd60b" aria-labelledby="expand_accordion_heading_mw_28bed1ea-d57e-4ed6-bb8f-29ec66bbd60b" class="accordion-collapse collapse"><div class="accordion-body"><p>This property is read-only.</p><div class="cshsummary" id="csh_mw_28bed1ea-d57e-4ed6-bb8f-29ec66bbd60b"><p>Index of triggered events, returned as a row vector.
                <code class="literal">EventSolution(:,j)</code> contains the solution of all variables at time
                <code class="literal">EventTime(j)</code>, and <code class="literal">EventIndex(j)</code> indicates
              which event triggered.</p></div></div></div></div></div></div></div><div id="mw_130b2c2a-5b20-4be0-870b-16cff8148642_div" class="refsect2"><h3 id="mw_130b2c2a-5b20-4be0-870b-16cff8148642">Sensitivity Analysis</h3><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item " itemscope="" itemprop="property" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/PropertyReference" itemid="mw_71177ba1-d8b0-420c-8941-644c2e594134"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_71177ba1-d8b0-420c-8941-644c2e594134" data-bs-target="#expand_accordion_body_mw_71177ba1-d8b0-420c-8941-644c2e594134" aria-controls="expand_accordion_body_mw_71177ba1-d8b0-420c-8941-644c2e594134" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="prop_Sensitivity" class="anchor_target"></span><h3 id="mw_71177ba1-d8b0-420c-8941-644c2e594134"><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/ReferenceEntity" itemprop="refentityobj"><meta itemprop="refentity" content="property:matlab.ode.ODEResults.Sensitivity"><code itemprop="name" id="propname_Sensitivity">Sensitivity</code></span> &#8212; <span itemprop="purpose">Sensitivity analysis results</span><br/>
<span class="add_font_color_general remove_bold"><span class="example_desc" itemprop="inputvalues">Read-only: <span itemprop="inputvalue">array</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_71177ba1-d8b0-420c-8941-644c2e594134" aria-labelledby="expand_accordion_heading_mw_71177ba1-d8b0-420c-8941-644c2e594134" class="accordion-collapse collapse"><div class="accordion-body"><p>This property is read-only.</p><div class="cshsummary" id="csh_mw_71177ba1-d8b0-420c-8941-644c2e594134"><p>Sensitivity analysis results, returned as an array.
                <code class="property">Sensitivity</code> has a number of columns equal to the number of
              parameters being analyzed, and the same number of rows as
                <code class="property">Solution</code>. The number of pages in the array is equal to the
              number of time steps.</p><p>Consider an ODE system of the form</p><div id="d126e1228203" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-15px" display="block"><mrow><mtable><mtr><mtd><mrow><mfrac><mrow><mi>d</mi><msub><mi>y</mi><mi>i</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><msub><mi>f</mi><mi>i</mi></msub><mrow><mo>(</mo><mrow><mi>t</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>p</mi></mrow><mo>)</mo></mrow><mo>,</mo></mrow></mtd><mtd><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi></mrow></mtd></mtr></mtable><mtext>​</mtext><mtext>​</mtext><mtext>​</mtext></mrow></math></p></div></div><p>The parameters <code class="literal">p</code> can be treated as independent variables to
              obtain the sensitivity functions</p><div id="d126e1228213" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-20px" display="block"><mrow><mtable><mtr><mtd><mrow><msub><mi>u</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mrow><mo>∂</mo><msub><mi>y</mi><mi>i</mi></msub></mrow><mrow><mo>∂</mo><msub><mi>p</mi><mi>j</mi></msub></mrow></mfrac><mo>,</mo></mrow></mtd><mtd><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi><mo>,</mo></mrow></mtd><mtd><mrow><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>m</mi></mrow></mtd></mtr></mtable></mrow></math></p></div></div><p>The sensitivity analysis results contain these partial derivative values of the
              equations taken with respect to the  parameters. You can control aspects of the
              sensitivity analysis by setting properties of the <a href="odesensitivity.html"><code class="object">odeSensitivity</code></a> object assigned to the <code class="property">Senstivity</code>
              property of the <code class="object">ode</code> object.</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item " itemscope="" itemprop="property" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/PropertyReference" itemid="mw_0d96a215-1218-4627-bc14-5353a73fc3a4"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_0d96a215-1218-4627-bc14-5353a73fc3a4" data-bs-target="#expand_accordion_body_mw_0d96a215-1218-4627-bc14-5353a73fc3a4" aria-controls="expand_accordion_body_mw_0d96a215-1218-4627-bc14-5353a73fc3a4" class="accordion-button add_cursor_pointer collapsed" aria-expanded="false"><span id="prop_EventSensitivity" class="anchor_target"></span><h3 id="mw_0d96a215-1218-4627-bc14-5353a73fc3a4"><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/ReferenceEntity" itemprop="refentityobj"><meta itemprop="refentity" content="property:matlab.ode.ODEResults.EventSensitivity"><code itemprop="name" id="propname_EventSensitivity">EventSensitivity</code></span> &#8212; <span itemprop="purpose">Sensitivity values at time of events</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc" itemprop="inputvalues">Read-only: <span itemprop="inputvalue">array</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_0d96a215-1218-4627-bc14-5353a73fc3a4" aria-labelledby="expand_accordion_heading_mw_0d96a215-1218-4627-bc14-5353a73fc3a4" class="accordion-collapse collapse"><div class="accordion-body"><p>This property is read-only.</p><div class="cshsummary" id="csh_mw_0d96a215-1218-4627-bc14-5353a73fc3a4"><p>Sensitivity values at time of events, returned as an array.
                <code class="property">EventSensitivity</code> has a number of columns equal to the number of
              parameters being analyzed, and the same number of rows as
                <code class="property">Solution</code>. The number of pages in the array is equal to the
              number of events, <code class="literal">numel(EventTime)</code>.</p></div></div></div></div></div></div></div></div></div></div></div><div class="examples"><h2 id="mw_b20f2d48-1847-463c-9067-6773e3f9b338">Examples</h2><div class="expandableContent" id="expandableExamples"><p class="switch"><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true3">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_b6f19642-afba-4525-8ee7-3ab3076c0bda"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_b6f19642-afba-4525-8ee7-3ab3076c0bda" data-bs-target="#expand_accordion_body_mw_b6f19642-afba-4525-8ee7-3ab3076c0bda" aria-controls="expand_accordion_body_mw_b6f19642-afba-4525-8ee7-3ab3076c0bda" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_b6f19642-afba-4525-8ee7-3ab3076c0bda">Solve Single ODE</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_b6f19642-afba-4525-8ee7-3ab3076c0bda" aria-labelledby="expand_accordion_heading_mw_b6f19642-afba-4525-8ee7-3ab3076c0bda" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/SolveSingleODEExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Solve Single ODE",
          "description": "Create an empty ode object, and then specify values for the ODEFcn and InitialValue properties.",
          "thumbnailURL": "../../examples/matlab/win64/SolveSingleODEExample_01.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "matlab.ode.oderesults.html"

        },
          "identifier": "matlab.SolveSingleODEExample",
          "name": "SolveSingleODEExample",
          "url": "matlab.ode.oderesults.html#mw_b6f19642-afba-4525-8ee7-3ab3076c0bda"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/SolveSingleODEExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "SolveSingleODEExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Create an empty <code class="literal">ode</code> object, and then specify values for the <code class="literal">ODEFcn</code> and <code class="literal">InitialValue</code> properties.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>F = ode;
F.ODEFcn = @(t,y) 2*t;
F.InitialValue = 0;</pre></div></div></div><p>Check which solver is selected for the problem, and then solve the equation over the time range <code class="literal">[0 10]</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>F.SelectedSolver</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans = 
  SolverID enumeration

    ode45

</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>sol = solve(F,0,10)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>sol = 
  ODEResults with properties:

        Time: [0 0.2500 0.5000 0.7500 1 1.2500 1.5000 1.7500 2 2.2500 2.5000 2.7500 3 3.2500 3.5000 3.7500 4 4.2500 4.5000 4.7500 5 5.2500 5.5000 5.7500 6 6.2500 6.5000 6.7500 7 7.2500 7.5000 7.7500 8 8.2500 8.5000 8.7500 9 9.2500 9.5000 9.7500 10]
    Solution: [0 0.0625 0.2500 0.5625 1.0000 1.5625 2.2500 3.0625 4 5.0625 6.2500 7.5625 9 10.5625 12.2500 14.0625 16 18.0625 20.2500 22.5625 25 27.5625 30.2500 33.0625 36 39.0625 42.2500 45.5625 49 52.5625 56.2500 60.0625 64 68.0625 … ] (1×41 double)

</pre></div></div></div><p>Plot the results.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>plot(sol.Time,sol.Solution,<span style="color:#A020F0">"-o"</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e1228299" class="mediaobject"><p><img src="../../examples/matlab/win64/SolveSingleODEExample_01.png" alt="Figure contains an axes object. The axes object contains an object of type line." width="560"></p></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-SolveSingleODEExample"><meta itemprop="exampletitle" content="Solve Single ODE"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_36feb7b8-a525-463d-a937-d7b145ab6dd4"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_36feb7b8-a525-463d-a937-d7b145ab6dd4" data-bs-target="#expand_accordion_body_mw_36feb7b8-a525-463d-a937-d7b145ab6dd4" aria-controls="expand_accordion_body_mw_36feb7b8-a525-463d-a937-d7b145ab6dd4" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_36feb7b8-a525-463d-a937-d7b145ab6dd4">Interpolate ODE Solution Outside of Original Interval</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_36feb7b8-a525-463d-a937-d7b145ab6dd4" aria-labelledby="expand_accordion_heading_mw_36feb7b8-a525-463d-a937-d7b145ab6dd4" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/InterpolateODEProblemOutsideOfOriginalIntervalExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Interpolate ODE Solution Outside of Original Interval",
          "description": "Create an ode object for the equations @(t,y) [y(2); 1000*(1-y(1)^2)*y(2)-y(1)] with the initial conditions [2 0]. Specify the solver as \"stiff\".",
          "thumbnailURL": "../../examples/matlab/win64/InterpolateODEProblemOutsideOfOriginalIntervalExample_01.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "matlab.ode.oderesults.html"

        },
          "identifier": "matlab.InterpolateODEProblemOutsideOfOriginalIntervalExample",
          "name": "InterpolateODEProblemOutsideOfOriginalIntervalExample",
          "url": "matlab.ode.oderesults.html#mw_36feb7b8-a525-463d-a937-d7b145ab6dd4"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/InterpolateODEProblemOutsideOfOriginalIntervalExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "InterpolateODEProblemOutsideOfOriginalIntervalExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Create an <code class="literal">ode</code> object for the equations <code class="literal">@(t,y) [y(2); 1000*(1-y(1)^2)*y(2)-y(1)]</code> with the initial conditions <code class="literal">[2 0]</code>. Specify the solver as <code class="literal">"stiff"</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>F = ode(ODEFcn=@(t,y) [y(2); 1000*(1-y(1)^2)*y(2)-y(1)],InitialValue=[2 0],Solver=<span style="color:#A020F0">"stiff"</span>);</pre></div></div></div><p>Create a function handle that can evaluate the solution of the problem in the interval <code class="literal">[0 1000]</code> by using the <code class="literal">solutionFcn</code> method. </p><div class="itemizedlist"><ul><li><p>Specify <code class="literal">Extension="on"</code> to enable the function handle to evaluate the solution at times outside of the original interval <code class="literal">[0 1000]</code>.</p></li><li><p>Specify <code class="literal">OutputVariables=1</code> so that the function handle interpolates only the first solution variable.</p></li><li><p>Specify two outputs to also return the integration results in the original interval.</p></li></ul></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[fh,S] = solutionFcn(F,0,1000,Extension=<span style="color:#A020F0">"on"</span>,OutputVariables=1)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>fh = <span class="emphasis"><em>function_handle with value:</em></span>
    @ode.solutionFcn/interpolate

</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>S = 
  ODEResults with properties:

        Time: [0 1.4606e-05 2.9212e-05 4.3818e-05 1.1010e-04 1.7639e-04 2.4267e-04 3.0896e-04 4.5006e-04 5.9116e-04 7.3226e-04 8.7336e-04 0.0010 0.0012 0.0013 0.0015 0.0017 0.0018 0.0021 0.0024 0.0027 0.0030 0.0033 0.0044 0.0055 0.0066 … ] (1×227 double)
    Solution: [2×227 double]

</pre></div></div></div><p>Extract and plot the integration results for the first solution variable in <code class="literal">S</code>, and then use the function handle <code class="literal">fh</code> to also evaluate the solution in the extended interval <code class="literal">[1000 3000]</code>. Plot the extended solution in red.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>plot(S.Time,S.Solution(1,:),<span style="color:#A020F0">"-o"</span>)
t = linspace(1000,3000);
ys = fh(t);
hold <span style="color:#A020F0">on</span>
plot(t,ys,<span style="color:#A020F0">"r-o"</span>)
hold <span style="color:#A020F0">off</span></pre></div></div></div><div class="informalfigure"><div id="d126e1228374" class="mediaobject"><p><img src="../../examples/matlab/win64/InterpolateODEProblemOutsideOfOriginalIntervalExample_01.png" alt="Figure contains an axes object. The axes object contains 2 objects of type line." width="560"></p></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-InterpolateODEProblemOutsideOfOriginalIntervalExample"><meta itemprop="exampletitle" content="Interpolate ODE Solution Outside of Original Interval"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_217afd8e-8013-4cca-9adc-22f158e6c6f7"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_217afd8e-8013-4cca-9adc-22f158e6c6f7" data-bs-target="#expand_accordion_body_mw_217afd8e-8013-4cca-9adc-22f158e6c6f7" aria-controls="expand_accordion_body_mw_217afd8e-8013-4cca-9adc-22f158e6c6f7" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_217afd8e-8013-4cca-9adc-22f158e6c6f7">Examine Parameter Sensitivity</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_217afd8e-8013-4cca-9adc-22f158e6c6f7" aria-labelledby="expand_accordion_heading_mw_217afd8e-8013-4cca-9adc-22f158e6c6f7" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/ParameterSensitivityExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Examine Parameter Sensitivity",
          "description": "Solve an ODE system with two equations and two parameters, and perform sensitivity analysis on the parameters.",
          "thumbnailURL": "../../examples/matlab/win64/ParameterSensitivityExample_02.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "matlab.ode.oderesults.html"

        },
          "identifier": "matlab.ParameterSensitivityExample",
          "name": "ParameterSensitivityExample",
          "url": "matlab.ode.oderesults.html#mw_217afd8e-8013-4cca-9adc-22f158e6c6f7"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/ParameterSensitivityExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "ParameterSensitivityExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Solve an ODE system with two equations and two parameters, and perform sensitivity analysis on the parameters.</p><p>Create an <code class="literal">ode</code> object to represent this system of equations.</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mtable columnalign="left"><mtr><mtd><mrow><mfrac><mrow><msub><mrow><mi mathvariant="normal">dy</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">dt</mi></mrow></mfrac><mo>=</mo><msub><mrow><mi mathvariant="italic">p</mi></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>-</mo><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mfrac><mrow><msub><mrow><mi mathvariant="normal">dy</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">dt</mi></mrow></mfrac><mo>=</mo><msub><mrow><mo>-</mo><mi mathvariant="italic">p</mi></mrow><mrow><mn>2</mn></mrow></msub><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mtd></mtr></mtable></mrow></math></p></div><p></p><p>Specify the initial conditions as <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub><mrow><mo>(</mo><mrow><mn>0</mn></mrow><mo>)</mo></mrow><mo>=</mo><mn>2</mn></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub><mrow><mo>(</mo><mrow><mn>0</mn></mrow><mo>)</mo></mrow><mo>=</mo><mn>3</mn></mrow></math></span>, and parameter values of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">p</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>=</mo><mn>0</mn><mo>.</mo><mn>05</mn></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">p</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>=</mo><mn>1</mn><mo>.</mo><mn>5</mn></mrow></math></span>. To enable sensitivity analysis of the parameters, set the <code class="literal">Sensitivity</code> property of the <code class="literal">ode</code> object to an <code class="literal">odeSensitivity</code> object.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>p = [0.05 1.5];
F = ode(ODEFcn=@(t,y,p) [p(1)*y(1)-y(2); -p(2)*y(2)], <span style="color:#0000FF">...</span>
        InitialValue=[2 3], <span style="color:#0000FF">...</span>
        Parameters=p, <span style="color:#0000FF">...</span>
        Sensitivity=odeSensitivity)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>F = 
  ode with properties:

   Problem definition
               ODEFcn: @(t,y,p)[p(1)*y(1)-y(2);-p(2)*y(2)]
           Parameters: [0.0500 1.5000]
          InitialTime: 0
         InitialValue: [2 3]
          Sensitivity: [1×1 odeSensitivity]
         EquationType: standard

   Solver properties
    AbsoluteTolerance: 1.0000e-06
    RelativeTolerance: 1.0000e-03
               Solver: auto
       SelectedSolver: cvodesnonstiff

  Show all properties


</pre></div></div></div><p>Because the equations are nonstiff and sensitivity analysis is enabled, the <code class="literal">ode</code> object automatically chooses the <code class="literal">cvodesnonstiff</code> solver for this problem.</p><p>Solve the ODE over the time interval <code class="literal">[0 5]</code>, and plot the solution for each component.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>S = solve(F,0,5)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>S = 
  ODEResults with properties:

           Time: [0 2.9540e-09 2.9543e-05 2.2465e-04 4.1976e-04 0.0024 0.0080 0.0137 0.0245 0.0353 0.0611 0.0869 0.1499 0.2129 0.3169 0.4208 0.5248 0.7204 0.9161 1.1118 1.3075 1.5031 1.6988 1.8945 2.0901 2.2858 2.4815 2.6772 2.8728 … ] (1×40 double)
       Solution: [2×40 double]
    Sensitivity: [2×2×40 double]

</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>plot(S.Time,S.Solution(1,:),<span style="color:#A020F0">"-o"</span>,S.Time,S.Solution(2,:),<span style="color:#A020F0">"-o"</span>)
legend(<span style="color:#A020F0">"y1"</span>,<span style="color:#A020F0">"y2"</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e1228563" class="mediaobject"><p><img src="../../examples/matlab/win64/ParameterSensitivityExample_01.png" alt="Figure contains an axes object. The axes object contains 2 objects of type line. These objects represent y1, y2." width="560"></p></div></div><p>The values in <code class="literal">S.Sensitivity</code> are partial derivatives of the equations with respect to the parameters. To examine the effects of the parameter values during the integration, plot the sensitivity values. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>figure
hold <span style="color:#A020F0">on</span>
plot(S.Time,squeeze(S.Sensitivity(1,1,:)),<span style="color:#A020F0">"-o"</span>)
plot(S.Time,squeeze(S.Sensitivity(1,2,:)),<span style="color:#A020F0">"-o"</span>)
plot(S.Time,squeeze(S.Sensitivity(2,1,:)),<span style="color:#A020F0">"-o"</span>)
plot(S.Time,squeeze(S.Sensitivity(2,2,:)),<span style="color:#A020F0">"-o"</span>)
legend(<span style="color:#A020F0">"p1,eq1"</span>,<span style="color:#A020F0">"p2,eq1"</span>,<span style="color:#A020F0">"p1,eq2"</span>,<span style="color:#A020F0">"p2,eq2"</span>)
hold <span style="color:#A020F0">off</span></pre></div></div></div><div class="informalfigure"><div id="d126e1228574" class="mediaobject"><p><img src="../../examples/matlab/win64/ParameterSensitivityExample_02.png" alt="Figure contains an axes object. The axes object contains 4 objects of type line. These objects represent p1,eq1, p2,eq1, p1,eq2, p2,eq2." width="560"></p></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-ParameterSensitivityExample"><meta itemprop="exampletitle" content="Examine Parameter Sensitivity"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_7347c528-0107-4ef7-9e3b-e3adcc3cb47f"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_7347c528-0107-4ef7-9e3b-e3adcc3cb47f" data-bs-target="#expand_accordion_body_mw_7347c528-0107-4ef7-9e3b-e3adcc3cb47f" aria-controls="expand_accordion_body_mw_7347c528-0107-4ef7-9e3b-e3adcc3cb47f" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_7347c528-0107-4ef7-9e3b-e3adcc3cb47f">Use Callback Function to Restart Integration of Bouncing Ball</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_7347c528-0107-4ef7-9e3b-e3adcc3cb47f" aria-labelledby="expand_accordion_heading_mw_7347c528-0107-4ef7-9e3b-e3adcc3cb47f" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/BouncingBallEventsExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Use Callback Function to Restart Integration of Bouncing Ball",
          "description": "Consider a ball thrown upward with an initial velocity dy/dt. The ball is subject to acceleration due to gravity aimed downward, so its acceleration is",
          "thumbnailURL": "../../examples/matlab/win64/BouncingBallEventsExample_01.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "matlab.ode.oderesults.html"

        },
          "identifier": "matlab.BouncingBallEventsExample",
          "name": "BouncingBallEventsExample",
          "url": "matlab.ode.oderesults.html#mw_7347c528-0107-4ef7-9e3b-e3adcc3cb47f"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/BouncingBallEventsExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "BouncingBallEventsExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Consider a ball thrown upward with an initial velocity <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">dy</mi><mo>/</mo><mi mathvariant="normal">dt</mi></mrow></math></span>. The ball is subject to acceleration due to gravity aimed downward, so its acceleration is</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mfrac><mrow><msup><mrow><mi>d</mi></mrow><mrow><mn>2</mn></mrow></msup><mi>y</mi></mrow><mrow><mi>d</mi><msup><mrow><mi>t</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac><mo>=</mo><mo>-</mo><mi>g</mi><mo stretchy="false">.</mo></mrow></math></p></div><p></p><p>Rewriting the equation as a first-order system of equations with the substitutions <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>=</mo><mi mathvariant="italic">y</mi></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>=</mo><mfrac><mrow><mi mathvariant="normal">dy</mi></mrow><mrow><mi mathvariant="normal">dt</mi></mrow></mfrac></mrow></math></span> yields</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mtable columnalign="left"><mtr><mtd><mrow><msubsup><mrow><mi>y</mi></mrow><mrow><mn>1</mn></mrow><mrow><mo>′</mo></mrow></msubsup><mo>=</mo><msub><mrow><mi>y</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mrow><mi>y</mi></mrow><mrow><mn>2</mn></mrow><mrow><mo>′</mo></mrow></msubsup><mo>=</mo><mo>-</mo><mi>g</mi><mo stretchy="false">.</mo></mrow></mtd></mtr></mtable></mrow></math></p></div><p></p><p>Solve the equations for the position <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></math></span> and velocity <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></math></span> of the ball over time. </p><div class="procedure"><span id="mw_c07cd0ce-01bd-4542-a385-1b4525c08fcc.BouncingBallEventsExample-1" class="anchor_target"></span><p class="title" id="mw_c07cd0ce-01bd-4542-a385-1b4525c08fcc_sep_BouncingBallEventsExample-1"><b>Define Equations and Initial Conditions</b></p><p>Create a function handle for the first-order system of equations that accepts two inputs for <code class="literal">(t,y)</code>. Use the value <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">g</mi><mo>=</mo><mn>9</mn><mo>.</mo><mn>8</mn></mrow></math></span> for the acceleration due to gravity.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>dydt = @(t,y) [y(2); -9.8];</pre></div></div></div><p>Next, create a vector with the initial conditions. The ball starts at position <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>=</mo><mn>3</mn></mrow></math></span> at <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">t</mi><mo>=</mo><mn>0</mn></mrow></math></span> as it is thrown upward with initial velocity <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>=</mo><mn>20</mn></mrow></math></span>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>y0 = [3 20];</pre></div></div></div><span id="mw_c07cd0ce-01bd-4542-a385-1b4525c08fcc.BouncingBallEventsExample-2" class="anchor_target"></span><p class="title" id="mw_c07cd0ce-01bd-4542-a385-1b4525c08fcc_sep_BouncingBallEventsExample-2"><b>Model Ball Bounces as Events</b></p><p>The ball initially travels upward until the force due to gravity causes it to change direction and head back down to the ground. If you solve the equations without more consideration, then the ball falls back downward forever without striking the ground. Instead, you can use an event function to detect when the position of the ball goes to zero where the ground is located. Because the solution component <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>=</mo><mi mathvariant="italic">y</mi></mrow></math></span> is the position of the ball, the event function tracks the value of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></math></span> so that an event triggers whenever <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>=</mo><mn>0</mn></mrow></math></span>.</p><p>Create a function handle for the event function that accepts two inputs for <code class="literal">(t,y)</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>bounceEvent = @(t,y) y(1);</pre></div></div></div><p>When the ball strikes the ground, its direction changes again as it heads back upwards with a new (smaller) initial velocity. To model this situation, use a callback function along with the event function. When an event triggers, the ODE solver invokes the callback function. The callback function resets the position and initial velocity of the ball so that the integration can restart with the correct initial conditions. When an event occurs, the callback function sets the position <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>=</mo><mn>0</mn></mrow></math></span> and attenuates the velocity by a factor of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mn>0</mn><mo>.</mo><mn>9</mn></mrow></math></span> while reversing its direction back upward. Define a callback function that performs these actions.</p><div class="code_responsive"><pre id="d126e1228844" class="programlisting"><span style="color:#0000FF">function</span> [stop,y] = bounceResponse(t,y)
stop = false;
y(1) = 0;
y(2) = -0.9*y(2);
<span style="color:#0000FF">end</span>
</pre></div><p>(The callback function is included as a local function at the end of the example.)</p><p>Create an <code class="literal">odeEvent</code> object to represent the bouncing ball events. Specify <code class="literal">Direction="descending"</code> so that only events where the position is decreasing are detected. Also, specify <code class="literal">Response="callback"</code> so that the solver invokes the callback function when an event occurs.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>E = odeEvent(EventFcn=bounceEvent, <span style="color:#0000FF">...</span>
             Direction=<span style="color:#A020F0">"descending"</span>, <span style="color:#0000FF">...</span>
             Response=<span style="color:#A020F0">"callback"</span>, <span style="color:#0000FF">...</span>
             CallbackFcn=@bounceResponse)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>E = 
  odeEvent with properties:

       EventFcn: @(t,y)y(1)
      Direction: descending
       Response: callback
    CallbackFcn: @bounceResponse

</pre></div></div></div><span id="mw_c07cd0ce-01bd-4542-a385-1b4525c08fcc.BouncingBallEventsExample-3" class="anchor_target"></span><p class="title" id="mw_c07cd0ce-01bd-4542-a385-1b4525c08fcc_sep_BouncingBallEventsExample-3"><b>Solve Equations</b></p><p>Create an <code class="literal">ode</code> object for the problem, specifying the equations <code class="literal">dydt</code>, initial conditions <code class="literal">y0</code>, and events <code class="literal">E</code> as property values.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>F = ode(ODEFcn=dydt,InitialValue=y0,EventDefinition=E);</pre></div></div></div><p>Integrate the equations over the time interval <code class="literal">[0 30]</code> by using the <code class="literal">solve</code> method. Specify <code class="literal">Refine=8</code> to generate 8 points per step. The resulting object has properties for the time and solution, and because events are being tracked, the object also displays properties related to the events that triggered during the integration.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>S = solve(F,0,30,Refine=8)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>S = 
  ODEResults with properties:

             Time: [0 0.0038 0.0075 0.0113 0.0151 0.0188 0.0226 0.0264 0.0301 0.0490 0.0678 0.0867 0.1055 0.1243 0.1432 0.1620 0.1809 0.2751 0.3692 0.4634 0.5576 0.6518 0.7460 0.8402 0.9344 1.3094 1.6844 2.0594 2.4344 2.8094 3.1844 … ] (1×468 double)
         Solution: [2×468 double]
        EventTime: [4.2265 8.1607 11.7015 14.8882 17.7563 20.3375 22.6606 24.7514 26.6331 28.3267 29.8509]
    EventSolution: [2×11 double]
       EventIndex: [1 1 1 1 1 1 1 1 1 1 1]

</pre></div></div></div><span id="mw_c07cd0ce-01bd-4542-a385-1b4525c08fcc.BouncingBallEventsExample-4" class="anchor_target"></span><p class="title" id="mw_c07cd0ce-01bd-4542-a385-1b4525c08fcc_sep_BouncingBallEventsExample-4"><b>Plot Results</b></p><p>Plot the position <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></math></span> of the ball over time, marking the initial position with a green circle and events with red circles.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>plot(S.Time,S.Solution(1,:),<span style="color:#A020F0">"--"</span>)
hold <span style="color:#A020F0">on</span>
plot(S.EventTime,S.EventSolution(1,:),<span style="color:#A020F0">"ro"</span>)
plot(0,y0(1),<span style="color:#A020F0">"go"</span>)
hold <span style="color:#A020F0">off</span>
ylim([0 25])
xlabel(<span style="color:#A020F0">"Time"</span>)
ylabel(<span style="color:#A020F0">"Position y_1"</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e1228902" class="mediaobject"><p><img src="../../examples/matlab/win64/BouncingBallEventsExample_01.png" alt="Figure contains an axes object. The axes object with xlabel Time, ylabel Position y indexOf 1 baseline Position y_1 contains 3 objects of type line. One or more of the lines displays its values using only markers" width="560"></p></div></div><span id="mw_c07cd0ce-01bd-4542-a385-1b4525c08fcc.BouncingBallEventsExample-5" class="anchor_target"></span><p class="title" id="mw_c07cd0ce-01bd-4542-a385-1b4525c08fcc_sep_BouncingBallEventsExample-5"><b>Local Functions</b></p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> [stop,y] = bounceResponse(t,y)
stop = false;
y(1) = 0;
y(2) = -0.9*y(2);
<span style="color:#0000FF">end</span></pre></div></div></div></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-BouncingBallEventsExample"><meta itemprop="exampletitle" content="Use Callback Function to Restart Integration of Bouncing Ball"></div></div></div></div><div class="ref_sect"><h2 id="mw_c07cd0ce-01bd-4542-a385-1b4525c08fcc_vh">Version History</h2><p><strong>Introduced in R2023b</strong></p></div><div class="ref_sect"><h2 id="mw_c07cd0ce-01bd-4542-a385-1b4525c08fcc_seealso">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="ode.html"><span itemprop="name"><code class="object">ode</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="odeevent.html"><span itemprop="name"><code class="object">odeEvent</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="odesensitivity.html"><span itemprop="name"><code class="object">odeSensitivity</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="ode.solve.html"><span itemprop="name"><code class="function">solve</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="ode.solutionfcn.html"><span itemprop="name"><code class="function">solutionFcn</code></span></a></span></p></div>
    </div></div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

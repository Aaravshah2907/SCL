<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>cgs</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../sparse-matrices.html",
          "name": "Sparse Matrices"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "sparse-matrices"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExtendedCapabilities",

        "itemListElement":
        [
{
          "@type": "ListItem",
          "position": 1,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "distributedarrays",
          "value": "limited"

        }
          },
{
          "@type": "ListItem",
          "position": 2,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "gpuarrays",
          "value": "limited"

        }
          },
{
          "@type": "ListItem",
          "position": 3,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "threadsupport",
          "value": "full"

        }
          }
        ]
        }
        </script>
<meta xmlns="http://www.w3.org/1999/xhtml" name="chunktype" content="refpage"><meta xmlns="http://www.w3.org/1999/xhtml" name="refentity" itemprop="refentity" content="function:cgs"><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="fcn">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ref/function">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This MATLAB function attempts to solve the system of linear equations A*x = b for x using the Conjugate Gradients Squared Method."><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "refentry";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../sparse-matrices.html?s_tid=CRUX_lftnav" itemprop="url" id="sparse-matrices"><span itemprop="title">Sparse Matrices</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item notranslate"><a href="#responsive_offcanvas"><span class="refname">cgs</span></a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-refentry">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li><a href="#f80-998594_sep_mw_ca18cf8e-f5fd-4d29-8647-8ad1b02a261f" class="intrnllnk">Syntax</a></li><li class="nav-item"><a href="#description" class="nav-link intrnllnk">Description</a></li><li class="nav-item"><a href="#f80-998594_sep_mw_b5e3743d-6775-476f-98c3-158d8667ef18" class="nav-link intrnllnk">Examples</a><ul class="nav"><li class="nav-item"><a href="#mw_093c4ffb-ecd6-4371-b5e1-13ded081ee33" class="nav-link intrnllnk">Iterative Solution to Linear System</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_6ec41967-285d-45c2-a645-85036e1ebfad" class="nav-link intrnllnk">Using <code class="literal">cgs</code> with Preconditioner</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_ee219d10-2f5a-41ab-9de3-b1e47a356856" class="nav-link intrnllnk">Supplying Initial Guess</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_f3867002-e4d7-4b20-9113-2d73daabffb8" class="nav-link intrnllnk">Using Function Handle Instead of Numeric Matrix</a></li></ul></li><li class="nav-item"><a href="#f80-998594_sep_mw_bbe848a2-1c66-4534-9176-4d00308aa219" class="nav-link intrnllnk">Input Arguments</a><ul class="nav"><li class="nav-item"><a href="#mw_c3949bfc-8b38-464c-bd0d-4467f274337e" class="nav-link intrnllnk">A</a></li><li class="nav-item"><a href="#f80-998594_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" class="nav-link intrnllnk">b</a></li><li class="nav-item"><a href="#f80-998594_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="nav-link intrnllnk">tol</a></li><li class="nav-item"><a href="#f80-998594_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" class="nav-link intrnllnk">maxit</a></li><li class="nav-item"><a href="#f80-998594_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" class="nav-link intrnllnk">M</a><a href="#f80-998594_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" class="nav-link intrnllnk">M1</a><a href="#f80-998594_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" class="nav-link intrnllnk">M2</a></li><li class="nav-item"><a href="#f80-998594_sep_mw_40e27791-2264-4d42-8cb6-b8bf869783bc" class="nav-link intrnllnk">x0</a></li></ul></li><li class="nav-item"><a href="#f80-998594_sep_mw_960ce4e0-3a43-430a-82c1-6ffe28ca848e" class="nav-link intrnllnk">Output Arguments</a><ul class="nav"><li class="nav-item"><a href="#f80-998594_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="nav-link intrnllnk">x</a></li><li class="nav-item"><a href="#f80-998594_sep_mw_1f278699-812f-4628-8d99-e8f6ae362e34" class="nav-link intrnllnk">flag</a></li><li class="nav-item"><a href="#f80-998594_sep_mw_6de229ba-091b-4137-acf4-6c7691a0398c" class="nav-link intrnllnk">relres</a></li><li class="nav-item"><a href="#f80-998594_sep_mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4" class="nav-link intrnllnk">iter</a></li><li class="nav-item"><a href="#f80-998594_sep_mw_e2a3240f-74d0-4b34-943e-502f3dd9d174" class="nav-link intrnllnk">resvec</a></li></ul></li><li class="nav-item"><a href="#mw_b49a2575-b930-4c57-bdd4-056fd527ece0" class="nav-link intrnllnk">More About</a><ul class="nav"><li class="nav-item"><a href="#mw_69e17635-3962-4f9e-abce-9af8d148c3ed" class="nav-link intrnllnk">Conjugate Gradients Squared Method</a></li></ul></li><li class="nav-item"><a href="#f80-998594_sep_mw_021450b1-4be9-4d57-b903-c4a2d800c810" class="nav-link intrnllnk">Tips</a></li><li><a href="#References" class="intrnllnk">References</a></li><li class="nav-item"><a href="#refsect-extended-capabilities" class="nav-link intrnllnk">Extended Capabilities</a></li><li class="nav-item"><a href="#mw_8021742f-759e-4b6a-bf43-27519353c38d" class="nav-link intrnllnk">Version History</a><ul class="nav"><li class="nav-item"><a href="#f80-998594_sep_mw_7463413e-98d4-46c3-a401-f17c5cf7a6c1" class="nav-link intrnllnk">Specify single-precision input arguments</a></li></ul></li><li class="nav-item"><a href="#f80-998594_seealso" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=sparse-matrices&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=sparse-matrices&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=sparse-matrices&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=sparse-matrices&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=sparse-matrices&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=sparse-matrices&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-ref-function"><div class="function_ref"><span id="f80-998594" class="anchor_target"></span><h1 class="r2025b notranslate" itemprop="title"><span class="refname">cgs</span></h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">Solve system of linear equations &#8212; conjugate gradients squared method</p><div class="switch"><a href="javascript:void(0);" id="expandAllPage" data-allexpanded="true1">collapse all in page</a></div></div></div>
<span id="f80-998594.mw_ca18cf8e-f5fd-4d29-8647-8ad1b02a261f" class="anchor_target"></span><div class="ref_sect"><h2 id="f80-998594_sep_mw_ca18cf8e-f5fd-4d29-8647-8ad1b02a261f">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><div class="code_responsive"><code class="synopsis"><a href="#d126e200628" class="intrnllnk">x = cgs(A,b)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e200655" class="intrnllnk">x = cgs(A,b,tol)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e200673" class="intrnllnk">x = cgs(A,b,tol,maxit)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e200695" class="intrnllnk">x = cgs(A,b,tol,maxit,M)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e200734" class="intrnllnk">x = cgs(A,b,tol,maxit,M1,M2)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e200764" class="intrnllnk">x = cgs(A,b,tol,maxit,M1,M2,x0)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e200791" class="intrnllnk">[x,flag] = cgs(<span class="argument_placeholder">___</span>)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e200815" class="intrnllnk">[x,flag,relres] = cgs(<span class="argument_placeholder">___</span>)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e200843" class="intrnllnk">[x,flag,relres,iter] = cgs(<span class="argument_placeholder">___</span>)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e200869" class="intrnllnk">[x,flag,relres,iter,resvec] = cgs(<span class="argument_placeholder">___</span>)</a></code></div></div></div></div><div class="clear"></div><span id="f80-998594.mw_37f9bc44-5f44-44ec-a215-d865b0f820a9" class="anchor_target"></span><h2 id="description">Description</h2><div class="descriptions"><div class="cshsummary" id="csh_f80-998594"><div class="description_module"><div class="description_element"><div class="code_responsive"><p><span id="d126e200628" itemprop="syntax"><code class="synopsis"><a href="#f80-998594_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a> = cgs(<a href="#mw_c3949bfc-8b38-464c-bd0d-4467f274337e" class="intrnllnk"><code class="argument">A</code></a>,<a href="#f80-998594_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" class="intrnllnk"><code class="argument">b</code></a>)</code></span>
        attempts to solve the system of linear equations <code class="literal">A*x = b</code> for
          <code class="literal">x</code> using the <a href="cgs.html#mw_69e17635-3962-4f9e-abce-9af8d148c3ed" class="intrnllnk">Conjugate Gradients Squared Method</a>. When the attempt is
        successful, <code class="function">cgs</code> displays a message to confirm convergence. If
          <code class="function">cgs</code> fails to converge after the maximum number of iterations or halts
        for any reason, it displays a diagnostic message that includes the relative residual
          <code class="literal">norm(b-A*x)/norm(b)</code> and the iteration number at which the method
        stopped.</p></div></div><div class="description_element"><div class="code_responsive"><p><span id="d126e200655" itemprop="syntax"><code class="synopsis"><a href="#f80-998594_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a> = cgs(<a href="#mw_c3949bfc-8b38-464c-bd0d-4467f274337e" class="intrnllnk"><code class="argument">A</code></a>,<a href="#f80-998594_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" class="intrnllnk"><code class="argument">b</code></a>,<a href="#f80-998594_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="intrnllnk"><code class="argument">tol</code></a>)</code></span>
        specifies a tolerance for the method. The default tolerance is
        <code class="literal">1e-6</code>.</p></div></div><div class="description_element"><div class="code_responsive"><p><span id="d126e200673" itemprop="syntax"><code class="synopsis"><a href="#f80-998594_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a> = cgs(<a href="#mw_c3949bfc-8b38-464c-bd0d-4467f274337e" class="intrnllnk"><code class="argument">A</code></a>,<a href="#f80-998594_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" class="intrnllnk"><code class="argument">b</code></a>,<a href="#f80-998594_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="intrnllnk"><code class="argument">tol</code></a>,<a href="#f80-998594_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" class="intrnllnk"><code class="argument">maxit</code></a>)</code></span>
        specifies the maximum number of iterations to use. <code class="function">cgs</code> displays a
        diagnostic message if it fails to converge within <code class="literal">maxit</code>
        iterations.</p></div></div><div class="description_element"><div class="code_responsive"><p><span id="d126e200695" itemprop="syntax"><code class="synopsis"><a href="#f80-998594_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a> = cgs(<a href="#mw_c3949bfc-8b38-464c-bd0d-4467f274337e" class="intrnllnk"><code class="argument">A</code></a>,<a href="#f80-998594_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" class="intrnllnk"><code class="argument">b</code></a>,<a href="#f80-998594_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="intrnllnk"><code class="argument">tol</code></a>,<a href="#f80-998594_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" class="intrnllnk"><code class="argument">maxit</code></a>,<a href="#f80-998594_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" class="intrnllnk"><code class="argument">M</code></a>)</code></span>
        specifies a preconditioner matrix <code class="literal">M</code> and computes <code class="literal">x</code> by
        effectively solving the system <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-7px" display="block"><mrow><mi>A</mi><msup><mi>M</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>y</mi><mo>=</mo><mi>b</mi></mrow></math></span></span> for <em class="varname">y</em>, where <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-7px" display="block"><mrow><mi>y</mi><mo>=</mo><mi>M</mi><mi>x</mi></mrow></math></span></span>. Using a preconditioner matrix can improve the numerical properties of the
        problem and the efficiency of the calculation.</p></div><p class="syntax_example"><a href="cgs.html#mw_6ec41967-285d-45c2-a645-85036e1ebfad" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e200734" itemprop="syntax"><code class="synopsis"><a href="#f80-998594_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a> = cgs(<a href="#mw_c3949bfc-8b38-464c-bd0d-4467f274337e" class="intrnllnk"><code class="argument">A</code></a>,<a href="#f80-998594_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" class="intrnllnk"><code class="argument">b</code></a>,<a href="#f80-998594_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="intrnllnk"><code class="argument">tol</code></a>,<a href="#f80-998594_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" class="intrnllnk"><code class="argument">maxit</code></a>,<a href="#f80-998594_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" class="intrnllnk"><code class="argument">M1</code></a>,<a href="#f80-998594_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" class="intrnllnk"><code class="argument">M2</code></a>)</code></span>
        specifies factors of the preconditioner matrix <code class="literal">M</code> such that <code class="literal">M =
          M1*M2</code>.</p></div><p class="syntax_example"><a href="cgs.html#mw_6ec41967-285d-45c2-a645-85036e1ebfad" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e200764" itemprop="syntax"><code class="synopsis"><a href="#f80-998594_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a> = cgs(<a href="#mw_c3949bfc-8b38-464c-bd0d-4467f274337e" class="intrnllnk"><code class="argument">A</code></a>,<a href="#f80-998594_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" class="intrnllnk"><code class="argument">b</code></a>,<a href="#f80-998594_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="intrnllnk"><code class="argument">tol</code></a>,<a href="#f80-998594_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" class="intrnllnk"><code class="argument">maxit</code></a>,<a href="#f80-998594_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" class="intrnllnk"><code class="argument">M1</code></a>,<a href="#f80-998594_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" class="intrnllnk"><code class="argument">M2</code></a>,<a href="#f80-998594_sep_mw_40e27791-2264-4d42-8cb6-b8bf869783bc" class="intrnllnk"><code class="argument">x0</code></a>)</code></span>
        specifies an initial guess for the solution vector <code class="literal">x</code>. The default is a
        vector of zeros.</p></div></div><div class="description_element"><div class="code_responsive"><p><span id="d126e200791" itemprop="syntax"><code class="synopsis">[<a href="#f80-998594_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a>,<a href="#f80-998594_sep_mw_1f278699-812f-4628-8d99-e8f6ae362e34" class="intrnllnk"><code class="argument">flag</code></a>] = cgs(<span class="argument_placeholder">___</span>)</code></span>
        returns a flag that specifies whether the algorithm successfully converged. When
          <code class="literal">flag = 0</code>, convergence was successful. You can use this output syntax
        with any of the previous input argument combinations. When you specify the
          <code class="literal">flag</code> output, <code class="function">cgs</code> does not display any diagnostic
        messages.</p></div><p class="syntax_example"><a href="cgs.html#mw_6ec41967-285d-45c2-a645-85036e1ebfad" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e200815" itemprop="syntax"><code class="synopsis">[<a href="#f80-998594_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a>,<a href="#f80-998594_sep_mw_1f278699-812f-4628-8d99-e8f6ae362e34" class="intrnllnk"><code class="argument">flag</code></a>,<a href="#f80-998594_sep_mw_6de229ba-091b-4137-acf4-6c7691a0398c" class="intrnllnk"><code class="argument">relres</code></a>] = cgs(<span class="argument_placeholder">___</span>)</code></span>
        also returns the relative residual <code class="literal">norm(b-A*x)/norm(b)</code>. If
          <code class="literal">flag</code> is <code class="literal">0</code>, then <code class="literal">relres &lt;=
        tol</code>.</p></div><p class="syntax_example"><a href="cgs.html#mw_6ec41967-285d-45c2-a645-85036e1ebfad" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e200843" itemprop="syntax"><code class="synopsis">[<a href="#f80-998594_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a>,<a href="#f80-998594_sep_mw_1f278699-812f-4628-8d99-e8f6ae362e34" class="intrnllnk"><code class="argument">flag</code></a>,<a href="#f80-998594_sep_mw_6de229ba-091b-4137-acf4-6c7691a0398c" class="intrnllnk"><code class="argument">relres</code></a>,<a href="#f80-998594_sep_mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4" class="intrnllnk"><code class="argument">iter</code></a>] = cgs(<span class="argument_placeholder">___</span>)</code></span>
        also returns the iteration number <code class="literal">iter</code> at which <code class="literal">x</code> was
        computed.</p></div><p class="syntax_example"><a href="cgs.html#mw_6ec41967-285d-45c2-a645-85036e1ebfad" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e200869" itemprop="syntax"><code class="synopsis">[<a href="#f80-998594_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a>,<a href="#f80-998594_sep_mw_1f278699-812f-4628-8d99-e8f6ae362e34" class="intrnllnk"><code class="argument">flag</code></a>,<a href="#f80-998594_sep_mw_6de229ba-091b-4137-acf4-6c7691a0398c" class="intrnllnk"><code class="argument">relres</code></a>,<a href="#f80-998594_sep_mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4" class="intrnllnk"><code class="argument">iter</code></a>,<a href="#f80-998594_sep_mw_e2a3240f-74d0-4b34-943e-502f3dd9d174" class="intrnllnk"><code class="argument">resvec</code></a>] = cgs(<span class="argument_placeholder">___</span>)</code></span>
        also returns a vector of the residual norms at each iteration, including the first residual
          <code class="literal">norm(b-A*x0)</code>.</p></div><p class="syntax_example"><a href="cgs.html#mw_6ec41967-285d-45c2-a645-85036e1ebfad" class="intrnllnk">example</a></p></div></div></div></div><div class="clear"></div><div class="examples"><h2 id="f80-998594_sep_mw_b5e3743d-6775-476f-98c3-158d8667ef18">Examples</h2><div class="expandableContent" id="expandableExamples"><p class="switch"><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true3">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_093c4ffb-ecd6-4371-b5e1-13ded081ee33"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_093c4ffb-ecd6-4371-b5e1-13ded081ee33" data-bs-target="#expand_accordion_body_mw_093c4ffb-ecd6-4371-b5e1-13ded081ee33" aria-controls="expand_accordion_body_mw_093c4ffb-ecd6-4371-b5e1-13ded081ee33" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_093c4ffb-ecd6-4371-b5e1-13ded081ee33">Iterative Solution to Linear System</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_093c4ffb-ecd6-4371-b5e1-13ded081ee33" aria-labelledby="expand_accordion_heading_mw_093c4ffb-ecd6-4371-b5e1-13ded081ee33" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/CGSLinearSystemExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Iterative Solution to Linear System",
          "description": "Solve a square linear system using cgs with default settings, and then adjust the tolerance and number of iterations used in the solution process.",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "cgs.html"

        },
          "identifier": "matlab.CGSLinearSystemExample",
          "name": "CGSLinearSystemExample",
          "url": "cgs.html#mw_093c4ffb-ecd6-4371-b5e1-13ded081ee33"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/CGSLinearSystemExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "CGSLinearSystemExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Solve a square linear system using <code class="literal">cgs</code> with default settings, and then adjust the tolerance and number of iterations used in the solution process.</p><p>Create a random sparse matrix <code class="literal">A</code> with 50% density. Also create a random vector for the right-hand side of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">Ax</mi><mo>=</mo><mi mathvariant="italic">b</mi></mrow></math></span>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>rng <span style="color:#A020F0">default</span>
A = sprand(600,600,.5);
A = A'*A + speye(size(A));
b = rand(600,1);</pre></div></div></div><p>Solve <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">Ax</mi><mo>=</mo><mi mathvariant="italic">b</mi></mrow></math></span> using <code class="literal">cgs</code>. The output display includes the value of the relative residual error <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mfrac><mrow><mrow><mo>‖</mo><mrow><mi mathvariant="italic">b</mi><mo>-</mo><mi mathvariant="normal">Ax</mi></mrow><mo>‖</mo></mrow></mrow><mrow><mrow><mo>‖</mo><mrow><mi mathvariant="italic">b</mi></mrow><mo>‖</mo></mrow></mrow></mfrac></mrow></math></span>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>x = cgs(A,b);</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>cgs stopped at iteration 20 without converging to the desired tolerance 1e-06
because the maximum number of iterations was reached.
The iterate returned (number 20) has relative residual 0.068.
</pre></div></div></div><p>By default <code class="literal">cgs</code> uses 20 iterations and a tolerance of <code class="literal">1e-6</code>, and the algorithm is unable to converge in those 20 iterations for this matrix. Since the residual is still large, it is a good indicator that more iterations (or a preconditioner matrix) are needed. You also can use a larger tolerance to make it easier for the algorithm to converge.</p><p>Solve the system again using a tolerance of <code class="literal">1e-4</code> and 40 iterations.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>x = cgs(A,b,1e-4,40);</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>cgs stopped at iteration 40 without converging to the desired tolerance 0.0001
because the maximum number of iterations was reached.
The iterate returned (number 40) has relative residual 0.0024.
</pre></div></div></div><p>Even with a looser tolerance and more iterations <code class="literal">cgs</code> does not converge. When an iterative algorithm stalls in this manner it is a good indication that a preconditioner matrix is needed.</p><p>Calculate the incomplete Cholesky factorization of <code class="literal">A</code>, and use the <code class="literal">L</code> factor as a preconditioner input to <code class="literal">cgs</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>L = ichol(A);
x = cgs(A,b,1e-4,40,L);</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>cgs converged at iteration 13 to a solution with relative residual 7.3e-05.
</pre></div></div></div><p>Using a preconditioner improves the numerical properties of the problem enough that <code class="literal">cgs</code> is able to converge.</p><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-CGSLinearSystemExample"><meta itemprop="exampletitle" content="Iterative Solution to Linear System"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_6ec41967-285d-45c2-a645-85036e1ebfad"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_6ec41967-285d-45c2-a645-85036e1ebfad" data-bs-target="#expand_accordion_body_mw_6ec41967-285d-45c2-a645-85036e1ebfad" aria-controls="expand_accordion_body_mw_6ec41967-285d-45c2-a645-85036e1ebfad" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_6ec41967-285d-45c2-a645-85036e1ebfad">Using <code class="literal">cgs</code> with Preconditioner</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_6ec41967-285d-45c2-a645-85036e1ebfad" aria-labelledby="expand_accordion_heading_mw_6ec41967-285d-45c2-a645-85036e1ebfad" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/UsingCgsWithAPreconditionerExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Using cgs with Preconditioner",
          "description": "Examine the effect of using a preconditioner matrix with cgs to solve a linear system.",
          "thumbnailURL": "../../examples/matlab/win64/UsingCgsWithAPreconditionerExample_01.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "cgs.html"

        },
          "identifier": "matlab.UsingCgsWithAPreconditionerExample",
          "name": "UsingCgsWithAPreconditionerExample",
          "url": "cgs.html#mw_6ec41967-285d-45c2-a645-85036e1ebfad"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/UsingCgsWithAPreconditionerExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "UsingCgsWithAPreconditionerExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Examine the effect of using a preconditioner matrix with <code class="literal">cgs</code> to solve a linear system.</p><p>Load west0479, a real 479-by-479 nonsymmetric sparse matrix.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>load <span style="color:#A020F0">west0479</span>
A = west0479;</pre></div></div></div><p>Define <code class="literal">b</code> so that the true solution to <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">Ax</mi><mo>=</mo><mi mathvariant="italic">b</mi></mrow></math></span> is a vector of all ones.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>b = sum(A,2);</pre></div></div></div><p>Set the tolerance and maximum number of iterations.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>tol = 1e-12;
maxit = 20;</pre></div></div></div><p>Use <code class="literal">cgs</code> to find a solution at the requested tolerance and number of iterations. Specify five outputs to return information about the solution process:</p><div class="itemizedlist"><ul><li><p><code class="literal">x</code> is the computed solution to <code class="literal">A*x = b</code>.</p></li><li><p><code class="literal">fl0</code> is a flag indicating whether the algorithm converged.</p></li><li><p><code class="literal">rr0</code> is the relative residual of the computed answer <code class="literal">x</code>.</p></li><li><p><code class="literal">it0</code> is the iteration number when <code class="literal">x</code> was computed.</p></li><li><p><code class="literal">rv0</code> is a vector of the residual history for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mrow><mo>‖</mo><mrow><mi mathvariant="italic">b</mi><mo>-</mo><mi mathvariant="normal">Ax</mi></mrow><mo>‖</mo></mrow></mrow></math></span>.</p></li></ul></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[x,fl0,rr0,it0,rv0] = cgs(A,b,tol,maxit);
fl0</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>fl0 = 
1
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>rr0</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>rr0 = 
1
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>it0</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>it0 = 
0
</pre></div></div></div><p><code class="literal">fl0</code> is <code class="literal">1</code> because <code class="literal">cgs</code> does not converge to the requested tolerance <code class="literal">1e-12</code> within the requested 20 iterations. In fact, the behavior of <code class="literal">cgs</code> is so poor that the initial guess <code class="literal">x0 = zeros(size(A,2),1)</code> is the best solution and is returned, as indicated by <code class="literal">it0 = 0</code>.</p><p>To aid with the slow convergence, you can specify a preconditioner matrix. Since <code class="literal">A</code> is nonsymmetric, use <code class="literal">ilu</code> to generate the preconditioner <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">M</mi><mo>=</mo><mi mathvariant="italic">L</mi><mtext> </mtext><mi mathvariant="italic">U</mi></mrow></math></span>. Specify a drop tolerance to ignore nondiagonal entries with values smaller than <code class="literal">1e-6</code>. Solve the preconditioned system <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><mi mathvariant="italic">A</mi><mtext> </mtext><mi mathvariant="italic">M</mi></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup><mi mathvariant="italic">M</mi><mtext> </mtext><mi mathvariant="italic">x</mi><mo>=</mo><mi mathvariant="italic">b</mi></mrow></math></span> by specifying <code class="literal">L</code> and <code class="literal">U</code> as inputs to <code class="literal">cgs</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>setup = struct(<span style="color:#A020F0">'type'</span>,<span style="color:#A020F0">'ilutp'</span>,<span style="color:#A020F0">'droptol'</span>,1e-6);
[L,U] = ilu(A,setup);
[x1,fl1,rr1,it1,rv1] = cgs(A,b,tol,maxit,L,U);
fl1</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>fl1 = 
0
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>rr1</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>rr1 = 
4.3850e-14
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>it1</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>it1 = 
3
</pre></div></div></div><p>The use of an <code class="literal">ilu</code> preconditioner produces a relative residual less than the prescribed tolerance of <code class="literal">1e-12</code> at the third iteration. The output <code class="literal">rv1(1)</code> is <code class="literal">norm(b)</code>, and the output <code class="literal">rv1(end)</code> is <code class="literal">norm(b-A*x1)</code>. </p><p>You can follow the progress of <code class="literal">cgs</code> by plotting the relative residuals at each iteration. Plot the residual history of each solution with a line for the specified tolerance.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>semilogy(0:length(rv0)-1,rv0/norm(b),<span style="color:#A020F0">'-o'</span>)
hold <span style="color:#A020F0">on</span>
semilogy(0:length(rv1)-1,rv1/norm(b),<span style="color:#A020F0">'-o'</span>)
yline(tol,<span style="color:#A020F0">'r--'</span>);
legend(<span style="color:#A020F0">'No preconditioner'</span>,<span style="color:#A020F0">'ILU preconditioner'</span>,<span style="color:#A020F0">'Tolerance'</span>,<span style="color:#A020F0">'Location'</span>,<span style="color:#A020F0">'East'</span>)
xlabel(<span style="color:#A020F0">'Iteration number'</span>)
ylabel(<span style="color:#A020F0">'Relative residual'</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e201208" class="mediaobject"><p><img src="../../examples/matlab/win64/UsingCgsWithAPreconditionerExample_01.png" alt="Figure contains an axes object. The axes object with xlabel Iteration number, ylabel Relative residual contains 3 objects of type line, constantline. These objects represent No preconditioner, ILU preconditioner, Tolerance." width="560"></p></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-UsingCgsWithAPreconditionerExample"><meta itemprop="exampletitle" content="Using cgs with Preconditioner"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_ee219d10-2f5a-41ab-9de3-b1e47a356856"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_ee219d10-2f5a-41ab-9de3-b1e47a356856" data-bs-target="#expand_accordion_body_mw_ee219d10-2f5a-41ab-9de3-b1e47a356856" aria-controls="expand_accordion_body_mw_ee219d10-2f5a-41ab-9de3-b1e47a356856" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_ee219d10-2f5a-41ab-9de3-b1e47a356856">Supplying Initial Guess</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_ee219d10-2f5a-41ab-9de3-b1e47a356856" aria-labelledby="expand_accordion_heading_mw_ee219d10-2f5a-41ab-9de3-b1e47a356856" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/CGSInitialGuessExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Supplying Initial Guess",
          "description": "Examine the effect of supplying cgs with an initial guess of the solution.",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "cgs.html"

        },
          "identifier": "matlab.CGSInitialGuessExample",
          "name": "CGSInitialGuessExample",
          "url": "cgs.html#mw_ee219d10-2f5a-41ab-9de3-b1e47a356856"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/CGSInitialGuessExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "CGSInitialGuessExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Examine the effect of supplying <code class="literal">cgs</code> with an initial guess of the solution.</p><p>Create a tridiagonal sparse matrix. Use the sum of each row as the vector for the right-hand side of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">Ax</mi><mo>=</mo><mi mathvariant="italic">b</mi></mrow></math></span> so that the expected solution for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi></mrow></math></span> is a vector of ones.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>n = 900;
e = ones(n,1);
A = spdiags([e 2*e e],-1:1,n,n);
b = sum(A,2);</pre></div></div></div><p>Use <code class="literal">cgs</code> to solve <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">Ax</mi><mo>=</mo><mi mathvariant="italic">b</mi></mrow></math></span> twice: one time with the default initial guess, and one time with a good initial guess of the solution. Use 200 iterations and the default tolerance for both solutions. Specify the initial guess in the second solution as a vector with all elements equal to <code class="literal">0.99</code>. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>maxit = 200;
x1 = cgs(A,b,[],maxit);</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>cgs converged at iteration 17 to a solution with relative residual 8.8e-07.
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>x0 = 0.99*e;
x2 = cgs(A,b,[],maxit,[],[],x0);</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>cgs converged at iteration 4 to a solution with relative residual 8e-07.
</pre></div></div></div><p>In this case supplying an initial guess enables <code class="literal">cgs</code> to converge more quickly.</p><div class="procedure"><span id="CGSInitialGuessExample-1" class="anchor_target"></span><p class="title" id="CGSInitialGuessExample-1"><b>Returning Intermediate Results</b></p><p>You also can use the initial guess to get intermediate results by calling <code class="literal">cgs</code> in a for-loop. Each call to the solver performs a few iterations and stores the calculated solution. Then you use that solution as the initial vector for the next batch of iterations. </p><p>For example, this code performs 100 iterations four times and stores the solution vector after each pass in the for-loop:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>x0 = zeros(size(A,2),1);
tol = 1e-8;
maxit = 100;
<span style="color:#0000FF">for</span> k = 1:4
    [x,flag,relres] = cgs(A,b,tol,maxit,[],[],x0);
    X(:,k) = x;
    R(k) = relres;
    x0 = x;
<span style="color:#0000FF">end</span></pre></div></div></div><p><code class="literal">X(:,k)</code> is the solution vector computed at iteration <code class="literal">k</code> of the for-loop, and <code class="literal">R(k)</code> is the relative residual of that solution.</p></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-CGSInitialGuessExample"><meta itemprop="exampletitle" content="Supplying Initial Guess"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_f3867002-e4d7-4b20-9113-2d73daabffb8"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_f3867002-e4d7-4b20-9113-2d73daabffb8" data-bs-target="#expand_accordion_body_mw_f3867002-e4d7-4b20-9113-2d73daabffb8" aria-controls="expand_accordion_body_mw_f3867002-e4d7-4b20-9113-2d73daabffb8" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_f3867002-e4d7-4b20-9113-2d73daabffb8">Using Function Handle Instead of Numeric Matrix</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_f3867002-e4d7-4b20-9113-2d73daabffb8" aria-labelledby="expand_accordion_heading_mw_f3867002-e4d7-4b20-9113-2d73daabffb8" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/CGSFunctionHandleExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Using Function Handle Instead of Numeric Matrix",
          "description": "Solve a linear system by providing cgs with a function handle that computes A*x in place of the coefficient matrix A.",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "cgs.html"

        },
          "identifier": "matlab.CGSFunctionHandleExample",
          "name": "CGSFunctionHandleExample",
          "url": "cgs.html#mw_f3867002-e4d7-4b20-9113-2d73daabffb8"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/CGSFunctionHandleExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "CGSFunctionHandleExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Solve a linear system by providing <code class="literal">cgs</code> with a function handle that computes <code class="literal">A*x</code> in place of the coefficient matrix <code class="literal">A</code>.</p><p>One of the Wilkinson test matrices generated by <code class="literal">gallery</code> is a 21-by-21 tridiagonal matrix. Preview the matrix.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>A = gallery(<span style="color:#A020F0">'wilk'</span>,21)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>A = <span class="emphasis"><em>21×21</em></span>

    10     1     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     1     9     1     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     1     8     1     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     1     7     1     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     1     6     1     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     1     5     1     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     1     4     1     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     1     3     1     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     1     2     1     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     1     1     1     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     1     0     1     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     1     1     1     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     1     2     1     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0     1     3     1     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0     0     1     4     1     0     0     0     0     0
      &#x22EE;

</pre></div></div></div><p>The Wilkinson matrix has a special structure, so you can represent the operation <code class="literal">A*x</code> with a function handle. When <code class="literal">A</code> multiplies a vector, most of the elements in the resulting vector are zeros. The nonzero elements in the result correspond with the nonzero tridiagonal elements of <code class="literal">A</code>. Moreover, only the main diagonal has nonzeros that are not equal to 1. </p><p>The expression <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">Ax</mi></mrow></math></span> becomes:</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">Ax</mi><mo>=</mo><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><mn>10</mn></mrow></mtd><mtd><mrow><mn>1</mn></mrow></mtd><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mo>&#x22EF;</mo></mrow></mtd><mtd><mrow><mi data-category="placeholder-atom"/></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mo data-category="structure">&#x22EF;</mo></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mi data-category="placeholder-atom"/></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mo data-category="structure">&#x22EF;</mo></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>0</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>0</mn></mrow></mtd></mtr><mtr data-category="structure-part"><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>1</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>9</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>1</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>0</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mi data-category="placeholder-atom"/></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mi data-category="placeholder-atom"/></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mi data-category="placeholder-atom"/></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mi data-category="placeholder-atom"/></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mi id="5CFAFBEB" data-category="placeholder-atom"/></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="54E037D8" data-category="placeholder"><mn id="B38EC078">0</mn></mrow></mtd></mtr><mtr id="9B4CF8A9" data-category="structure-part"><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="BB73F7D0" data-category="placeholder"><mn id="59689744">0</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="4A76FE70" data-category="placeholder"><mn id="3A9F4CC5">1</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="3639FA53" data-category="placeholder"><mn id="CA922D61">8</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="D7BF07BC" data-category="placeholder"><mn id="83C6278F">1</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="05FCA501" data-category="placeholder"><mn id="CF11BD39">0</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="E51EA33A" data-category="placeholder"><mi id="EF995190" data-category="placeholder-atom"/></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="6C535183" data-category="placeholder"><mi id="6B91ABF6" data-category="placeholder-atom"/></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="B99A0443" data-category="placeholder"><mi id="E6E374EA" data-category="placeholder-atom"/></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="A382FCD5" data-category="placeholder"><mi id="40506BFE" data-category="placeholder-atom"/></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="15B3577B" data-category="placeholder"><mo id="42E59279" data-category="structure">&#x22EE;</mo></mrow></mtd></mtr><mtr id="9B4CF8A9" data-category="structure-part"><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="E328089B" data-category="placeholder"><mo id="A90817EE" data-category="structure">&#x22EE;</mo></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="A741CB93" data-category="placeholder"><mn id="1EE570DC">0</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="3A2FE26D" data-category="placeholder"><mn id="194D27FB">1</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="40C72515" data-category="placeholder"><mn id="87AC19AF">7</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="FE315CAA" data-category="placeholder"><mn id="88F8B9A7">1</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="17C8D22F" data-category="placeholder"><mn id="5D3237E3">0</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="87802F84" data-category="placeholder"><mi id="192EB106" data-category="placeholder-atom"/></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="1C7D3AE1" data-category="placeholder"><mi id="FA4D3D50" data-category="placeholder-atom"/></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="9FF23EA3" data-category="placeholder"><mi id="5FD39F37" data-category="placeholder-atom"/></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="7C2463FF" data-category="placeholder"><mi id="7C2FFFAE" data-category="placeholder-atom"/></mrow></mtd></mtr><mtr id="9B4CF8A9" data-category="structure-part"><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="BFD00C04" data-category="placeholder"><mi id="80C6712A" data-category="placeholder-atom"/></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="8312CC91" data-category="placeholder"><mi id="EF33355A" data-category="placeholder-atom"/></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="1E7F8456" data-category="placeholder"><mn id="55870011">0</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="7E454958" data-category="placeholder"><mn id="16998AE2">1</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="34925E55" data-category="placeholder"><mn id="26C14B1E">6</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="1CFE2C98" data-category="placeholder"><mn id="A47DBA25">1</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="5F63CF0A" data-category="placeholder"><mn id="87275F61">0</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="FCD428CD" data-category="placeholder"><mi id="CA21787F" data-category="placeholder-atom"/></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="10FEA04C" data-category="placeholder"><mi id="41BF87CC" data-category="placeholder-atom"/></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="A7DD3DDC" data-category="placeholder"><mo id="4A5A8985" data-category="structure">&#x22EE;</mo></mrow></mtd></mtr><mtr id="9B4CF8A9" data-category="structure-part"><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="43265F28" data-category="placeholder"><mo id="E7E2DB83" data-category="structure">&#x22EE;</mo></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="B40B5A9B" data-category="placeholder"><mi id="5B7D0E2C" data-category="placeholder-atom"/></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="56ABFAD2" data-category="placeholder"><mi id="382F1581" data-category="placeholder-atom"/></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="3529B57C" data-category="placeholder"><mn id="0A2AB65D">0</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="7E03D67F" data-category="placeholder"><mn id="1B618848">1</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="6AE36434" data-category="placeholder"><mn id="72A0577B">5</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="4A84C550" data-category="placeholder"><mn id="909B5844">1</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="29115B52" data-category="placeholder"><mn id="6A6C71CD">0</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="73C39CDC" data-category="placeholder"><mi id="43E21FB5" data-category="placeholder-atom"/></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="507955C7" data-category="placeholder"><mi id="9CCF5F3B" data-category="placeholder-atom"/></mrow></mtd></mtr><mtr id="9B4CF8A9" data-category="structure-part"><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="B9A3E708" data-category="placeholder"><mi id="29730948" data-category="placeholder-atom"/></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="C50EE130" data-category="placeholder"><mi id="0D7D28F8" data-category="placeholder-atom"/></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="5D724EE6" data-category="placeholder"><mi id="19627BB9" data-category="placeholder-atom"/></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="EB69A299" data-category="placeholder"><mi id="793B0157" data-category="placeholder-atom"/></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="764007E9" data-category="placeholder"><mn id="083C6E02">0</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="160333FE" data-category="placeholder"><mn id="D17439C8">1</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="BE4235CF" data-category="placeholder"><mn id="951C126F">4</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="CCBE0953" data-category="placeholder"><mn id="BD0AA8B3">1</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="814C1C85" data-category="placeholder"><mn id="55A98D87">0</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="61DA6428" data-category="placeholder"><mo id="70416F50" data-category="structure">&#x22EE;</mo></mrow></mtd></mtr><mtr id="9B4CF8A9" data-category="structure-part"><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="1F08157F" data-category="placeholder"><mo id="1C2948AC" data-category="structure">&#x22EE;</mo></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="37D5FABC" data-category="placeholder"><mi id="40EA947B" data-category="placeholder-atom"/></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="AF0F27E3" data-category="placeholder"><mi id="7255C9C8" data-category="placeholder-atom"/></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="63BD0D9E" data-category="placeholder"><mi id="7A2AFF2A" data-category="placeholder-atom"/></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="63E1516A" data-category="placeholder"><mi id="0F19DF1D" data-category="placeholder-atom"/></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="DA8D68B6" data-category="placeholder"><mn id="925E2D20">0</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="4AF81FE1" data-category="placeholder"><mn id="60E6637F">1</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="0C483420" data-category="placeholder"><mn id="B4D3CFC6">3</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="E014400F" data-category="placeholder"><mo id="05E1AC98" data-category="structure">⋱</mo></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="793DD800" data-category="placeholder"><mn id="2BCD4DE9">0</mn></mrow></mtd></mtr><mtr id="9B4CF8A9" data-category="structure-part"><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="6555D8D9" data-category="placeholder"><mn id="E6E744B6">0</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="06854A28" data-category="placeholder"><mi id="568B0A6F" data-category="placeholder-atom"/></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="8B0A3860" data-category="placeholder"><mi id="9F575435" data-category="placeholder-atom"/></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="620190CD" data-category="placeholder"><mi id="5582BFFE" data-category="placeholder-atom"/></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="573552FD" data-category="placeholder"><mi id="251F9680" data-category="placeholder-atom"/></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="CBDF68E5" data-category="placeholder"><mi id="04254524" data-category="placeholder-atom"/></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="32E43178" data-category="placeholder"><mn id="C9BE766C">0</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="0D3A326A" data-category="placeholder"><mo id="255E5C0C" data-category="structure">⋱</mo></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="DD3D69E7" data-category="placeholder"><mo id="D66D2855" data-category="structure">⋱</mo></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="E731310C" data-category="placeholder"><mn id="398EA705">1</mn></mrow></mtd></mtr><mtr id="9B4CF8A9" data-category="structure-part"><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="6F0BE83D" data-category="placeholder"><mn id="C92DEB34">0</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="49203E59" data-category="placeholder"><mn id="67C0DC24">0</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="9DF6A5D2" data-category="placeholder"><mo id="DC423457" data-category="structure">&#x22EF;</mo></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="6B22AF0C" data-category="placeholder"><mi id="386A3C21" data-category="placeholder-atom"/></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="F8B25BA1" data-category="placeholder"><mo id="7E3E0A06" data-category="structure">&#x22EF;</mo></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="B8CAD8FA" data-category="placeholder"><mi id="3E6D442D" data-category="placeholder-atom"/></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="884F256B" data-category="placeholder"><mo id="BFCE6B52" data-category="structure">&#x22EF;</mo></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="874CDA10" data-category="placeholder"><mn id="FBDD1EF4">0</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="22144029" data-category="placeholder"><mn id="694E5F66">1</mn></mrow></mtd><mtd id="9B4CF8A9" data-category="structure-part"><mrow id="97FF4968" data-category="placeholder"><mn id="F6494C5F">10</mn></mrow></mtd></mtr></mtable><mo id="D3005C25" data-category="static">]</mo></mrow><mrow id="4B1CC66E" data-category="structure"><mo id="F74CBFD2" data-category="static">[</mo><mtable id="27C526C4" data-category="structure-part" columnalign="center"><mtr id="27C526C4" data-category="structure-part"><mtd id="27C526C4" data-category="structure-part"><mrow id="EE66AE95" data-category="placeholder"><msub id="579062DF" data-category="structure"><mrow id="A776B4C5" data-category="placeholder"><mi mathvariant="italic" id="475E1363">x</mi></mrow><mrow id="CE3768DF" data-category="placeholder"><mn id="34BA193A">1</mn></mrow></msub></mrow></mtd></mtr><mtr id="27C526C4" data-category="structure-part"><mtd id="27C526C4" data-category="structure-part"><mrow id="9CA3913C" data-category="placeholder"><msub id="A687A0C9" data-category="structure"><mrow id="4A9ECF49" data-category="placeholder"><mi mathvariant="italic" id="5B51C6A8">x</mi></mrow><mrow id="5FE49C74" data-category="placeholder"><mn id="A325A134">2</mn></mrow></msub></mrow></mtd></mtr><mtr id="27C526C4" data-category="structure-part"><mtd id="27C526C4" data-category="structure-part"><mrow id="C09E0D42" data-category="placeholder"><msub id="2CB7136B" data-category="structure"><mrow id="699FFE25" data-category="placeholder"><mi mathvariant="italic" id="CB8EAEDA">x</mi></mrow><mrow id="ECF0BFD7" data-category="placeholder"><mn id="0BF3E540">3</mn></mrow></msub></mrow></mtd></mtr><mtr id="27C526C4" data-category="structure-part"><mtd id="27C526C4" data-category="structure-part"><mrow id="5FD96058" data-category="placeholder"><msub id="79B99DC4" data-category="structure"><mrow id="DA458A74" data-category="placeholder"><mi mathvariant="italic" id="66E09CAF">x</mi></mrow><mrow id="2EBF6BB7" data-category="placeholder"><mn id="4755D912">4</mn></mrow></msub></mrow></mtd></mtr><mtr id="27C526C4" data-category="structure-part"><mtd id="27C526C4" data-category="structure-part"><mrow id="C3BD7596" data-category="placeholder"><msub id="E49A349A" data-category="structure"><mrow id="289EAFC5" data-category="placeholder"><mi mathvariant="italic" id="7729F7F6">x</mi></mrow><mrow id="4DBDD2C6" data-category="placeholder"><mn id="8894B647">5</mn></mrow></msub></mrow></mtd></mtr><mtr id="27C526C4" data-category="structure-part"><mtd id="27C526C4" data-category="structure-part"><mrow id="80CB0C7A" data-category="placeholder"><mo id="BE133DD7" data-category="structure">&#x22EE;</mo></mrow></mtd></mtr><mtr id="27C526C4" data-category="structure-part"><mtd id="27C526C4" data-category="structure-part"><mrow id="01F101E7" data-category="placeholder"><mi id="15631E04" data-category="placeholder-atom"/></mrow></mtd></mtr><mtr id="27C526C4" data-category="structure-part"><mtd id="27C526C4" data-category="structure-part"><mrow id="92A95F3D" data-category="placeholder"><mo id="71F9A054" data-category="structure">&#x22EE;</mo></mrow></mtd></mtr><mtr id="27C526C4" data-category="structure-part"><mtd id="27C526C4" data-category="structure-part"><mrow id="E607082C" data-category="placeholder"><mi id="1492D530" data-category="placeholder-atom"/></mrow></mtd></mtr><mtr id="27C526C4" data-category="structure-part"><mtd id="27C526C4" data-category="structure-part"><mrow id="B6B30258" data-category="placeholder"><msub id="49854FF5" data-category="structure"><mrow id="A5FF8245" data-category="placeholder"><mi mathvariant="italic" id="89BE91F4">x</mi></mrow><mrow id="9487361C" data-category="placeholder"><mn id="A10C5D58">21</mn></mrow></msub></mrow></mtd></mtr></mtable><mo id="45157F5B" data-category="static">]</mo></mrow><mo id="07971FA7">=</mo><mrow id="26893028" data-category="structure"><mo id="282A75A5" data-category="static">[</mo><mtable id="C8396102" data-category="structure-part" columnalign="center"><mtr id="C8396102" data-category="structure-part"><mtd id="C8396102" data-category="structure-part"><mrow id="1301743F"><mn id="ED0DBEE9">10</mn><msub id="8781D911" data-category="structure"><mrow id="667BCB65" data-category="placeholder"><mi mathvariant="italic" id="97F75651">x</mi></mrow><mrow id="0A30DA2F" data-category="placeholder"><mn id="7FE7792A">1</mn></mrow></msub><mo id="D5652660">+</mo><msub id="028AEE8E" data-category="structure"><mrow id="AF60D2F8" data-category="placeholder"><mi mathvariant="italic" id="0D18BC0E">x</mi></mrow><mrow id="EB3E1595" data-category="placeholder"><mn id="976C183C">2</mn></mrow></msub></mrow></mtd></mtr><mtr id="C8396102" data-category="structure-part"><mtd id="C8396102" data-category="structure-part"><mrow id="9D4541B0"><msub id="B8C09DF1" data-category="structure"><mrow id="D4AADD86" data-category="placeholder"><mi mathvariant="italic" id="0FBBFDF7">x</mi></mrow><mrow id="90B12A6C" data-category="placeholder"><mn id="CC6C4285">1</mn></mrow></msub><mo id="2DD065FA">+</mo><mn id="E07B173E">9</mn><msub id="8BEBCC7D" data-category="structure"><mrow id="9335EFBF" data-category="placeholder"><mi mathvariant="italic" id="89DA14FF">x</mi></mrow><mrow id="BBA9FDEF" data-category="placeholder"><mn id="A39A56BB">2</mn></mrow></msub><mo id="E81006DE">+</mo><msub id="045A2E8E" data-category="structure"><mrow id="90625DDB" data-category="placeholder"><mi mathvariant="italic" id="E9071955">x</mi></mrow><mrow id="846C1FE6" data-category="placeholder"><mn id="802943D6">3</mn></mrow></msub></mrow></mtd></mtr><mtr id="C8396102" data-category="structure-part"><mtd id="C8396102" data-category="structure-part"><mrow id="8E033F16"><msub id="8BE20F52" data-category="structure"><mrow id="A66C7F8E" data-category="placeholder"><mi mathvariant="italic" id="87FDEF3A">x</mi></mrow><mrow id="EC4C354D" data-category="placeholder"><mn id="845EB523">2</mn></mrow></msub><mo id="F991227D">+</mo><mn id="601ABB34">8</mn><msub id="1091EA59" data-category="structure"><mrow id="282096FC" data-category="placeholder"><mi mathvariant="italic" id="3B3E1192">x</mi></mrow><mrow id="53D737F1" data-category="placeholder"><mn id="4AEA2663">3</mn></mrow></msub><mo id="27957827">+</mo><msub id="2A57E167" data-category="structure"><mrow id="8DDCAFD9" data-category="placeholder"><mi mathvariant="italic" id="5E9294E7">x</mi></mrow><mrow id="AF489F13" data-category="placeholder"><mn id="5C345AB3">4</mn></mrow></msub></mrow></mtd></mtr><mtr id="C8396102" data-category="structure-part"><mtd id="C8396102" data-category="structure-part"><mrow id="33D14808"><mo id="27183012" data-category="structure">&#x22EE;</mo></mrow></mtd></mtr><mtr id="C8396102" data-category="structure-part"><mtd id="C8396102" data-category="structure-part"><mrow id="0527E965" data-category="placeholder"><msub id="D2D6A29E" data-category="structure"><mrow id="6C53D1B6" data-category="placeholder"><mi mathvariant="italic" id="D2BF5230">x</mi></mrow><mrow id="367112AD" data-category="placeholder"><mn id="5E8AD942">19</mn></mrow></msub><mo id="74381363">+</mo><mn id="84B714F2">9</mn><msub id="900C1D15" data-category="structure"><mrow id="B0BBC4CA" data-category="placeholder"><mi mathvariant="italic" id="515F1604">x</mi></mrow><mrow id="8500C808" data-category="placeholder"><mn id="66D00FF5">20</mn></mrow></msub><mo id="B0241696">+</mo><msub id="82910A0B" data-category="structure"><mrow id="E47B6FC9" data-category="placeholder"><mi mathvariant="italic" id="2E2AA06E">x</mi></mrow><mrow id="B1A462D4" data-category="placeholder"><mn id="F5361042">21</mn></mrow></msub></mrow></mtd></mtr><mtr id="C8396102" data-category="structure-part"><mtd id="C8396102" data-category="structure-part"><mrow id="DF1FD969" data-category="placeholder"><msub id="61237A8F" data-category="structure"><mrow id="473A13EC" data-category="placeholder"><mi mathvariant="italic" id="408D8046">x</mi></mrow><mrow id="C65C336D" data-category="placeholder"><mn id="43DA4605">20</mn></mrow></msub><mo id="3088AA97">+</mo><mn id="E1DBFBA1">10</mn><msub id="47342202" data-category="structure"><mrow id="90035D40" data-category="placeholder"><mi mathvariant="italic" id="4E8D728E">x</mi></mrow><mrow id="DE7F3E36" data-category="placeholder"><mn id="BB16AC15">21</mn></mrow></msub></mrow></mtd></mtr></mtable><mo id="C52495D4" data-category="static">]</mo></mrow></mrow></math></span>.</p><p>The resulting vector can be written as the sum of three vectors:</p><p><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">Ax</mi><mo>=</mo><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><mn>0</mn><mo>+</mo><mn>10</mn><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>+</mo><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>+</mo><mn>9</mn><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>+</mo><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>3</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>+</mo><mn>8</mn><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>3</mn></mrow></msub><mo>+</mo><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>4</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mo>&#x22EE;</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>19</mn></mrow></msub><mo>+</mo><mn>9</mn><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>20</mn></mrow></msub><mo>+</mo><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>21</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>20</mn></mrow></msub><mo>+</mo><mn>10</mn><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>21</mn></mrow></msub><mo>+</mo><mn>0</mn></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow></math></span>=<span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mo>&#x22EE;</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>20</mn></mrow></msub></mrow></mtd></mtr></mtable><mo>]</mo></mrow><mo>+</mo><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><mn>10</mn><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mn>9</mn><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mo>&#x22EE;</mo></mrow></mtd></mtr><mtr><mtd><mrow><mn>10</mn><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>21</mn></mrow></msub></mrow></mtd></mtr></mtable><mo>]</mo></mrow><mo>+</mo><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mo>&#x22EE;</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>21</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mn>0</mn></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow></math></span>.</p><p>In MATLAB&#174;, write a function that creates these vectors and adds them together, thus giving the value of <code class="literal">A*x</code>:</p><div class="code_responsive"><pre id="d126e202187" class="programlisting"><span style="color:#0000FF">function</span> y = afun(x)
y = [0; x(1:20)] + <span style="color:#0000FF">...</span>
    [(10:-1:0)'; (1:10)'].*x + <span style="color:#0000FF">...</span>
    [x(2:21); 0];
<span style="color:#0000FF">end</span>
</pre></div><p>(This function is saved as a local function at the end of the example.)</p><p>Now, solve the linear system <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">Ax</mi><mo>=</mo><mi mathvariant="italic">b</mi></mrow></math></span> by providing <code class="literal">cgs</code> with the function handle that calculates <code class="literal">A*x</code>. Use a tolerance of <code class="literal">1e-12</code> and 50 iterations.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>b = ones(21,1);
tol = 1e-12;  
maxit = 50;
x1 = cgs(@afun,b,tol,maxit)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>cgs converged at iteration 11 to a solution with relative residual 1.3e-14.
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>x1 = <span class="emphasis"><em>21×1</em></span>

    0.0910
    0.0899
    0.0999
    0.1109
    0.1241
    0.1443
    0.1544
    0.2383
    0.1309
    0.5000
    0.3691
    0.5000
    0.1309
    0.2383
    0.1544
      &#x22EE;

</pre></div></div></div><p>Check that <code class="literal">afun(x1)</code> produces a vector of ones.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>afun(x1)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans = <span class="emphasis"><em>21×1</em></span>

    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
      &#x22EE;

</pre></div></div></div><div class="procedure"><span id="CGSFunctionHandleExample-1" class="anchor_target"></span><p class="title" id="CGSFunctionHandleExample-1"><b>Local Functions</b></p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> y = afun(x)
y = [0; x(1:20)] + <span style="color:#0000FF">...</span>
    [(10:-1:0)'; (1:10)'].*x + <span style="color:#0000FF">...</span>
    [x(2:21); 0];
<span style="color:#0000FF">end</span></pre></div></div></div></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-CGSFunctionHandleExample"><meta itemprop="exampletitle" content="Using Function Handle Instead of Numeric Matrix"></div></div></div></div><div class="ref_sect"><h2 id="f80-998594_sep_mw_bbe848a2-1c66-4534-9176-4d00308aa219">Input Arguments</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="f80-998594.mw_bbe848a2-1c66-4534-9176-4d00308aa219_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="mw_c3949bfc-8b38-464c-bd0d-4467f274337e"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_c3949bfc-8b38-464c-bd0d-4467f274337e" data-bs-target="#expand_accordion_body_mw_c3949bfc-8b38-464c-bd0d-4467f274337e" aria-controls="expand_accordion_body_mw_c3949bfc-8b38-464c-bd0d-4467f274337e" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_A" class="anchor_target"></span><h3 id="mw_c3949bfc-8b38-464c-bd0d-4467f274337e"><code itemprop="name">A</code> &#8212; <span itemprop="purpose">Coefficient matrix</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">matrix</span> | <span itemprop="inputvalue">function handle</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_c3949bfc-8b38-464c-bd0d-4467f274337e" aria-labelledby="expand_accordion_heading_mw_c3949bfc-8b38-464c-bd0d-4467f274337e" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_c3949bfc-8b38-464c-bd0d-4467f274337e"><p>Coefficient matrix, specified as a square matrix or function handle. This matrix is
            the coefficient matrix in the linear system <code class="literal">A*x = b</code>. Generally,
              <code class="literal">A</code> is a large sparse matrix or a function handle that returns the
            product of a large sparse matrix and column vector.</p><h4 class="descriptionsect">Specifying <code class="literal">A</code> as a Function Handle</h4>
        <p>You can optionally specify the coefficient matrix as a function handle instead of a matrix.
        The function handle returns matrix-vector products instead of forming the entire coefficient
        matrix, making the calculation more efficient.</p><p>To use a function handle, use the function signature <code class="literal">function y = afun(x)</code>. <a href="../math/parameterizing-functions.html" class="a">Parameterizing Functions</a> explains how to provide additional parameters to the function <code class="function">afun</code>, if necessary. The function call <code class="literal">afun(x)</code> must return the value of <code class="literal">A*x</code>.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code> | <code itemprop="datatype">function_handle</code><br/>
<strong>Complex Number Support: </strong>Yes</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="f80-998594_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_f80-998594_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" data-bs-target="#expand_accordion_body_f80-998594_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" aria-controls="expand_accordion_body_f80-998594_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_b" class="anchor_target"></span><h3 id="f80-998594_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab"><code itemprop="name">b</code> &#8212; <span itemprop="purpose">Right side of linear equation</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">column vector</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_f80-998594_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" aria-labelledby="expand_accordion_heading_f80-998594_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f80-998594.mw_3800dea9-6306-44ef-9490-f16e20ceb7ab"><p>Right side of linear equation, specified as a
                                                  column vector. The length of <code class="literal">b</code>
                                                  must be equal to
                                                  <code class="literal">size(A,1)</code>.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code><br/>
<strong>Complex Number Support: </strong>Yes</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="f80-998594_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_f80-998594_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" data-bs-target="#expand_accordion_body_f80-998594_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" aria-controls="expand_accordion_body_f80-998594_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_tol" class="anchor_target"></span><h3 id="f80-998594_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b"><code itemprop="name">tol</code> &#8212; <span itemprop="purpose">Method tolerance</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue defaultvalue"><code class="literal">[]</code> or
                                    <code class="literal">1e-6</code></span> (default) | <span itemprop="inputvalue">positive scalar</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_f80-998594_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" aria-labelledby="expand_accordion_heading_f80-998594_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f80-998594.mw_b797b123-ccd8-4b99-a496-07d543d1a21b"><p>Method tolerance, specified as a positive scalar. Use this input to trade off accuracy and
                                    runtime in the calculation. <code class="function">cgs</code>
                                    must meet the tolerance within the number of allowed iterations
                                    to be successful. A smaller value of <code class="literal">tol</code>
                                    means the answer must be more precise for the calculation to be
                                    successful.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code></p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="f80-998594_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_f80-998594_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" data-bs-target="#expand_accordion_body_f80-998594_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" aria-controls="expand_accordion_body_f80-998594_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_maxit" class="anchor_target"></span><h3 id="f80-998594_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16"><code itemprop="name">maxit</code> &#8212; <span itemprop="purpose">Maximum number of iterations</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue defaultvalue"><code class="literal">[]</code> or <code class="literal">min(size(A,1),20)</code></span> (default) | <span itemprop="inputvalue">positive scalar integer</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_f80-998594_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" aria-labelledby="expand_accordion_heading_f80-998594_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f80-998594.mw_843917a7-f520-49f0-8815-7ffb3f307a16"><p>Maximum number of iterations, specified as a positive scalar integer. Increase the value of
                <code class="literal">maxit</code> to allow more iterations for
                <code class="function">cgs</code> to meet the tolerance <a href="#f80-998594_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="intrnllnk"><code class="argument">tol</code></a>.
            Generally, a smaller value of <code class="argument">tol</code> means more iterations are
            required to successfully complete the calculation.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code></p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="f80-998594_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_f80-998594_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" data-bs-target="#expand_accordion_body_f80-998594_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" aria-controls="expand_accordion_body_f80-998594_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_M" class="anchor_target"></span><span id="inputarg_M1" class="anchor_target"></span><span id="inputarg_M2" class="anchor_target"></span><h3 id="f80-998594_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667"><code itemprop="name">M</code>, <code itemprop="name">M1</code>, <code itemprop="name">M2</code> &#8212; <span itemprop="purpose">Preconditioner matrices (as separate arguments)</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue defaultvalue"><code class="literal">eye(size(A))</code></span> (default) | <span itemprop="inputvalue">matrices</span> | <span itemprop="inputvalue">function handles</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_f80-998594_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" aria-labelledby="expand_accordion_heading_f80-998594_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f80-998594.mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667"><p>Preconditioner matrices, specified as separate arguments of matrices or function
            handles. You can specify a preconditioner matrix <code class="literal">M</code> or its matrix
            factors <code class="literal">M = M1*M2</code> to improve the numerical aspects of the linear
            system and make it easier for <code class="function">cgs</code> to converge quickly. You
            can use the incomplete matrix factorization functions <a href="ilu.html"><code class="function">ilu</code></a> and <a href="ichol.html"><code class="function">ichol</code></a> to generate preconditioner
            matrices. You also can use <a href="equilibrate.html"><code class="function">equilibrate</code></a> prior to factorization to improve the condition number of
            the coefficient matrix. For more information on preconditioners, see <a href="../math/iterative-methods-for-linear-systems.html" class="a">Iterative Methods for Linear Systems</a>.</p><p><code class="function">cgs</code> treats unspecified preconditioners as identity
            matrices.</p>
            <h4 class="descriptionsect">Specifying <code class="literal">M</code> as a Function Handle</h4>
            <p>You can optionally specify any of <code class="literal">M</code>, <code class="literal">M1</code>, or
                    <code class="literal">M2</code> as function handles instead of matrices. The function
                handle performs matrix-vector operations instead of forming the entire
                preconditioner matrix, making the calculation more efficient.</p>
            <p>To use a function handle, use the function signature <code class="literal">function y =
                    mfun(x)</code>. <a href="../math/parameterizing-functions.html" class="a">Parameterizing Functions</a> explains
                how to provide additional parameters to the function <code class="function">mfun</code>, if
                necessary. The function call <code class="literal">mfun(x)</code> must return the value of
                    <code class="literal">M\x</code> or <code class="literal">M2\(M1\x)</code>.</p>
        </div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code> | <code itemprop="datatype">function_handle</code><br/>
<strong>Complex Number Support: </strong>Yes</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="f80-998594_sep_mw_40e27791-2264-4d42-8cb6-b8bf869783bc"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_f80-998594_sep_mw_40e27791-2264-4d42-8cb6-b8bf869783bc" data-bs-target="#expand_accordion_body_f80-998594_sep_mw_40e27791-2264-4d42-8cb6-b8bf869783bc" aria-controls="expand_accordion_body_f80-998594_sep_mw_40e27791-2264-4d42-8cb6-b8bf869783bc" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_x0" class="anchor_target"></span><h3 id="f80-998594_sep_mw_40e27791-2264-4d42-8cb6-b8bf869783bc"><code itemprop="name">x0</code> &#8212; <span itemprop="purpose">Initial guess</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue defaultvalue"><code class="literal">[]</code> or a column vector of zeros</span> (default) | <span itemprop="inputvalue">column vector</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_f80-998594_sep_mw_40e27791-2264-4d42-8cb6-b8bf869783bc" aria-labelledby="expand_accordion_heading_f80-998594_sep_mw_40e27791-2264-4d42-8cb6-b8bf869783bc" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f80-998594.mw_40e27791-2264-4d42-8cb6-b8bf869783bc"><p>Initial guess, specified as a column vector with length equal to <code class="literal">size(A,2)</code>.
            If you can provide <code class="function">cgs</code> with a more reasonable initial guess
                <code class="literal">x0</code> than the default vector of zeros, then it can save computation
            time and help the algorithm converge faster.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code><br/>
<strong>Complex Number Support: </strong>Yes</p></div></div></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="f80-998594_sep_mw_960ce4e0-3a43-430a-82c1-6ffe28ca848e">Output Arguments</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="f80-998594.mw_960ce4e0-3a43-430a-82c1-6ffe28ca848e_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_f80-998594_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" data-bs-target="#expand_accordion_body_f80-998594_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" aria-controls="expand_accordion_body_f80-998594_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_x" class="anchor_target"></span><h3 id="f80-998594_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7"><code class="name">x</code> &#8212; Linear system solution<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">column vector</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_f80-998594_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" aria-labelledby="expand_accordion_heading_f80-998594_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f80-998594.mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7"><p>Linear system solution, returned as a column vector. This output gives the approximate
            solution to the linear system <code class="literal">A*x = b</code>. If the calculation is
            successful (<code class="literal">flag = 0</code>), then <a href="#f80-998594_sep_mw_6de229ba-091b-4137-acf4-6c7691a0398c" class="intrnllnk"><code class="argument">relres</code></a> is less than
            or equal to <a href="#f80-998594_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="intrnllnk"><code class="argument">tol</code></a>.</p><p>Whenever the calculation is not successful (<code class="literal">flag ~= 0</code>), the solution
                <code class="literal">x</code> returned by <code class="function">cgs</code> is the one with
            minimal residual norm computed over all the iterations.</p></div><p class="datatypelist"><strong>Data Types: </strong><code>single</code> | <code>double</code></p></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_f80-998594_sep_mw_1f278699-812f-4628-8d99-e8f6ae362e34" data-bs-target="#expand_accordion_body_f80-998594_sep_mw_1f278699-812f-4628-8d99-e8f6ae362e34" aria-controls="expand_accordion_body_f80-998594_sep_mw_1f278699-812f-4628-8d99-e8f6ae362e34" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_flag" class="anchor_target"></span><h3 id="f80-998594_sep_mw_1f278699-812f-4628-8d99-e8f6ae362e34"><code class="name">flag</code> &#8212; Convergence flag<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">scalar</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_f80-998594_sep_mw_1f278699-812f-4628-8d99-e8f6ae362e34" aria-labelledby="expand_accordion_heading_f80-998594_sep_mw_1f278699-812f-4628-8d99-e8f6ae362e34" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f80-998594.mw_1f278699-812f-4628-8d99-e8f6ae362e34"><p>Convergence flag, returned as one of the scalar values in this table. The convergence flag
            indicates whether the calculation was successful and differentiates between several
            different forms of failure.</p>
<span id="f80-998594.mw_209843fd-4b3b-4dff-acd5-04a205074bab" class="anchor_target"></span><div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="50%"><col class="tcol2" width="50%"></colgroup><thead><tr><th><p>Flag Value</p></th><th><p>Convergence</p></th></tr></thead><tbody><tr><td><p><code class="literal">0</code></p></td><td><p>Success &#8212; <code class="function">cgs</code> converged to the
                                    desired tolerance <code class="literal">tol</code> within
                                        <code class="literal">maxit</code> iterations. </p></td></tr><tr><td><p><code class="literal">1</code></p></td><td><p>Failure &#8212; <code class="function">cgs</code> iterated
                                        <code class="literal">maxit</code> iterations but did not
                                    converge.</p></td></tr><tr><td><p><code class="literal">2</code></p></td><td><p>Failure &#8212; The preconditioner matrix <code class="literal">M</code> or
                                        <code class="literal">M = M1*M2</code> is ill
                                conditioned.</p></td></tr><tr><td><p><code class="literal">3</code></p></td><td><p>Failure &#8212; <code class="function">cgs</code> stagnated after
                                    two consecutive iterations were the same.</p></td></tr><tr><td><p><code class="literal">4</code></p></td><td><p>Failure &#8212; One of the scalar quantities calculated by the
                                        <code class="function">cgs</code> algorithm became too small
                                    or too large to continue computing.</p></td></tr></tbody></table></div><p>
</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_f80-998594_sep_mw_6de229ba-091b-4137-acf4-6c7691a0398c" data-bs-target="#expand_accordion_body_f80-998594_sep_mw_6de229ba-091b-4137-acf4-6c7691a0398c" aria-controls="expand_accordion_body_f80-998594_sep_mw_6de229ba-091b-4137-acf4-6c7691a0398c" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_relres" class="anchor_target"></span><h3 id="f80-998594_sep_mw_6de229ba-091b-4137-acf4-6c7691a0398c"><code class="name">relres</code> &#8212; Relative residual error<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">scalar</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_f80-998594_sep_mw_6de229ba-091b-4137-acf4-6c7691a0398c" aria-labelledby="expand_accordion_heading_f80-998594_sep_mw_6de229ba-091b-4137-acf4-6c7691a0398c" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f80-998594.mw_6de229ba-091b-4137-acf4-6c7691a0398c"><p>Relative residual error, returned as a scalar. The relative residual error <code class="literal">relres = norm(b-A*x)/norm(b)</code> is an indication of how accurate the answer is. If the calculation converges to the tolerance <a href="#f80-998594_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="intrnllnk"><code class="argument">tol</code></a> within <a href="#f80-998594_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" class="intrnllnk"><code class="argument">maxit</code></a> iterations, then <code class="literal">relres &lt;= tol</code>.</p></div><p class="datatypelist"><strong>Data Types: </strong><code>single</code> | <code>double</code></p></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_f80-998594_sep_mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4" data-bs-target="#expand_accordion_body_f80-998594_sep_mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4" aria-controls="expand_accordion_body_f80-998594_sep_mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_iter" class="anchor_target"></span><h3 id="f80-998594_sep_mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4"><code class="name">iter</code> &#8212; Iteration number<br/>
<span class="add_font_color_general remove_bold"><span class="example_desc">scalar</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_f80-998594_sep_mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4" aria-labelledby="expand_accordion_heading_f80-998594_sep_mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f80-998594.mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4"><p>Iteration number, returned as a scalar. This output indicates the iteration number at which
                                    the computed answer for <a href="#f80-998594_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a> was
                                    calculated.</p></div><p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_f80-998594_sep_mw_e2a3240f-74d0-4b34-943e-502f3dd9d174" data-bs-target="#expand_accordion_body_f80-998594_sep_mw_e2a3240f-74d0-4b34-943e-502f3dd9d174" aria-controls="expand_accordion_body_f80-998594_sep_mw_e2a3240f-74d0-4b34-943e-502f3dd9d174" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_resvec" class="anchor_target"></span><h3 id="f80-998594_sep_mw_e2a3240f-74d0-4b34-943e-502f3dd9d174"><code class="name">resvec</code> &#8212; Residual error<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">vector</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_f80-998594_sep_mw_e2a3240f-74d0-4b34-943e-502f3dd9d174" aria-labelledby="expand_accordion_heading_f80-998594_sep_mw_e2a3240f-74d0-4b34-943e-502f3dd9d174" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f80-998594.mw_e2a3240f-74d0-4b34-943e-502f3dd9d174"><p>Residual error, returned as a vector. The residual error <code class="literal">norm(b-A*x)</code>
            reveals how close the algorithm is to converging for a given value of
                <code class="literal">x</code>. The number of elements in <code class="literal">resvec</code> is equal
            to the number of iterations. You can examine the contents of <code class="literal">resvec</code>
            to help decide whether to change the values of <a href="#f80-998594_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="intrnllnk"><code class="argument">tol</code></a> or
                <a href="#f80-998594_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" class="intrnllnk"><code class="argument">maxit</code></a>.</p></div><p class="datatypelist"><strong>Data Types: </strong><code>single</code> | <code>double</code></p></div></div></div></div></div></div></div></div></div><div class="moreabout ref_sect"><h2 id="mw_b49a2575-b930-4c57-bdd4-056fd527ece0">More About</h2><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true2">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_mw_69e17635-3962-4f9e-abce-9af8d148c3ed" aria-controls="expand_body_mw_69e17635-3962-4f9e-abce-9af8d148c3ed" class="accordion-button" aria-expanded="true"><h3 id="mw_69e17635-3962-4f9e-abce-9af8d148c3ed">Conjugate Gradients Squared Method</h3></button></div><div id="expand_body_mw_69e17635-3962-4f9e-abce-9af8d148c3ed" class="accordion-collapse collapsed collapse show"><div class="accordion-body"><p class="shortdesc">The conjugate gradients squared (CGS) algorithm was developed as an
        improvement to the biconjugate gradient (BiCG) algorithm. Instead of using the residual and
        its conjugate, the CGS algorithm avoids using the transpose of the coefficient matrix by
        working with a squared residual [1].</p><p>CGS gains faster convergence for about the same computational cost as BiCG, but can have
        irregular convergence behavior, especially when the initial guess is close to the solution
          <a href="cgs.html#bqu3sck-1" class="intrnllnk">[1]</a>.</p></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="f80-998594_sep_mw_021450b1-4be9-4d57-b903-c4a2d800c810">Tips</h2><div class="itemizedlist"><ul><li><p>Convergence of most iterative methods depends on the condition number of the
                coefficient matrix, <code class="literal">cond(A)</code>. When <code class="literal">A</code> is square,
                you can use <a href="equilibrate.html"><code class="function">equilibrate</code></a> to improve its condition number, and on its own this
                makes it easier for most iterative solvers to converge. However, using
                    <code class="function">equilibrate</code> also leads to better quality preconditioner
                matrices when you subsequently factor the equilibrated matrix <code class="literal">B =
                    R*P*A*C</code>.</p></li><li><p>You can use matrix reordering functions such as <code class="function">dissect</code> and
                    <code class="function">symrcm</code> to permute the rows and columns of the coefficient
                matrix and minimize the number of nonzeros when the coefficient matrix is factored
                to generate a preconditioner. This can reduce the memory and time required to
                subsequently solve the preconditioned linear system.</p></li></ul></div></div><div class="bibliography"><h2 id="References">References</h2><div id="bqu3sck-1" class="bibliomixed"><p>[1] Barrett, R., M. Berry, T. F. Chan, et al., <em class="citetitle">Templates
        for the Solution of Linear Systems: Building Blocks for Iterative Methods</em>, SIAM,
      Philadelphia, 1994. </p></div><div id="bqu3scs-1" class="bibliomixed"><p>[2] Sonneveld, Peter, “CGS: A fast Lanczos-type solver for
      nonsymmetric linear systems,” <em class="citetitle">SIAM J. Sci. Stat. Comput.</em>,
      January 1989, Vol. 10, No. 1, pp. 36&#8211;52. </p></div></div><div class="ref_sect"><h2 id="refsect-extended-capabilities">Extended Capabilities</h2><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink">expand all</a></p><div id="accordion_refsect-extended-capabilities" role="tablist" aria-multiselectable="true"><span id="mw_1ab49027-7433-41b6-815a-9f24d8f39e11" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="f80-998594" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_f80-998594_threadsupport" aria-controls="expand_body_f80-998594_threadsupport" class="accordion-button collapsed" aria-expanded="false"><h3 id="f80-998594_threadsupport">Thread-Based Environment<br/> <span class=" remove_bold add_font_color_general">Run code in the background using MATLAB&#174; <code class="function">backgroundPool</code> or accelerate code with Parallel Computing Toolbox&#8482; <code class="function">ThreadPool</code>.</span></h3></button></div><div id="expand_body_f80-998594_threadsupport" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>This function fully supports thread-based environments. For
                more information, see <a href="../matlab_prog/run-functions-on-threads.html" class="a">Run MATLAB Functions in Thread-Based Environment</a>.</p></div></div></div></div></div><span id="mw_80d63079-f358-4e0d-a807-68ed00db0041" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="f80-998594" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_f80-998594_gpuarrays" aria-controls="expand_body_f80-998594_gpuarrays" class="accordion-button collapsed" aria-expanded="false"><h3 id="f80-998594_gpuarrays">GPU Arrays<br/> <span class=" remove_bold add_font_color_general">Accelerate code by running on a graphics processing unit (GPU) using Parallel Computing Toolbox&#8482;.</span></h3></button></div><div id="expand_body_f80-998594_gpuarrays" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>The <code class="function">cgs</code> function
    supports GPU array input with these usage notes and limitations:</p><div class="itemizedlist"><ul><li><p>When input <code class="literal">A</code> is a sparse matrix:</p>
<div class="itemizedlist"><ul><li><p>If
    you use two preconditioners, <code class="literal">M1</code> and <code class="literal">M2</code>, then they must be
    lower triangular and upper triangular matrices, or both of them must be function handles. Using
    lower triangular and upper triangular preconditioner matrices instead of function handles can
    significantly improve computation speed.</p></li><li><p><code class="function">cgs</code> does not detect stagnation (Flag 3). Instead, it
                  reports failure to converge (Flag 1).</p></li></ul></div><p>
</p></li></ul></div><p>For more information, see <a href="../../parallel-computing/run-matlab-functions-on-a-gpu.html" class="a">Run MATLAB Functions on a GPU</a><span role="cross_prod"> (Parallel Computing Toolbox)</span>.</p></div></div></div></div></div><span id="mw_de8d3164-f503-4129-93b2-be2dab44c2e8" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="f80-998594" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_f80-998594_distributedarrays" aria-controls="expand_body_f80-998594_distributedarrays" class="accordion-button collapsed" aria-expanded="false"><h3 id="f80-998594_distributedarrays">Distributed Arrays<br/> <span class=" remove_bold add_font_color_general">Partition large arrays across the combined memory of your cluster using Parallel Computing Toolbox&#8482;.</span></h3></button></div><div id="expand_body_f80-998594_distributedarrays" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>Usage notes and limitations:</p><div class="itemizedlist"><ul><li><p>If <code class="literal">M1</code> is a function, then it is applied independently to each
            row.</p></li></ul></div><p>For more information, see <a href="../../parallel-computing/run-matlab-functions-with-distributed-arrays.html" class="a">Run MATLAB Functions with Distributed Arrays</a><span role="cross_prod"> (Parallel Computing Toolbox)</span>.</p></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="mw_8021742f-759e-4b6a-bf43-27519353c38d">Version History</h2><strong>Introduced before R2006a</strong><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink">expand all</a></p><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="f80-998594.mw_7463413e-98d4-46c3-a401-f17c5cf7a6c1" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_f80-998594_sep_mw_7463413e-98d4-46c3-a401-f17c5cf7a6c1" aria-controls="expand_body_f80-998594_sep_mw_7463413e-98d4-46c3-a401-f17c5cf7a6c1" class="accordion-button collapsed" aria-expanded="false"><h3 id="f80-998594_sep_mw_7463413e-98d4-46c3-a401-f17c5cf7a6c1">R2025a: <span class="remove_bold">Specify single-precision input arguments</span></h3></button></div><div id="expand_body_f80-998594_sep_mw_7463413e-98d4-46c3-a401-f17c5cf7a6c1" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>You can specify these arguments as single precision:</p>
<div class="itemizedlist"><ul><li><p><code class="argument">A</code> &#8212; Coefficient matrix</p></li><li><p><code class="argument">b</code> &#8212; Right side of linear equation</p></li><li><p><code class="argument">M</code>, <code class="argument">M1</code>, <code class="argument">M2</code> &#8212;
                    Preconditioner matrices</p></li><li><p><code class="argument">x0</code> &#8212; Initial guess</p></li></ul></div><p>
</p><p>If you specify any of these arguments as single precision, the function computes in single
        precision and returns the linear system solution, relative residual error, and residual
        error outputs as type <code class="class">single</code>. For faster computation, specify all arguments,
        including function handle outputs, as the same precision.</p></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="f80-998594_seealso">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="bicg.html"><span itemprop="name"><code class="function">bicg</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="bicgstab.html"><span itemprop="name"><code class="function">bicgstab</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="gmres.html"><span itemprop="name"><code class="function">gmres</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="lsqr.html"><span itemprop="name"><code class="function">lsqr</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="ilu.html"><span itemprop="name"><code class="function">ilu</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="minres.html"><span itemprop="name"><code class="function">minres</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="pcg.html"><span itemprop="name"><code class="function">pcg</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="qmr.html"><span itemprop="name"><code class="function">qmr</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="symmlq.html"><span itemprop="name"><code class="function">symmlq</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="double.mldivide.html"><span itemprop="name"><code class="function">mldivide</code></span></a></span></p><div class="examples_container"><h3 class="remove_border">Topics</h3><div itemprop="content"><ul class="list-unstyled"><li><a href="../math/iterative-methods-for-linear-systems.html" class="a">Iterative Methods for Linear Systems</a></li></ul></div></div></div>
    </div></div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>linsolve</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../linear-algebra.html",
          "name": "Linear Algebra"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "linear-algebra"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExtendedCapabilities",

        "itemListElement":
        [
{
          "@type": "ListItem",
          "position": 1,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "codegen",
          "value": "limited"

        }
          },
{
          "@type": "ListItem",
          "position": 2,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "gpucodegen",
          "value": "limited"

        }
          },
{
          "@type": "ListItem",
          "position": 3,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "distributedarrays",
          "value": "full"

        }
          },
{
          "@type": "ListItem",
          "position": 4,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "threadsupport",
          "value": "full"

        }
          },
{
          "@type": "ListItem",
          "position": 5,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "gpuarrays",
          "value": "limited"

        }
          }
        ]
        }
        </script>
<meta xmlns="http://www.w3.org/1999/xhtml" name="chunktype" content="refpage"><meta xmlns="http://www.w3.org/1999/xhtml" name="refentity" itemprop="refentity" content="function:linsolve"><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="fcn">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ref/function">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This MATLAB function solves the linear system AX = B using one of these methods: When A is square, linsolve uses LU factorization with partial pivoting."><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "refentry";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../linear-algebra.html?s_tid=CRUX_lftnav" itemprop="url" id="linear-algebra"><span itemprop="title">Linear Algebra</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item notranslate"><a href="#responsive_offcanvas"><span class="refname">linsolve</span></a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-refentry">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li><a href="#mw_a94785f1-63c4-446a-adc0-0356a6d31999" class="intrnllnk">Syntax</a></li><li class="nav-item"><a href="#description" class="nav-link intrnllnk">Description</a></li><li class="nav-item"><a href="#mw_41c84511-bfba-499f-a392-72a62e8d9bce" class="nav-link intrnllnk">Examples</a><ul class="nav"><li class="nav-item"><a href="#mw_f405bef0-76ac-4c5b-8c40-c65d1a0a331e" class="nav-link intrnllnk">Solve Linear System</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_d462d960-7a5b-4cb5-991b-69d78594610c" class="nav-link intrnllnk">Suppress Matrix Condition Warnings</a></li></ul></li><li class="nav-item"><a href="#mw_293994f8-3c30-476d-b9b1-e3a85e4f9d30" class="nav-link intrnllnk">Input Arguments</a><ul class="nav"><li class="nav-item"><a href="#mw_52023500-1d5a-4bba-9a6d-2a77ab1fde3d" class="nav-link intrnllnk">A</a></li><li class="nav-item"><a href="#mw_6fc752ec-2a12-4102-99a0-f2bb6a1c1f56" class="nav-link intrnllnk">B</a></li><li class="nav-item"><a href="#mw_f23b9376-00ee-4eba-8af3-48ee240f0b77" class="nav-link intrnllnk">opts</a></li></ul></li><li class="nav-item"><a href="#mw_7666b08b-4d6b-4175-8f3b-c0c979bd9c6d" class="nav-link intrnllnk">Output Arguments</a><ul class="nav"><li class="nav-item"><a href="#mw_71546c16-6dd2-499c-9e78-916b923fdf59" class="nav-link intrnllnk">X</a></li><li class="nav-item"><a href="#mw_cc8f0b87-752f-4f69-8716-ddfe6aeec9f6" class="nav-link intrnllnk">r</a></li></ul></li><li class="nav-item"><a href="#mw_d996324e-f19a-467b-87da-ad4fe5e593ac" class="nav-link intrnllnk">Tips</a></li><li class="nav-item"><a href="#refsect-extended-capabilities" class="nav-link intrnllnk">Extended Capabilities</a></li><li class="nav-item"><a href="#f89-1017256_vh" class="nav-link intrnllnk">Version History</a></li><li class="nav-item"><a href="#f89-1017256_seealso" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=linear-algebra&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=linear-algebra&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=linear-algebra&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=linear-algebra&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=linear-algebra&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=linear-algebra&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-ref-function"><div class="function_ref"><span id="f89-1017256" class="anchor_target"></span><h1 class="r2025b notranslate" itemprop="title"><span class="refname">linsolve</span></h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">Solve linear system of equations</p><div class="switch"><a href="javascript:void(0);" id="expandAllPage" data-allexpanded="true1">collapse all in page</a></div></div></div>
<span id="mw_a94785f1-63c4-446a-adc0-0356a6d31999" class="anchor_target"></span><div class="ref_sect"><h2 id="mw_a94785f1-63c4-446a-adc0-0356a6d31999">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><div class="code_responsive"><code class="synopsis"><a href="#d126e1003863" class="intrnllnk">X = linsolve(A,B)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1003906" class="intrnllnk">X = linsolve(A,B,opts)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1003944" class="intrnllnk">[X,r] = linsolve(<span class="argument_placeholder">___</span>)</a></code></div></div></div></div><div class="clear"></div><span id="mw_6a5396ff-d8f9-42a7-9674-70bc60d34e9b" class="anchor_target"></span><h2 id="description">Description</h2><div class="descriptions"><div class="cshsummary" id="csh_f89-1017256"><div class="description_module"><div class="description_element"><div class="code_responsive"><p><span id="d126e1003863" itemprop="syntax"><code class="synopsis"><a href="#mw_71546c16-6dd2-499c-9e78-916b923fdf59" class="intrnllnk"><code class="argument">X</code></a> = linsolve(<a href="#mw_52023500-1d5a-4bba-9a6d-2a77ab1fde3d" class="intrnllnk"><code class="argument">A</code></a>,<a href="#mw_6fc752ec-2a12-4102-99a0-f2bb6a1c1f56" class="intrnllnk"><code class="argument">B</code></a>)</code></span>
        solves the linear system <span class="inlineequation"><em class="varname">A</em><em class="varname">X</em> = <em class="varname">B</em></span> using one of these methods:</p>
<div class="itemizedlist"><ul><li><p>When <code class="literal">A</code> is <span class="emphasis"><em>square</em></span>,
                <code class="function">linsolve</code> uses LU factorization with partial pivoting.</p></li><li><p>For all other cases, <code class="function">linsolve</code> uses QR factorization with
              column pivoting.</p></li></ul></div><p>
<code class="function">linsolve</code> warns if <code class="literal">A</code> is ill
        conditioned (for square matrices) or rank deficient (for rectangular matrices).</p></div><p class="syntax_example"><a href="linsolve.html#mw_d462d960-7a5b-4cb5-991b-69d78594610c" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e1003906" itemprop="syntax"><code class="synopsis"><a href="#mw_71546c16-6dd2-499c-9e78-916b923fdf59" class="intrnllnk"><code class="argument">X</code></a> = linsolve(<a href="#mw_52023500-1d5a-4bba-9a6d-2a77ab1fde3d" class="intrnllnk"><code class="argument">A</code></a>,<a href="#mw_6fc752ec-2a12-4102-99a0-f2bb6a1c1f56" class="intrnllnk"><code class="argument">B</code></a>,<a href="#mw_f23b9376-00ee-4eba-8af3-48ee240f0b77" class="intrnllnk"><code class="argument">opts</code></a>)</code></span>
        uses an appropriate solver as determined by the options structure <code class="literal">opts</code>.
        The fields in <code class="literal">opts</code> are logical values describing properties of the matrix
          <code class="literal">A</code>. For example, if <code class="literal">A</code> is an upper triangular matrix,
        you can set <code class="literal">opts.UT = true</code> to make <code class="function">linsolve</code> use a
        solver designed for upper triangular matrices. <code class="function">linsolve</code> does not test
        to verify that <code class="literal">A</code> has the properties specified in
        <code class="literal">opts</code>.</p></div><p class="syntax_example"><a href="linsolve.html#mw_f405bef0-76ac-4c5b-8c40-c65d1a0a331e" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e1003944" itemprop="syntax"><code class="synopsis">[<a href="#mw_71546c16-6dd2-499c-9e78-916b923fdf59" class="intrnllnk"><code class="argument">X</code></a>,<a href="#mw_cc8f0b87-752f-4f69-8716-ddfe6aeec9f6" class="intrnllnk"><code class="argument">r</code></a>] = linsolve(<span class="argument_placeholder">___</span>)</code></span>
        also returns <code class="literal">r</code>, which is the reciprocal of the condition number of
          <code class="literal">A</code> (for square matrices) or the rank of <code class="literal">A</code> (for
        rectangular matrices). You can use any of the input argument combinations in previous
        syntaxes. With this syntax, <code class="function">linsolve</code> does not warn if
          <code class="literal">A</code> is ill conditioned or rank deficient.</p></div><p class="syntax_example"><a href="linsolve.html#mw_d462d960-7a5b-4cb5-991b-69d78594610c" class="intrnllnk">example</a></p></div></div></div></div><div class="clear"></div><div class="examples"><h2 id="mw_41c84511-bfba-499f-a392-72a62e8d9bce">Examples</h2><div class="expandableContent" id="expandableExamples"><p class="switch"><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true3">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_f405bef0-76ac-4c5b-8c40-c65d1a0a331e"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_f405bef0-76ac-4c5b-8c40-c65d1a0a331e" data-bs-target="#expand_accordion_body_mw_f405bef0-76ac-4c5b-8c40-c65d1a0a331e" aria-controls="expand_accordion_body_mw_f405bef0-76ac-4c5b-8c40-c65d1a0a331e" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_f405bef0-76ac-4c5b-8c40-c65d1a0a331e">Solve Linear System</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_f405bef0-76ac-4c5b-8c40-c65d1a0a331e" aria-labelledby="expand_accordion_heading_mw_f405bef0-76ac-4c5b-8c40-c65d1a0a331e" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/CompareLinsolveAndBackslashExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Solve Linear System",
          "description": "Solve a linear system with both mldivide and linsolve to compare performance.",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "linsolve.html"

        },
          "identifier": "matlab.CompareLinsolveAndBackslashExample",
          "name": "CompareLinsolveAndBackslashExample",
          "url": "linsolve.html#mw_f405bef0-76ac-4c5b-8c40-c65d1a0a331e"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/CompareLinsolveAndBackslashExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "CompareLinsolveAndBackslashExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Solve a linear system with both <code class="literal">mldivide</code> and <code class="literal">linsolve</code> to compare performance.</p><p><code class="literal">mldivide</code> is the recommended way to solve most linear systems of equations in MATLAB&#174;. However, the function performs several checks on the input matrix to determine whether it has any special properties. If you know about the properties of the coefficient matrix ahead of time, then you can use <code class="literal">linsolve</code> to avoid time-consuming checks for large matrices.</p><p>Create a 10000-by-10000 magic square matrix and extract the lower triangular portion. Set the <code class="literal">LT</code> field of the <code class="literal">opts</code> structure to <code class="literal">true</code> to indicate that <code class="literal">A</code> is a lower triangular matrix.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>A = tril(magic(1e4));
opts.LT = true;</pre></div></div></div><p>Create a vector of ones for the right-hand side of the linear equation <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">Ax</mi><mo>=</mo><mi mathvariant="italic">b</mi></mrow></math></span>. The number of rows in <code class="literal">A</code> and <code class="literal">b</code> must be equal.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>b = ones(size(A,2),1);</pre></div></div></div><p>Solve the linear system <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true"><mi mathvariant="normal">Ax</mi><mo>=</mo><mi mathvariant="italic">b</mi></math></span> using <code class="literal">mldivide</code> and time the calculation.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>tic
x1 = A\b; 
t1 = toc</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>t1 = 
0.1105
</pre></div></div></div><p>Now, solve the system again using <code class="literal">linsolve</code>. Specify the options structure so that <code class="literal">linsolve</code> can select an appropriate solver for a lower triangular matrix.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>tic
x2 = linsolve(A,b,opts);
t2 = toc</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>t2 = 
0.0811
</pre></div></div></div><p>Compare the execution times to see how much faster <code class="literal">linsolve</code> is. As with any timing comparison, the results can vary between different computers and releases of MATLAB.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>speedup = t1/t2</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>speedup = 
1.3628
</pre></div></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-CompareLinsolveAndBackslashExample"><meta itemprop="exampletitle" content="Solve Linear System"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_d462d960-7a5b-4cb5-991b-69d78594610c"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_d462d960-7a5b-4cb5-991b-69d78594610c" data-bs-target="#expand_accordion_body_mw_d462d960-7a5b-4cb5-991b-69d78594610c" aria-controls="expand_accordion_body_mw_d462d960-7a5b-4cb5-991b-69d78594610c" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_d462d960-7a5b-4cb5-991b-69d78594610c">Suppress Matrix Condition Warnings</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_d462d960-7a5b-4cb5-991b-69d78594610c" aria-labelledby="expand_accordion_heading_mw_d462d960-7a5b-4cb5-991b-69d78594610c" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/SuppressMatrixConditionWarningsExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Suppress Matrix Condition Warnings",
          "description": "Solve a linear system using linsolve with two outputs to suppress matrix conditioning warnings.",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "linsolve.html"

        },
          "identifier": "matlab.SuppressMatrixConditionWarningsExample",
          "name": "SuppressMatrixConditionWarningsExample",
          "url": "linsolve.html#mw_d462d960-7a5b-4cb5-991b-69d78594610c"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/SuppressMatrixConditionWarningsExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "SuppressMatrixConditionWarningsExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Solve a linear system using <code class="literal">linsolve</code> with two outputs to suppress matrix conditioning warnings.</p><p>Create a 20-by-20 Hilbert test matrix. This matrix is nearly singular, with the largest singular value being about <code class="literal">2e18</code> larger than the smallest.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>A = hilb(20);</pre></div></div></div><p>Solve a linear system involving <code class="literal">A</code> with <code class="literal">linsolve</code>. Since <code class="literal">A</code> is nearly singular, <code class="literal">linsolve</code> returns a warning.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>b = ones(20,1);
x = linsolve(A,b);</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>Warning: Matrix is close to singular or badly scaled. Results may be inaccurate. RCOND =  1.276108e-19.
</pre></div></div></div><p>Now, solve the same linear system, but specify two outputs to <code class="literal">linsolve</code>. MATLAB&#174; suppresses the warning, and the second output <code class="literal">r</code> contains the reciprocal condition number of <code class="literal">A</code>. You can use this syntax to handle ill-conditioned matrices with special cases in your code, without the code producing a warning.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[x,r] = linsolve(A,b)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>x = <span class="emphasis"><em>20×1</em></span>
10<sup>8</sup> ×

    0.0000
   -0.0000
    0.0008
   -0.0144
    0.1448
   -0.8567
    3.1338
   -7.1545
    9.9712
   -8.4571
    6.6461
   -9.3842
    9.2835
   -2.2931
    1.7153
      &#x22EE;

</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>r = 
1.2761e-19
</pre></div></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-SuppressMatrixConditionWarningsExample"><meta itemprop="exampletitle" content="Suppress Matrix Condition Warnings"></div></div></div></div><div class="ref_sect"><h2 id="mw_293994f8-3c30-476d-b9b1-e3a85e4f9d30">Input Arguments</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="mw_293994f8-3c30-476d-b9b1-e3a85e4f9d30_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="mw_52023500-1d5a-4bba-9a6d-2a77ab1fde3d"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_52023500-1d5a-4bba-9a6d-2a77ab1fde3d" data-bs-target="#expand_accordion_body_mw_52023500-1d5a-4bba-9a6d-2a77ab1fde3d" aria-controls="expand_accordion_body_mw_52023500-1d5a-4bba-9a6d-2a77ab1fde3d" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_A" class="anchor_target"></span><h3 id="mw_52023500-1d5a-4bba-9a6d-2a77ab1fde3d"><code itemprop="name">A</code> &#8212; <span itemprop="purpose">Coefficient matrix</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">matrix</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_52023500-1d5a-4bba-9a6d-2a77ab1fde3d" aria-labelledby="expand_accordion_heading_mw_52023500-1d5a-4bba-9a6d-2a77ab1fde3d" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_52023500-1d5a-4bba-9a6d-2a77ab1fde3d"><p>Coefficient matrix. <code class="literal">A</code> appears in the system of linear equations
            on the left as <span class="inlineequation"><em class="varname">A</em><em class="varname">X</em> =
                <em class="varname">B</em></span>. The number of rows in <code class="literal">A</code> must equal the number of
            rows in <code class="literal">B</code>.</p><p><code class="literal">A</code> cannot be sparse. To solve a linear system involving a sparse
            matrix, use <a href="double.mldivide.html"><code class="function">mldivide</code></a> or <a href="decomposition.html"><code class="object">decomposition</code></a>
            instead.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code><br/>
<strong>Complex Number Support: </strong>Yes</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="mw_6fc752ec-2a12-4102-99a0-f2bb6a1c1f56"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_6fc752ec-2a12-4102-99a0-f2bb6a1c1f56" data-bs-target="#expand_accordion_body_mw_6fc752ec-2a12-4102-99a0-f2bb6a1c1f56" aria-controls="expand_accordion_body_mw_6fc752ec-2a12-4102-99a0-f2bb6a1c1f56" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_B" class="anchor_target"></span><h3 id="mw_6fc752ec-2a12-4102-99a0-f2bb6a1c1f56"><code itemprop="name">B</code> &#8212; <span itemprop="purpose">Input array</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">vector</span> | <span itemprop="inputvalue">matrix</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_6fc752ec-2a12-4102-99a0-f2bb6a1c1f56" aria-labelledby="expand_accordion_heading_mw_6fc752ec-2a12-4102-99a0-f2bb6a1c1f56" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_6fc752ec-2a12-4102-99a0-f2bb6a1c1f56"><p>Input array, specified as a vector or matrix. <code class="literal">B</code> appears in the
            system of linear equations on the right as <span class="inlineequation"><em class="varname">A</em><em class="varname">X</em> =
                <em class="varname">B</em></span>. If <code class="literal">B</code> is a matrix, then each column in the matrix
            represents a different vector for the right-hand side.</p><p>The number of rows in <code class="literal">A</code> must equal the number of rows in
              <code class="literal">B</code>.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code><br/>
<strong>Complex Number Support: </strong>Yes</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="mw_f23b9376-00ee-4eba-8af3-48ee240f0b77"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_f23b9376-00ee-4eba-8af3-48ee240f0b77" data-bs-target="#expand_accordion_body_mw_f23b9376-00ee-4eba-8af3-48ee240f0b77" aria-controls="expand_accordion_body_mw_f23b9376-00ee-4eba-8af3-48ee240f0b77" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_opts" class="anchor_target"></span><h3 id="mw_f23b9376-00ee-4eba-8af3-48ee240f0b77"><code itemprop="name">opts</code> &#8212; <span itemprop="purpose">Coefficient matrix properties</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">structure</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_f23b9376-00ee-4eba-8af3-48ee240f0b77" aria-labelledby="expand_accordion_heading_mw_f23b9376-00ee-4eba-8af3-48ee240f0b77" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_f23b9376-00ee-4eba-8af3-48ee240f0b77"><p>Coefficient matrix properties, specified as a structure. Use this structure to
            specify properties of <code class="literal">A</code> that <code class="function">linsolve</code> uses to
            select an appropriate solver for the linear system. The fields in the structure contain
              <code class="literal">true</code>/<code class="literal">false</code> values to indicate whether
              <code class="literal">A</code> has each property. By default all fields in the structure are
            assumed to be <code class="literal">false</code>. This table lists the possible fields in
              <code class="literal">opts</code> and their corresponding matrix properties.</p><div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="50%"><col class="tcol2" width="50%"></colgroup><thead><tr><th>Field</th><th>Matrix Property</th></tr></thead><tbody><tr><td><p><code class="literal">LT</code></p></td><td><p>Lower triangular (nonzero values appearing only on or below the main
                      diagonal)</p></td></tr><tr><td><p><code class="literal">UT</code></p></td><td><p>Upper triangular (nonzero values appearing only on or above the main
                      diagonal)</p></td></tr><tr><td><p><code class="literal">UHESS</code></p></td><td><p>Upper Hessenberg (all zero values below the first
                    subdiagonal)</p></td></tr><tr><td><p><code class="literal">SYM</code></p></td><td><p>Real symmetric or complex Hermitian (matrix equal to its
                      transpose)</p></td></tr><tr><td><p><code class="literal">POSDEF</code></p></td><td><p>Positive definite (all positive eigenvalues)</p></td></tr><tr><td><p><code class="literal">RECT</code></p></td><td><p>Rectangular matrix (different number of rows and
                    columns)</p></td></tr><tr><td><p><code class="literal">TRANSA</code></p></td><td><p>Conjugate transpose &#8212; Specifies whether the function solves
                        <code class="literal">A*X = B</code> (when <code class="literal">opts.TRANSA = false</code>) or
                      the transposed problem <code class="literal">A'*X = B</code> (when <code class="literal">opts.TRANSA
                        = true</code>)</p></td></tr></tbody></table></div><p class="description_valueexample"><strong>Example: </strong><code class="literal">opts.UT = true</code> specifies that <code class="literal">A</code> is
            upper triangular.</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">opts.SYM = true, opts.POSDEF = true</code> sets two fields to
            specify that <code class="literal">A</code> is symmetric and positive definite.</p>
            <h4 class="descriptionsect">Valid Combinations</h4>
            <p>The rows of this table list all combinations of field values in
                <code class="literal">opts</code> that are valid for <code class="function">linsolve</code>. Empty
              cells are the default value of <code class="literal">false</code>, and a
                <code class="literal">true</code>/<code class="literal">false</code> entry indicates that
                <code class="function">linsolve</code> accepts either value.</p>
            <div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="13%"><col class="tcol2" width="13%"><col class="tcol3" width="13%"><col class="tcol4" width="13%"><col class="tcol5" width="13%"><col class="tcol6" width="13%"><col class="tcol7" width="13%"><col class="tcol8" width="13%"></colgroup><thead><tr><th>&nbsp;</th><th><p><code class="literal">LT</code></p></th><th><p><code class="literal">UT</code></p></th><th><p><code class="literal">UHESS</code></p></th><th><p><code class="literal">SYM</code></p></th><th><p><code class="literal">POSDEF</code></p></th><th><p><code class="literal">RECT</code></p></th><th><p><code class="literal">TRANSA</code></p></th></tr></thead><tbody><tr><td><p><code class="literal">A</code> is lower triangular</p></td><td><p><code class="literal">true</code></p></td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td><p><code class="literal">true</code>/<code class="literal">false</code></p></td><td><p><code class="literal">true</code>/<code class="literal">false</code></p></td></tr><tr><td><p><code class="literal">A</code> is upper triangular</p></td><td>&nbsp;</td><td><p><code class="literal">true</code></p></td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td><p><code class="literal">true</code>/<code class="literal">false</code></p></td><td><p><code class="literal">true</code>/<code class="literal">false</code></p></td></tr><tr><td><p><code class="literal">A</code> is upper Hessenberg</p></td><td>&nbsp;</td><td>&nbsp;</td><td><p><code class="literal">true</code></p></td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td><p><code class="literal">true</code>/<code class="literal">false</code></p></td></tr><tr><td><p><code class="literal">A</code> is symmetric</p></td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td><p><code class="literal">true</code></p></td><td><p><code class="literal">true</code>/<code class="literal">false</code></p></td><td>&nbsp;</td><td><p><code class="literal">true</code>/<code class="literal">false</code></p></td></tr><tr><td><p><code class="literal">A</code> is   rectangular</p></td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td><p><code class="literal">true</code>/<code class="literal">false</code></p></td><td><p><code class="literal">true</code>/<code class="literal">false</code></p></td></tr></tbody></table></div>
          
            <h4 class="descriptionsect">Notes on Usage</h4>
            <div class="itemizedlist"><ul><li><p>If <code class="literal">A</code> has the properties in <code class="literal">opts</code>, then
                    <code class="function">linsolve</code> is faster compared to
                    <code class="function">mldivide</code>, because <code class="function">linsolve</code> invokes the
                  appropriate solver immediately and does not perform any tests to verify that
                    <code class="literal">A</code> has the specified properties.</p></li><li><p>If <code class="literal">A</code> does <span class="emphasis"><em>not</em></span> have the properties that
                  you specify in <code class="literal">opts</code>, then <code class="function">linsolve</code> returns
                  incorrect results and does not always return an error message. Therefore, if you
                  are unsure whether <code class="literal">A</code> has the specified properties, use
                    <a href="double.mldivide.html"><code class="function">mldivide</code></a> or <a href="decomposition.html"><code class="object">decomposition</code></a> instead.</p></li></ul></div>
          </div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">struct</code></p></div></div></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="mw_7666b08b-4d6b-4175-8f3b-c0c979bd9c6d">Output Arguments</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="mw_7666b08b-4d6b-4175-8f3b-c0c979bd9c6d_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_71546c16-6dd2-499c-9e78-916b923fdf59" data-bs-target="#expand_accordion_body_mw_71546c16-6dd2-499c-9e78-916b923fdf59" aria-controls="expand_accordion_body_mw_71546c16-6dd2-499c-9e78-916b923fdf59" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_X" class="anchor_target"></span><h3 id="mw_71546c16-6dd2-499c-9e78-916b923fdf59"><code class="name">X</code> &#8212; Linear system solution<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">vector | matrix</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_71546c16-6dd2-499c-9e78-916b923fdf59" aria-labelledby="expand_accordion_heading_mw_71546c16-6dd2-499c-9e78-916b923fdf59" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_71546c16-6dd2-499c-9e78-916b923fdf59"><p>Linear system solution, returned as a vector or matrix that satisfies <span class="inlineequation"><em class="varname">A</em><em class="varname">X</em> =
                <em class="varname">B</em></span> (or <span class="inlineequation"><em class="varname">A</em><sup>T</sup><em class="varname">X</em> =
                  <em class="varname">B</em></span> if <code class="literal">opts.TRANSA = true</code>). The size of
              <code class="literal">X</code> depends on whether <code class="literal">opts.TRANSA = true</code>:</p>
<div class="itemizedlist"><ul><li><p>If <code class="literal">A</code> is <code class="literal">m</code>-by-<code class="literal">n</code> and
                    <code class="literal">B</code> is <code class="literal">m</code>-by-<code class="literal">k</code>, then
                    <code class="literal">X</code> is <code class="literal">n</code>-by-<code class="literal">k</code> and is the
                  solution to <span class="inlineequation"><em class="varname">A</em><em class="varname">X</em> =
                      <em class="varname">B</em></span>.</p></li><li><p>If <code class="literal">opts.TRANSA = true</code>, then <code class="literal">A</code> is
                    <code class="literal">m</code>-by-<code class="literal">n</code> and <code class="literal">B</code> is
                    <code class="literal">n</code>-by-<code class="literal">k</code>. In this case, <code class="literal">X</code>
                  is <code class="literal">m</code>-by-<code class="literal">k</code> and is the solution to <span class="inlineequation"><em class="varname">A</em><sup>T</sup><em class="varname">X</em>
                      = <em class="varname">B</em></span>.</p></li></ul></div><p>
</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_cc8f0b87-752f-4f69-8716-ddfe6aeec9f6" data-bs-target="#expand_accordion_body_mw_cc8f0b87-752f-4f69-8716-ddfe6aeec9f6" aria-controls="expand_accordion_body_mw_cc8f0b87-752f-4f69-8716-ddfe6aeec9f6" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_r" class="anchor_target"></span><h3 id="mw_cc8f0b87-752f-4f69-8716-ddfe6aeec9f6"><code class="name">r</code> &#8212; Reciprocal condition number or rank<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">scalar</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_cc8f0b87-752f-4f69-8716-ddfe6aeec9f6" aria-labelledby="expand_accordion_heading_mw_cc8f0b87-752f-4f69-8716-ddfe6aeec9f6" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_cc8f0b87-752f-4f69-8716-ddfe6aeec9f6"><p>Reciprocal condition number or rank, returned as a scalar.</p><div class="itemizedlist"><ul><li><p>If <code class="literal">A</code> is a square matrix, then <code class="literal">r</code> is the
                reciprocal condition number of <code class="literal">A</code>. </p></li><li><p>If <code class="literal">A</code> is a rectangular matrix, then <code class="literal">r</code> is
                the rank of <code class="literal">A</code>.</p></li><li><p>If <code class="literal">opts</code> is specified, then <code class="literal">r</code> is the
                reciprocal of the condition number of <code class="literal">A</code> unless
                  <code class="literal">RECT</code> is <code class="literal">true</code> and both <code class="literal">LT</code>
                and <code class="literal">UT</code> are <code class="literal">false</code>, in which case,
                  <code class="literal">r</code> gives the rank of <code class="literal">A</code>.</p></li></ul></div></div></div></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="mw_d996324e-f19a-467b-87da-ad4fe5e593ac">Tips</h2><div class="itemizedlist"><ul><li><p>The speed benefit of <code class="function">linsolve</code> can vary depending on the matrix
          structure and the relative optimization of the underlying algorithms. In some cases (such
          as with small matrices) there might not be any speed-up compared to
            <code class="function">mldivide</code>. The speed benefit with <code class="function">linsolve</code>
          arises by avoiding costly checks on the properties of large matrices, or by choosing an
          algorithm that is better suited to the input than the choice that
            <code class="function">mldivide</code> makes.</p></li></ul></div></div><div class="ref_sect"><h2 id="refsect-extended-capabilities">Extended Capabilities</h2><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink">expand all</a></p><div id="accordion_refsect-extended-capabilities" role="tablist" aria-multiselectable="true"><span id="bvlxo0y-2" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="f89-1017256" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_f89-1017256_codegen" aria-controls="expand_body_f89-1017256_codegen" class="accordion-button collapsed" aria-expanded="false"><h3 id="f89-1017256_codegen">C/C++ Code Generation<br/> <span class=" remove_bold add_font_color_general">Generate C and C++ code using MATLAB&#174; Coder&#8482;.</span></h3></button></div><div id="expand_body_f89-1017256_codegen" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>
        <span>Usage notes and limitations:</span>
      </p><p>
        </p>
<div class="itemizedlist"><ul><li><p>The <code class="literal">opts</code> structure must be a constant scalar. Code generation
              does not support arrays of options structures.</p></li><li><p>Code generation only optimizes these cases:</p>
<div class="itemizedlist"><ul><li><p><code class="literal">UT</code></p></li><li><p><code class="literal">LT</code></p></li><li><p><code class="literal">UHESS</code> = <code class="literal">true</code> (the
                      <code class="literal">TRANSA</code> can be either <code class="literal">true</code> or
                      <code class="literal">false</code>)</p></li><li><p><code class="literal">SYM</code> = <code class="literal">true</code> and
                      <code class="literal">POSDEF</code> = <code class="literal">true</code></p></li></ul></div><p>
Other options are equivalent to using
              <code class="function">mldivide</code>.</p></li><li><p>Code generation does not support sparse matrix inputs for this
    function.</p></li></ul></div><p>

      </p></div></div></div></div></div><span id="mw_80da6aa6-e352-4783-8acf-790667a2d2e7" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="f89-1017256" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_f89-1017256_gpucodegen" aria-controls="expand_body_f89-1017256_gpucodegen" class="accordion-button collapsed" aria-expanded="false"><h3 id="f89-1017256_gpucodegen">GPU Code Generation<br/> <span class=" remove_bold add_font_color_general">Generate CUDA&#174; code for NVIDIA&#174; GPUs using GPU Coder&#8482;.</span></h3></button></div><div id="expand_body_f89-1017256_gpucodegen" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>Usage notes and limitations:</p><div class="itemizedlist"><ul><li><p>The <code class="literal">opts</code> structure must be a constant scalar. Code generation
            does not support arrays of options structures.</p></li><li><p>Code generation only optimizes these cases:</p>
<div class="itemizedlist"><ul><li><p><code class="literal">UT</code></p></li><li><p><code class="literal">LT</code></p></li><li><p><code class="literal">UHESS</code> = <code class="literal">true</code> (the
                    <code class="literal">TRANSA</code> can be either <code class="literal">true</code> or
                    <code class="literal">false</code>)</p></li><li><p><code class="literal">SYM</code> = <code class="literal">true</code> and <code class="literal">POSDEF</code>
                  = <code class="literal">true</code></p></li></ul></div><p>
Other options are equivalent to using
            <code class="function">mldivide</code>.</p></li><li><p>Code generation does not support sparse matrix
            inputs for this function.</p></li></ul></div></div></div></div></div></div><span id="mw_cc79d484-4a6b-4828-9cc0-423dea9ca527" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="f89-1017256" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_f89-1017256_threadsupport" aria-controls="expand_body_f89-1017256_threadsupport" class="accordion-button collapsed" aria-expanded="false"><h3 id="f89-1017256_threadsupport">Thread-Based Environment<br/> <span class=" remove_bold add_font_color_general">Run code in the background using MATLAB&#174; <code class="function">backgroundPool</code> or accelerate code with Parallel Computing Toolbox&#8482; <code class="function">ThreadPool</code>.</span></h3></button></div><div id="expand_body_f89-1017256_threadsupport" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>This function fully supports thread-based environments. For
                more information, see <a href="../matlab_prog/run-functions-on-threads.html" class="a">Run MATLAB Functions in Thread-Based Environment</a>.</p></div></div></div></div></div><span id="mw_b99fdf79-ea5f-4d87-b554-f22849984a4b" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="f89-1017256" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_f89-1017256_gpuarrays" aria-controls="expand_body_f89-1017256_gpuarrays" class="accordion-button collapsed" aria-expanded="false"><h3 id="f89-1017256_gpuarrays">GPU Arrays<br/> <span class=" remove_bold add_font_color_general">Accelerate code by running on a graphics processing unit (GPU) using Parallel Computing Toolbox&#8482;.</span></h3></button></div><div id="expand_body_f89-1017256_gpuarrays" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>Usage notes and limitations:</p><div class="itemizedlist"><ul><li><p>The two-output syntax <code class="literal">[x,r] = linsolve(___)</code> is not
            supported.</p></li><li><p>The MATLAB<sup>&#x00AE;</sup>
            <code class="literal">linsolve</code> function prints a warning if <code class="literal">A</code> is
            badly scaled, nearly singular, or rank deficient. The <code class="literal">gpuArray</code>
            <code class="literal">linsolve</code> is unable to check for this condition. Take action to avoid
            this condition.</p></li></ul></div><p>For more information, see <a href="../../parallel-computing/run-matlab-functions-on-a-gpu.html" class="a">Run MATLAB Functions on a GPU</a><span role="cross_prod"> (Parallel Computing Toolbox)</span>.</p></div></div></div></div></div><span id="mw_1d3cc741-19aa-492e-a269-ab8dfd09f467" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="f89-1017256" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_f89-1017256_distributedarrays" aria-controls="expand_body_f89-1017256_distributedarrays" class="accordion-button collapsed" aria-expanded="false"><h3 id="f89-1017256_distributedarrays">Distributed Arrays<br/> <span class=" remove_bold add_font_color_general">Partition large arrays across the combined memory of your cluster using Parallel Computing Toolbox&#8482;.</span></h3></button></div><div id="expand_body_f89-1017256_distributedarrays" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>This function fully supports distributed arrays. For more
    information, see <a href="../../parallel-computing/run-matlab-functions-with-distributed-arrays.html" class="a">Run MATLAB Functions with Distributed Arrays</a><span role="cross_prod"> (Parallel Computing Toolbox)</span>.</p></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="f89-1017256_vh">Version History</h2><p><strong>Introduced before R2006a</strong></p></div><div class="ref_sect"><h2 id="f89-1017256_seealso">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="double.mldivide.html"><span itemprop="name"><code class="function">mldivide</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="decomposition.html"><span itemprop="name"><code class="object">decomposition</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="lsqminnorm.html"><span itemprop="name"><code class="function">lsqminnorm</code></span></a></span></p><div class="examples_container"><h3 class="remove_border">Topics</h3><div itemprop="content"><ul class="list-unstyled"><li><a href="../math/systems-of-linear-equations.html" class="a">Systems of Linear Equations</a></li></ul></div></div></div>
    </div></div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

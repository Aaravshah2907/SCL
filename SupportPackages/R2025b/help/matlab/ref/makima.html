<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>makima</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../interpolation.html",
          "name": "Interpolation"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "interpolation"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExtendedCapabilities",

        "itemListElement":
        [
{
          "@type": "ListItem",
          "position": 1,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "codegen",
          "value": "limited"

        }
          },
{
          "@type": "ListItem",
          "position": 2,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "gpuarrays",
          "value": "full"

        }
          },
{
          "@type": "ListItem",
          "position": 3,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "threadsupport",
          "value": "full"

        }
          },
{
          "@type": "ListItem",
          "position": 4,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "distributedarrays",
          "value": "full"

        }
          }
        ]
        }
        </script>
<meta xmlns="http://www.w3.org/1999/xhtml" name="chunktype" content="refpage"><meta xmlns="http://www.w3.org/1999/xhtml" name="refentity" itemprop="refentity" content="function:makima"><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="fcn">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ref/function">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This MATLAB function performs Modified Akima Interpolation using the values y at sample points x to find interpolated values yq at the query points xq."><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "refentry";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../interpolation.html?s_tid=CRUX_lftnav" itemprop="url" id="btfpj5e"><span itemprop="title">Interpolation</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item notranslate"><a href="#responsive_offcanvas"><span class="refname">makima</span></a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-refentry">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li><a href="#mw_e3c8081f-aa35-4c4f-acaa-1bd22fd4ff9e" class="intrnllnk">Syntax</a></li><li class="nav-item"><a href="#description" class="nav-link intrnllnk">Description</a></li><li class="nav-item"><a href="#mw_fd60c418-c5a1-4e3d-b83b-94cbd0565969" class="nav-link intrnllnk">Examples</a><ul class="nav"><li class="nav-item"><a href="#mw_a1762e00-0c73-45d0-b474-e48008e52eef" class="nav-link intrnllnk">Akima Interpolation of Cosine Data</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_cc0c5239-ebe0-4fc7-ac39-f39077e687f3" class="nav-link intrnllnk">Data Interpolation with <code class="literal">spline</code>, <code class="literal">pchip</code>, and <code class="literal">makima</code></a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_dd39faaf-6e4d-4a25-9d8f-cfc24c75b16c" class="nav-link intrnllnk">Akima Interpolation with Piecewise Polynomial Structure</a></li></ul></li><li class="nav-item"><a href="#mw_4526fc42-ef48-4212-a29c-8998326a38b2" class="nav-link intrnllnk">Input Arguments</a><ul class="nav"><li class="nav-item"><a href="#mw_c93c9047-ef69-4c8d-8428-7a019ef13869" class="nav-link intrnllnk">x</a></li><li class="nav-item"><a href="#mw_20454c8c-9796-469b-8d1a-01ad70a6959f" class="nav-link intrnllnk">y</a></li><li class="nav-item"><a href="#mw_984580bc-270f-45c1-9191-c77d151c2fe3" class="nav-link intrnllnk">xq</a></li></ul></li><li class="nav-item"><a href="#mw_cb19cc20-2852-4b72-b222-6b905bea32b6" class="nav-link intrnllnk">Output Arguments</a><ul class="nav"><li class="nav-item"><a href="#mw_50c6a773-b566-4594-aad7-696cf0709899" class="nav-link intrnllnk">yq</a></li><li class="nav-item"><a href="#mw_f1743e2c-1c29-44ce-8d6e-02fcb5e3a2c1" class="nav-link intrnllnk">pp</a></li></ul></li><li class="nav-item"><a href="#mw_e22c9119-5a42-41de-8ecf-48ed54cee501" class="nav-link intrnllnk">More About</a><ul class="nav"><li class="nav-item"><a href="#mw_e8ee1c8c-2cc3-46c4-90c4-c3208804ff4e" class="nav-link intrnllnk">Modified Akima Interpolation</a></li></ul></li><li><a href="#References" class="intrnllnk">References</a></li><li class="nav-item"><a href="#refsect-extended-capabilities" class="nav-link intrnllnk">Extended Capabilities</a></li><li class="nav-item"><a href="#mw_fda58e3c-de78-4b86-beb0-98bd56d7d7b4_vh" class="nav-link intrnllnk">Version History</a></li><li class="nav-item"><a href="#mw_fda58e3c-de78-4b86-beb0-98bd56d7d7b4_seealso" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=interpolation&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=interpolation&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=interpolation&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=interpolation&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=interpolation&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=interpolation&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-ref-function"><div class="function_ref"><span id="mw_fda58e3c-de78-4b86-beb0-98bd56d7d7b4" class="anchor_target"></span><h1 class="r2025b notranslate" itemprop="title"><span class="refname">makima</span></h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">Modified Akima piecewise cubic Hermite interpolation</p><div class="switch"><a href="javascript:void(0);" id="expandAllPage" data-allexpanded="true1">collapse all in page</a></div></div></div>
<span id="mw_e3c8081f-aa35-4c4f-acaa-1bd22fd4ff9e" class="anchor_target"></span><div class="ref_sect"><h2 id="mw_e3c8081f-aa35-4c4f-acaa-1bd22fd4ff9e">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><div class="code_responsive"><code class="synopsis"><a href="#d126e1032980" class="intrnllnk">yq = makima(x,y,xq)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1033009" class="intrnllnk">pp = makima(x,y)</a></code></div></div></div></div><div class="clear"></div><span id="mw_b3ccbbc2-0dd9-4668-8f1d-ef732b8bc7b0" class="anchor_target"></span><h2 id="description">Description</h2><div class="descriptions"><div class="cshsummary" id="csh_mw_fda58e3c-de78-4b86-beb0-98bd56d7d7b4"><div class="description_module"><div class="description_element"><div class="code_responsive"><p><span id="d126e1032980" itemprop="syntax"><code class="synopsis"><a href="#mw_50c6a773-b566-4594-aad7-696cf0709899" class="intrnllnk"><code class="argument">yq</code></a> = makima(<a href="#mw_c93c9047-ef69-4c8d-8428-7a019ef13869" class="intrnllnk"><code class="argument">x</code></a>,<a href="#mw_20454c8c-9796-469b-8d1a-01ad70a6959f" class="intrnllnk"><code class="argument">y</code></a>,<a href="#mw_984580bc-270f-45c1-9191-c77d151c2fe3" class="intrnllnk"><code class="argument">xq</code></a>)</code></span>
        performs <a href="makima.html#mw_e8ee1c8c-2cc3-46c4-90c4-c3208804ff4e" class="intrnllnk">Modified Akima Interpolation</a> using the values
          <code class="literal">y</code> at sample points <code class="literal">x</code> to find interpolated values
          <code class="literal">yq</code> at the query points <code class="literal">xq</code>.</p></div><p class="syntax_example"><a href="makima.html#mw_cc0c5239-ebe0-4fc7-ac39-f39077e687f3" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e1033009" itemprop="syntax"><code class="synopsis"><a href="#mw_f1743e2c-1c29-44ce-8d6e-02fcb5e3a2c1" class="intrnllnk"><code class="argument">pp</code></a> = makima(<a href="#mw_c93c9047-ef69-4c8d-8428-7a019ef13869" class="intrnllnk"><code class="argument">x</code></a>,<a href="#mw_20454c8c-9796-469b-8d1a-01ad70a6959f" class="intrnllnk"><code class="argument">y</code></a>)</code></span>
        returns a piecewise polynomial structure for use with <code class="function">ppval</code> and the
        spline utility <code class="function">unmkpp</code>.</p></div><p class="syntax_example"><a href="makima.html#mw_dd39faaf-6e4d-4a25-9d8f-cfc24c75b16c" class="intrnllnk">example</a></p></div></div></div></div><div class="clear"></div><div class="examples"><h2 id="mw_fd60c418-c5a1-4e3d-b83b-94cbd0565969">Examples</h2><div class="expandableContent" id="expandableExamples"><p class="switch"><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true3">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_a1762e00-0c73-45d0-b474-e48008e52eef"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_a1762e00-0c73-45d0-b474-e48008e52eef" data-bs-target="#expand_accordion_body_mw_a1762e00-0c73-45d0-b474-e48008e52eef" aria-controls="expand_accordion_body_mw_a1762e00-0c73-45d0-b474-e48008e52eef" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_a1762e00-0c73-45d0-b474-e48008e52eef">Akima Interpolation of Cosine Data</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_a1762e00-0c73-45d0-b474-e48008e52eef" aria-labelledby="expand_accordion_heading_mw_a1762e00-0c73-45d0-b474-e48008e52eef" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/AkimaCosineExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Akima Interpolation of Cosine Data",
          "description": "Use makima to interpolate a cosine curve over unevenly spaced sample points.",
          "thumbnailURL": "../../examples/matlab/win64/AkimaCosineExample_02.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "makima.html"

        },
          "identifier": "matlab.AkimaCosineExample",
          "name": "AkimaCosineExample",
          "url": "makima.html#mw_a1762e00-0c73-45d0-b474-e48008e52eef"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/AkimaCosineExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "AkimaCosineExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Use <code class="literal">makima</code> to interpolate a cosine curve over unevenly spaced sample points.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>x = [0 1 2.5 3.6 5 7 8.1 10];
y = cos(x);
xq = 0:.25:10;
yq = makima(x,y,xq);
plot(x,y,<span style="color:#A020F0">'o'</span>,xq,yq,<span style="color:#A020F0">'--'</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e1033053" class="mediaobject"><p><img src="../../examples/matlab/win64/AkimaCosineExample_01.png" alt="Figure contains an axes object. The axes object contains 2 objects of type line. One or more of the lines displays its values using only markers" width="560"></p></div></div><p>With oscillatory functions, the Akima algorithm flattens the curve near local extrema. To compensate for this flattening, you can add more sample points near the local extrema.</p><p>Add sample points near <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi><mo>=</mo><mn>6</mn><mo>.</mo><mn>5</mn></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi><mo>=</mo><mn>9</mn></mrow></math></span> and replot the interpolation.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>x = [0 1 2.5 3.6 5 6.5 7 8.1 9 10];
y = cos(x);
xq = 0:.25:10;
yq = makima(x,y,xq);
plot(x,y,<span style="color:#A020F0">'o'</span>,xq,yq,<span style="color:#A020F0">'--'</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e1033081" class="mediaobject"><p><img src="../../examples/matlab/win64/AkimaCosineExample_02.png" alt="Figure contains an axes object. The axes object contains 2 objects of type line. One or more of the lines displays its values using only markers" width="560"></p></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-AkimaCosineExample"><meta itemprop="exampletitle" content="Akima Interpolation of Cosine Data"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_cc0c5239-ebe0-4fc7-ac39-f39077e687f3"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_cc0c5239-ebe0-4fc7-ac39-f39077e687f3" data-bs-target="#expand_accordion_body_mw_cc0c5239-ebe0-4fc7-ac39-f39077e687f3" aria-controls="expand_accordion_body_mw_cc0c5239-ebe0-4fc7-ac39-f39077e687f3" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_cc0c5239-ebe0-4fc7-ac39-f39077e687f3">Data Interpolation with <code class="literal">spline</code>, <code class="literal">pchip</code>, and <code class="literal">makima</code></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_cc0c5239-ebe0-4fc7-ac39-f39077e687f3" aria-labelledby="expand_accordion_heading_mw_cc0c5239-ebe0-4fc7-ac39-f39077e687f3" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/DataInterpolationComparisonExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Data Interpolation with spline, pchip, and makima",
          "description": "Compare the interpolation results produced by spline, pchip, and makima for two different data sets. These functions all perform different forms of piecewise cubic Hermite interpolation. Each function differs in how it computes the slopes of the interpolant, leading to different behaviors when the underlying data has flat areas or undulations.",
          "thumbnailURL": "../../examples/matlab/win64/DataInterpolationComparisonExample_02.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "makima.html"

        },
          "identifier": "matlab.DataInterpolationComparisonExample",
          "name": "DataInterpolationComparisonExample",
          "url": "makima.html#mw_cc0c5239-ebe0-4fc7-ac39-f39077e687f3"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/DataInterpolationComparisonExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "DataInterpolationComparisonExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Compare the interpolation results produced by <code class="literal">spline</code>, <code class="literal">pchip</code>, and <code class="literal">makima</code> for two different data sets. These functions all perform different forms of piecewise cubic Hermite interpolation. Each function differs in how it computes the slopes of the interpolant, leading to different behaviors when the underlying data has flat areas or undulations.</p><p>Compare the interpolation results on sample data that connects flat regions. Create vectors of <code class="literal">x</code> values, function values at those points <code class="literal">y</code>, and query points <code class="literal">xq</code>. Compute interpolations at the query points using  <code class="literal">spline</code>, <code class="literal">pchip</code>, and <code class="literal">makima</code>. Plot the interpolated function values at the query points for comparison.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>x = -3:3; 
y = [-1 -1 -1 0 1 1 1]; 
xq1 = -3:.01:3;
p = pchip(x,y,xq1);
s = spline(x,y,xq1);
m = makima(x,y,xq1);
plot(x,y,<span style="color:#A020F0">'o'</span>,xq1,p,<span style="color:#A020F0">'-'</span>,xq1,s,<span style="color:#A020F0">'-.'</span>,xq1,m,<span style="color:#A020F0">'--'</span>)
legend(<span style="color:#A020F0">'Sample Points'</span>,<span style="color:#A020F0">'pchip'</span>,<span style="color:#A020F0">'spline'</span>,<span style="color:#A020F0">'makima'</span>,<span style="color:#A020F0">'Location'</span>,<span style="color:#A020F0">'SouthEast'</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e1033136" class="mediaobject"><p><img src="../../examples/matlab/win64/DataInterpolationComparisonExample_01.png" alt="Figure contains an axes object. The axes object contains 4 objects of type line. One or more of the lines displays its values using only markers These objects represent Sample Points, pchip, spline, makima." width="560"></p></div></div><p>In this case, <code class="literal">pchip</code> and <code class="literal">makima</code> have similar behavior in that they avoid overshoots and can accurately connect the flat regions.</p><p>Perform a second comparison using an oscillatory sample function.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>x = 0:15;
y = besselj(1,x);
xq2 = 0:0.01:15;
p = pchip(x,y,xq2);
s = spline(x,y,xq2);
m = makima(x,y,xq2);
plot(x,y,<span style="color:#A020F0">'o'</span>,xq2,p,<span style="color:#A020F0">'-'</span>,xq2,s,<span style="color:#A020F0">'-.'</span>,xq2,m,<span style="color:#A020F0">'--'</span>)
legend(<span style="color:#A020F0">'Sample Points'</span>,<span style="color:#A020F0">'pchip'</span>,<span style="color:#A020F0">'spline'</span>,<span style="color:#A020F0">'makima'</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e1033150" class="mediaobject"><p><img src="../../examples/matlab/win64/DataInterpolationComparisonExample_02.png" alt="Figure contains an axes object. The axes object contains 4 objects of type line. One or more of the lines displays its values using only markers These objects represent Sample Points, pchip, spline, makima." width="560"></p></div></div><p>When the underlying function is oscillatory, <code class="literal">spline</code> and <code class="literal">makima</code> capture the movement between points better than <code class="literal">pchip</code>, which is aggressively flattened near local extrema.</p><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-DataInterpolationComparisonExample"><meta itemprop="exampletitle" content="Data Interpolation with spline, pchip, and makima"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_dd39faaf-6e4d-4a25-9d8f-cfc24c75b16c"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_dd39faaf-6e4d-4a25-9d8f-cfc24c75b16c" data-bs-target="#expand_accordion_body_mw_dd39faaf-6e4d-4a25-9d8f-cfc24c75b16c" aria-controls="expand_accordion_body_mw_dd39faaf-6e4d-4a25-9d8f-cfc24c75b16c" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_dd39faaf-6e4d-4a25-9d8f-cfc24c75b16c">Akima Interpolation with Piecewise Polynomial Structure</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_dd39faaf-6e4d-4a25-9d8f-cfc24c75b16c" aria-labelledby="expand_accordion_heading_mw_dd39faaf-6e4d-4a25-9d8f-cfc24c75b16c" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/AkimaPiecewisePolynomialExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Akima Interpolation with Piecewise Polynomial Structure",
          "description": "Create vectors for the sample points x and values at those points y. Use makima to construct a piecewise polynomial structure for the data.",
          "thumbnailURL": "../../examples/matlab/win64/AkimaPiecewisePolynomialExample_01.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "makima.html"

        },
          "identifier": "matlab.AkimaPiecewisePolynomialExample",
          "name": "AkimaPiecewisePolynomialExample",
          "url": "makima.html#mw_dd39faaf-6e4d-4a25-9d8f-cfc24c75b16c"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/AkimaPiecewisePolynomialExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "AkimaPiecewisePolynomialExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Create vectors for the sample points <code class="literal">x</code> and values at those points <code class="literal">y</code>. Use <code class="literal">makima</code> to construct a piecewise polynomial structure for the data.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>x = -5:5;
y = [1 1 1 0 0 1 1 2 2 2 2];
pp = makima(x,y)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>pp = <span class="emphasis"><em>struct with fields:</em></span>
      form: 'pp'
    breaks: [-5 -4 -3 -2 -1 0 1 2 3 4 5]
     coefs: [10×4 double]
    pieces: 10
     order: 4
       dim: 1

</pre></div></div></div><p>The structure contains the information for 10 polynomials of order 4 that span the data. <code class="literal">pp.coefs(i,:)</code> contains the coefficients for the polynomial that is valid in the region defined by the breakpoints <code class="literal">[breaks(i) breaks(i+1)]</code>.</p><p>Use the structure with <code class="literal">ppval</code> to evaluate the interpolation at several query points, and then plot the results. In regions with three or more constant points, the Akima algorithm connects the points with a straight line.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>xq = -5:0.2:5;
m = ppval(pp,xq);
plot(x,y,<span style="color:#A020F0">'o'</span>,xq,m,<span style="color:#A020F0">'-.'</span>)
ylim([-0.2 2.2])</pre></div></div></div><div class="informalfigure"><div id="d126e1033208" class="mediaobject"><p><img src="../../examples/matlab/win64/AkimaPiecewisePolynomialExample_01.png" alt="Figure contains an axes object. The axes object contains 2 objects of type line. One or more of the lines displays its values using only markers" width="560"></p></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-AkimaPiecewisePolynomialExample"><meta itemprop="exampletitle" content="Akima Interpolation with Piecewise Polynomial Structure"></div></div></div></div><div class="ref_sect"><h2 id="mw_4526fc42-ef48-4212-a29c-8998326a38b2">Input Arguments</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="mw_4526fc42-ef48-4212-a29c-8998326a38b2_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="mw_c93c9047-ef69-4c8d-8428-7a019ef13869"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_c93c9047-ef69-4c8d-8428-7a019ef13869" data-bs-target="#expand_accordion_body_mw_c93c9047-ef69-4c8d-8428-7a019ef13869" aria-controls="expand_accordion_body_mw_c93c9047-ef69-4c8d-8428-7a019ef13869" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_x" class="anchor_target"></span><h3 id="mw_c93c9047-ef69-4c8d-8428-7a019ef13869"><code itemprop="name">x</code> &#8212; <span itemprop="purpose">Sample points</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">vector</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_c93c9047-ef69-4c8d-8428-7a019ef13869" aria-labelledby="expand_accordion_heading_mw_c93c9047-ef69-4c8d-8428-7a019ef13869" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_c93c9047-ef69-4c8d-8428-7a019ef13869"><p>Sample points, specified as a vector. The vector <code class="literal">x</code> specifies the
            points at which the data <code class="literal">y</code> is given. The elements of
              <code class="literal">x</code> must be unique.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code></p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="mw_20454c8c-9796-469b-8d1a-01ad70a6959f"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_20454c8c-9796-469b-8d1a-01ad70a6959f" data-bs-target="#expand_accordion_body_mw_20454c8c-9796-469b-8d1a-01ad70a6959f" aria-controls="expand_accordion_body_mw_20454c8c-9796-469b-8d1a-01ad70a6959f" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_y" class="anchor_target"></span><h3 id="mw_20454c8c-9796-469b-8d1a-01ad70a6959f"><code itemprop="name">y</code> &#8212; <span itemprop="purpose">Function values at sample points</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">vector</span> | <span itemprop="inputvalue">matrix</span> | <span itemprop="inputvalue">array</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_20454c8c-9796-469b-8d1a-01ad70a6959f" aria-labelledby="expand_accordion_heading_mw_20454c8c-9796-469b-8d1a-01ad70a6959f" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_20454c8c-9796-469b-8d1a-01ad70a6959f"><p>Function values at sample points, specified as a numeric vector, matrix, or array.
              <code class="literal">x</code> and <code class="literal">y</code> must have the same length.</p><p>If <code class="literal">y</code> is a matrix or array, then the values in the last dimension,
              <code class="literal">y(:,...,:,j)</code>, are taken as the values to match with
              <code class="literal">x</code>. In that case, the last dimension of <code class="literal">y</code> must be
            the same length as <code class="literal">x</code>.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code></p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="mw_984580bc-270f-45c1-9191-c77d151c2fe3"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_984580bc-270f-45c1-9191-c77d151c2fe3" data-bs-target="#expand_accordion_body_mw_984580bc-270f-45c1-9191-c77d151c2fe3" aria-controls="expand_accordion_body_mw_984580bc-270f-45c1-9191-c77d151c2fe3" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_xq" class="anchor_target"></span><h3 id="mw_984580bc-270f-45c1-9191-c77d151c2fe3"><code itemprop="name">xq</code> &#8212; <span itemprop="purpose">Query points</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">scalar</span> | <span itemprop="inputvalue">vector</span> | <span itemprop="inputvalue">matrix</span> | <span itemprop="inputvalue">array</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_984580bc-270f-45c1-9191-c77d151c2fe3" aria-labelledby="expand_accordion_heading_mw_984580bc-270f-45c1-9191-c77d151c2fe3" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_984580bc-270f-45c1-9191-c77d151c2fe3"><p>Query points, specified as a scalar, vector, matrix, or array. The points specified
            in <code class="literal">xq</code> are the <em class="varname">x</em>-coordinates for the interpolated
            function values <code class="literal">yq</code> computed by <code class="function">makima</code>.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code></p></div></div></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="mw_cb19cc20-2852-4b72-b222-6b905bea32b6">Output Arguments</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="mw_cb19cc20-2852-4b72-b222-6b905bea32b6_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_50c6a773-b566-4594-aad7-696cf0709899" data-bs-target="#expand_accordion_body_mw_50c6a773-b566-4594-aad7-696cf0709899" aria-controls="expand_accordion_body_mw_50c6a773-b566-4594-aad7-696cf0709899" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_yq" class="anchor_target"></span><h3 id="mw_50c6a773-b566-4594-aad7-696cf0709899"><code class="name">yq</code> &#8212; Interpolated values at query points<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">scalar | vector | matrix | array</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_50c6a773-b566-4594-aad7-696cf0709899" aria-labelledby="expand_accordion_heading_mw_50c6a773-b566-4594-aad7-696cf0709899" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_50c6a773-b566-4594-aad7-696cf0709899"><p>Interpolated values at query points, returned as a scalar, vector, matrix, or array.
            The size of <code class="literal">yq</code> is related to the sizes of <code class="literal">y</code> and
              <code class="literal">xq</code>:</p><div class="itemizedlist"><ul><li><p>If <code class="literal">y</code> is a vector, then <code class="literal">yq</code> has the same
                size as <code class="literal">xq</code>.</p></li><li><p>If <code class="literal">y</code> is an array of size <code class="literal">Ny = size(y)</code>,
                then these conditions apply:</p>
<div class="itemizedlist"><ul><li><p>If <code class="literal">xq</code> is a scalar or vector, then
                        <code class="literal">size(yq)</code> returns <code class="literal">[Ny(1:end-1)
                        length(xq)]</code>.</p></li><li><p>If <code class="literal">xq</code> is an array, then <code class="literal">size(yq)</code>
                      returns <code class="literal">[Ny(1:end-1) size(xq)]</code>.</p></li></ul></div><p>
</p></li></ul></div></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_f1743e2c-1c29-44ce-8d6e-02fcb5e3a2c1" data-bs-target="#expand_accordion_body_mw_f1743e2c-1c29-44ce-8d6e-02fcb5e3a2c1" aria-controls="expand_accordion_body_mw_f1743e2c-1c29-44ce-8d6e-02fcb5e3a2c1" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_pp" class="anchor_target"></span><h3 id="mw_f1743e2c-1c29-44ce-8d6e-02fcb5e3a2c1"><code class="name">pp</code> &#8212; Piecewise polynomial<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">structure</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_f1743e2c-1c29-44ce-8d6e-02fcb5e3a2c1" aria-labelledby="expand_accordion_heading_mw_f1743e2c-1c29-44ce-8d6e-02fcb5e3a2c1" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_f1743e2c-1c29-44ce-8d6e-02fcb5e3a2c1"><p>Piecewise polynomial, returned as a structure. Use this structure with the <a href="ppval.html"><code class="function">ppval</code></a> function to evaluate the interpolating polynomials at one or more
            query points. The structure has these fields.</p><div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="50%"><col class="tcol2" width="50%"></colgroup><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code class="literal">form</code></td><td><p><code class="literal">'pp'</code> for <span class="emphasis"><em>piecewise
                      polynomial</em></span></p></td></tr><tr><td><code class="literal">breaks</code></td><td><p>Vector of length&nbsp;<code class="literal">L+1</code>&nbsp;with strictly
                      increasing elements that represent the start and end of each
                        of<code class="literal">&nbsp;L</code>&nbsp;intervals</p></td></tr><tr><td><code class="literal">coefs</code></td><td><p><code class="literal">L</code>-by-<code class="literal">k</code> matrix with each
                        row&nbsp;<code class="literal">coefs(i,:)</code>&nbsp;containing the local
                      coefficients of an order&nbsp;<code class="literal">k</code>&nbsp;polynomial on
                        the&nbsp;<code class="literal">i</code>th
                        interval,&nbsp;<code class="literal">[breaks(i),breaks(i+1)]</code></p></td></tr><tr><td><code class="literal">pieces</code></td><td><p>Number of pieces, <code class="literal">L</code></p></td></tr><tr><td><code class="literal">order</code></td><td><p>Order of polynomials</p></td></tr><tr><td><code class="literal">dim</code></td><td><p>Dimensionality of target</p></td></tr></tbody></table></div><p>Because the polynomial coefficients in <code class="literal">coefs</code> are local
            coefficients for each interval, you must subtract the lower endpoint of the
            corresponding knot interval to use the coefficients in a conventional polynomial
            equation. In other words, for the coefficients <code class="literal">[a,b,c,d]</code> on the
            interval <code class="literal">[x1,x2]</code>, the corresponding polynomial is</p>
<div id="d126e1033496" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><mi>f</mi><mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mo>=</mo><mi>a</mi><msup><mrow><mrow><mo>(</mo><mrow><mi>x</mi><mo>−</mo><msub><mi>x</mi><mn>1</mn></msub></mrow><mo>)</mo></mrow></mrow><mn>3</mn></msup><mo>+</mo><mi>b</mi><msup><mrow><mrow><mo>(</mo><mrow><mi>x</mi><mo>−</mo><msub><mi>x</mi><mn>1</mn></msub></mrow><mo>)</mo></mrow></mrow><mn>2</mn></msup><mo>+</mo><mi>c</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>−</mo><msub><mi>x</mi><mn>1</mn></msub></mrow><mo>)</mo></mrow><mo>+</mo><mi>d</mi><mtext> </mtext><mo>.</mo></mrow></math></p></div></div><p></p></div></div></div></div></div></div></div></div></div></div><div class="moreabout ref_sect"><h2 id="mw_e22c9119-5a42-41de-8ecf-48ed54cee501">More About</h2><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true2">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_mw_e8ee1c8c-2cc3-46c4-90c4-c3208804ff4e" aria-controls="expand_body_mw_e8ee1c8c-2cc3-46c4-90c4-c3208804ff4e" class="accordion-button" aria-expanded="true"><h3 id="mw_e8ee1c8c-2cc3-46c4-90c4-c3208804ff4e">Modified Akima Interpolation</h3></button></div><div id="expand_body_mw_e8ee1c8c-2cc3-46c4-90c4-c3208804ff4e" class="accordion-collapse collapsed collapse show"><div class="accordion-body"><p class="shortdesc">The <strong class="emphasis bold">Akima algorithm</strong> for
        one-dimensional interpolation, described in <a href="makima.html#mw_92e0dff0-2a99-477f-b2da-8fec666be99a" class="intrnllnk">[1]</a> and <a href="makima.html#mw_a7a1bb2e-45d0-44d7-9cbc-c5c98a45f138" class="intrnllnk">[2]</a>, performs cubic
        interpolation to produce piecewise polynomials with continuous first-order derivatives (C1).
        The algorithm avoids excessive local undulations.</p><p>If <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-20px" display="block"><mrow><msub><mi>δ</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>v</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>v</mi><mi>i</mi></msub></mrow><mrow><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac></mrow></math></span></span> is the slope on interval <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-9px" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mi>x</mi><mi>i</mi></msub><mtext> </mtext><mtext> </mtext><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mo>)</mo></mrow></mrow></math></span></span>, then the value of the derivative <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><msub><mi>d</mi><mi>i</mi></msub></mrow></math></span></span> at the sample point <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow></math></span></span> is a weighted average of nearby slopes:</p><div id="d126e1033540" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-20px" display="block"><mrow><msub><mi>d</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>w</mi><mn>1</mn></msub></mrow><mrow><msub><mi>w</mi><mn>1</mn></msub><mo>+</mo><msub><mi>w</mi><mn>2</mn></msub></mrow></mfrac><msub><mi>δ</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mfrac><mrow><msub><mi>w</mi><mn>2</mn></msub></mrow><mrow><msub><mi>w</mi><mn>1</mn></msub><mo>+</mo><msub><mi>w</mi><mn>2</mn></msub></mrow></mfrac><msub><mi>δ</mi><mi>i</mi></msub><mo>.</mo></mrow></math></p></div></div><p>In Akima's original formula, the weights are:</p><div id="d126e1033545" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-23px" display="block"><mtable columnalign="left"><mtr><mtd><msub><mi>w</mi><mn>1</mn></msub><mo>=</mo><mrow><mo>|</mo><mrow><msub><mi>δ</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>δ</mi><mi>i</mi></msub></mrow><mo>|</mo></mrow><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>w</mi><mn>2</mn></msub><mo>=</mo><mrow><mo>|</mo><mrow><msub><mi>δ</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>δ</mi><mrow><mi>i</mi><mo>−</mo><mn>2</mn></mrow></msub></mrow><mo>|</mo></mrow><mo>.</mo></mtd></mtr></mtable></math></p></div></div><p>The original Akima algorithm gives equal weight to the points on both sides, evenly
        dividing an undulation.</p><p>When two flat regions with different slopes meet, the modification made to the original
        Akima algorithm gives more weight to the side where the slope is closer to zero. This
        modification gives priority to the side that is closer to horizontal, which is more
        intuitive and avoids overshoot. In particular, whenever there are three or more consecutive
        collinear points, the algorithm connects them with a straight line and thus avoids an
        overshoot.</p><p>The weights used in the modified Akima algorithm are:</p><div id="d126e1033552" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-41px" display="block"><mtable columnalign="left"><mtr><mtd><msub><mi>w</mi><mn>1</mn></msub><mo>=</mo><mrow><mo>|</mo><mrow><msub><mi>δ</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>δ</mi><mi>i</mi></msub></mrow><mo>|</mo></mrow><mo>+</mo><mfrac><mrow><mrow><mo>|</mo><mrow><msub><mi>δ</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>δ</mi><mi>i</mi></msub></mrow><mo>|</mo></mrow></mrow><mn>2</mn></mfrac><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>w</mi><mn>2</mn></msub><mo>=</mo><mrow><mo>|</mo><mrow><msub><mi>δ</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>δ</mi><mrow><mi>i</mi><mo>−</mo><mn>2</mn></mrow></msub></mrow><mo>|</mo></mrow><mo>+</mo><mfrac><mrow><mrow><mo>|</mo><mrow><msub><mi>δ</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>δ</mi><mrow><mi>i</mi><mo>−</mo><mn>2</mn></mrow></msub></mrow><mo>|</mo></mrow></mrow><mn>2</mn></mfrac><mo>.</mo></mtd></mtr></mtable></math></p></div></div><p>Compared to the <code class="function">spline</code> algorithm, the Akima algorithm produces
        fewer undulations and is better suited to deal with quick changes between flat regions.
        Compared to the <code class="function">pchip</code> algorithm, the Akima algorithm is not as
        aggressively flattened and is therefore still able to deal with oscillatory data.</p></div></div></div></div></div></div></div><div class="bibliography"><h2 id="References">References</h2><div id="mw_92e0dff0-2a99-477f-b2da-8fec666be99a" class="bibliomixed"><p>[1] Akima, Hiroshi. "A new method of
      interpolation and smooth curve fitting based on local procedures." <em class="citetitle">Journal of the
        ACM (JACM)</em> , 17.4, 1970, pp. 589&#8211;602.</p></div><div id="mw_a7a1bb2e-45d0-44d7-9cbc-c5c98a45f138" class="bibliomixed"><p>[2] Akima, Hiroshi. "A method of
      bivariate interpolation and smooth surface fitting based on local procedures."
        <em class="citetitle">Communications of the ACM</em> , 17.1, 1974, pp. 18&#8211;20. </p></div></div><div class="ref_sect"><h2 id="refsect-extended-capabilities">Extended Capabilities</h2><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink">expand all</a></p><div id="accordion_refsect-extended-capabilities" role="tablist" aria-multiselectable="true"><span id="mw_b3522459-d0b0-4029-8485-be09edbe86c9" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="mw_fda58e3c-de78-4b86-beb0-98bd56d7d7b4" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_mw_fda58e3c-de78-4b86-beb0-98bd56d7d7b4_codegen" aria-controls="expand_body_mw_fda58e3c-de78-4b86-beb0-98bd56d7d7b4_codegen" class="accordion-button collapsed" aria-expanded="false"><h3 id="mw_fda58e3c-de78-4b86-beb0-98bd56d7d7b4_codegen">C/C++ Code Generation<br/> <span class=" remove_bold add_font_color_general">Generate C and C++ code using MATLAB&#174; Coder&#8482;.</span></h3></button></div><div id="expand_body_mw_fda58e3c-de78-4b86-beb0-98bd56d7d7b4_codegen" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p><span>Usage notes and limitations:</span></p><p>
        </p>
<div class="itemizedlist"><ul><li><p>Input <code class="literal">x</code> must be strictly increasing.</p></li><li><p>Code generation does not remove <code class="literal">y</code> entries with
                <code class="literal">NaN</code> values.</p></li><li><p>If you generate code for the <code class="literal">pp = makima(x,y)</code> syntax, then you
              cannot input <code class="literal">pp</code> to the <code class="function">ppval</code> function in
                MATLAB<sup>&#x00AE;</sup>. To create a MATLAB
              <code class="literal">pp</code> structure from a <code class="literal">pp</code> structure created by the
              code generator:</p>
<div class="itemizedlist"><ul><li><p>In code generation, use <code class="function">unmkpp</code> to return the piecewise
                    polynomial details to MATLAB.</p></li><li><p>In MATLAB, use <code class="function">mkpp</code> to create the <code class="literal">pp</code>
                    structure.</p></li></ul></div><p>
</p></li><li><p>If you supply <code class="literal">xq</code>, and if <code class="literal">y</code> has a
              variable-size and is not a variable-length vector, then the orientation of vector
              outputs in the generated code might not match the orientation in MATLAB.</p></li></ul></div><p>

      </p></div></div></div></div></div><span id="mw_70cfda0e-3c8d-4148-93ec-928998a3f6dd" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="mw_fda58e3c-de78-4b86-beb0-98bd56d7d7b4" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_mw_fda58e3c-de78-4b86-beb0-98bd56d7d7b4_threadsupport" aria-controls="expand_body_mw_fda58e3c-de78-4b86-beb0-98bd56d7d7b4_threadsupport" class="accordion-button collapsed" aria-expanded="false"><h3 id="mw_fda58e3c-de78-4b86-beb0-98bd56d7d7b4_threadsupport">Thread-Based Environment<br/> <span class=" remove_bold add_font_color_general">Run code in the background using MATLAB&#174; <code class="function">backgroundPool</code> or accelerate code with Parallel Computing Toolbox&#8482; <code class="function">ThreadPool</code>.</span></h3></button></div><div id="expand_body_mw_fda58e3c-de78-4b86-beb0-98bd56d7d7b4_threadsupport" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>This function fully supports thread-based environments. For
                more information, see <a href="../matlab_prog/run-functions-on-threads.html" class="a">Run MATLAB Functions in Thread-Based Environment</a>.</p></div></div></div></div></div><span id="mw_66322013-b741-4b78-b8b1-94b1d1f979f1" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="mw_fda58e3c-de78-4b86-beb0-98bd56d7d7b4" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_mw_fda58e3c-de78-4b86-beb0-98bd56d7d7b4_gpuarrays" aria-controls="expand_body_mw_fda58e3c-de78-4b86-beb0-98bd56d7d7b4_gpuarrays" class="accordion-button collapsed" aria-expanded="false"><h3 id="mw_fda58e3c-de78-4b86-beb0-98bd56d7d7b4_gpuarrays">GPU Arrays<br/> <span class=" remove_bold add_font_color_general">Accelerate code by running on a graphics processing unit (GPU) using Parallel Computing Toolbox&#8482;.</span></h3></button></div><div id="expand_body_mw_fda58e3c-de78-4b86-beb0-98bd56d7d7b4_gpuarrays" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>The <code class="function">makima</code> function
    fully supports GPU arrays. To run the function on a GPU, specify the input data as a <a href="../../parallel-computing/gpuarray.html"><code class="function">gpuArray</code></a><span role="cross_prod"> (Parallel Computing Toolbox)</span>. For more information, see <a href="../../parallel-computing/run-matlab-functions-on-a-gpu.html" class="a">Run MATLAB Functions on a GPU</a><span role="cross_prod"> (Parallel Computing Toolbox)</span>.</p></div></div></div></div></div><span id="mw_cfffde86-c76f-4767-9425-6e82f5757396" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="mw_fda58e3c-de78-4b86-beb0-98bd56d7d7b4" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_mw_fda58e3c-de78-4b86-beb0-98bd56d7d7b4_distributedarrays" aria-controls="expand_body_mw_fda58e3c-de78-4b86-beb0-98bd56d7d7b4_distributedarrays" class="accordion-button collapsed" aria-expanded="false"><h3 id="mw_fda58e3c-de78-4b86-beb0-98bd56d7d7b4_distributedarrays">Distributed Arrays<br/> <span class=" remove_bold add_font_color_general">Partition large arrays across the combined memory of your cluster using Parallel Computing Toolbox&#8482;.</span></h3></button></div><div id="expand_body_mw_fda58e3c-de78-4b86-beb0-98bd56d7d7b4_distributedarrays" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>Usage notes and limitations:</p><div class="itemizedlist"><ul><li><p>The <code class="literal">makima(<code class="argument">x</code>,<code class="argument">y</code>)</code> syntax
            is not supported for distributed arrays.</p></li></ul></div><p>For more information, see <a href="../../parallel-computing/run-matlab-functions-with-distributed-arrays.html" class="a">Run MATLAB Functions with Distributed Arrays</a><span role="cross_prod"> (Parallel Computing Toolbox)</span>.</p></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="mw_fda58e3c-de78-4b86-beb0-98bd56d7d7b4_vh">Version History</h2><p><strong>Introduced in R2019b</strong></p></div><div class="ref_sect"><h2 id="mw_fda58e3c-de78-4b86-beb0-98bd56d7d7b4_seealso">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="double.interp1.html"><span itemprop="name"><code class="function">interp1</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="spline.html"><span itemprop="name"><code class="function">spline</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="pchip.html"><span itemprop="name"><code class="function">pchip</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="ppval.html"><span itemprop="name"><code class="function">ppval</code></span></a></span></p><div class="examples_container"><h3 class="remove_border">External Websites</h3><div itemprop="content"><ul class="list-unstyled"><li><a href="https://blogs.mathworks.com/cleve/2019/04/29/makima-piecewise-cubic-interpolation/">Cleve's Corner: Makima Piecewise Cubic Interpolation</a></li></ul></div></div></div>
    </div></div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

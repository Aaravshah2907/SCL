<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>trapz</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../numerical-integration-and-differential-equations.html",
          "name": "Numerical Integration and Differential Equations"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../numerical-integration-and-differentiation.html",
          "name": "Numerical Integration and Differentiation"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "numerical-integration-and-differentiation"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExtendedCapabilities",

        "itemListElement":
        [
{
          "@type": "ListItem",
          "position": 1,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "codegen",
          "value": "limited"

        }
          },
{
          "@type": "ListItem",
          "position": 2,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "distributedarrays",
          "value": "full"

        }
          },
{
          "@type": "ListItem",
          "position": 3,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "gpuarrays",
          "value": "full"

        }
          },
{
          "@type": "ListItem",
          "position": 4,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "threadsupport",
          "value": "full"

        }
          }
        ]
        }
        </script>
<meta xmlns="http://www.w3.org/1999/xhtml" name="chunktype" content="refpage"><meta xmlns="http://www.w3.org/1999/xhtml" name="refentity" itemprop="refentity" content="function:trapz"><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="fcn">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ref/function">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This MATLAB function computes the approximate integral of Y via the trapezoidal method with unit spacing."><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "refentry";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../numerical-integration-and-differential-equations.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Numerical Integration and Differential Equations</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../numerical-integration-and-differentiation.html?s_tid=CRUX_lftnav" itemprop="url" id="numerical-integration-and-differentiation"><span itemprop="title">Numerical Integration and Differentiation</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item notranslate"><a href="#responsive_offcanvas"><span class="refname">trapz</span></a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-refentry">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li><a href="#d126e1908999" class="intrnllnk">Syntax</a></li><li class="nav-item"><a href="#description" class="nav-link intrnllnk">Description</a></li><li class="nav-item"><a href="#buaijhw-5" class="nav-link intrnllnk">Examples</a><ul class="nav"><li class="nav-item"><a href="#buaijhw-1" class="nav-link intrnllnk">Integrate Vector of Data with Unit Spacing</a></li></ul><ul class="nav"><li class="nav-item"><a href="#bual0sj-1" class="nav-link intrnllnk">Integrate Vector of Data with Nonunit Spacing</a></li></ul><ul class="nav"><li class="nav-item"><a href="#buakefd-1" class="nav-link intrnllnk">Integrate Matrix with Nonuniform Spacing</a></li></ul><ul class="nav"><li class="nav-item"><a href="#buakefe-1_1" class="nav-link intrnllnk">Multiple Numerical Integrations</a></li></ul></li><li class="nav-item"><a href="#buaijhw-4" class="nav-link intrnllnk">Input Arguments</a><ul class="nav"><li class="nav-item"><a href="#buaijhv-1-Y" class="nav-link intrnllnk">Y</a></li><li class="nav-item"><a href="#buaijhv-1-X" class="nav-link intrnllnk">X</a></li><li class="nav-item"><a href="#buaijhv-1-dim" class="nav-link intrnllnk">dim</a></li></ul></li><li class="nav-item"><a href="#bua4lr9" class="nav-link intrnllnk">More About</a><ul class="nav"><li class="nav-item"><a href="#bua4lsr" class="nav-link intrnllnk">Trapezoidal Method</a></li></ul></li><li class="nav-item"><a href="#bual_zk-5" class="nav-link intrnllnk">Tips</a></li><li class="nav-item"><a href="#refsect-extended-capabilities" class="nav-link intrnllnk">Extended Capabilities</a></li><li class="nav-item"><a href="#buaijhv-1_vh" class="nav-link intrnllnk">Version History</a></li><li class="nav-item"><a href="#buaijhv-1_seealso" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=numerical-integration-and-differentiation&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=numerical-integration-and-differentiation&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=numerical-integration-and-differentiation&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=numerical-integration-and-differentiation&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=numerical-integration-and-differentiation&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=numerical-integration-and-differentiation&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-ref-function"><div class="function_ref"><span id="buaijhv-1" class="anchor_target"></span><h1 class="r2025b notranslate" itemprop="title"><span class="refname">trapz</span></h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">Trapezoidal numerical integration</p><div class="switch"><a href="javascript:void(0);" id="expandAllPage" data-allexpanded="true1">collapse all in page</a></div></div></div>
<div class="ref_sect"><h2 id="d126e1908999">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><div class="code_responsive"><code class="synopsis"><a href="#d126e1909008" class="intrnllnk">Q = trapz(Y)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1909056" class="intrnllnk">Q = trapz(X,Y)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1909098" class="intrnllnk">Q = trapz(<span class="argument_placeholder">___</span>,dim)</a></code></div></div></div></div><div class="clear"></div><span id="buaijhv-2" class="anchor_target"></span><h2 id="description">Description</h2><div class="descriptions"><div class="cshsummary" id="csh_buaijhv-1"><div class="description_module"><span id="buaijhv-3" class="anchor_target"></span>
<div class="description_element"><div class="code_responsive"><p><span id="d126e1909008" itemprop="syntax"><code class="synopsis">Q = trapz(<a href="#buaijhv-1-Y" class="intrnllnk"><code class="argument">Y</code></a>)</code></span> computes the approximate integral of
                        <code class="literal">Y</code> via the <a href="trapz.html#bua4lsr" class="intrnllnk">trapezoidal method</a> with unit spacing. The size of
                        <code class="literal">Y</code> determines the dimension to integrate along:</p><div class="itemizedlist"><ul><li><p>If <code class="literal">Y</code> is a vector, then <code class="literal">trapz(Y)</code> is
the approximate integral of <code class="literal">Y</code>.</p></li><li><p>If <code class="literal">Y</code> is a matrix, then <code class="literal">trapz(Y)</code> integrates
over each column and returns a row vector of integration values.</p></li><li><p>If <code class="literal">Y</code> is a multidimensional array,
then <code class="literal">trapz(Y)</code> integrates over the first dimension
whose size does not equal 1. The size of this dimension becomes 1,
and the sizes of other dimensions remain unchanged.</p></li></ul></div></div><p class="syntax_example"><a href="trapz.html#buaijhw-1" class="intrnllnk">example</a></p></div>
<div class="description_element"><div class="code_responsive"><p><span id="d126e1909056" itemprop="syntax"><code class="synopsis">Q = trapz(<a href="#buaijhv-1-X" class="intrnllnk"><code class="argument">X</code></a>,<a href="#buaijhv-1-Y" class="intrnllnk"><code class="argument">Y</code></a>)</code></span> integrates
                        <code class="literal">Y</code> with respect to the coordinates or scalar spacing
                    specified by <code class="literal">X</code>.</p>
<div class="itemizedlist"><ul><li><p>If <code class="literal">X</code> is a vector of coordinates, then
                                    <code class="literal">length(X)</code> must be equal to the size of the
                                first dimension of <code class="literal">Y</code> whose size does not equal
                                1.</p></li><li><p>If <code class="literal">X</code> is a scalar spacing, then
                                    <code class="literal">trapz(X,Y)</code> is equivalent to
                                    <code class="literal">X*trapz(Y)</code>.</p></li></ul></div><p>
</p></div><p class="syntax_example"><a href="trapz.html#bual0sj-1" class="intrnllnk">example</a></p></div>
<div class="description_element"><div class="code_responsive"><p><span id="d126e1909098" itemprop="syntax"><code class="synopsis">Q = trapz(<span class="argument_placeholder">___</span>,<a href="#buaijhv-1-dim" class="intrnllnk"><code class="argument">dim</code></a>)</code></span> integrates along the
                    dimension <code class="literal">dim</code> using any of the previous syntaxes. You must
                    specify <code class="literal">Y</code>, and optionally can specify <code class="literal">X</code>.
                    If you specify <code class="literal">X</code>, then it can be a scalar or a vector with
                    length equal to <code class="literal">size(Y,dim)</code>. For example, if
                        <code class="literal">Y</code> is a matrix, then <code class="literal">trapz(X,Y,2)</code>
                    integrates each row of <code class="literal">Y</code>.</p></div><p class="syntax_example"><a href="trapz.html#buakefd-1" class="intrnllnk">example</a></p></div>
</div></div></div><div class="clear"></div><div class="examples"><h2 id="buaijhw-5">Examples</h2><div class="expandableContent" id="expandableExamples"><p class="switch"><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true3">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_buaijhw-1"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_buaijhw-1" data-bs-target="#expand_accordion_body_buaijhw-1" aria-controls="expand_accordion_body_buaijhw-1" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="buaijhw-1">Integrate Vector of Data with Unit Spacing</h3></button></div><div role="tabpanel" id="expand_accordion_body_buaijhw-1" aria-labelledby="expand_accordion_heading_buaijhw-1" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/IntegrateVectorofDatawithUnitSpacingExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Integrate Vector of Data with Unit Spacing",
          "description": "Calculate the integral of a vector where the spacing between data points is 1.",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "trapz.html"

        },
          "identifier": "matlab.IntegrateVectorofDatawithUnitSpacingExample",
          "name": "IntegrateVectorofDatawithUnitSpacingExample",
          "url": "trapz.html#buaijhw-1"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/IntegrateVectorofDatawithUnitSpacingExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "IntegrateVectorofDatawithUnitSpacingExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Calculate the integral of a vector where the spacing between data points is 1.</p><p>Create a numeric vector of data. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>Y = [1 4 9 16 25];</pre></div></div></div><p><code class="literal">Y</code> contains function values for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mrow><mi>x</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></math></span> in the domain [1, 5].</p><p>Use <code class="literal">trapz</code> to integrate the data with unit spacing. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>Q = trapz(Y)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>Q = 
42
</pre></div></div></div><p>This approximate integration yields a value of <code class="literal">42</code>. In this case, the exact answer is a little less, <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mn>4</mn><mn>1</mn><mfrac><mrow><mn>1</mn></mrow><mrow><mn>3</mn></mrow></mfrac></mrow></math></span>. The <code class="literal">trapz</code> function overestimates the value of the integral because <span class="emphasis"><em>f(x)</em></span> is concave up.</p><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-IntegrateVectorofDatawithUnitSpacingExample"><meta itemprop="exampletitle" content="Integrate Vector of Data with Unit Spacing"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_bual0sj-1"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bual0sj-1" data-bs-target="#expand_accordion_body_bual0sj-1" aria-controls="expand_accordion_body_bual0sj-1" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="bual0sj-1">Integrate Vector of Data with Nonunit Spacing</h3></button></div><div role="tabpanel" id="expand_accordion_body_bual0sj-1" aria-labelledby="expand_accordion_heading_bual0sj-1" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/IntegrateVectorofDatawithNonunitSpacingExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Integrate Vector of Data with Nonunit Spacing",
          "description": "Calculate the integral of a vector where the spacing between data points is uniform, but not equal to 1.",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "trapz.html"

        },
          "identifier": "matlab.IntegrateVectorofDatawithNonunitSpacingExample",
          "name": "IntegrateVectorofDatawithNonunitSpacingExample",
          "url": "trapz.html#bual0sj-1"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/IntegrateVectorofDatawithNonunitSpacingExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "IntegrateVectorofDatawithNonunitSpacingExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Calculate the integral of a vector where the spacing between data points is uniform, but not equal to 1.</p><p>Create a domain vector. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>X = 0:pi/100:pi;</pre></div></div></div><p>Calculate the sine of <code class="literal">X</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>Y = sin(X);</pre></div></div></div><p>Integrate <code class="literal">Y</code> using <code class="literal">trapz</code>. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>Q = trapz(X,Y)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>Q = 
1.9998
</pre></div></div></div><p>When the spacing between points is constant, but not equal to 1, an alternative to creating a vector for <code class="literal">X</code> is to specify the scalar spacing value. In that case, <code class="literal">trapz(pi/100,Y)</code> is the same as <code class="literal">pi/100*trapz(Y)</code>.</p><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-IntegrateVectorofDatawithNonunitSpacingExample"><meta itemprop="exampletitle" content="Integrate Vector of Data with Nonunit Spacing"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_buakefd-1"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_buakefd-1" data-bs-target="#expand_accordion_body_buakefd-1" aria-controls="expand_accordion_body_buakefd-1" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="buakefd-1">Integrate Matrix with Nonuniform Spacing</h3></button></div><div role="tabpanel" id="expand_accordion_body_buakefd-1" aria-labelledby="expand_accordion_heading_buakefd-1" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/IntegrateMatrixwithNonuniformSpacingExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Integrate Matrix with Nonuniform Spacing",
          "description": "Integrate the rows of a matrix where the data has a nonuniform spacing.",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "trapz.html"

        },
          "identifier": "matlab.IntegrateMatrixwithNonuniformSpacingExample",
          "name": "IntegrateMatrixwithNonuniformSpacingExample",
          "url": "trapz.html#buakefd-1"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/IntegrateMatrixwithNonuniformSpacingExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "IntegrateMatrixwithNonuniformSpacingExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Integrate the rows of a matrix where the data has a nonuniform spacing.</p><p>Create a vector of <span class="emphasis"><em>x</em></span>-coordinates and a matrix of observations that take place at the irregular intervals. The rows of <code class="literal">Y</code> represent velocity data, taken at the times contained in <code class="literal">X</code>, for three different trials. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>X = [1 2.5 7 10];
Y = [5.2   7.7   9.6   13.2;
     4.8   7.0  10.5   14.5;
     4.9   6.5  10.2   13.8];</pre></div></div></div><p>Use <code class="literal">trapz</code> to integrate each row independently and find the total distance traveled in each trial. Since the data is not evaluated at constant intervals, specify <code class="literal">X</code> to indicate the spacing between the data points. Specify <code class="literal">dim = 2</code> since the data is in the rows of <code class="literal">Y</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>Q1 = trapz(X,Y,2)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>Q1 = <span class="emphasis"><em>3×1</em></span>

   82.8000
   85.7250
   82.1250

</pre></div></div></div><p>The result is a column vector of integration values, one for each row in <code class="literal">Y</code>. </p><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-IntegrateMatrixwithNonuniformSpacingExample"><meta itemprop="exampletitle" content="Integrate Matrix with Nonuniform Spacing"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_buakefe-1_1"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_buakefe-1_1" data-bs-target="#expand_accordion_body_buakefe-1_1" aria-controls="expand_accordion_body_buakefe-1_1" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="buakefe-1_1">Multiple Numerical Integrations</h3></button></div><div role="tabpanel" id="expand_accordion_body_buakefe-1_1" aria-labelledby="expand_accordion_heading_buakefe-1_1" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/MultipleNumericalIntegrationsExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Multiple Numerical Integrations",
          "description": "Create a grid of domain values.",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "trapz.html"

        },
          "identifier": "matlab.MultipleNumericalIntegrationsExample",
          "name": "MultipleNumericalIntegrationsExample",
          "url": "trapz.html#buakefe-1_1"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/MultipleNumericalIntegrationsExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "MultipleNumericalIntegrationsExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Create a grid of domain values. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>x = -3:.1:3; 
y = -5:.1:5; 
[X,Y] = meshgrid(x,y);</pre></div></div></div><p>Calculate the function <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mrow><mi>x</mi></mrow><mrow><mn>2</mn></mrow></msup><mo>+</mo><msup><mrow><mi>y</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></math></span> on the grid.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>F = X.^2 + Y.^2;</pre></div></div></div><p><code class="literal">trapz</code> integrates numeric data rather than functional expressions, so in general the expression does not need to be known to use <code class="literal">trapz</code> on a matrix of data. In cases where the functional expression is known, you can instead use <code class="literal">integral</code>, <code class="literal">integral2</code>, or <code class="literal">integral3</code>.</p><p>Use <code class="literal">trapz</code> to approximate the double integral </p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>I</mi><mo>=</mo><msubsup><mrow><mo stretchy="false">∫</mo></mrow><mrow><mo>-</mo><mn>5</mn></mrow><mrow><mn>5</mn></mrow></msubsup><msubsup><mrow><mo stretchy="false">∫</mo></mrow><mrow><mo>-</mo><mn>3</mn></mrow><mrow><mn>3</mn></mrow></msubsup><mrow><mo>(</mo><msup><mrow><mi>x</mi></mrow><mrow><mn>2</mn></mrow></msup><mo>+</mo><msup><mrow><mi>y</mi></mrow><mrow><mn>2</mn></mrow></msup><mo>)</mo></mrow><mi>d</mi><mi>x</mi><mspace width="0.2222222222222222em"/><mi>d</mi><mi>y</mi></mrow></math></p></div><p></p><p>To perform double or triple integrations on an array of numeric data, nest function calls to <code class="literal">trapz</code>. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>I = trapz(y,trapz(x,F,2))</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>I = 
680.2000
</pre></div></div></div><p><code class="literal">trapz</code> performs the integration over <span class="emphasis"><em>x</em></span> first, producing a column vector. Then, the integration over <span class="emphasis"><em>y</em></span> reduces the column vector to a single scalar. <code class="literal">trapz</code> slightly overestimates the exact answer of 680 because <span class="emphasis"><em>f(x,y)</em></span> is concave up.</p><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-MultipleNumericalIntegrationsExample"><meta itemprop="exampletitle" content="Multiple Numerical Integrations"></div></div></div></div><div class="ref_sect"><h2 id="buaijhw-4">Input Arguments</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="buaijhw-4_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="buaijhv-1-Y"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_buaijhv-1-Y" data-bs-target="#expand_accordion_body_buaijhv-1-Y" aria-controls="expand_accordion_body_buaijhv-1-Y" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_Y" class="anchor_target"></span><h3 id="buaijhv-1-Y"><code itemprop="name">Y</code> &#8212; <span itemprop="purpose">Numeric data</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">vector</span> | <span itemprop="inputvalue">matrix</span> | <span itemprop="inputvalue">multidimensional array</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_buaijhv-1-Y" aria-labelledby="expand_accordion_heading_buaijhv-1-Y" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_buaijhv-1-Y"><p>Numeric data, specified as a vector, matrix, or multidimensional
array. By default, <code class="literal">trapz</code> integrates along the first
dimension of <code class="literal">Y</code> whose size does not equal 1.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code><br/>
<strong>Complex Number Support: </strong>Yes</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="buaijhv-1-X"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_buaijhv-1-X" data-bs-target="#expand_accordion_body_buaijhv-1-X" aria-controls="expand_accordion_body_buaijhv-1-X" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_X" class="anchor_target"></span><h3 id="buaijhv-1-X"><code itemprop="name">X</code> &#8212; <span itemprop="purpose">Point spacing</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue defaultvalue"><code class="literal">1</code>
                    </span> (default) | <span itemprop="inputvalue">uniform scalar spacing</span> | <span itemprop="inputvalue">vector of coordinates</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_buaijhv-1-X" aria-labelledby="expand_accordion_heading_buaijhv-1-X" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_buaijhv-1-X"><p>Point spacing, specified as <code class="literal">1</code> (default), a uniform
                        scalar spacing, or a vector of coordinates.</p><div class="itemizedlist"><ul><li><p>If <code class="literal">X</code> is a scalar, then it specifies a uniform
                                spacing between the data points and <code class="literal">trapz(X,Y)</code> is
                                equivalent to <code class="literal">X*trapz(Y)</code>.</p></li><li><p>If <code class="literal">X</code> is a vector, then it specifies
                                    <em class="varname">x</em>-coordinates for the data points and
                                    <code class="literal">length(X)</code> must be the same as the size of the
                                integration dimension in <code class="literal">Y</code>.</p></li></ul></div></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code></p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="buaijhv-1-dim"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_buaijhv-1-dim" data-bs-target="#expand_accordion_body_buaijhv-1-dim" aria-controls="expand_accordion_body_buaijhv-1-dim" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_dim" class="anchor_target"></span><h3 id="buaijhv-1-dim"><code itemprop="name">dim</code> &#8212; <span itemprop="purpose">Dimension to operate along</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">positive integer scalar</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_buaijhv-1-dim" aria-labelledby="expand_accordion_heading_buaijhv-1-dim" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_buaijhv-1-dim"><p>Dimension
    to operate along, specified as a positive integer scalar. If you do not specify the dimension,
    then the default is the first array dimension whose size does not equal 1.</p><p>Consider a two-dimensional input array, <code class="literal">Y</code>:</p>
<div class="itemizedlist"><ul><li><p><code class="literal">trapz(Y,1)</code> works on successive elements in the columns of
                                        <code class="literal">Y</code> and returns a row vector.</p><div class="informalfigure"><div id="d126e1909254" class="mediaobject"><p class="listimage"><img src="trapz_dim_1.png" alt="trapz(Y,1) column-wise computation" height="162" width="143"></p></div></div></li><li><p><code class="literal">trapz(Y,2)</code> works on successive elements in the rows of <code class="literal">Y</code>
                                    and returns a column vector.</p><div class="informalfigure"><div id="d126e1909265" class="mediaobject"><p class="listimage"><img src="trapz_dim_2.png" alt="trapz(Y,2) row-wise computation" height="101" width="211"></p></div></div></li></ul></div><p>
</p><p>If <code class="literal">dim</code> is greater than <code class="literal">ndims(Y)</code>,
then <code class="literal">trapz</code> returns an array of zeros of the same
size as <code class="literal">Y</code>.</p></div></div></div></div></div></div></div></div></div></div></div><div class="moreabout ref_sect"><h2 id="bua4lr9">More About</h2><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true2">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_bua4lsr" aria-controls="expand_body_bua4lsr" class="accordion-button" aria-expanded="true"><h3 id="bua4lsr">Trapezoidal Method</h3></button></div><div id="expand_body_bua4lsr" class="accordion-collapse collapsed collapse show"><div class="accordion-body"><p class="shortdesc"><code class="literal">trapz</code> performs numerical integration via the trapezoidal
                method. This method approximates the integration over an interval by breaking the
                area down into trapezoids with more easily computable areas. For example, here is a
                trapezoidal integration of the sine function using eight evenly-spaced
                trapezoids:</p><div class="informalfigure"><div id="d126e1909586" class="mediaobject"><p><img src="sine_trapezoids.png" alt="The plot of one period of the sin(x) function with eight trapezoids underneath the curve to estimate its area" height="273" width="594"></p></div></div><p>For an integration with <code class="literal">N+1</code> evenly spaced
points, the approximation is</p><div id="d126e1909595" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-40px" display="block"><mtable><mtr><mtd><mstyle displaystyle="true"><mrow><munderover><mo>∫</mo><mi>a</mi><mi>b</mi></munderover><mrow><mi>f</mi><mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mi>d</mi><mi>x</mi><mtext> </mtext><mtext> </mtext><mo>≈</mo><mtext> </mtext><mtext> </mtext></mrow></mrow></mstyle><mfrac><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow><mrow><mn>2</mn><mi>N</mi></mrow></mfrac><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mrow><mrow><mo>(</mo><mrow><mi>f</mi><mrow><mo>(</mo><mrow><msub><mi>x</mi><mi>n</mi></msub></mrow><mo>)</mo></mrow><mo>+</mo><mi>f</mi><mrow><mo>(</mo><mrow><msub><mi>x</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mo>=</mo><mfrac><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow><mrow><mn>2</mn><mi>N</mi></mrow></mfrac><mrow><mo>[</mo><mrow><mi>f</mi><mrow><mo>(</mo><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><mo>)</mo></mrow><mo>+</mo><mn>2</mn><mi>f</mi><mrow><mo>(</mo><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><mo>)</mo></mrow><mo>+</mo><mn>...</mn><mo>+</mo><mn>2</mn><mi>f</mi><mrow><mo>(</mo><mrow><msub><mi>x</mi><mi>N</mi></msub></mrow><mo>)</mo></mrow><mo>+</mo><mi>f</mi><mrow><mo>(</mo><mrow><msub><mi>x</mi><mrow><mi>N</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mo>)</mo></mrow></mrow><mo>]</mo></mrow><mtext> </mtext><mtext> </mtext><mo>,</mo></mtd></mtr></mtable></math></p></div></div><p>where the spacing between each point is equal to the scalar value <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-15px" display="block"><mrow><mfrac><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow><mi>N</mi></mfrac></mrow></math></span></span>. By default MATLAB<sup>&#x00AE;</sup> uses a spacing of 1.</p><p>If the spacing between the <code class="literal">N+1</code> points is not constant, then the formula
                generalizes to</p><div id="d126e1909613" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-21px" display="block"><mrow><mstyle displaystyle="true"><mrow><munderover><mo>∫</mo><mi>a</mi><mi>b</mi></munderover><mrow><mi>f</mi><mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mi>d</mi><mi>x</mi><mtext> </mtext><mtext> </mtext><mo>≈</mo><mtext> </mtext><mtext> </mtext><mtext> </mtext><mfrac><mn>1</mn><mn>2</mn></mfrac><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mrow><mrow><mo>(</mo><mrow><msub><mi>x</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>x</mi><mi>n</mi></msub></mrow><mo>)</mo></mrow></mrow></mstyle></mrow></mrow></mstyle><mrow><mo>[</mo><mrow><mi>f</mi><mrow><mo>(</mo><mrow><msub><mi>x</mi><mi>n</mi></msub></mrow><mo>)</mo></mrow><mo>+</mo><mi>f</mi><mrow><mo>(</mo><mrow><msub><mi>x</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mo>)</mo></mrow></mrow><mo>]</mo></mrow><mtext> </mtext><mo>,</mo></mrow></math></p></div></div><p>where <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-7px" display="block"><mrow><mi>a</mi><mo>=</mo><msub><mi>x</mi><mn>1</mn></msub><mo>&lt;</mo><msub><mi>x</mi><mn>2</mn></msub><mo>&lt;</mo><mtext> </mtext><mtext> </mtext><mn>...</mn><mtext> </mtext><mtext> </mtext><mo>&lt;</mo><msub><mi>x</mi><mi>N</mi></msub><mo>&lt;</mo><msub><mi>x</mi><mrow><mi>N</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>b</mi></mrow></math></span></span>, and <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><mrow><mo>(</mo><mrow><msub><mi>x</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>x</mi><mi>n</mi></msub></mrow><mo>)</mo></mrow></mrow></math></span></span> is the spacing between each consecutive pair of points.</p></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="bual_zk-5">Tips</h2><div class="itemizedlist"><ul><li><p>Use <code class="function">trapz</code> and <code class="function">cumtrapz</code> to
perform numerical integrations on discrete data sets. Use <code class="function">integral</code>, <code class="function">integral2</code>,
or <code class="function">integral3</code> instead if a functional expression
for the data is available.</p></li><li><p><code class="literal">trapz</code> reduces the size of the dimension
it operates on to 1, and returns only the final integration value. <code class="literal">cumtrapz</code> also
returns the intermediate integration values, preserving the size of
the dimension it operates on.</p></li></ul></div></div><div class="ref_sect"><h2 id="refsect-extended-capabilities">Extended Capabilities</h2><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink">expand all</a></p><div id="accordion_refsect-extended-capabilities" role="tablist" aria-multiselectable="true"><span id="bvl2jm1-1" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="buaijhv-1" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_buaijhv-1_codegen" aria-controls="expand_body_buaijhv-1_codegen" class="accordion-button collapsed" aria-expanded="false"><h3 id="buaijhv-1_codegen">C/C++ Code Generation<br/> <span class=" remove_bold add_font_color_general">Generate C and C++ code using MATLAB&#174; Coder&#8482;.</span></h3></button></div><div id="expand_body_buaijhv-1_codegen" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p><span>Usage notes and limitations:</span></p><p></p>
<div class="itemizedlist"><ul><li><p>If used, the <code class="literal">dim</code> argument must be a constant at
                            code generation time.</p></li><li><p>For input argument <code class="literal">Y</code>:</p>
<div class="itemizedlist"><ul><li><p>If you do not specify a dimension, the code generator operates
    along the first dimension of the input array that is variable size or whose size does not equal
    1. If this dimension is variable size at code generation time and is 1 at run time, a run-time
    error can occur. To avoid this error, specify the dimension.</p></li></ul></div><p>
</p></li></ul></div><p>
</p></div></div></div></div></div><span id="mw_f4779251-6737-41de-8132-2d5cc9a2dd4b" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="buaijhv-1" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_buaijhv-1_threadsupport" aria-controls="expand_body_buaijhv-1_threadsupport" class="accordion-button collapsed" aria-expanded="false"><h3 id="buaijhv-1_threadsupport">Thread-Based Environment<br/> <span class=" remove_bold add_font_color_general">Run code in the background using MATLAB&#174; <code class="function">backgroundPool</code> or accelerate code with Parallel Computing Toolbox&#8482; <code class="function">ThreadPool</code>.</span></h3></button></div><div id="expand_body_buaijhv-1_threadsupport" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>This function fully supports thread-based environments. For
                more information, see <a href="../matlab_prog/run-functions-on-threads.html" class="a">Run MATLAB Functions in Thread-Based Environment</a>.</p></div></div></div></div></div><span id="mw_2678a1c3-4b17-40d0-8f3c-03ce9a187b12" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="buaijhv-1" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_buaijhv-1_gpuarrays" aria-controls="expand_body_buaijhv-1_gpuarrays" class="accordion-button collapsed" aria-expanded="false"><h3 id="buaijhv-1_gpuarrays">GPU Arrays<br/> <span class=" remove_bold add_font_color_general">Accelerate code by running on a graphics processing unit (GPU) using Parallel Computing Toolbox&#8482;.</span></h3></button></div><div id="expand_body_buaijhv-1_gpuarrays" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>The <code class="function">trapz</code> function
    fully supports GPU arrays. To run the function on a GPU, specify the input data as a <a href="../../parallel-computing/gpuarray.html"><code class="function">gpuArray</code></a><span role="cross_prod"> (Parallel Computing Toolbox)</span>. For more information, see <a href="../../parallel-computing/run-matlab-functions-on-a-gpu.html" class="a">Run MATLAB Functions on a GPU</a><span role="cross_prod"> (Parallel Computing Toolbox)</span>.</p></div></div></div></div></div><span id="mw_b4e41cbb-8168-457e-8a02-2fefb4572071" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="buaijhv-1" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_buaijhv-1_distributedarrays" aria-controls="expand_body_buaijhv-1_distributedarrays" class="accordion-button collapsed" aria-expanded="false"><h3 id="buaijhv-1_distributedarrays">Distributed Arrays<br/> <span class=" remove_bold add_font_color_general">Partition large arrays across the combined memory of your cluster using Parallel Computing Toolbox&#8482;.</span></h3></button></div><div id="expand_body_buaijhv-1_distributedarrays" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>This function fully supports distributed arrays. For more
    information, see <a href="../../parallel-computing/run-matlab-functions-with-distributed-arrays.html" class="a">Run MATLAB Functions with Distributed Arrays</a><span role="cross_prod"> (Parallel Computing Toolbox)</span>.</p></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="buaijhv-1_vh">Version History</h2><p><strong>Introduced before R2006a</strong></p></div><div class="ref_sect"><h2 id="buaijhv-1_seealso">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="double.cumsum.html"><span itemprop="name"><code class="function">cumsum</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="cumtrapz.html"><span itemprop="name"><code class="function">cumtrapz</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="integral.html"><span itemprop="name"><code class="function">integral</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="integral2.html"><span itemprop="name"><code class="function">integral2</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="integral3.html"><span itemprop="name"><code class="function">integral3</code></span></a></span></p><div class="examples_container"><h3 class="remove_border">Topics</h3><div itemprop="content"><ul class="list-unstyled"><li><a href="../math/integration-of-numeric-data.html" class="a">Integration of Numeric Data</a></li></ul></div></div></div>
    </div></div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>lu</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../linear-algebra.html",
          "name": "Linear Algebra"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "linear-algebra"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExtendedCapabilities",

        "itemListElement":
        [
{
          "@type": "ListItem",
          "position": 1,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "codegen",
          "value": "limited"

        }
          },
{
          "@type": "ListItem",
          "position": 2,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "distributedarrays",
          "value": "limited"

        }
          },
{
          "@type": "ListItem",
          "position": 3,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "gpuarrays",
          "value": "limited"

        }
          },
{
          "@type": "ListItem",
          "position": 4,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "gpucodegen",
          "value": "limited"

        }
          },
{
          "@type": "ListItem",
          "position": 5,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "threadsupport",
          "value": "full"

        }
          }
        ]
        }
        </script>
<meta xmlns="http://www.w3.org/1999/xhtml" name="chunktype" content="refpage"><meta xmlns="http://www.w3.org/1999/xhtml" name="refentity" itemprop="refentity" content="function:lu"><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="fcn">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ref/function">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This MATLAB function factorizes the full or sparse matrix A into an upper triangular matrix U and a permuted lower triangular matrix L such that A = L*U."><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "refentry";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../linear-algebra.html?s_tid=CRUX_lftnav" itemprop="url" id="linear-algebra"><span itemprop="title">Linear Algebra</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item notranslate"><a href="#responsive_offcanvas"><span class="refname">lu<span id="CA_DSPLU" class="anchor_target"></span></span></a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-refentry">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li><a href="#d126e1026332" class="intrnllnk">Syntax</a></li><li class="nav-item"><a href="#description" class="nav-link intrnllnk">Description</a></li><li class="nav-item"><a href="#d126e1026549" class="nav-link intrnllnk">Examples</a><ul class="nav"><li class="nav-item"><a href="#mw_4b339f49-fb06-44fb-8014-f43f4e0b03db" class="nav-link intrnllnk">LU Factorization of Matrix</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_c755dd83-baf9-462f-97a1-e55cd5b02030" class="nav-link intrnllnk">Solve Linear System with LU Factorization</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_9d15b57b-1291-4913-9817-5128f3a5e958" class="nav-link intrnllnk">LU Factorization of Sparse Matrix</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_541f2442-eeb4-42d5-a121-6e7e7fa3087f" class="nav-link intrnllnk">Save Memory with Permutation Vectors</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_4d2f7cc0-6037-4068-aed2-dfe21915a289" class="nav-link intrnllnk">Reduce Fill-in of Sparse Matrix Factorization</a></li></ul></li><li class="nav-item"><a href="#d126e1026909" class="nav-link intrnllnk">Input Arguments</a><ul class="nav"><li class="nav-item"><a href="#d126e1026913" class="nav-link intrnllnk">A</a></li><li class="nav-item"><a href="#d126e1026946" class="nav-link intrnllnk">S</a></li><li class="nav-item"><a href="#d126e1026979" class="nav-link intrnllnk">thresh</a></li><li class="nav-item"><a href="#mw_c7ac10f5-4b1d-4b24-aac5-cb08fc302896" class="nav-link intrnllnk">outputForm</a></li></ul></li><li class="nav-item"><a href="#d126e1027222" class="nav-link intrnllnk">Output Arguments</a><ul class="nav"><li class="nav-item"><a href="#d126e1027226" class="nav-link intrnllnk">L</a></li><li class="nav-item"><a href="#d126e1027269" class="nav-link intrnllnk">U</a></li><li class="nav-item"><a href="#d126e1027286" class="nav-link intrnllnk">P</a></li><li class="nav-item"><a href="#d126e1027314" class="nav-link intrnllnk">Q</a></li><li class="nav-item"><a href="#d126e1027342" class="nav-link intrnllnk">D</a></li></ul></li><li class="nav-item"><a href="#d126e1027366" class="nav-link intrnllnk">Algorithms</a></li><li><a href="#References" class="intrnllnk">References</a></li><li class="nav-item"><a href="#refsect-extended-capabilities" class="nav-link intrnllnk">Extended Capabilities</a></li><li class="nav-item"><a href="#mw_badb7372-0ccf-47e5-acd0-67fbf02a9336" class="nav-link intrnllnk">Version History</a><ul class="nav"><li class="nav-item"><a href="#mw_4314dc35-1626-48ea-907c-a8f4eb12c013" class="nav-link intrnllnk">Specify single-precision sparse input argument</a></li></ul></li><li class="nav-item"><a href="#f89-998950_seealso" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=linear-algebra&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=linear-algebra&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=linear-algebra&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=linear-algebra&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=linear-algebra&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=linear-algebra&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-ref-function"><div class="function_ref"><span id="f89-998950" class="anchor_target"></span><h1 class="r2025b notranslate" itemprop="title"><span class="refname">lu<span id="CA_DSPLU" class="anchor_target"></span></span></h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">LU matrix factorization</p><div class="switch"><a href="javascript:void(0);" id="expandAllPage" data-allexpanded="true1">collapse all in page</a></div></div></div>
<div class="ref_sect"><h2 id="d126e1026332">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><div class="code_responsive"><code class="synopsis"><a href="#d126e1026341" class="intrnllnk">[L,U] = lu(A)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1026368" class="intrnllnk">[L,U,P] = lu(A)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1026397" class="intrnllnk">[L,U,P] = lu(A,outputForm)</a></code></div></div><div class="syntax_signature_module"><div class="code_responsive"><code class="synopsis"><a href="#d126e1026435" class="intrnllnk">[L,U,P,Q] = lu(S)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1026471" class="intrnllnk">[L,U,P,Q,D] = lu(S)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1026498" class="intrnllnk">[<span class="argument_placeholder">___</span>] = lu(S,thresh)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1026518" class="intrnllnk">[<span class="argument_placeholder">___</span>] = lu(<span class="argument_placeholder">___</span>,outputForm)</a></code></div></div></div></div><div class="clear"></div><h2 id="description">Description</h2><div class="descriptions"><div class="cshsummary" id="csh_f89-998950"><div class="description_module"><span id="mw_68fab1d0-3d65-4063-94fe-5cbb5775da1c" class="anchor_target"></span>
            <div class="description_element"><div class="code_responsive"><p><span id="d126e1026341" itemprop="syntax"><code class="synopsis">[<a href="#d126e1027226" class="intrnllnk"><code class="argument">L</code></a>,<a href="#d126e1027269" class="intrnllnk"><code class="argument">U</code></a>] = lu(<a href="#d126e1026913" class="intrnllnk"><code class="argument">A</code></a>)</code></span>
                    factorizes the full or sparse matrix <code class="literal">A</code> into an upper
                    triangular matrix <code class="literal">U</code> and a permuted lower triangular matrix
                        <code class="literal">L</code> such that <code class="literal">A = L*U</code>.</p></div><p class="syntax_example"><a href="lu.html#mw_4b339f49-fb06-44fb-8014-f43f4e0b03db" class="intrnllnk">example</a></p></div>
            <div class="description_element"><div class="code_responsive"><p><span id="d126e1026368" itemprop="syntax"><code class="synopsis">[<a href="#d126e1027226" class="intrnllnk"><code class="argument">L</code></a>,<a href="#d126e1027269" class="intrnllnk"><code class="argument">U</code></a>,<a href="#d126e1027286" class="intrnllnk"><code class="argument">P</code></a>] = lu(<a href="#d126e1026913" class="intrnllnk"><code class="argument">A</code></a>)</code></span>
                    also returns a permutation matrix <code class="literal">P</code> such that <code class="literal">A =
                        P'*L*U</code>. With this syntax, <code class="literal">L</code> is unit lower
                    triangular and <code class="literal">U</code> is upper triangular.</p></div><p class="syntax_example"><a href="lu.html#mw_4b339f49-fb06-44fb-8014-f43f4e0b03db" class="intrnllnk">example</a></p></div>
            <div class="description_element"><div class="code_responsive"><p><span id="d126e1026397" itemprop="syntax"><code class="synopsis">[<a href="#d126e1027226" class="intrnllnk"><code class="argument">L</code></a>,<a href="#d126e1027269" class="intrnllnk"><code class="argument">U</code></a>,<a href="#d126e1027286" class="intrnllnk"><code class="argument">P</code></a>] = lu(<a href="#d126e1026913" class="intrnllnk"><code class="argument">A</code></a>,<a href="#mw_c7ac10f5-4b1d-4b24-aac5-cb08fc302896" class="intrnllnk"><code class="argument">outputForm</code></a>)</code></span>
                    returns <code class="literal">P</code> in the form specified by
                        <code class="literal">outputForm</code>. Specify <code class="literal">outputForm</code> as
                        <code class="literal">'vector'</code> to return <code class="literal">P</code> as a permutation
                    vector such that <code class="literal">A(P,:) = L*U</code>.</p></div><p class="syntax_example"><a href="lu.html#mw_541f2442-eeb4-42d5-a121-6e7e7fa3087f" class="intrnllnk">example</a></p></div>
        </div><div class="description_module"><span id="mw_07dc2239-7bf7-44a7-9e77-af3cc7568051" class="anchor_target"></span>
            <div class="description_element"><div class="code_responsive"><p><span id="d126e1026435" itemprop="syntax"><code class="synopsis">[<a href="#d126e1027226" class="intrnllnk"><code class="argument">L</code></a>,<a href="#d126e1027269" class="intrnllnk"><code class="argument">U</code></a>,<a href="#d126e1027286" class="intrnllnk"><code class="argument">P</code></a>,<a href="#d126e1027314" class="intrnllnk"><code class="argument">Q</code></a>] = lu(<a href="#d126e1026946" class="intrnllnk"><code class="argument">S</code></a>)</code></span>
                    factorizes sparse matrix <code class="literal">S</code> into a unit lower triangular
                    matrix <code class="literal">L</code>, an upper triangular matrix <code class="literal">U</code>, a
                    row permutation matrix <code class="literal">P</code>, and a column permutation matrix
                        <code class="literal">Q</code>, such that <code class="literal">P*S*Q = L*U</code>.</p></div><p class="syntax_example"><a href="lu.html#mw_9d15b57b-1291-4913-9817-5128f3a5e958" class="intrnllnk">example</a></p></div>
            <div class="description_element"><div class="code_responsive"><p><span id="d126e1026471" itemprop="syntax"><code class="synopsis">[<a href="#d126e1027226" class="intrnllnk"><code class="argument">L</code></a>,<a href="#d126e1027269" class="intrnllnk"><code class="argument">U</code></a>,<a href="#d126e1027286" class="intrnllnk"><code class="argument">P</code></a>,<a href="#d126e1027314" class="intrnllnk"><code class="argument">Q</code></a>,<a href="#d126e1027342" class="intrnllnk"><code class="argument">D</code></a>] = lu(<a href="#d126e1026946" class="intrnllnk"><code class="argument">S</code></a>)</code></span>
                    also returns a diagonal scaling matrix <code class="literal">D</code> such that
                        <code class="literal">P*(D\S)*Q = L*U</code>. Typically, the row-scaling leads to a
                    sparser and more stable factorization.</p></div></div>
            <div class="description_element"><div class="code_responsive"><p><span id="d126e1026498" itemprop="syntax"><code class="synopsis">[<span class="argument_placeholder">___</span>] = lu(<a href="#d126e1026946" class="intrnllnk"><code class="argument">S</code></a>,<a href="#d126e1026979" class="intrnllnk"><code class="argument">thresh</code></a>)</code></span>
                    specifies thresholds for the pivoting strategy employed by
                        <code class="function">lu</code> using any of the previous output argument
                    combinations. Depending on the number of output arguments specified, the default
                    value and requirements for the <code class="literal">thresh</code> input are different.
                    See the <code class="argument">thresh</code> argument description for details.</p></div></div>
            <div class="description_element"><div class="code_responsive"><p><span id="d126e1026518" itemprop="syntax"><code class="synopsis">[<span class="argument_placeholder">___</span>] = lu(<span class="argument_placeholder">___</span>,<a href="#mw_c7ac10f5-4b1d-4b24-aac5-cb08fc302896" class="intrnllnk"><code class="argument">outputForm</code></a>)</code></span>
                    returns <code class="literal">P</code> and <code class="literal">Q</code> in the form specified by
                        <code class="literal">outputForm</code>. Specify <code class="literal">outputForm</code> as
                        <code class="literal">'vector'</code> to return <code class="literal">P</code> and
                        <code class="literal">Q</code> as permutation vectors. You can use any of the input
                    argument combinations in previous syntaxes.</p></div><p class="syntax_example"><a href="lu.html#mw_541f2442-eeb4-42d5-a121-6e7e7fa3087f" class="intrnllnk">example</a></p></div>
        </div></div></div><div class="clear"></div><div class="examples"><h2 id="d126e1026549">Examples</h2><div class="expandableContent" id="expandableExamples"><p class="switch"><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true3">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_4b339f49-fb06-44fb-8014-f43f4e0b03db"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_4b339f49-fb06-44fb-8014-f43f4e0b03db" data-bs-target="#expand_accordion_body_mw_4b339f49-fb06-44fb-8014-f43f4e0b03db" aria-controls="expand_accordion_body_mw_4b339f49-fb06-44fb-8014-f43f4e0b03db" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_4b339f49-fb06-44fb-8014-f43f4e0b03db">LU Factorization of Matrix</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_4b339f49-fb06-44fb-8014-f43f4e0b03db" aria-labelledby="expand_accordion_heading_mw_4b339f49-fb06-44fb-8014-f43f4e0b03db" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/LUFactorizationOfMatrixExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "LU Factorization of Matrix",
          "description": "Compute the LU factorization of a matrix and examine the resulting factors. LU factorization is a way of decomposing a matrix A into an upper triangular matrix U, a lower triangular matrix L, and a permutation matrix P such that PA=LU. These matrices describe the steps needed to perform Gaussian elimination on the matrix until it is in reduced row echelon form. The L matrix contains all of the multipliers, and the permutation matrix P accounts for row interchanges.",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "lu.html"

        },
          "identifier": "matlab.LUFactorizationOfMatrixExample",
          "name": "LUFactorizationOfMatrixExample",
          "url": "lu.html#mw_4b339f49-fb06-44fb-8014-f43f4e0b03db"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/LUFactorizationOfMatrixExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "LUFactorizationOfMatrixExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Compute the LU factorization of a matrix and examine the resulting factors. LU factorization is a way of decomposing a matrix <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">A</mi></mrow></math></span> into an upper triangular matrix <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">U</mi></mrow></math></span>, a lower triangular matrix <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">L</mi></mrow></math></span>, and a permutation matrix <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">P</mi></mrow></math></span> such that <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">PA</mi><mo>=</mo><mi mathvariant="normal">LU</mi></mrow></math></span>. These matrices describe the steps needed to perform Gaussian elimination on the matrix until it is in reduced row echelon form. The <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">L</mi></mrow></math></span> matrix contains all of the multipliers, and the permutation matrix <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">P</mi></mrow></math></span> accounts for row interchanges.</p><p>Create a 3-by-3 matrix and calculate the LU factors.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>A = [10 -7 0
     -3  2 6
      5 -1 5];</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[L,U] = lu(A)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>L = <span class="emphasis"><em>3×3</em></span>

    1.0000         0         0
   -0.3000   -0.0400    1.0000
    0.5000    1.0000         0

</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>U = <span class="emphasis"><em>3×3</em></span>

   10.0000   -7.0000         0
         0    2.5000    5.0000
         0         0    6.2000

</pre></div></div></div><p>Multiply the factors to recreate <code class="literal">A</code>. With the two-input syntax, <code class="literal">lu</code> incorporates the permutation matrix <code class="literal">P</code> directly into the <code class="literal">L</code> factor, such that the <code class="literal">L</code> being returned is really <code class="literal">P'*L</code> and thus <code class="literal">A = L*U</code>. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>L*U</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans = <span class="emphasis"><em>3×3</em></span>

    10    -7     0
    -3     2     6
     5    -1     5

</pre></div></div></div><p>You can specify three outputs to separate the permutation matrix from the multipliers in <code class="literal">L</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[L,U,P] = lu(A)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>L = <span class="emphasis"><em>3×3</em></span>

    1.0000         0         0
    0.5000    1.0000         0
   -0.3000   -0.0400    1.0000

</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>U = <span class="emphasis"><em>3×3</em></span>

   10.0000   -7.0000         0
         0    2.5000    5.0000
         0         0    6.2000

</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>P = <span class="emphasis"><em>3×3</em></span>

     1     0     0
     0     0     1
     0     1     0

</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>P'*L*U</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans = <span class="emphasis"><em>3×3</em></span>

    10    -7     0
    -3     2     6
     5    -1     5

</pre></div></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-LUFactorizationOfMatrixExample"><meta itemprop="exampletitle" content="LU Factorization of Matrix"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_c755dd83-baf9-462f-97a1-e55cd5b02030"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_c755dd83-baf9-462f-97a1-e55cd5b02030" data-bs-target="#expand_accordion_body_mw_c755dd83-baf9-462f-97a1-e55cd5b02030" aria-controls="expand_accordion_body_mw_c755dd83-baf9-462f-97a1-e55cd5b02030" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_c755dd83-baf9-462f-97a1-e55cd5b02030">Solve Linear System with LU Factorization</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_c755dd83-baf9-462f-97a1-e55cd5b02030" aria-labelledby="expand_accordion_heading_mw_c755dd83-baf9-462f-97a1-e55cd5b02030" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/SolveLinearSystemWithLUFactorizationExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Solve Linear System with LU Factorization",
          "description": "Solve a linear system by performing an LU factorization and using the factors to simplify the problem. Compare the results with other approaches using the backslash operator and decomposition object.",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "lu.html"

        },
          "identifier": "matlab.SolveLinearSystemWithLUFactorizationExample",
          "name": "SolveLinearSystemWithLUFactorizationExample",
          "url": "lu.html#mw_c755dd83-baf9-462f-97a1-e55cd5b02030"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/SolveLinearSystemWithLUFactorizationExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "SolveLinearSystemWithLUFactorizationExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Solve a linear system by performing an LU factorization and using the factors to simplify the problem. Compare the results with other approaches using the backslash operator and <code class="literal">decomposition</code> object.</p><p>Create a 5-by-5 magic square matrix and solve the linear system <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">Ax</mi><mo>=</mo><mi mathvariant="italic">b</mi></mrow></math></span> with all of the elements of <code class="literal">b</code> equal to 65, the magic sum. Since 65 is the magic sum for this matrix (all of the rows and columns add to 65), the expected solution for <code class="literal">x</code> is a vector of 1s.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>A = magic(5);
b = 65*ones(5,1);
x = A\b</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>x = <span class="emphasis"><em>5×1</em></span>

    1.0000
    1.0000
    1.0000
    1.0000
    1.0000

</pre></div></div></div><p>For generic square matrices, the backslash operator computes the solution of the linear system using LU decomposition. LU decomposition expresses <code class="literal">A</code> as the product of triangular matrices, and linear systems involving triangular matrices are easily solved using substitution formulas. </p><p>To recreate the answer computed by backslash, compute the LU decomposition of <code class="literal">A</code>. Then, use the factors to solve two triangular linear systems:</p><div class="code_responsive"><pre id="d126e1026727" class="programlisting">y = L\(P*b);
x = U\y;
</pre></div><p>This approach of precomputing the matrix factors prior to solving the linear system can improve performance when many linear systems will be solved, since the factorization occurs only once and does not need to be repeated.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[L,U,P] = lu(A)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>L = <span class="emphasis"><em>5×5</em></span>

    1.0000         0         0         0         0
    0.7391    1.0000         0         0         0
    0.4783    0.7687    1.0000         0         0
    0.1739    0.2527    0.5164    1.0000         0
    0.4348    0.4839    0.7231    0.9231    1.0000

</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>U = <span class="emphasis"><em>5×5</em></span>

   23.0000    5.0000    7.0000   14.0000   16.0000
         0   20.3043   -4.1739   -2.3478    3.1739
         0         0   24.8608   -2.8908   -1.0921
         0         0         0   19.6512   18.9793
         0         0         0         0  -22.2222

</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>P = <span class="emphasis"><em>5×5</em></span>

     0     1     0     0     0
     1     0     0     0     0
     0     0     0     0     1
     0     0     1     0     0
     0     0     0     1     0

</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>y = L\(P*b);
x = U\y</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>x = <span class="emphasis"><em>5×1</em></span>

    1.0000
    1.0000
    1.0000
    1.0000
    1.0000

</pre></div></div></div><p>The <code class="literal">decomposition</code> object also is useful to solve linear systems using specialized factorizations, since you get many of the performance benefits of precomputing the matrix factors but you do not need to know how to use the factors. Use the decomposition object with the <code class="literal">'lu'</code> type to recreate the same results.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>dA = decomposition(A,<span style="color:#A020F0">'lu'</span>);
x = dA\b</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>x = <span class="emphasis"><em>5×1</em></span>

    1.0000
    1.0000
    1.0000
    1.0000
    1.0000

</pre></div></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-SolveLinearSystemWithLUFactorizationExample"><meta itemprop="exampletitle" content="Solve Linear System with LU Factorization"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_9d15b57b-1291-4913-9817-5128f3a5e958"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_9d15b57b-1291-4913-9817-5128f3a5e958" data-bs-target="#expand_accordion_body_mw_9d15b57b-1291-4913-9817-5128f3a5e958" aria-controls="expand_accordion_body_mw_9d15b57b-1291-4913-9817-5128f3a5e958" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_9d15b57b-1291-4913-9817-5128f3a5e958">LU Factorization of Sparse Matrix</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_9d15b57b-1291-4913-9817-5128f3a5e958" aria-labelledby="expand_accordion_heading_mw_9d15b57b-1291-4913-9817-5128f3a5e958" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/LUFactorizationOfSparseMatrixExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "LU Factorization of Sparse Matrix",
          "description": "Compute the LU factorization of a sparse matrix and verify the identity L*U = P*S*Q.",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "lu.html"

        },
          "identifier": "matlab.LUFactorizationOfSparseMatrixExample",
          "name": "LUFactorizationOfSparseMatrixExample",
          "url": "lu.html#mw_9d15b57b-1291-4913-9817-5128f3a5e958"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/LUFactorizationOfSparseMatrixExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "LUFactorizationOfSparseMatrixExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Compute the LU factorization of a sparse matrix and verify the identity <code class="literal">L*U = P*S*Q</code>.</p><p>Create a 60-by-60 sparse adjacency matrix of the connectivity graph of the Buckminster-Fuller geodesic dome.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>S = bucky;</pre></div></div></div><p>Compute the LU factorization of <code class="literal">S</code> using the sparse matrix syntax with four outputs to return the row and column permutation matrices.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[L,U,P,Q] = lu(S);</pre></div></div></div><p>Permute the rows and columns of <code class="literal">S</code> with <code class="literal">P*S*Q</code> and compare the result with multiplying the triangular factors <code class="literal">L*U</code>. The 1-norm of their difference is within round-off error, indicating that <code class="literal">L*U = P*S*Q</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>e = P*S*Q - L*U;
norm(e,1)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans = 
5.7732e-15
</pre></div></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-LUFactorizationOfSparseMatrixExample"><meta itemprop="exampletitle" content="LU Factorization of Sparse Matrix"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_541f2442-eeb4-42d5-a121-6e7e7fa3087f"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_541f2442-eeb4-42d5-a121-6e7e7fa3087f" data-bs-target="#expand_accordion_body_mw_541f2442-eeb4-42d5-a121-6e7e7fa3087f" aria-controls="expand_accordion_body_mw_541f2442-eeb4-42d5-a121-6e7e7fa3087f" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_541f2442-eeb4-42d5-a121-6e7e7fa3087f">Save Memory with Permutation Vectors</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_541f2442-eeb4-42d5-a121-6e7e7fa3087f" aria-labelledby="expand_accordion_heading_mw_541f2442-eeb4-42d5-a121-6e7e7fa3087f" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/SaveMemoryWithPermutationVectorsExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Save Memory with Permutation Vectors",
          "description": "Compute the LU factorization of a matrix. Save memory by returning the row permutations as a vector instead of a matrix.",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "lu.html"

        },
          "identifier": "matlab.SaveMemoryWithPermutationVectorsExample",
          "name": "SaveMemoryWithPermutationVectorsExample",
          "url": "lu.html#mw_541f2442-eeb4-42d5-a121-6e7e7fa3087f"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/SaveMemoryWithPermutationVectorsExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "SaveMemoryWithPermutationVectorsExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Compute the LU factorization of a matrix. Save memory by returning the row permutations as a vector instead of a matrix.</p><p>Create a 1000-by-1000 random matrix.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>A = rand(1000);</pre></div></div></div><p>Compute the LU factorization with the permutation information stored as a matrix <code class="literal">P</code>. Compare the result with the permutation information stored as a vector <code class="literal">p</code>. The larger the matrix, the more memory efficient it is to use a permutation vector.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[L1,U1,P] = lu(A);
[L2,U2,p] = lu(A,<span style="color:#A020F0">'vector'</span>);
whos <span style="color:#A020F0">P</span> <span style="color:#A020F0">p</span></pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>  Name         Size                Bytes  Class     Attributes

  P         1000x1000            8000000  double              
  p            1x1000               8000  double              
</pre></div></div></div><p>Using a permutation vector also saves on execution time in subsequent operations. For instance, you can use the previous LU factorizations to solve a linear system <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">Ax</mi><mo>=</mo><mi mathvariant="italic">b</mi></mrow></math></span>. Although the solutions obtained from the permutation vector and permutation matrix are equivalent (up to round-off), the solution using the permutation vector typically requires a little less time.</p><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-SaveMemoryWithPermutationVectorsExample"><meta itemprop="exampletitle" content="Save Memory with Permutation Vectors"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_4d2f7cc0-6037-4068-aed2-dfe21915a289"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_4d2f7cc0-6037-4068-aed2-dfe21915a289" data-bs-target="#expand_accordion_body_mw_4d2f7cc0-6037-4068-aed2-dfe21915a289" aria-controls="expand_accordion_body_mw_4d2f7cc0-6037-4068-aed2-dfe21915a289" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_4d2f7cc0-6037-4068-aed2-dfe21915a289">Reduce Fill-in of Sparse Matrix Factorization</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_4d2f7cc0-6037-4068-aed2-dfe21915a289" aria-labelledby="expand_accordion_heading_mw_4d2f7cc0-6037-4068-aed2-dfe21915a289" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/ReduceFillinOfSparseMatrixFactorizationExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Reduce Fill-in of Sparse Matrix Factorization",
          "description": "Compare the results of computing the LU factorization of a sparse matrix with and without column permutations.",
          "thumbnailURL": "../../examples/matlab/win64/ReduceFillinOfSparseMatrixFactorizationExample_02.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "lu.html"

        },
          "identifier": "matlab.ReduceFillinOfSparseMatrixFactorizationExample",
          "name": "ReduceFillinOfSparseMatrixFactorizationExample",
          "url": "lu.html#mw_4d2f7cc0-6037-4068-aed2-dfe21915a289"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/ReduceFillinOfSparseMatrixFactorizationExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "ReduceFillinOfSparseMatrixFactorizationExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Compare the results of computing the LU factorization of a sparse matrix with and without column permutations.</p><p>Load the <code class="literal">west0479</code> matrix, which is a real-valued 479-by-479 sparse matrix.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>load <span style="color:#A020F0">west0479</span>
A = west0479;</pre></div></div></div><p>Calculate the LU factorization of <code class="literal">A</code> by calling <code class="literal">lu</code> with three outputs. Generate spy plots of the L and U factors.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[L,U,P] = lu(A);
subplot(1,2,1)
spy(L)
title(<span style="color:#A020F0">'L factor'</span>)
subplot(1,2,2)
spy(U)
title(<span style="color:#A020F0">'U factor'</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e1026888" class="mediaobject"><p><img src="../../examples/matlab/win64/ReduceFillinOfSparseMatrixFactorizationExample_01.png" alt="Figure contains 2 axes objects. Axes object 1 with title L factor, xlabel nz = 10351 contains a line object which displays its values using only markers. Axes object 2 with title U factor, xlabel nz = 6046 contains a line object which displays its values using only markers." width="560"></p></div></div><p>Now, calculate the LU factorization of <code class="literal">A</code> using <code class="literal">lu</code> with four outputs, which permutes the columns of <code class="literal">A</code> to reduce the number of nonzeros in the factors. The resulting factors are much sparser than if column permutations are not used.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[L,U,P,Q] = lu(A);
subplot(1,2,1)
spy(L)
title(<span style="color:#A020F0">'L factor'</span>)
subplot(1,2,2)
spy(U)
title(<span style="color:#A020F0">'U factor'</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e1026903" class="mediaobject"><p><img src="../../examples/matlab/win64/ReduceFillinOfSparseMatrixFactorizationExample_02.png" alt="Figure contains 2 axes objects. Axes object 1 with title L factor, xlabel nz = 1855 contains a line object which displays its values using only markers. Axes object 2 with title U factor, xlabel nz = 2391 contains a line object which displays its values using only markers." width="560"></p></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-ReduceFillinOfSparseMatrixFactorizationExample"><meta itemprop="exampletitle" content="Reduce Fillin of Sparse Matrix Factorization"></div></div></div></div><div class="ref_sect"><h2 id="d126e1026909">Input Arguments</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="d126e1026909_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="d126e1026913"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_d126e1026913" data-bs-target="#expand_accordion_body_d126e1026913" aria-controls="expand_accordion_body_d126e1026913" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_A" class="anchor_target"></span><h3 id="d126e1026913"><code itemprop="name">A</code> &#8212; <span itemprop="purpose">Input matrix</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">matrix</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_d126e1026913" aria-labelledby="expand_accordion_heading_d126e1026913" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f89-998950"><p>Input matrix. <code class="literal">A</code> can be full or sparse as well as square
                        or rectangular in size.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code><br/>
<strong>Complex Number Support: </strong>Yes</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="d126e1026946"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_d126e1026946" data-bs-target="#expand_accordion_body_d126e1026946" aria-controls="expand_accordion_body_d126e1026946" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_S" class="anchor_target"></span><h3 id="d126e1026946"><code itemprop="name">S</code> &#8212; <span itemprop="purpose">Sparse input matrix</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">sparse matrix</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_d126e1026946" aria-labelledby="expand_accordion_heading_d126e1026946" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f89-998950"><p>Sparse input matrix. <code class="literal">S</code> can be square or rectangular in
                        size.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code><br/>
<strong>Complex Number Support: </strong>Yes</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="d126e1026979"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_d126e1026979" data-bs-target="#expand_accordion_body_d126e1026979" aria-controls="expand_accordion_body_d126e1026979" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_thresh" class="anchor_target"></span><h3 id="d126e1026979"><code itemprop="name">thresh</code> &#8212; <span itemprop="purpose">Pivoting thresholds for sparse matrices</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">scalar</span> | <span itemprop="inputvalue">two-element vector</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_d126e1026979" aria-labelledby="expand_accordion_heading_d126e1026979" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f89-998950"><p>Pivoting thresholds for sparse matrices, specified as a scalar or
                        two-element vector. Valid values are in the interval <code class="literal">[0
                            1]</code>. The way you specify <code class="literal">thresh</code> depends on
                        how many outputs are specified in the call to <code class="function">lu</code>:</p>
<div class="itemizedlist"><ul><li><p>For <strong class="emphasis bold">three outputs or less</strong>,
                                        <code class="literal">thresh</code> must be a scalar, and the default
                                    value is <code class="literal">1.0</code>.</p></li><li><p>For <strong class="emphasis bold">four outputs or more</strong>,
                                        <code class="literal">thresh</code> can be a scalar or a two element
                                    vector. The default value is <code class="literal">[0.1 0.001]</code>. If
                                    you specify <code class="literal">thresh</code> as a scalar, then that
                                    only replaces the first value in the vector.</p></li></ul></div><p>
</p><p>At a high level, this input enables you to make trade-offs between
                        accuracy and total execution time. Smaller values of
                            <code class="literal">thresh</code> tend to lead to sparser LU factors, but the
                        solution can become inaccurate. Larger values can lead to a more accurate
                        solution (but not always), and usually an increase in the total work and
                        memory usage.</p><p>
                        <code class="function">lu</code> selects a pivoting strategy based first on the
                        number of output arguments and second on the properties of the matrix being
                        factorized. In all cases, setting the threshold value(s) to
                            <code class="literal">1.0</code> results in partial pivoting, while setting them
                        to <code class="literal">0</code> causes the pivots to be chosen only based on the
                        sparsity of the resulting matrix. All values of <code class="literal">L</code> have an
                        absolute value of <code class="literal">1/min(thresh)</code> or less.</p><div class="itemizedlist"><ul><li><p><strong class="emphasis bold">Three or fewer output arguments</strong> &#8212;
                                The algorithm selects the diagonal pivot if it satisfies the
                                equation<div class="code_responsive"><pre class="programlisting">A(j,j) &gt;= thresh * max(abs(A(j:m,j)))</pre></div>Otherwise,
                                it selects the row that contains the element of largest absolute
                                value.</p></li><li><p><strong class="emphasis bold">Symmetric Pivoting Strategy</strong> &#8212; If
                                    <code class="literal">S</code> is a square sparse matrix with a mostly
                                symmetric structure and mostly nonzero diagonal, then
                                    <code class="function">lu</code> uses a symmetric pivoting strategy. For
                                this strategy, the algorithm selects the diagonal pivot
                                    <code class="literal">j</code> if it satisfies the
                                inequality:<div class="code_responsive"><pre class="programlisting">A(i,j) &gt;= thresh(2) * max(abs(A(j:m,j)))</pre></div>If
                                the diagonal entry fails this test, then <code class="function">lu</code>
                                selects the sparsest row <code class="literal">i</code> satisfying the
                                inequality:<div class="code_responsive"><pre class="programlisting">A(i,j) &gt;= thresh(1) * max(abs(A(j:m,j)))</pre></div></p></li><li><p><strong class="emphasis bold">Nonsymmetric Pivoting Strategy</strong> &#8212;
                                If <code class="literal">S</code> does not satisfy the requirements for the
                                symmetric pivoting strategy, then <code class="literal">lu</code> uses a
                                nonsymmetric strategy. In this case, <code class="literal">lu</code> selects
                                the sparsest row <code class="literal">i</code> satisfying the
                                inequality:<div class="code_responsive"><pre class="programlisting">A(i,j) &gt;= thresh(1) * max(abs(A(j:m,j)))</pre></div>A
                                value of <code class="literal">1.0</code> for <code class="literal">thresh(1)</code>
                                results in conventional partial pivoting. Entries in
                                    <code class="literal">L</code> have an absolute value of
                                    <code class="literal">1/thresh(1)</code> or less. The second element of
                                the <code class="literal">thresh</code> input vector is not used with the
                                nonsymmetric strategy.</p></li></ul></div><div class="alert alert-info d-inline-block"><span class="alert_icon icon-alert-info-reverse"></span><p class="alert_heading"><strong>Note</strong></p><p>In some rare cases, an incorrect factorization results in
                                <code class="literal">P*S*Q</code> ≠ <code class="literal">L*U</code>. If this occurs,
                            increase <code class="literal">thresh</code> to a maximum of
                                <code class="literal">1.0</code> (regular partial pivoting), and try
                            again.</p></div></div></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="mw_c7ac10f5-4b1d-4b24-aac5-cb08fc302896"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_c7ac10f5-4b1d-4b24-aac5-cb08fc302896" data-bs-target="#expand_accordion_body_mw_c7ac10f5-4b1d-4b24-aac5-cb08fc302896" aria-controls="expand_accordion_body_mw_c7ac10f5-4b1d-4b24-aac5-cb08fc302896" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_outputForm" class="anchor_target"></span><h3 id="mw_c7ac10f5-4b1d-4b24-aac5-cb08fc302896"><code itemprop="name">outputForm</code> &#8212; <span itemprop="purpose">Shape of permutation outputs</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue defaultvalue"><code class="literal">'matrix'</code></span> (default) | <span itemprop="inputvalue"><code class="literal">'vector'</code></span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_c7ac10f5-4b1d-4b24-aac5-cb08fc302896" aria-labelledby="expand_accordion_heading_mw_c7ac10f5-4b1d-4b24-aac5-cb08fc302896" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_c7ac10f5-4b1d-4b24-aac5-cb08fc302896"><p>Shape of permutation outputs, specified as <code class="literal">'matrix'</code> or
                            <code class="literal">'vector'</code>. This flag controls whether
                            <code class="function">lu</code> returns the row permutations
                            <code class="literal">P</code> and column permutations <code class="literal">Q</code> as
                        permutation matrices or permutation vectors.</p><p>As <strong class="emphasis bold">matrices</strong>, the outputs
                            <code class="literal">P</code> and <code class="literal">Q</code> satisfy these identities:</p>
<div class="itemizedlist"><ul><li><p>Three outputs  &#8212; <code class="literal">P</code> satisfies <code class="literal">P*A =
                                        L*U</code>.</p></li><li><p>Four outputs  &#8212; <code class="literal">P</code> and <code class="literal">Q</code>
                                    satisfy <code class="literal">P*S*Q = L*U</code>.</p></li><li><p>Five outputs &#8212; <code class="literal">P</code>, <code class="literal">Q</code>, and
                                        <code class="literal">D</code> satisfy <code class="literal">P*(D\S)*Q =
                                        L*U</code>.</p></li></ul></div><p>
</p><p>As <strong class="emphasis bold">vectors</strong>, the outputs
                            <code class="literal">P</code> and <code class="literal">Q</code> satisfy these identities:</p>
<div class="itemizedlist"><ul><li><p>Three outputs &#8212; <code class="literal">P</code> satisfies <code class="literal">A(P,:)
                                        = L*U</code></p></li><li><p>Four outputs &#8212; <code class="literal">P</code> and <code class="literal">Q</code>
                                    satisfy <code class="literal">S(P,Q) = L*U</code></p></li><li><p>Five outputs &#8212; <code class="literal">P</code>, <code class="literal">Q</code>, and
                                        <code class="literal">D</code> satisfy <code class="literal">D(:,P)\S(:,Q) =
                                        L*U</code>.</p></li></ul></div><p>
</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">[L,U,P] = lu(A,'vector')</code></p></div></div></div></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="d126e1027222">Output Arguments</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="d126e1027222_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_d126e1027226" data-bs-target="#expand_accordion_body_d126e1027226" aria-controls="expand_accordion_body_d126e1027226" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_L" class="anchor_target"></span><h3 id="d126e1027226"><code class="name">L</code> &#8212; Lower triangular factor<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">matrix</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_d126e1027226" aria-labelledby="expand_accordion_heading_d126e1027226" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f89-998950"><p>Lower triangular factor, returned as a matrix. The form of
                            <code class="literal">L</code> depends on whether the row permutations
                            <code class="literal">P</code> are returned in a separate output:</p>
<div class="itemizedlist"><ul><li><p>If the third output <code class="literal">P</code> is specified, then
                                        <code class="literal">L</code> is returned as a unit lower triangular
                                    matrix (that is, a lower triangular matrix with 1s on the main
                                    diagonal).</p></li><li><p>If the third output <code class="literal">P</code> is not specified,
                                    then <code class="literal">L</code> is returned as a row-permutation of a
                                    unit lower triangular matrix. Specifically, it is the product
                                        <code class="literal">P'*L</code> of the outputs <code class="literal">P</code>
                                    and <code class="literal">L</code> returned in the three output
                                    case.</p></li></ul></div><p>
</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_d126e1027269" data-bs-target="#expand_accordion_body_d126e1027269" aria-controls="expand_accordion_body_d126e1027269" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_U" class="anchor_target"></span><h3 id="d126e1027269"><code class="name">U</code> &#8212; Upper triangular factor<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">matrix</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_d126e1027269" aria-labelledby="expand_accordion_heading_d126e1027269" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f89-998950"><p>Upper triangular factor, returned as an upper triangular matrix.</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_d126e1027286" data-bs-target="#expand_accordion_body_d126e1027286" aria-controls="expand_accordion_body_d126e1027286" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_P" class="anchor_target"></span><h3 id="d126e1027286"><code class="name">P</code> &#8212; Row permutation<br/>
<span class="add_font_color_general remove_bold"><span class="example_desc">vector | matrix</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_d126e1027286" aria-labelledby="expand_accordion_heading_d126e1027286" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f89-998950"><p>Row permutation, returned as a permutation matrix or, if the
                            <code class="literal">'vector'</code> option is specified, as a permutation
                        vector. Use this output to improve the numerical stability of the
                        calculation.</p><p>See <a href="lu.html#mw_c7ac10f5-4b1d-4b24-aac5-cb08fc302896" class="intrnllnk"><code class="argument">outputForm</code></a> for a description of the identities that this
                        output satisfies.</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_d126e1027314" data-bs-target="#expand_accordion_body_d126e1027314" aria-controls="expand_accordion_body_d126e1027314" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_Q" class="anchor_target"></span><h3 id="d126e1027314"><code class="name">Q</code> &#8212; Column permutation<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">vector | matrix</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_d126e1027314" aria-labelledby="expand_accordion_heading_d126e1027314" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f89-998950"><p>Column permutation, returned as a permutation matrix or, if the
                            <code class="literal">'vector'</code> option is specified, as a permutation
                        vector. Use this output to reduce the fill-in (number of nonzeros) in the
                        factors of a sparse matrix.</p><p>See <a href="lu.html#mw_c7ac10f5-4b1d-4b24-aac5-cb08fc302896" class="intrnllnk"><code class="argument">outputForm</code></a> for a description of the identities that this
                        output satisfies.</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_d126e1027342" data-bs-target="#expand_accordion_body_d126e1027342" aria-controls="expand_accordion_body_d126e1027342" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_D" class="anchor_target"></span><h3 id="d126e1027342"><code class="name">D</code> &#8212; Row scaling<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">diagonal matrix</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_d126e1027342" aria-labelledby="expand_accordion_heading_d126e1027342" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f89-998950"><p>Row scaling, returned as a diagonal matrix. <code class="literal">D</code> is used
                        to scale the values in <code class="literal">S</code> such that <code class="literal">P*(D\S)*Q =
                            L*U</code>. Typically, but not always, the row scaling leads to a
                        sparser and more stable factorization.</p></div></div></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="d126e1027366">Algorithms</h2><p>The LU factorization is computed using a variant of Gaussian elimination. Computing an
            accurate solution is dependent upon the value of the condition number of the original
            matrix <code class="literal">cond(A)</code>. If the matrix has a large condition number (it is
            nearly singular), then the computed factorization might not be accurate.</p><p>The LU factorization is a key step in obtaining the inverse with
                <code class="literal">inv</code> and the determinant with <code class="literal">det</code>. It is also
            the basis for the linear equation solution or matrix division obtained with the
            operators <code class="literal">\</code> and <code class="literal">/</code>. This necessarily means that the
            numerical limitations of <code class="function">lu</code> are also present in these dependent
            functions.</p></div><div class="bibliography"><h2 id="References">References</h2><div id="mw_8ce70447-6889-4391-bda0-bfad88d87b56" class="bibliomixed"><p>[1] Gilbert, John R., and Tim
            Peierls. “Sparse Partial Pivoting in Time Proportional to Arithmetic Operations.”
                <em class="citetitle">SIAM Journal on Scientific and Statistical Computing</em> 9, no. 5
            (September 1988): 862&#8211;874. <a href="https://doi.org/10.1137/0909058" target="_blank">https://doi.org/10.1137/0909058</a>.</p></div><div id="mw_179c5fe5-58c4-4582-9e56-11e8bcc80152" class="bibliomixed"><p>[2] Anderson, E., ed. <em class="citetitle italic">LAPACK Users’ Guide</em>. 3rd ed. Software, Environments,
            Tools. Philadelphia: Society for Industrial and Applied Mathematics, 1999. <a href="https://doi.org/10.1137/1.9780898719604" target="_blank">https://doi.org/10.1137/1.9780898719604</a>.</p></div><div id="mw_ff0393d2-aa3d-4773-bcee-4a35165e95de" class="bibliomixed"><p>[3] Davis, Timothy A. "Algorithm
            832: UMFPACK V4.3 &#8211; an unsymmetric-pattern multifrontal method." <em class="citetitle italic">ACM Transactions on Mathematical Software</em> 30, no. 2 (June
            2004): 196&#8211;199. <a href="https://doi.org/10.1145/992200.992206" target="_blank">https://doi.org/10.1145/992200.992206</a>.</p></div></div><div class="ref_sect"><h2 id="refsect-extended-capabilities">Extended Capabilities</h2><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink">expand all</a></p><div id="accordion_refsect-extended-capabilities" role="tablist" aria-multiselectable="true"><span id="bvlo6b3-1" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="f89-998950" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_f89-998950_codegen" aria-controls="expand_body_f89-998950_codegen" class="accordion-button collapsed" aria-expanded="false"><h3 id="f89-998950_codegen">C/C++ Code Generation<br/> <span class=" remove_bold add_font_color_general">Generate C and C++ code using MATLAB&#174; Coder&#8482;.</span></h3></button></div><div id="expand_body_f89-998950_codegen" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>
                <span>Usage notes and limitations:</span>
            </p><p>
                </p>
<div class="itemizedlist"><ul><li><p>Code generation does not support sparse matrix inputs for this
    function.</p></li></ul></div><p>

            </p></div></div></div></div></div><span id="mw_276d26fe-1096-4540-957a-587aa5583b5f" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="f89-998950" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_f89-998950_gpucodegen" aria-controls="expand_body_f89-998950_gpucodegen" class="accordion-button collapsed" aria-expanded="false"><h3 id="f89-998950_gpucodegen">GPU Code Generation<br/> <span class=" remove_bold add_font_color_general">Generate CUDA&#174; code for NVIDIA&#174; GPUs using GPU Coder&#8482;.</span></h3></button></div><div id="expand_body_f89-998950_gpucodegen" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>Usage notes and limitations:</p><div class="itemizedlist"><ul><li><p>Code generation does not support sparse
                        matrix inputs for this function.</p></li></ul></div></div></div></div></div></div><span id="mw_1c8dec28-3b47-4b21-ac96-6d33377f29e5" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="f89-998950" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_f89-998950_threadsupport" aria-controls="expand_body_f89-998950_threadsupport" class="accordion-button collapsed" aria-expanded="false"><h3 id="f89-998950_threadsupport">Thread-Based Environment<br/> <span class=" remove_bold add_font_color_general">Run code in the background using MATLAB&#174; <code class="function">backgroundPool</code> or accelerate code with Parallel Computing Toolbox&#8482; <code class="function">ThreadPool</code>.</span></h3></button></div><div id="expand_body_f89-998950_threadsupport" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>This function fully supports thread-based environments. For
                more information, see <a href="../matlab_prog/run-functions-on-threads.html" class="a">Run MATLAB Functions in Thread-Based Environment</a>.</p></div></div></div></div></div><span id="mw_96cbd902-6787-40f3-ac32-220d59788a48" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="f89-998950" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_f89-998950_gpuarrays" aria-controls="expand_body_f89-998950_gpuarrays" class="accordion-button collapsed" aria-expanded="false"><h3 id="f89-998950_gpuarrays">GPU Arrays<br/> <span class=" remove_bold add_font_color_general">Accelerate code by running on a graphics processing unit (GPU) using Parallel Computing Toolbox&#8482;.</span></h3></button></div><div id="expand_body_f89-998950_gpuarrays" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>The <code class="function">lu</code> function
    supports GPU array input with these usage notes and limitations:</p><div class="itemizedlist"><ul><li><p><code class="literal">A</code> must be nonsparse.</p></li></ul></div><p>For more information, see <a href="../../parallel-computing/run-matlab-functions-on-a-gpu.html" class="a">Run MATLAB Functions on a GPU</a><span role="cross_prod"> (Parallel Computing Toolbox)</span>.</p></div></div></div></div></div><span id="mw_1733fcc1-101d-41c5-b9dc-b099615a64c7" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="f89-998950" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_f89-998950_distributedarrays" aria-controls="expand_body_f89-998950_distributedarrays" class="accordion-button collapsed" aria-expanded="false"><h3 id="f89-998950_distributedarrays">Distributed Arrays<br/> <span class=" remove_bold add_font_color_general">Partition large arrays across the combined memory of your cluster using Parallel Computing Toolbox&#8482;.</span></h3></button></div><div id="expand_body_f89-998950_distributedarrays" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>Usage notes and limitations:</p><div class="itemizedlist"><ul><li><p><code class="literal">A</code> must be nonsparse.</p></li></ul></div><p>For more information, see <a href="../../parallel-computing/run-matlab-functions-with-distributed-arrays.html" class="a">Run MATLAB Functions with Distributed Arrays</a><span role="cross_prod"> (Parallel Computing Toolbox)</span>.</p></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="mw_badb7372-0ccf-47e5-acd0-67fbf02a9336">Version History</h2><strong>Introduced before R2006a</strong><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink">expand all</a></p><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_mw_4314dc35-1626-48ea-907c-a8f4eb12c013" aria-controls="expand_body_mw_4314dc35-1626-48ea-907c-a8f4eb12c013" class="accordion-button collapsed" aria-expanded="false"><h3 id="mw_4314dc35-1626-48ea-907c-a8f4eb12c013">R2025a: <span class="remove_bold">Specify single-precision sparse input argument</span></h3></button></div><div id="expand_body_mw_4314dc35-1626-48ea-907c-a8f4eb12c013" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>You can specify the sparse input matrix <code class="argument">S</code> as single
                precision. If <code class="argument">S</code> is <code class="class">single</code>, the output arguments
                are also <code class="class">single</code> except those that are related to indexing, such as
                ordering and permutation vectors.</p></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="f89-998950_seealso">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="cond.html"><span itemprop="name"><code class="function">cond</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="det.html"><span itemprop="name"><code class="function">det</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="inv.html"><span itemprop="name"><code class="function">inv</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="ilu.html"><span itemprop="name"><code class="function">ilu</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="qr.html"><span itemprop="name"><code class="function">qr</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="rref.html"><span itemprop="name"><code class="function">rref</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="double.mldivide.html"><span itemprop="name"><code class="function">mldivide</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="decomposition.html"><span itemprop="name"><code class="object">decomposition</code></span></a></span></p><div class="examples_container"><h3 class="remove_border">Topics</h3><div itemprop="content"><ul class="list-unstyled"><li><a href="../math/factorizations.html" class="a">Factorizations</a></li></ul></div></div></div>
    </div></div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

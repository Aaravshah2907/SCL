<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>bvpset</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../numerical-integration-and-differential-equations.html",
          "name": "Numerical Integration and Differential Equations"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../boundary-value-problems.html",
          "name": "Boundary Value Problems"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "boundary-value-problems"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExtendedCapabilities",

        "itemListElement":
        [
{
          "@type": "ListItem",
          "position": 1,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "threadsupport",
          "value": "full"

        }
          }
        ]
        }
        </script>
<meta xmlns="http://www.w3.org/1999/xhtml" name="chunktype" content="refpage"><meta xmlns="http://www.w3.org/1999/xhtml" name="refentity" itemprop="refentity" content="function:bvpset"><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="fcn">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ref/function">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This MATLAB function creates a structure options that you can supply to the boundary value problem solver bvp4c, in which the named properties have the specified values."><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "refentry";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../numerical-integration-and-differential-equations.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Numerical Integration and Differential Equations</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../boundary-value-problems.html?s_tid=CRUX_lftnav" itemprop="url" id="boundary-value-problems"><span itemprop="title">Boundary Value Problems</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item notranslate"><a href="#responsive_offcanvas"><span class="refname">bvpset</span></a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-refentry">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li><a href="#f79-999998" class="intrnllnk">Syntax</a></li><li class="nav-item"><a href="#f79-1000003" class="nav-link intrnllnk">Description</a></li><li class="nav-item"><a href="#f79-1000012" class="nav-link intrnllnk">BVP Properties</a><ul class="nav"><li class="nav-item"><a href="#f79-1035260" class="nav-link intrnllnk">Error Tolerance Properties</a></li></ul><ul class="nav"><li class="nav-item"><a href="#f79-1034438" class="nav-link intrnllnk">Vectorization</a></li></ul><ul class="nav"><li class="nav-item"><a href="#f79-1034473" class="nav-link intrnllnk">Analytical Partial Derivatives</a></li></ul><ul class="nav"><li class="nav-item"><a href="#f79-1034579" class="nav-link intrnllnk">Singular BVPs</a></li></ul><ul class="nav"><li class="nav-item"><a href="#f79-1034656" class="nav-link intrnllnk">Mesh Size Property</a></li></ul><ul class="nav"><li class="nav-item"><a href="#f79-1034689" class="nav-link intrnllnk">Solution Statistic Property</a></li></ul></li><li class="nav-item"><a href="#f79-1000075" class="nav-link intrnllnk">Examples</a></li><li class="nav-item"><a href="#refsect-extended-capabilities" class="nav-link intrnllnk">Extended Capabilities</a></li><li class="nav-item"><a href="#f79-999995_vh" class="nav-link intrnllnk">Version History</a></li><li class="nav-item"><a href="#f79-999995_seealso" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=boundary-value-problems&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=boundary-value-problems&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=boundary-value-problems&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=boundary-value-problems&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=boundary-value-problems&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=boundary-value-problems&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-ref-function"><div class="function_ref"><span id="f79-999995" class="anchor_target"></span><h1 class="r2025b notranslate" itemprop="title"><span class="refname">bvpset</span></h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">Create or alter options structure of boundary value problem</p></div></div><a class="indexterm" name="d126e167635"></a><a class="indexterm" name="d126e167638"></a>
<span id="f79-999998" class="anchor_target"></span><div class="ref_sect"><h2 id="f79-999998">Syntax</h2><div class="syntax_signature"><p class="synopsis"><code>options = bvpset('name1',value1,'name2',value2,...)<br/>
options = bvpset(oldopts,'name1',value1,...)<br/>
options = bvpset(oldopts,newopts)<br/>
bvpset<br/>
</code></p></div></div><div class="clear"></div><div class="ref_sect"><h2 id="f79-1000003">Description</h2><div class="cshsummary" id="csh_f79-999995"><p><span id="f79-1000004" itemprop="syntax"><code id="f79-1000004" class="synopsis">options = bvpset('name1',value1,'name2',value2,...)</code></span> creates
a structure <code class="literal">options</code> that you can supply to the
boundary value problem solver <a href="bvp4c.html"><code class="function">bvp4c</code></a>,
in which the named properties have the specified values. Any unspecified
properties retain their default values. For all properties, it is
sufficient to type only the leading characters that uniquely identify
the property. <code class="literal">bvpset</code> ignores case for property
names.</p><p><span id="f79-1000006" itemprop="syntax"><code id="f79-1000006" class="synopsis">options = bvpset(oldopts,'name1',value1,...)</code></span> alters
an existing options structure <code class="literal">oldopts</code>. This overwrites
any values in <code class="literal">oldopts</code> that are specified using
name/value pairs and returns the modified structure as the output
argument. </p><p><span id="f79-1000008" itemprop="syntax"><code id="f79-1000008" class="synopsis">options = bvpset(oldopts,newopts)</code></span> combines
an existing options structure <code class="literal">oldopts</code> with a new
options structure <code class="literal">newopts</code>. Any values set in <code class="literal">newopts</code> overwrite
the corresponding values in <code class="literal">oldopts</code>.</p><p><span id="f79-1000010" itemprop="syntax"><code id="f79-1000010" class="synopsis">bvpset</code></span> with no input arguments
displays all property names and their possible values, indicating
defaults with braces <code class="literal">{}</code>.</p><p>You can use the function <a href="bvpget.html"><code class="function">bvpget</code></a> to
query the <code class="literal">options</code> structure for the value of a
specific property.</p></div></div><div id="f79-1000012_div" class="ref_sect"><h2 id="f79-1000012">BVP Properties</h2><p><code class="literal">bvpset</code> enables you to specify properties
for the boundary value problem solver <a href="bvp4c.html"><code class="function">bvp4c</code></a>.
There are several categories of properties that you can set:</p><div class="itemizedlist"><ul><li><p><a href="bvpset.html#f79-1035260" class="intrnllnk">Error Tolerance Properties</a></p></li><li><p><a href="bvpset.html#f79-1034438" class="intrnllnk">Vectorization</a></p></li><li><p><a href="bvpset.html#f79-1034473" class="intrnllnk">Analytical Partial Derivatives</a></p></li><li><p><a href="bvpset.html#f79-1034579" class="intrnllnk">Singular BVPs</a></p></li><li><p><a href="bvpset.html#f79-1034656" class="intrnllnk">Mesh Size Property</a></p></li><li><p><a href="bvpset.html#f79-1034689" class="intrnllnk">Solution Statistic Property</a></p></li></ul></div><div id="f79-1035260_div" class="refsect2"><h3 id="f79-1035260">Error Tolerance Properties</h3><a class="indexterm" name="d126e167727"></a><a class="indexterm" name="d126e167730"></a><p>Because <a href="bvp4c.html"><code class="function">bvp4c</code></a> uses a
collocation formula, the numerical solution is based on a mesh of
points at which the collocation equations are satisfied. Mesh selection
and error control are based on the residual of this solution, such
that the computed solution <em class="varname">S</em>(<em class="varname">x</em>)
is the exact solution of a perturbed problem <em class="varname">S</em>′(<em class="varname">x</em>)
= <em class="varname">f</em>(<em class="varname">x</em>,<em class="varname">S</em>(<em class="varname">x</em>))
+ <em class="varname">res</em>(<em class="varname">x</em>). On each subinterval
of the mesh, a norm of the residual in the <code class="literal">i</code>th
component of the solution, <code class="literal">res(i)</code>, is estimated
and is required to be less than or equal to a tolerance. This tolerance
is a function of the relative and absolute tolerances, <code class="literal">RelTol</code> and <code class="literal">AbsTol</code>,
defined by the user.</p><div id="d126e167769" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-11px" display="block"><mrow><mo>∥</mo><mrow><mo>(</mo><mrow><mtext>res</mtext><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo>/</mo><mi>max</mi><mrow><mo>(</mo><mrow><mtext>abs</mtext><mrow><mo>(</mo><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow><mo>,</mo><mtext>AbsTol</mtext><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo>/</mo><mtext>RelTol</mtext></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow><mo>∥</mo><mtext> </mtext><mo>≤</mo><mtext>RelTol</mtext></mrow></math></p></div></div><p>The following table describes the error tolerance properties.</p><div itemprop="content" id="d126e167773" class="table_class"><p class="title"><strong class="title">BVP Error Tolerance Properties</strong></p><div class="table-responsive"><table class="table table-condensed" summary="BVP Error Tolerance Properties" width="100%"><colgroup><col class="tcol1" width="18%"><col class="tcol2" width="17%"><col class="tcol3" width="65%"></colgroup><thead><tr><th><p>Property</p></th><th><p>Value</p></th><th><p>Description</p></th></tr></thead><tbody><tr><td><p><code class="property">RelTol</code></p></td><td><p>Positive scalar {<code class="literal">1e-3</code>}</p></td><td><p><a class="indexterm" name="d126e167800"></a>A relative error tolerance that applies to all components
of the residual vector. It is a measure of the residual relative to
the size of <em class="varname">f</em>(<em class="varname">x</em>,<em class="varname">y</em>).
The default, <code class="literal">1e-3</code>, corresponds to 0.1% accuracy.</p><p>The
computed solution <em class="varname">S</em>(<em class="varname">x</em>) is the
exact solution of <em class="varname">S</em>′(<em class="varname">x</em>)
= <em class="varname">F</em>(<em class="varname">x</em>,<em class="varname">S</em>(<em class="varname">x</em>))
+ res(<em class="varname">x</em>). On each subinterval of the mesh, the
residual res(<em class="varname">x</em>) satisfies </p><p></p>
<div id="d126e167837" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-11px" display="block"><mrow><mo>∥</mo><mrow><mo>(</mo><mrow><mtext>res</mtext><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo>/</mo><mi>max</mi><mrow><mo>(</mo><mrow><mtext>abs</mtext><mrow><mo>(</mo><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow><mo>,</mo><mtext>AbsTol</mtext><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo>/</mo><mtext>RelTol</mtext></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow><mo>∥</mo><mtext> </mtext><mo>≤</mo><mtext>RelTol</mtext></mrow></math></p></div></div><p></p></td></tr><tr><td><p><code class="property">AbsTol</code></p></td><td><p>Positive scalar or vector {<code class="literal">1e-6</code>}</p></td><td><a class="indexterm" name="d126e167850"></a><p>Absolute error tolerances that apply to the corresponding
components of the residual vector. <code class="literal">AbsTol(i)</code> is
a threshold below which the values of the corresponding components
are unimportant. If a scalar value is specified, it applies to all
components. </p></td></tr></tbody></table></div></div></div><div id="f79-1034438_div" class="refsect2"><h3 id="f79-1034438">Vectorization</h3><a class="indexterm" name="d126e167859"></a><p>The following table describes the BVP vectorization property.
Vectorization of the ODE function used by <code class="function">bvp4c</code> differs
from the vectorization used by the ODE solvers:</p><div class="itemizedlist"><ul><li><p>For <code class="function">bvp4c</code>, the ODE function must
be vectorized with respect to the first argument as well as the second
one, so that <code class="literal">F([x1 x2 ...],[y1 y2 ...])</code> returns <code class="literal">[F(x1,y1) F(x2,y2)...]</code>.</p></li><li><p><code class="function">bvp4c</code> benefits from vectorization
even when analytical Jacobians are provided. For stiff ODE solvers,
vectorization is ignored when analytical Jacobians are used.   </p></li></ul></div><div itemprop="content" id="d126e167880" class="table_class"><p class="title"><strong class="title">Vectorization Properties</strong></p><div class="table-responsive"><table class="table table-condensed" summary="Vectorization Properties"><colgroup><col class="tcol1" width="22%"><col class="tcol2" width="20%"><col class="tcol3" width="58%"></colgroup><thead><tr><th><p>Property</p></th><th><p>Value</p></th><th><p>Description</p></th></tr></thead><tbody><tr><td><p id="f79-1034456"><code class="property">Vectorized</code></p></td><td><p><code class="literal">on</code>&nbsp;|&nbsp;{<code class="literal">off</code>}</p></td><td><a class="indexterm" name="d126e167907"></a><p>Set on to inform <code class="literal">bvp4c</code> that you have coded the
                  ODE function F so that <code class="literal">F([x1 x2 ...],[y1 y2 ...])</code> returns
                    <code class="literal">[F(x1,y1) F(x2,y2) ...]</code>. That is, your ODE function can pass
                  to the solver a whole array of column vectors at once. This enables the solver to
                  reduce the number of function evaluations and may significantly reduce solution
                  time.</p><p>With the MATLAB<sup>&#x00AE;</sup> array notation, it is typically an easy matter to vectorize an ODE
                  function. In the <code class="literal">shockbvp</code> example shown previously, the
                  shockODE function has been vectorized using <a href="double.colon.html"><code class="function">colon</code></a> notation into the subscripts and by using the array
                  multiplication (<code class="literal">.*</code>)
                operator.</p><div class="code_responsive"><pre class="programlisting">function dydx = shockODE(x,y,e)
pix = pi*x;
dydx = [ y(2,:)... 
-x/e.*y(2,:)-pi^2*cos(pix)-
pix/e.*sin(pix)];</pre></div></td></tr></tbody></table></div></div></div><div id="f79-1034473_div" class="refsect2"><h3 id="f79-1034473">Analytical Partial Derivatives</h3><a class="indexterm" name="d126e167932"></a><a class="indexterm" name="d126e167935"></a><a class="indexterm" name="d126e167937"></a><a class="indexterm" name="d126e167940"></a><p>By default, the <a href="bvp4c.html"><code class="function">bvp4c</code></a> solver
approximates all partial derivatives with finite differences. <code class="function">bvp4c</code> can
be more efficient if you provide analytical partial derivatives ∂<em class="varname">f</em>/∂<em class="varname">y</em> of
the differential equations, and analytical partial derivatives, ∂<em class="varname">bc</em>/∂<em class="varname">ya</em> and
∂<em class="varname">bc</em>/∂<em class="varname">yb</em>, of the
boundary conditions. If the problem involves unknown parameters, you
must also provide partial derivatives, ∂<em class="varname">f</em>/∂<em class="varname">p</em> and
∂<em class="varname">bc</em>/∂<em class="varname">p</em>, with respect
to the parameters.</p><p>The following table describes the analytical partial derivatives
properties.</p><div itemprop="content" id="d126e167972" class="table_class"><p class="title"><strong class="title">BVP Analytical Partial Derivative Properties</strong></p><div class="table-responsive"><table class="table table-condensed" summary="BVP Analytical Partial Derivative Properties"><colgroup><col class="tcol1" width="23%"><col class="tcol2" width="25%"><col class="tcol3" width="52%"></colgroup><thead><tr><th><p>Property</p></th><th><p>Value</p></th><th><p>Description</p></th></tr></thead><tbody><tr><td><p id="f79-1034514" class="cellmonospace"><code class="property">FJacobian</code></p></td><td><p>Function handle</p></td><td><p>A function handle that computes the analytical partial
derivatives of <em class="varname">f</em>(<em class="varname">x</em>,<em class="varname">y</em>).
When solving <em class="varname">y</em>′ = <em class="varname">f</em>(<em class="varname">x</em>,<em class="varname">y</em>),
set this property to <code class="literal">@fjac</code> if <code class="literal">dfdy = fjac(x,y)</code> evaluates
the Jacobian ∂<em class="varname">f</em>/∂<em class="varname">y</em>.
If the problem involves unknown parameters <em class="varname">p</em>, <code class="literal">[dfdy,dfdp]
= fjac(x,y,p)</code> must also return the partial derivative ∂<em class="varname">f</em>/∂<em class="varname">p</em>.
For problems with constant partial derivatives, set this property
to the value of <code class="literal">dfdy</code> or to a cell array <code class="literal">{dfdy,dfdp}</code>.</p></td></tr><tr><td><p id="f79-1034541" class="cellmonospace"><code class="property">BCJacobian</code></p></td><td><p>Function handle</p></td><td><p>A function handle that computes the analytical partial
derivatives of <em class="varname">bc</em>(<em class="varname">ya</em>,<em class="varname">yb</em>).
For boundary conditions <em class="varname">bc</em>(<em class="varname">ya</em>,<em class="varname">yb</em>),
set this property to <code class="literal">@bcjac</code> if [<code class="literal">dbcdya,dbcdyb]
= bcjac(ya,yb)</code> evaluates the partial derivatives ∂<em class="varname">bc</em>/∂<em class="varname">ya</em>,
and  ∂<em class="varname">bc</em>/∂<em class="varname">yb</em>.
If the problem involves unknown parameters <em class="varname">p</em>, <code class="literal">[dbcdya,dbcdyb,dbcdp]
= bcjac(ya,yb,p)</code> must also return the partial derivative
 ∂<em class="varname">bc</em>/∂<em class="varname">p</em>. For problems
with constant partial derivatives, set this property to a cell array <code class="literal">{dbcdya,dbcdyb}</code> or <code class="literal">{dbcdya,dbcdyb,dbcdp}</code>.</p></td></tr></tbody></table></div></div></div><div id="f79-1034579_div" class="refsect2"><h3 id="f79-1034579">Singular BVPs</h3><a class="indexterm" name="d126e168083"></a><p><code class="literal">bvp4c</code> can solve singular problems of the
form</p><div id="d126e168090" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-15px" display="block"><mrow><msup><mi>y</mi><mo>′</mo></msup><mo>=</mo><mi>S</mi><mfrac><mi>y</mi><mi>x</mi></mfrac><mo>+</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>p</mi><mo stretchy="false">)</mo></mrow></math></p></div></div><p>posed on the interval [0,<em class="varname">b</em>] where <em class="varname">b</em> &gt;
0. For such problems, specify the constant matrix <em class="varname">S</em> as
the value of <code class="literal">SingularTerm</code>. For equations of this
form, <code class="literal">odefun</code> evaluates only the <em class="varname">f</em>(<em class="varname">x</em>,<em class="varname">y</em>,<em class="varname">p</em>)
term, where <em class="varname">p</em> represents unknown parameters, if
any.</p><div itemprop="content" id="d126e168116" class="table_class"><p class="title"><strong class="title">Singular BVP Property</strong></p><div class="table-responsive"><table class="table table-condensed" summary="Singular BVP Property"><colgroup><col class="tcol1" width="28%"><col class="tcol2" width="25%"><col class="tcol3" width="47%"></colgroup><thead><tr><th><p>Property</p></th><th><p>Value</p></th><th><p>Description</p></th></tr></thead><tbody><tr><td><p><code class="property">SingularTerm</code></p></td><td><p>Constant matrix</p></td><td><p>Singular term of singular BVPs. Set to the constant matrix <em class="varname">S</em> for
equations of the form </p><p></p>
<div id="d126e168145" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-15px" display="block"><mrow><msup><mi>y</mi><mo>′</mo></msup><mo>=</mo><mi>S</mi><mfrac><mi>y</mi><mi>x</mi></mfrac><mo>+</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>p</mi><mo stretchy="false">)</mo></mrow></math></p></div></div><p></p><p>posed
on the interval [0,<em class="varname">b</em>] where <em class="varname">b</em> &gt;
0. </p></td></tr></tbody></table></div></div></div><div id="f79-1034656_div" class="refsect2"><h3 id="f79-1034656">Mesh Size Property</h3><a class="indexterm" name="d126e168156"></a><a class="indexterm" name="d126e168159"></a><p><a href="bvp4c.html"><code class="function">bvp4c</code></a> solves a system of algebraic equations to determine the numerical
        solution to a BVP at each of the mesh points. The size of the algebraic system depends on
        the number of differential equations (<code class="literal">n</code>) and the number of mesh points in
        the current mesh (<code class="literal">N</code>). When the allowed number of mesh points is
        exhausted, the computation stops, <code class="literal">bvp4c</code> displays a warning message and
        returns the solution it found so far. This solution does not satisfy the error tolerance,
        but it may provide an excellent initial guess for computations restarted with relaxed error
        tolerances or an increased value of <code class="literal">Nmax</code>. </p><p>The following table describes the mesh size property.</p><div itemprop="content" id="d126e168174" class="table_class"><p class="title"><strong class="title">BVP Mesh Size Property</strong></p><div class="table-responsive"><table class="table table-condensed" summary="BVP Mesh Size Property"><colgroup><col class="tcol1" width="26%"><col class="tcol2" width="27%"><col class="tcol3" width="47%"></colgroup><thead><tr><th><p>Property</p></th><th><p>Value</p></th><th><p>Description</p></th></tr></thead><tbody><tr><td><p><code class="property">Nmax</code></p></td><td><p>positive integer {<code class="literal">floor(1000/n)</code>}</p></td><td><p>Maximum number of mesh points allowed when solving the BVP, where <code class="literal">n</code>
                  is the number of differential equations in the problem. The default value of
                    <code class="literal">Nmax</code> limits the size of the algebraic system to about 1000
                  equations. For systems of a few differential equations, the default value of
                    <code class="literal">Nmax</code> should be sufficient to obtain an accurate solution.
                </p></td></tr></tbody></table></div></div></div><div id="f79-1034689_div" class="refsect2"><h3 id="f79-1034689">Solution Statistic Property</h3><a class="indexterm" name="d126e168210"></a><a class="indexterm" name="d126e168213"></a><p>The <code class="property">Stats</code> property lets you view solution
statistics.</p><p>The following table describes the solution statistics property.</p><div itemprop="content" id="d126e168220" class="table_class"><p class="title"><strong class="title">BVP Solution Statistic Property</strong></p><div class="table-responsive"><table class="table table-condensed" summary="BVP Solution Statistic Property"><colgroup><col class="tcol1" width="24%"><col class="tcol2" width="23%"><col class="tcol3" width="53%"></colgroup><thead><tr><th><p>Property</p></th><th><p>Value</p></th><th><p>Description</p></th></tr></thead><tbody><tr><td><p><code class="property">Stats</code></p></td><td><p><code class="literal">on</code>&nbsp;|&nbsp;{<code class="literal">off</code>}</p></td><td><p>Specifies whether statistics about the computations are
displayed. If the <code class="property">stats</code> property is <code class="literal">on</code>,
after solving the problem, <a href="bvp4c.html"><code class="function">bvp4c</code></a> displays:</p><div class="itemizedlist"><ul><li><p>The number of points in the mesh</p></li><li><p>The maximum residual of the solution</p></li><li><p>The number of times it called the differential equation
function <code class="literal">odefun</code> to evaluate <em class="varname">f</em>(<em class="varname">x</em>,<em class="varname">y</em>)</p></li><li><p>The number of times it called the boundary condition
function <code class="literal">bcfun</code> to evaluate <em class="varname">bc</em>(<em class="varname">y</em>(<em class="varname">a</em>),<em class="varname">y</em>(<em class="varname">b</em>))</p></li></ul></div></td></tr></tbody></table></div></div></div></div><h2 id="f79-1000075">Examples</h2><p>To create an options structure that changes the relative error
tolerance of <a href="bvp4c.html"><code class="function">bvp4c</code></a> from the
default value of <code class="literal">1e-3</code> to <code class="literal">1e-4</code>,
enter</p><div class="code_responsive"><pre class="programlisting">options = bvpset('RelTol',1e-4);</pre></div><p>To recover the value of <code class="literal">'RelTol'</code> from <code class="literal">options</code>,
enter</p><div class="code_responsive"><pre class="programlisting">bvpget(options,'RelTol')

ans =

  1.0000e-004</pre></div><div class="ref_sect"><h2 id="refsect-extended-capabilities">Extended Capabilities</h2><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink">expand all</a></p><div id="accordion_refsect-extended-capabilities" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="f79-999995" class="anchor_target"></span><div class="accordion-header"><h3 id="f79-999995_threadsupport">Thread-Based Environment<br/> <span class=" remove_bold add_font_color_general">Run code in the background using MATLAB&#174; <code class="function">backgroundPool</code> or accelerate code with Parallel Computing Toolbox&#8482; <code class="function">ThreadPool</code>.</span></h3></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="f79-999995_vh">Version History</h2><p><strong>Introduced before R2006a</strong></p></div><div class="ref_sect"><h2 id="f79-999995_seealso">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="bvp4c.html"><span itemprop="name"><code class="function">bvp4c</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="bvp5c.html"><span itemprop="name"><code class="function">bvp5c</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="bvpget.html"><span itemprop="name"><code class="function">bvpget</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="bvpinit.html"><span itemprop="name"><code class="function">bvpinit</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="deval.html"><span itemprop="name"><code class="function">deval</code></span></a></span></p><div class="examples_container"><h3 class="remove_border">Topics</h3><div itemprop="content"><ul class="list-unstyled"><li><a href="../matlab_prog/creating-a-function-handle.html" class="a">Create Function Handle</a></li></ul></div></div></div>
    </div></div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

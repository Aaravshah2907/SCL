<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>ilu</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../sparse-matrices.html",
          "name": "Sparse Matrices"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "sparse-matrices"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExtendedCapabilities",

        "itemListElement":
        [
{
          "@type": "ListItem",
          "position": 1,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "distributedarrays",
          "value": "limited"

        }
          },
{
          "@type": "ListItem",
          "position": 2,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "threadsupport",
          "value": "full"

        }
          }
        ]
        }
        </script>
<meta xmlns="http://www.w3.org/1999/xhtml" name="chunktype" content="refpage"><meta xmlns="http://www.w3.org/1999/xhtml" name="refentity" itemprop="refentity" content="function:ilu"><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="fcn">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ref/function">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This MATLAB function performs the incomplete LU factorization of a sparse matrix A with zero-fill, and returns the lower triangular matrix L and the upper triangular matrix U."><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "refentry";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../sparse-matrices.html?s_tid=CRUX_lftnav" itemprop="url" id="sparse-matrices"><span itemprop="title">Sparse Matrices</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item notranslate"><a href="#responsive_offcanvas"><span class="refname">ilu</span></a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-refentry">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li><a href="#mw_9db8338c-8409-4f71-b2e1-71c51f8a9c38" class="intrnllnk">Syntax</a></li><li class="nav-item"><a href="#description" class="nav-link intrnllnk">Description</a></li><li class="nav-item"><a href="#mw_8b9fe38c-a3fa-4742-84db-5dd50698b464" class="nav-link intrnllnk">Examples</a><ul class="nav"><li class="nav-item"><a href="#mw_19759501-4e04-42f9-b60f-bf5c5f6bdb1c" class="nav-link intrnllnk">Different Types of Incomplete LU Factorization</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_a6e75420-838d-4e51-95cd-8c256b29d997" class="nav-link intrnllnk">Drop Tolerance of Incomplete LU Factorization</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_d9ccfbbe-0595-4eb7-b1bb-7bb7863fdc09" class="nav-link intrnllnk">Using <code class="literal">ilu</code> as Preconditioner to Solve Linear System</a></li></ul></li><li class="nav-item"><a href="#mw_14408161-cf16-4466-833b-0035563298de" class="nav-link intrnllnk">Input Arguments</a><ul class="nav"><li class="nav-item"><a href="#mw_b053ef4c-2b70-4832-adfe-b02c70ffeddd" class="nav-link intrnllnk">A</a></li><li class="nav-item"><a href="#mw_be0d234f-6566-457b-b106-dbc6bf5e7d91" class="nav-link intrnllnk">options</a></li></ul></li><li class="nav-item"><a href="#mw_cc035b24-6e61-4263-940d-7af196005fc5" class="nav-link intrnllnk">Output Arguments</a><ul class="nav"><li class="nav-item"><a href="#mw_aa0a5446-3e40-4986-af30-f061365c378f" class="nav-link intrnllnk">L</a></li><li class="nav-item"><a href="#mw_19b2c217-1da6-448a-940d-0a0c12ee7587" class="nav-link intrnllnk">U</a></li><li class="nav-item"><a href="#mw_9318c26c-9146-4256-8b29-5d6988dbd2dc" class="nav-link intrnllnk">P</a></li><li class="nav-item"><a href="#mw_5d261b66-3c7c-417b-91c7-65281935b934" class="nav-link intrnllnk">W</a></li></ul></li><li class="nav-item"><a href="#mw_db16d47a-b4f7-42f9-931b-b66e6c723c77" class="nav-link intrnllnk">Tips</a></li><li><a href="#References" class="intrnllnk">References</a></li><li class="nav-item"><a href="#refsect-extended-capabilities" class="nav-link intrnllnk">Extended Capabilities</a></li><li class="nav-item"><a href="#mw_b74d5ff8-0542-4daa-91a8-3f6f6ff6e355" class="nav-link intrnllnk">Version History</a><ul class="nav"><li class="nav-item"><a href="#mw_e8994503-2ef8-42be-920a-794994059ac0" class="nav-link intrnllnk">Specify single-precision sparse input argument</a></li></ul></li><li class="nav-item"><a href="#f89-999064_seealso" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=sparse-matrices&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=sparse-matrices&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=sparse-matrices&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=sparse-matrices&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=sparse-matrices&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=sparse-matrices&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-ref-function"><div class="function_ref"><span id="f89-999064" class="anchor_target"></span><h1 class="r2025b notranslate" itemprop="title"><span class="refname">ilu</span></h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">Incomplete LU factorization</p><div class="switch"><a href="javascript:void(0);" id="expandAllPage" data-allexpanded="true1">collapse all in page</a></div></div></div>
<span id="mw_9db8338c-8409-4f71-b2e1-71c51f8a9c38" class="anchor_target"></span><div class="ref_sect"><h2 id="mw_9db8338c-8409-4f71-b2e1-71c51f8a9c38">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><div class="code_responsive"><code class="synopsis"><a href="#d126e844871" class="intrnllnk">[L,U] = ilu(A)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e844896" class="intrnllnk">[L,U,P] = ilu(A)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e844927" class="intrnllnk">W = ilu(A)</a></code></div></div><div class="syntax_signature_module"><div class="code_responsive"><code class="synopsis"><a href="#d126e844949" class="intrnllnk">[<span class="argument_placeholder">___</span>] = ilu(A,options)</a></code></div></div></div></div><div class="clear"></div><span id="mw_7a06a135-fed7-4d7e-9a92-83109569f83b" class="anchor_target"></span><h2 id="description">Description</h2><div class="descriptions"><div class="cshsummary" id="csh_f89-999064"><div class="description_module"><span id="mw_0f275626-7f87-4614-8801-4b5fd368b890" class="anchor_target"></span>
      <div class="description_element"><div class="code_responsive"><p><span id="d126e844871" itemprop="syntax"><code class="synopsis">[<a href="#mw_aa0a5446-3e40-4986-af30-f061365c378f" class="intrnllnk"><code class="argument">L</code></a>,<a href="#mw_19b2c217-1da6-448a-940d-0a0c12ee7587" class="intrnllnk"><code class="argument">U</code></a>] = ilu(<a href="#mw_b053ef4c-2b70-4832-adfe-b02c70ffeddd" class="intrnllnk"><code class="argument">A</code></a>)</code></span>
          performs the incomplete LU factorization of a sparse matrix <code class="literal">A</code> with
          zero-fill, and returns the lower triangular matrix <code class="literal">L</code> and the upper
          triangular matrix <code class="literal">U</code>.</p></div><p class="syntax_example"><a href="ilu.html#mw_19759501-4e04-42f9-b60f-bf5c5f6bdb1c" class="intrnllnk">example</a></p></div>
      <div class="description_element"><div class="code_responsive"><p><span id="d126e844896" itemprop="syntax"><code class="synopsis">[<a href="#mw_aa0a5446-3e40-4986-af30-f061365c378f" class="intrnllnk"><code class="argument">L</code></a>,<a href="#mw_19b2c217-1da6-448a-940d-0a0c12ee7587" class="intrnllnk"><code class="argument">U</code></a>,<a href="#mw_9318c26c-9146-4256-8b29-5d6988dbd2dc" class="intrnllnk"><code class="argument">P</code></a>] = ilu(<a href="#mw_b053ef4c-2b70-4832-adfe-b02c70ffeddd" class="intrnllnk"><code class="argument">A</code></a>)</code></span>
          also returns the permutation matrix <code class="literal">P</code> such that <code class="literal">L</code>
          and <code class="literal">U</code> are incomplete factors of <code class="literal">P*A</code> or
            <code class="literal">A*P</code>. By default, <code class="literal">P</code> is an identity matrix for the
          incomplete LU factorization without pivoting.</p></div></div>
      <div class="description_element"><div class="code_responsive"><p><span id="d126e844927" itemprop="syntax"><code class="synopsis"><a href="#mw_5d261b66-3c7c-417b-91c7-65281935b934" class="intrnllnk"><code class="argument">W</code></a> = ilu(<a href="#mw_b053ef4c-2b70-4832-adfe-b02c70ffeddd" class="intrnllnk"><code class="argument">A</code></a>)</code></span> returns the
          nonzeros of the LU factors. The output <code class="literal">W</code> is equal to <code class="argument">L + U -
            speye(size(A))</code>.</p></div><p class="syntax_example"><a href="ilu.html#mw_19759501-4e04-42f9-b60f-bf5c5f6bdb1c" class="intrnllnk">example</a></p></div>
    </div><div class="description_module"><span id="mw_fa51d41d-2fcc-493e-ae16-01ead427e796" class="anchor_target"></span>
      <div class="description_element"><div class="code_responsive"><p><span id="d126e844949" itemprop="syntax"><code class="synopsis">[<span class="argument_placeholder">___</span>] = ilu(<a href="#mw_b053ef4c-2b70-4832-adfe-b02c70ffeddd" class="intrnllnk"><code class="argument">A</code></a>,<a href="#mw_be0d234f-6566-457b-b106-dbc6bf5e7d91" class="intrnllnk"><code class="argument">options</code></a>)</code></span>
          performs the incomplete LU factorization of <code class="argument">A</code> with options specified
          by the structure <code class="argument">options</code>.</p><p>For example, you can perform an incomplete LU factorization with pivoting by setting
          the <code class="literal">type</code> field of <code class="literal">options</code> to
            <code class="literal">"ilutp"</code>. You can then specify a row-sum or column-sum preserving
          modified incomplete LU factorization by setting the <code class="literal">milu</code> field to
            <code class="literal">"row"</code> or <code class="literal">"col"</code>. This combination of options
          returns the permutation matrix <code class="literal">P</code> such that <code class="literal">L</code> and
            <code class="literal">U</code> are incomplete factors of <code class="literal">A*P</code> for the
            <code class="literal">"row"</code> option (where <code class="literal">U</code> is column permuted), or
            <code class="literal">L</code> and <code class="literal">U</code> are incomplete factors of
            <code class="literal">P*A</code> for the <code class="literal">"col"</code> option (where
            <code class="literal">L</code> is row permuted).</p></div><p class="syntax_example"><a href="ilu.html#mw_a6e75420-838d-4e51-95cd-8c256b29d997" class="intrnllnk">example</a></p></div>
    </div></div></div><div class="clear"></div><div class="examples"><h2 id="mw_8b9fe38c-a3fa-4742-84db-5dd50698b464">Examples</h2><div class="expandableContent" id="expandableExamples"><p class="switch"><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true3">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_19759501-4e04-42f9-b60f-bf5c5f6bdb1c"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_19759501-4e04-42f9-b60f-bf5c5f6bdb1c" data-bs-target="#expand_accordion_body_mw_19759501-4e04-42f9-b60f-bf5c5f6bdb1c" aria-controls="expand_accordion_body_mw_19759501-4e04-42f9-b60f-bf5c5f6bdb1c" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_19759501-4e04-42f9-b60f-bf5c5f6bdb1c">Different Types of Incomplete LU Factorization</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_19759501-4e04-42f9-b60f-bf5c5f6bdb1c" aria-labelledby="expand_accordion_heading_mw_19759501-4e04-42f9-b60f-bf5c5f6bdb1c" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/DifferentTypesOfIncompleteLUFactorizationExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Different Types of Incomplete LU Factorization",
          "description": "The ilu function provides three types of incomplete LU factorizations: the zero-fill factorization (ILU(0)), the Crout version (ILUC), and the factorization with threshold dropping and pivoting (ILUTP).",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "ilu.html"

        },
          "identifier": "matlab.DifferentTypesOfIncompleteLUFactorizationExample",
          "name": "DifferentTypesOfIncompleteLUFactorizationExample",
          "url": "ilu.html#mw_19759501-4e04-42f9-b60f-bf5c5f6bdb1c"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/DifferentTypesOfIncompleteLUFactorizationExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "DifferentTypesOfIncompleteLUFactorizationExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">The <code class="literal">ilu</code> function provides three types of incomplete LU factorizations: the zero-fill factorization (<code class="literal">ILU(0)</code>), the Crout version (<code class="literal">ILUC</code>), and the factorization with threshold dropping and pivoting (<code class="literal">ILUTP</code>).</p><p>By default, <code class="literal">ilu</code> performs the zero-fill incomplete LU factorization of a sparse matrix input. For example, find the complete and incomplete factorization of a sparse matrix with 7840 nonzeros. Its complete LU factors have 126,478 nonzeros, and its incomplete LU factors with zero-fill have 7840 nonzeros, the same number as <code class="literal">A</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>A = gallery(<span style="color:#A020F0">"neumann"</span>,1600) + speye(1600);
n = nnz(A)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>n = 
7840
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>n = nnz(lu(A))</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>n = 
126478
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>n = nnz(ilu(A))</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>n = 
7840
</pre></div></div></div><p>Because the zero-fill factorization preserves the sparsity pattern of the input matrix in its LU factors, the relative error of the factorization is essentially zero on the pattern of nonzero elements of <code class="literal">A</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[L,U] = ilu(A);
e = norm(A-(L*U).*spones(A),<span style="color:#A020F0">"fro"</span>)/norm(A,<span style="color:#A020F0">"fro"</span>)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>e = 
4.8874e-17
</pre></div></div></div><p>However, the product of these zero-fill factors is not a good approximation of the original matrix.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>e = norm(A-L*U,<span style="color:#A020F0">"fro"</span>)/norm(A,<span style="color:#A020F0">"fro"</span>)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>e = 
0.0601
</pre></div></div></div><p>To improve the accuracy, you can use other types of incomplete LU factorization with fill-in. For example, use the Crout version with a <code class="literal">1e-6</code> drop tolerance.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>options.droptol = 1e-6;
options.type = <span style="color:#A020F0">"crout"</span>;
[L,U] = ilu(A,options);</pre></div></div></div><p>The Crout version of the incomplete factorization has 51,482 nonzeros in its LU factors (less than the complete factorization). With fill-in, the product of the incomplete LU factors is a better approximation of the original matrix.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>n = nnz(ilu(A,options))</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>n = 
51482
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>e = norm(A-L*U,<span style="color:#A020F0">"fro"</span>)./norm(A,<span style="color:#A020F0">"fro"</span>)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>e = 
9.3040e-07
</pre></div></div></div><p>For comparison, for the same input matrix <code class="literal">A</code>, the incomplete factorization with threshold dropping and pivoting gives results similar to the Crout version.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>options.type = <span style="color:#A020F0">"ilutp"</span>;
[L,U,P] = ilu(A,options);
n = nnz(ilu(A,options))</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>n = 
51541
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>norm(P*A-L*U,<span style="color:#A020F0">"fro"</span>)./norm(A,<span style="color:#A020F0">"fro"</span>)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans = 
9.4960e-07
</pre></div></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-DifferentTypesOfIncompleteLUFactorizationExample"><meta itemprop="exampletitle" content="Different Types of Incomplete LU Factorization"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_a6e75420-838d-4e51-95cd-8c256b29d997"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_a6e75420-838d-4e51-95cd-8c256b29d997" data-bs-target="#expand_accordion_body_mw_a6e75420-838d-4e51-95cd-8c256b29d997" aria-controls="expand_accordion_body_mw_a6e75420-838d-4e51-95cd-8c256b29d997" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_a6e75420-838d-4e51-95cd-8c256b29d997">Drop Tolerance of Incomplete LU Factorization</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_a6e75420-838d-4e51-95cd-8c256b29d997" aria-labelledby="expand_accordion_heading_mw_a6e75420-838d-4e51-95cd-8c256b29d997" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/DropToleranceOfIncompleteLUFactorizationExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Drop Tolerance of Incomplete LU Factorization",
          "description": "Change the drop tolerance of incomplete LU factorization to factor a sparse matrix.",
          "thumbnailURL": "../../examples/matlab/win64/DropToleranceOfIncompleteLUFactorizationExample_02.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "ilu.html"

        },
          "identifier": "matlab.DropToleranceOfIncompleteLUFactorizationExample",
          "name": "DropToleranceOfIncompleteLUFactorizationExample",
          "url": "ilu.html#mw_a6e75420-838d-4e51-95cd-8c256b29d997"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/DropToleranceOfIncompleteLUFactorizationExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "DropToleranceOfIncompleteLUFactorizationExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Change the drop tolerance of incomplete LU factorization to factor a sparse matrix.</p><p>Load the <code class="literal">west0479</code> matrix, which is a real-valued 479-by-479 nonsymmetric sparse matrix. Estimate the condition number of the matrix by using <code class="literal">condest</code>. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>load <span style="color:#A020F0">west0479</span>
A = west0479;
c1 = condest(A)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>c1 = 
1.4244e+12
</pre></div></div></div><p>Improve the condition number of the matrix by using <a href="equilibrate.html" data-docid="matlab_ref#mw_7cd12e99-4052-4006-aafc-81199d0ad057" class="a"><code class="olink">equilibrate</code></a>. Permute and rescale the original matrix <code class="literal">A</code> to create a new matrix <code class="literal">B = R*P*A*C</code>, which has a better condition number and diagonal entries of only 1 and &#8211;1. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[P,R,C] = equilibrate(A);
B = R*P*A*C;
c2 = condest(B)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>c2 = 
5.1036e+04
</pre></div></div></div><p>Specify the options to perform the incomplete LU factorization of <code class="literal">B</code> with threshold dropping and pivoting that preserves the row sum. For comparison purposes, first specify a zero drop tolerance of fill-in, which produces the complete LU factorization.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>options.type = <span style="color:#A020F0">"ilutp"</span>;
options.milu = <span style="color:#A020F0">"row"</span>;
options.droptol = 0;
[L,U,P] = ilu(B,options);</pre></div></div></div><p>This factorization is very accurate in approximating the input matrix <code class="literal">B</code>, but the factors are significantly more dense than <code class="literal">B</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>e = norm(B*P-L*U,<span style="color:#A020F0">"fro"</span>)/norm(B,<span style="color:#A020F0">"fro"</span>)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>e = 
1.0345e-16
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>nLU = nnz(L)+nnz(U)-size(B,1)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>nLU = 
19118
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>nB = nnz(B)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>nB = 
1887
</pre></div></div></div><p>You can change the drop tolerance to obtain incomplete LU factors that are more sparse but less accurate in approximating <code class="literal">B</code>. For example, the following plots show the ratio of the density of the incomplete factors to the density of the input matrix plotted against the drop tolerance, and the relative error of the incomplete factorization.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>ntols = 20;
tau = logspace(-6,-2,ntols);
e = zeros(1,ntols);
nLU = zeros(1,ntols);
<span style="color:#0000FF">for</span> k = 1:ntols
    options.droptol = tau(k);
    [L,U,P] = ilu(B,options);
    nLU(k) = nnz(L)+nnz(U)-size(B,1);
    e(k) = norm(B*P-L*U,<span style="color:#A020F0">"fro"</span>)/norm(B,<span style="color:#A020F0">"fro"</span>);
<span style="color:#0000FF">end</span>
figure
semilogx(tau,nLU./nB,LineWidth=2)
title(<span style="color:#A020F0">"Ratio of nonzeros of LU factors with respect to B"</span>)
xlabel(<span style="color:#A020F0">"drop tolerance"</span>)
ylabel(<span style="color:#A020F0">"nnz(L)+nnz(U)-size(B,1)/nnz(B)"</span>,FontName=<span style="color:#A020F0">"FixedWidth"</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e845171" class="mediaobject"><p><img src="../../examples/matlab/win64/DropToleranceOfIncompleteLUFactorizationExample_01.png" alt="Figure contains an axes object. The axes object with title Ratio of nonzeros of LU factors with respect to B, xlabel drop tolerance, ylabel nnz(L)+nnz(U)-size(B,1)/nnz(B) contains an object of type line." width="560"></p></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>figure
loglog(tau,e,LineWidth=2)
title(<span style="color:#A020F0">"Relative error of the incomplete LU factorization"</span>)
xlabel(<span style="color:#A020F0">"drop tolerance"</span>)
ylabel(<span style="color:#A020F0">"$||BP-LU||_F\,/\,||B||_F$"</span>,Interpreter=<span style="color:#A020F0">"latex"</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e845178" class="mediaobject"><p><img src="../../examples/matlab/win64/DropToleranceOfIncompleteLUFactorizationExample_02.png" alt="Figure contains an axes object. The axes object with title Relative error of the incomplete LU factorization, xlabel drop tolerance, ylabel $||BP-LU|| indexOf F baseline \,/\,||B|| indexOf F baseline $ contains an object of type line." width="560"></p></div></div><p>In this example, the relative error of the incomplete LU factorization with threshold dropping is on the same order of the drop tolerance (which does not always occur).</p><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-DropToleranceOfIncompleteLUFactorizationExample"><meta itemprop="exampletitle" content="Drop Tolerance of Incomplete LU Factorization"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_d9ccfbbe-0595-4eb7-b1bb-7bb7863fdc09"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_d9ccfbbe-0595-4eb7-b1bb-7bb7863fdc09" data-bs-target="#expand_accordion_body_mw_d9ccfbbe-0595-4eb7-b1bb-7bb7863fdc09" aria-controls="expand_accordion_body_mw_d9ccfbbe-0595-4eb7-b1bb-7bb7863fdc09" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_d9ccfbbe-0595-4eb7-b1bb-7bb7863fdc09">Using <code class="literal">ilu</code> as Preconditioner to Solve Linear System</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_d9ccfbbe-0595-4eb7-b1bb-7bb7863fdc09" aria-labelledby="expand_accordion_heading_mw_d9ccfbbe-0595-4eb7-b1bb-7bb7863fdc09" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/UsingIluAsPreconditionerToSolveLinearSystemExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Using ilu as Preconditioner to Solve Linear System",
          "description": "Use an incomplete LU factorization as a preconditioner for bicgstab to solve a linear system.",
          "thumbnailURL": "../../examples/matlab/win64/UsingIluAsPreconditionerToSolveLinearSystemExample_01.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "ilu.html"

        },
          "identifier": "matlab.UsingIluAsPreconditionerToSolveLinearSystemExample",
          "name": "UsingIluAsPreconditionerToSolveLinearSystemExample",
          "url": "ilu.html#mw_d9ccfbbe-0595-4eb7-b1bb-7bb7863fdc09"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/UsingIluAsPreconditionerToSolveLinearSystemExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "UsingIluAsPreconditionerToSolveLinearSystemExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Use an incomplete LU factorization as a preconditioner for <a href="bicgstab.html" data-docid="matlab_ref#f79-999067" class="a"><code class="olink">bicgstab</code></a> to solve a linear system.</p><p>Load <code class="literal">west0479</code>, a real 479-by-479 nonsymmetric sparse matrix.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>load <span style="color:#A020F0">west0479</span>
A = west0479;</pre></div></div></div><p>Define <code class="literal">b</code> so that the true solution to <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">Ax</mi><mo>=</mo><mi mathvariant="italic">b</mi></mrow></math></span> is a vector of all ones.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>b = full(sum(A,2));</pre></div></div></div><p>Set the tolerance and maximum number of iterations.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>tol = 1e-12;
maxit = 20;</pre></div></div></div><p>Use <code class="literal">bicgstab</code> to find a solution at the requested tolerance and number of iterations. Specify five outputs to return information about the solution process:</p><div class="itemizedlist"><ul><li><p><code class="literal">x</code> is the computed solution to <code class="literal">A*x = b</code>.</p></li><li><p><code class="literal">fl0</code> is a flag indicating whether the algorithm converged.</p></li><li><p><code class="literal">rr0</code> is the relative residual of the computed answer <code class="literal">x</code>.</p></li><li><p><code class="literal">it0</code> is the iteration number when <code class="literal">x</code> was computed.</p></li><li><p><code class="literal">rv0</code> is a vector of the residual history at each half iteration for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mrow><mo>‖</mo><mrow><mi mathvariant="italic">b</mi><mo>-</mo><mi mathvariant="italic">Ax</mi></mrow><mo>‖</mo></mrow></mrow></math></span>.</p></li></ul></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[x,fl0,rr0,it0,rv0] = bicgstab(A,b,tol,maxit); 
fl0</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>fl0 = 
1
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>rr0</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>rr0 = 
1
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>it0</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>it0 = 
0
</pre></div></div></div><p><code class="literal">fl0</code> is <code class="literal">1</code> because <code class="literal">bicgstab</code> does not converge to the requested tolerance <code class="literal">1e-12</code> within the requested 20 iterations. In fact, the behavior of <code class="literal">bicgstab</code> is so poor that the initial guess <code class="literal">x0 = zeros(size(A,2),1)</code> is the best solution and is returned, as indicated by <code class="literal">it0 = 0</code>.</p><p>To aid with the slow convergence, you can specify a preconditioner matrix. Because <code class="literal">A</code> is nonsymmetric, use <code class="literal">ilu</code> to generate the preconditioner <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">M</mi><mo>=</mo><mi mathvariant="italic">L</mi><mtext> </mtext><mi mathvariant="italic">U</mi></mrow></math></span>. Specify a drop tolerance to ignore nondiagonal entries with values smaller than <code class="literal">1e-6</code>. Solve the preconditioned system <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><mi mathvariant="italic">A</mi><mtext> </mtext><mi mathvariant="italic">M</mi></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup><mtext> </mtext><mi mathvariant="italic">M</mi><mtext> </mtext><mi mathvariant="italic">x</mi><mo>=</mo><mi mathvariant="italic">b</mi></mrow></math></span> by specifying <code class="literal">L</code> and <code class="literal">U</code> as inputs to <code class="literal">bicgstab</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>options = struct(<span style="color:#A020F0">"type"</span>,<span style="color:#A020F0">"ilutp"</span>,<span style="color:#A020F0">"droptol"</span>,1e-6);
[L,U] = ilu(A,options);
[x_precond,fl1,rr1,it1,rv1] = bicgstab(A,b,tol,maxit,L,U);
fl1</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>fl1 = 
0
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>rr1</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>rr1 = 
7.0681e-14
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>it1</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>it1 = 
3
</pre></div></div></div><p>The use of an <code class="literal">ilu</code> preconditioner produces a relative residual <code class="literal">rr1</code> less than the requested tolerance of <code class="literal">1e-12</code> at the third iteration. The output <code class="literal">rv1(1)</code> is <code class="literal">norm(b)</code>, and the output <code class="literal">rv1(end)</code> is <code class="literal">norm(b-A*x1)</code>.</p><p>You can follow the progress of <code class="literal">bicgstab</code> by plotting the relative residuals at each half iteration. Plot the residual history of each solution with a line for the specified tolerance.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>semilogy((0:numel(rv0)-1)/2,rv0/norm(b),<span style="color:#A020F0">"-o"</span>)
hold <span style="color:#A020F0">on</span>
semilogy((0:numel(rv1)-1)/2,rv1/norm(b),<span style="color:#A020F0">"-o"</span>)
yline(tol,<span style="color:#A020F0">"r--"</span>);
legend(<span style="color:#A020F0">"No preconditioner"</span>,<span style="color:#A020F0">"ILU preconditioner"</span>,<span style="color:#A020F0">"Tolerance"</span>,Location=<span style="color:#A020F0">"East"</span>)
xlabel(<span style="color:#A020F0">"Iteration number"</span>)
ylabel(<span style="color:#A020F0">"Relative residual"</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e845393" class="mediaobject"><p><img src="../../examples/matlab/win64/UsingIluAsPreconditionerToSolveLinearSystemExample_01.png" alt="Figure contains an axes object. The axes object with xlabel Iteration number, ylabel Relative residual contains 3 objects of type line, constantline. These objects represent No preconditioner, ILU preconditioner, Tolerance." width="560"></p></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-UsingIluAsPreconditionerToSolveLinearSystemExample"><meta itemprop="exampletitle" content="Using ilu as Preconditioner to Solve Linear System"></div></div></div></div><div class="ref_sect"><h2 id="mw_14408161-cf16-4466-833b-0035563298de">Input Arguments</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="mw_14408161-cf16-4466-833b-0035563298de_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="mw_b053ef4c-2b70-4832-adfe-b02c70ffeddd"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_b053ef4c-2b70-4832-adfe-b02c70ffeddd" data-bs-target="#expand_accordion_body_mw_b053ef4c-2b70-4832-adfe-b02c70ffeddd" aria-controls="expand_accordion_body_mw_b053ef4c-2b70-4832-adfe-b02c70ffeddd" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_A" class="anchor_target"></span><h3 id="mw_b053ef4c-2b70-4832-adfe-b02c70ffeddd"><code itemprop="name">A</code> &#8212; <span itemprop="purpose">Input matrix</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">sparse square matrix</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_b053ef4c-2b70-4832-adfe-b02c70ffeddd" aria-labelledby="expand_accordion_heading_mw_b053ef4c-2b70-4832-adfe-b02c70ffeddd" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_b053ef4c-2b70-4832-adfe-b02c70ffeddd"><p>Input matrix, specified as a sparse square matrix.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code><br/>
<strong>Complex Number Support: </strong>Yes</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="mw_be0d234f-6566-457b-b106-dbc6bf5e7d91"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_be0d234f-6566-457b-b106-dbc6bf5e7d91" data-bs-target="#expand_accordion_body_mw_be0d234f-6566-457b-b106-dbc6bf5e7d91" aria-controls="expand_accordion_body_mw_be0d234f-6566-457b-b106-dbc6bf5e7d91" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_options" class="anchor_target"></span><h3 id="mw_be0d234f-6566-457b-b106-dbc6bf5e7d91"><code itemprop="name">options</code> &#8212; <span itemprop="purpose">LU factorization options</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">structure</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_be0d234f-6566-457b-b106-dbc6bf5e7d91" aria-labelledby="expand_accordion_heading_mw_be0d234f-6566-457b-b106-dbc6bf5e7d91" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_be0d234f-6566-457b-b106-dbc6bf5e7d91"><p>LU factorization options, specified as a structure with up to five
              fields:</p>
<div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="16%"><col class="tcol2" width="42%"><col class="tcol3" width="42%"></colgroup><thead><tr><th>Field Name</th><th>Summary</th><th>Description</th></tr></thead><tbody><tr><td><p><code class="literal">type</code></p></td><td>Type of incomplete LU factorization</td><td><p>Valid values for <code class="literal">type</code> are:</p>
<div class="itemizedlist"><ul><li><p><code class="literal">"nofill"</code>(default) &#8212; Perform ILU
                              factorization with <code class="literal">0</code> level of fill in, known as
                              ILU(0). With <code class="literal">type</code> set to
                                <code class="literal">"nofill"</code>, only the <code class="literal">milu</code> option
                              is used; all other fields are ignored.</p></li><li><p><code class="literal">"crout"</code> &#8212; Perform the Crout version of
                              ILU factorization, known as ILUC. With <code class="literal">type</code> set to
                                <code class="literal">"crout"</code>, only the <code class="literal">droptol</code> and
                                <code class="literal">milu</code> options are used; all other fields are
                              ignored.</p></li><li><p><code class="literal">"ilutp"</code> &#8212; Perform ILU factorization with
                              threshold and pivoting, known as ILUTP. Pivoting is performed only
                              with this type.</p></li></ul></div><p>
The default value is
                      <code class="literal">"nofill"</code>.</p></td></tr><tr><td><p><code class="literal">droptol</code></p></td><td>Drop tolerance of the incomplete LU factorization</td><td><p>Valid value for <code class="literal">droptol</code> is any nonnegative
                        scalar. The nonzero entries of <code class="literal">U</code> satisfy
                          <code class="literal">abs(U(i,j)) &gt;= droptol*norm(A(:,j))</code>, with the
                        exception of the diagonal entries, which are retained regardless of if they
                        satisfy this criterion. The entries of <code class="literal">L</code> are tested
                        against the local drop tolerance before being scaled by the pivot, so the
                        nonzero entries of <code class="literal">L</code> satisfy <code class="literal">abs(L(i,j)) &gt;=
                          droptol*norm(A(:,j))/U(j,j)</code>.</p><p>The default value is
                          <code class="literal">0</code>, which produces the complete LU
                      factorization.</p></td></tr><tr><td><p><code class="literal">milu</code></p></td><td>Type of modified incomplete LU factorization</td><td><p>Valid values for <code class="literal">milu</code> are:</p>
<div class="itemizedlist"><ul><li><p><code class="literal">"off"</code> &#8212; No modified incomplete LU
                              factorization is produced.</p></li><li><p><code class="literal">"row"</code> &#8212; Produce the row-sum modified
                              incomplete LU factorization. The diagonal elements of the upper
                              triangular factor <code class="literal">U</code> are compensated so that row
                              sums of the original matrix are preserved. That is, <code class="literal">A*e =
                                L*U*e</code>, where <code class="literal">e</code> is the column vector of
                              ones. </p></li><li><p><code class="literal">"col"</code> &#8212; Produce the column-sum modified
                              incomplete LU factorization. The diagonal elements of the upper
                              triangular factor <code class="literal">U</code> are compensated so that column
                              sums of the original matrix are preserved. That is, <code class="literal">e'*A =
                                e'*L*U</code>.</p></li></ul></div><p>
The default value is <code class="literal">"off"</code>.</p></td></tr><tr><td><p><code class="literal">udiag</code></p></td><td>Whether to replace zero diagonal entries of <code class="literal">U</code></td><td><p>Valid values for <code class="literal">udiag</code> are <code class="literal">0</code>
                        and <code class="literal">1</code>. If <code class="literal">udiag</code> is
                          <code class="literal">1</code>, then any zero diagonal entries of the upper
                        triangular factor <code class="literal">U</code> are replaced by the local drop
                        tolerance in an attempt to avoid a singular factor.</p><p>The default
                        value is <code class="literal">0</code>.</p></td></tr><tr><td><p><code class="literal">thresh</code></p></td><td>Pivot threshold</td><td><p>Valid values are between <code class="literal">0</code>, where the algorithm
                        selects the diagonal pivot, and <code class="literal">1</code>, where the algorithm
                        chooses the maximum magnitude entry in the column to be the pivot. Pivoting
                        occurs when the diagonal entry in a column has a magnitude less than
                          <code class="literal">thresh</code> times the magnitude of any subdiagonal entry in
                        that column.</p><p>The default value is
                      <code class="literal">1</code>.</p></td></tr></tbody></table></div><p>
</p></div></div></div></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="mw_cc035b24-6e61-4263-940d-7af196005fc5">Output Arguments</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="mw_cc035b24-6e61-4263-940d-7af196005fc5_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_aa0a5446-3e40-4986-af30-f061365c378f" data-bs-target="#expand_accordion_body_mw_aa0a5446-3e40-4986-af30-f061365c378f" aria-controls="expand_accordion_body_mw_aa0a5446-3e40-4986-af30-f061365c378f" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_L" class="anchor_target"></span><h3 id="mw_aa0a5446-3e40-4986-af30-f061365c378f"><code class="name">L</code> &#8212; Lower triangular factor<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">sparse square matrix</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_aa0a5446-3e40-4986-af30-f061365c378f" aria-labelledby="expand_accordion_heading_mw_aa0a5446-3e40-4986-af30-f061365c378f" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_aa0a5446-3e40-4986-af30-f061365c378f"><p>Lower triangular factor, returned as a sparse square matrix.</p>
<div class="itemizedlist"><ul><li><p>When <code class="literal">options.type</code> is specified as
                    <code class="literal">"nofill"</code> (by default) or <code class="literal">"crout"</code>,
                    <code class="literal">L</code> is returned as a unit lower triangular matrix (that is, a
                  lower triangular matrix with 1s on the main diagonal).</p></li><li><p>When <code class="literal">options.type</code> is specified as
                    <code class="literal">"ilutp"</code> and <code class="literal">options.milu</code> is specified as
                    <code class="literal">"col"</code>, <code class="literal">L</code> is returned as a row-permuted
                  unit lower triangular matrix.</p></li></ul></div><p>
</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_19b2c217-1da6-448a-940d-0a0c12ee7587" data-bs-target="#expand_accordion_body_mw_19b2c217-1da6-448a-940d-0a0c12ee7587" aria-controls="expand_accordion_body_mw_19b2c217-1da6-448a-940d-0a0c12ee7587" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_U" class="anchor_target"></span><h3 id="mw_19b2c217-1da6-448a-940d-0a0c12ee7587"><code class="name">U</code> &#8212; Upper triangular factor<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">sparse square matrix</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_19b2c217-1da6-448a-940d-0a0c12ee7587" aria-labelledby="expand_accordion_heading_mw_19b2c217-1da6-448a-940d-0a0c12ee7587" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_19b2c217-1da6-448a-940d-0a0c12ee7587"><p>Upper triangular factor, returned as a sparse square matrix.</p>
<div class="itemizedlist"><ul><li><p>When <code class="literal">options.type</code> is specified as
                    <code class="literal">"nofill"</code> (by default) or <code class="literal">"crout"</code>,
                    <code class="literal">U</code> is returned as an upper triangular matrix.</p></li><li><p>When <code class="literal">options.type</code> is specified as
                    <code class="literal">"ilutp"</code> and <code class="literal">options.milu</code> is specified as
                    <code class="literal">"row"</code>, <code class="literal">U</code> is returned as a column-permuted
                  upper triangular matrix.</p></li></ul></div><p>
</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_9318c26c-9146-4256-8b29-5d6988dbd2dc" data-bs-target="#expand_accordion_body_mw_9318c26c-9146-4256-8b29-5d6988dbd2dc" aria-controls="expand_accordion_body_mw_9318c26c-9146-4256-8b29-5d6988dbd2dc" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_P" class="anchor_target"></span><h3 id="mw_9318c26c-9146-4256-8b29-5d6988dbd2dc"><code class="name">P</code> &#8212; Permutation matrix<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">sparse square matrix</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_9318c26c-9146-4256-8b29-5d6988dbd2dc" aria-labelledby="expand_accordion_heading_mw_9318c26c-9146-4256-8b29-5d6988dbd2dc" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_9318c26c-9146-4256-8b29-5d6988dbd2dc"><p>Permutation matrix, returned as a sparse square matrix.</p><p>When <code class="literal">options.type</code> is specified as <code class="literal">"nofill"</code> (by
            default) or <code class="literal">"crout"</code>, <code class="literal">P</code> is returned as an identity
            matrix of the same size as <code class="literal">A</code> because neither of these types performs
            pivoting.</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_5d261b66-3c7c-417b-91c7-65281935b934" data-bs-target="#expand_accordion_body_mw_5d261b66-3c7c-417b-91c7-65281935b934" aria-controls="expand_accordion_body_mw_5d261b66-3c7c-417b-91c7-65281935b934" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_W" class="anchor_target"></span><h3 id="mw_5d261b66-3c7c-417b-91c7-65281935b934"><code class="name">W</code> &#8212; Nonzeros of the LU factors<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">sparse square matrix</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_5d261b66-3c7c-417b-91c7-65281935b934" aria-labelledby="expand_accordion_heading_mw_5d261b66-3c7c-417b-91c7-65281935b934" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_5d261b66-3c7c-417b-91c7-65281935b934"><p>Nonzeros of the LU factors, returned as a sparse square matrix, where <code class="literal">W = L
              + U - speye(size(A))</code>.</p></div></div></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="mw_db16d47a-b4f7-42f9-931b-b66e6c723c77">Tips</h2><div class="itemizedlist"><ul><li><p>The incomplete factorizations returned by this function may be useful as
          preconditioners for a system of linear equations being solved by <a href="../math/iterative-methods-for-linear-systems.html" class="a">iterative
            methods</a>, such as <a href="bicg.html"><code class="function">bicg</code></a>, <a href="bicgstab.html"><code class="function">bicgstab</code></a>, or <a href="gmres.html"><code class="function">gmres</code></a>.</p></li></ul></div></div><div class="bibliography"><h2 id="References">References</h2><div id="mw_93528a77-e60a-431e-b077-f144961045fb" class="bibliomixed"><p>[1] Saad, Y. "Preconditioning
      Techniques", chap. 10 in <em class="citetitle">Iterative Methods for Sparse Linear Systems</em>.
      The PWS Series in Computer Science. Boston: PWS Pub. Co, 1996.</p></div></div><div class="ref_sect"><h2 id="refsect-extended-capabilities">Extended Capabilities</h2><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink">expand all</a></p><div id="accordion_refsect-extended-capabilities" role="tablist" aria-multiselectable="true"><span id="mw_3a1d1d1d-31ba-490f-a922-77d48147e899" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="f89-999064" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_f89-999064_threadsupport" aria-controls="expand_body_f89-999064_threadsupport" class="accordion-button collapsed" aria-expanded="false"><h3 id="f89-999064_threadsupport">Thread-Based Environment<br/> <span class=" remove_bold add_font_color_general">Run code in the background using MATLAB&#174; <code class="function">backgroundPool</code> or accelerate code with Parallel Computing Toolbox&#8482; <code class="function">ThreadPool</code>.</span></h3></button></div><div id="expand_body_f89-999064_threadsupport" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>This function fully supports thread-based environments. For
                more information, see <a href="../matlab_prog/run-functions-on-threads.html" class="a">Run MATLAB Functions in Thread-Based Environment</a>.</p></div></div></div></div></div><span id="mw_da7396b2-a19c-482a-bc92-5823e3a8c7b3" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="f89-999064" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_f89-999064_distributedarrays" aria-controls="expand_body_f89-999064_distributedarrays" class="accordion-button collapsed" aria-expanded="false"><h3 id="f89-999064_distributedarrays">Distributed Arrays<br/> <span class=" remove_bold add_font_color_general">Partition large arrays across the combined memory of your cluster using Parallel Computing Toolbox&#8482;.</span></h3></button></div><div id="expand_body_f89-999064_distributedarrays" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>Usage notes and limitations:</p><div class="itemizedlist"><ul><li><p>If you include the field <code class="literal">type</code> in the structure array
              <code class="literal">options</code>, then you must set it to
            <code class="literal">'nofill'</code>.</p></li></ul></div><p>For more information, see <a href="../../parallel-computing/run-matlab-functions-with-distributed-arrays.html" class="a">Run MATLAB Functions with Distributed Arrays</a><span role="cross_prod"> (Parallel Computing Toolbox)</span>.</p></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="mw_b74d5ff8-0542-4daa-91a8-3f6f6ff6e355">Version History</h2><strong>Introduced in R2007a</strong><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink">expand all</a></p><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_mw_e8994503-2ef8-42be-920a-794994059ac0" aria-controls="expand_body_mw_e8994503-2ef8-42be-920a-794994059ac0" class="accordion-button collapsed" aria-expanded="false"><h3 id="mw_e8994503-2ef8-42be-920a-794994059ac0">R2025a: <span class="remove_bold">Specify single-precision sparse input argument</span></h3></button></div><div id="expand_body_mw_e8994503-2ef8-42be-920a-794994059ac0" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>You can specify the input matrix <code class="argument">A</code> as single precision. If
          <code class="argument">A</code> is <code class="class">single</code>, the output arguments are also
          <code class="class">single</code>.</p></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="f89-999064_seealso">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="lu.html"><span itemprop="name"><code class="function">lu</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="ichol.html"><span itemprop="name"><code class="function">ichol</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="bicg.html"><span itemprop="name"><code class="function">bicg</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="bicgstab.html"><span itemprop="name"><code class="function">bicgstab</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="gmres.html"><span itemprop="name"><code class="function">gmres</code></span></a></span></p><div class="examples_container"><h3 class="remove_border">Topics</h3><div itemprop="content"><ul class="list-unstyled"><li><a href="../math/sparse-matrix-operations.html" class="a">Sparse Matrix Operations</a></li><li><a href="../math/iterative-methods-for-linear-systems.html" class="a">Iterative Methods for Linear Systems</a></li></ul></div></div></div>
    </div></div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>ode23s</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../numerical-integration-and-differential-equations.html",
          "name": "Numerical Integration and Differential Equations"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../ordinary-differential-equations.html",
          "name": "Ordinary Differential Equations"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "ordinary-differential-equations"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExtendedCapabilities",

        "itemListElement":
        [
{
          "@type": "ListItem",
          "position": 1,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "codegen",
          "value": "limited"

        }
          }
        ]
        }
        </script>
<meta xmlns="http://www.w3.org/1999/xhtml" name="chunktype" content="refpage"><meta xmlns="http://www.w3.org/1999/xhtml" name="refentity" itemprop="refentity" content="function:ode23s"><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="fcn">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ref/function">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This MATLAB function, where tspan = [t0 tf], integrates the system of differential equations y'=f(t,y) from t0 to tf with initial conditions y0."><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "refentry";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../numerical-integration-and-differential-equations.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Numerical Integration and Differential Equations</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../ordinary-differential-equations.html?s_tid=CRUX_lftnav" itemprop="url" id="ordinary-differential-equations"><span itemprop="title">Ordinary Differential Equations</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item notranslate"><a href="#responsive_offcanvas"><span class="refname">ode23s</span></a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-refentry">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li><a href="#d126e1207874" class="intrnllnk">Syntax</a></li><li class="nav-item"><a href="#description" class="nav-link intrnllnk">Description</a></li><li class="nav-item"><a href="#bu8towo" class="nav-link intrnllnk">Examples</a><ul class="nav"><li class="nav-item"><a href="#bu4ao3t" class="nav-link intrnllnk">ODE with Single Solution Component</a></li></ul><ul class="nav"><li class="nav-item"><a href="#bu654ce" class="nav-link intrnllnk">Solve Stiff ODE</a></li></ul><ul class="nav"><li class="nav-item"><a href="#bu654cg" class="nav-link intrnllnk">Pass Extra Parameters to ODE Function</a></li></ul><ul class="nav"><li class="nav-item"><a href="#bu654ci" class="nav-link intrnllnk">Compare Stiff ODE Solvers</a></li></ul></li><li class="nav-item"><a href="#bu8tov6" class="nav-link intrnllnk">Input Arguments</a><ul class="nav"><li class="nav-item"><a href="#bu5ypsh_sep_shared-odefun" class="nav-link intrnllnk">odefun</a></li><li class="nav-item"><a href="#bu5ypsh_sep_shared-tspan" class="nav-link intrnllnk">tspan</a></li><li class="nav-item"><a href="#bu5ypsh_sep_shared-y0" class="nav-link intrnllnk">y0</a></li><li class="nav-item"><a href="#bu5ypsh_sep_shared-options" class="nav-link intrnllnk">options</a></li></ul></li><li class="nav-item"><a href="#bu8towe" class="nav-link intrnllnk">Output Arguments</a><ul class="nav"><li class="nav-item"><a href="#bu5ypsh_sep_shared-t" class="nav-link intrnllnk">t</a></li><li class="nav-item"><a href="#bu5ypsh_sep_shared-y" class="nav-link intrnllnk">y</a></li><li class="nav-item"><a href="#bu5ypsh_sep_shared-te" class="nav-link intrnllnk">te</a></li><li class="nav-item"><a href="#bu5ypsh_sep_shared-ye" class="nav-link intrnllnk">ye</a></li><li class="nav-item"><a href="#bu5ypsh_sep_shared-ie" class="nav-link intrnllnk">ie</a></li><li class="nav-item"><a href="#bu5ypsh_sep_shared-sol" class="nav-link intrnllnk">sol</a></li></ul></li><li class="nav-item"><a href="#bu8towx" class="nav-link intrnllnk">Algorithms</a></li><li><a href="#References" class="intrnllnk">References</a></li><li class="nav-item"><a href="#refsect-extended-capabilities" class="nav-link intrnllnk">Extended Capabilities</a></li><li class="nav-item"><a href="#mw_fc44b089-93c7-4621-8721-5a9779909cd3" class="nav-link intrnllnk">Version History</a><ul class="nav"><li class="nav-item"><a href="#mw_6eadd880-6bb0-4279-aa19-dd94b64e83f9" class="nav-link intrnllnk">Code generation support</a></li></ul></li><li class="nav-item"><a href="#bu5ypsh_seealso" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-ref-function"><div class="function_ref"><span id="bu5ypsh" class="anchor_target"></span><h1 class="r2025b notranslate" itemprop="title"><span class="refname">ode23s</span></h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">Solve stiff differential equations &#8212; low order
method</p><div class="switch"><a href="javascript:void(0);" id="expandAllPage" data-allexpanded="true1">collapse all in page</a></div></div></div>
<div class="ref_sect"><h2 id="d126e1207874">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><div class="code_responsive"><code class="synopsis"><a href="#d126e1207881" class="intrnllnk">[t,y] =
ode23s(odefun,tspan,y0)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1207949" class="intrnllnk">[t,y] =
ode23s(odefun,tspan,y0,options)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1207984" class="intrnllnk">[t,y,te,ye,ie]
= ode23s(odefun,tspan,y0,options)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1208050" class="intrnllnk">sol = ode23s(<span class="argument_placeholder">___</span>)</a></code></div></div></div></div><div class="clear"></div><span id="bu8tov1" class="anchor_target"></span><h2 id="description">Description</h2><div class="descriptions"><div class="cshsummary" id="csh_bu5ypsh"><div class="description_module"><div class="description_element"><div class="code_responsive"><p><span id="d126e1207881" itemprop="syntax"><code class="synopsis">[<a href="#bu5ypsh_sep_shared-t" class="intrnllnk"><code class="argument">t</code></a>,<a href="#bu5ypsh_sep_shared-y" class="intrnllnk"><code class="argument">y</code></a>] =
ode23s(<a href="#bu5ypsh_sep_shared-odefun" class="intrnllnk"><code class="argument">odefun</code></a>,<a href="#bu5ypsh_sep_shared-tspan" class="intrnllnk"><code class="argument">tspan</code></a>,<a href="#bu5ypsh_sep_shared-y0" class="intrnllnk"><code class="argument">y0</code></a>)</code></span>,
where <code class="literal">tspan = [t0 tf]</code>, integrates the system of
differential equations <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><mi>y</mi><mo>'</mo><mo>=</mo><mi>f</mi><mrow><mo>(</mo><mrow><mi>t</mi><mo>,</mo><mi>y</mi></mrow><mo>)</mo></mrow></mrow></math></span></span> from <code class="literal">t0</code> to <code class="literal">tf</code> with
initial conditions <code class="literal">y0</code>. Each row in the solution
array <code class="literal">y</code> corresponds to a value returned in column
vector <code class="literal">t</code>.</p><p>All MATLAB<sup>&#x00AE;</sup> ODE solvers can solve systems of equations of
the form <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><mi>y</mi><mo>'</mo><mo>=</mo><mi>f</mi><mrow><mo>(</mo><mrow><mi>t</mi><mo>,</mo><mi>y</mi></mrow><mo>)</mo></mrow></mrow></math></span></span>,
or problems that involve a mass matrix, <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><mi>M</mi><mrow><mo>(</mo><mrow><mi>t</mi><mo>,</mo><mi>y</mi></mrow><mo>)</mo></mrow><mi>y</mi><mo>'</mo><mo>=</mo><mi>f</mi><mrow><mo>(</mo><mrow><mi>t</mi><mo>,</mo><mi>y</mi></mrow><mo>)</mo></mrow></mrow></math></span></span>.
The solvers all use similar syntaxes. The <code class="function">ode23s</code> solver
only can solve problems with a mass matrix if the mass matrix is constant. <code class="function">ode15s</code> and <code class="function">ode23t</code> can
solve problems with a mass matrix that is singular, known as differential-algebraic
equations (DAEs). Specify the mass matrix using the <code class="literal">Mass</code> option
of <a href="odeset.html"><code class="function">odeset</code></a>.</p></div><p class="syntax_example"><a href="ode23s.html#bu4ao3t" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e1207949" itemprop="syntax"><code class="synopsis">[<a href="#bu5ypsh_sep_shared-t" class="intrnllnk"><code class="argument">t</code></a>,<a href="#bu5ypsh_sep_shared-y" class="intrnllnk"><code class="argument">y</code></a>] =
ode23s(<a href="#bu5ypsh_sep_shared-odefun" class="intrnllnk"><code class="argument">odefun</code></a>,<a href="#bu5ypsh_sep_shared-tspan" class="intrnllnk"><code class="argument">tspan</code></a>,<a href="#bu5ypsh_sep_shared-y0" class="intrnllnk"><code class="argument">y0</code></a>,<a href="#bu5ypsh_sep_shared-options" class="intrnllnk"><code class="argument">options</code></a>)</code></span> also
uses the integration settings defined by <code class="literal">options</code>,
which is an argument created using the <code class="literal">odeset</code> function.
For example, use the <code class="literal">AbsTol</code> and <code class="literal">RelTol</code> options
to specify absolute and relative error tolerances, or the <code class="literal">Mass</code> option
to provide a mass matrix.</p></div><p class="syntax_example"><a href="ode23s.html#bu654ci" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e1207984" itemprop="syntax"><code class="synopsis">[<a href="#bu5ypsh_sep_shared-t" class="intrnllnk"><code class="argument">t</code></a>,<a href="#bu5ypsh_sep_shared-y" class="intrnllnk"><code class="argument">y</code></a>,<a href="#bu5ypsh_sep_shared-te" class="intrnllnk"><code class="argument">te</code></a>,<a href="#bu5ypsh_sep_shared-ye" class="intrnllnk"><code class="argument">ye</code></a>,<a href="#bu5ypsh_sep_shared-ie" class="intrnllnk"><code class="argument">ie</code></a>]
= ode23s(<a href="#bu5ypsh_sep_shared-odefun" class="intrnllnk"><code class="argument">odefun</code></a>,<a href="#bu5ypsh_sep_shared-tspan" class="intrnllnk"><code class="argument">tspan</code></a>,<a href="#bu5ypsh_sep_shared-y0" class="intrnllnk"><code class="argument">y0</code></a>,<a href="#bu5ypsh_sep_shared-options" class="intrnllnk"><code class="argument">options</code></a>)</code></span> additionally
finds where functions of <span class="inlineequation">(<em class="varname">t</em>,<em class="varname">y</em>)</span>,
called event functions, are zero. In the output, <code class="literal">te</code> is
the time of the event, <code class="literal">ye</code> is the solution at the
time of the event, and <code class="literal">ie</code> is the index of the triggered
event.</p><p>For each event function, specify whether the integration is
to terminate at a zero and whether the direction of the zero crossing
matters. Do this by setting the <code class="property">'Events'</code> property
to a function, such as <code class="literal">myEventFcn</code> or <code class="literal">@myEventFcn</code>,
and creating a corresponding function: [<code class="literal">value</code>,<code class="literal">isterminal</code>,<code class="literal">direction</code>]
= <code class="literal">myEventFcn</code>(<code class="literal">t</code>,<code class="literal">y</code>).
For more information, see <a href="../math/ode-event-location.html" class="a">ODE Event Location</a>.</p></div></div><div class="description_element"><div class="code_responsive"><p><span id="d126e1208050" itemprop="syntax"><code class="synopsis"><a href="#bu5ypsh_sep_shared-sol" class="intrnllnk"><code class="argument">sol</code></a> = ode23s(<span class="argument_placeholder">___</span>)</code></span> returns
a structure that you can use with <code class="literal">deval</code> to evaluate
the solution at any point on the interval <code class="literal">[t0 tf]</code>.
You can use any of the input argument combinations in previous syntaxes.</p></div></div></div></div></div><div class="clear"></div><div class="examples"><h2 id="bu8towo">Examples</h2><div class="expandableContent" id="expandableExamples"><p class="switch"><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true3">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_bu4ao3t"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu4ao3t" data-bs-target="#expand_accordion_body_bu4ao3t" aria-controls="expand_accordion_body_bu4ao3t" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="bu4ao3t">ODE with Single Solution Component</h3></button></div><div role="tabpanel" id="expand_accordion_body_bu4ao3t" aria-labelledby="expand_accordion_heading_bu4ao3t" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/ODE23sWithSingleSolutionComponentExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "ODE with Single Solution Component",
          "description": "Simple ODEs that have a single solution component can be specified as an anonymous function in the call to the solver. The anonymous function must accept two inputs (t,y), even if one of the inputs is not used in the function.",
          "thumbnailURL": "../../examples/matlab/win64/ODE23sWithSingleSolutionComponentExample_01.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "ode23s.html"

        },
          "identifier": "matlab.ODE23sWithSingleSolutionComponentExample",
          "name": "ODE23sWithSingleSolutionComponentExample",
          "url": "ode23s.html#bu4ao3t"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/ODE23sWithSingleSolutionComponentExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "ODE23sWithSingleSolutionComponentExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Simple ODEs that have a single solution component can be specified as an anonymous function in the call to the solver. The anonymous function must accept two inputs <code class="literal">(t,y)</code>, even if one of the inputs is not used in the function.</p><p>Solve the ODE</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msup><mrow><mi>y</mi></mrow><mrow><mo>′</mo></mrow></msup><mo>=</mo><mo>-</mo><mn>1</mn><mn>0</mn><mi>t</mi><mo stretchy="false">.</mo></mrow></math></p></div><p></p><p>Specify a time interval of <code class="literal">[0 2]</code> and the initial condition <code class="literal">y0 = 1</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>tspan = [0 2];
y0 = 1;
[t,y] = ode23s(@(t,y) -10*t, tspan, y0);</pre></div></div></div><p>Plot the solution.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>plot(t,y,<span style="color:#A020F0">'-o'</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e1208615" class="mediaobject"><p><img src="../../examples/matlab/win64/ODE23sWithSingleSolutionComponentExample_01.png" alt="Figure contains an axes object. The axes object contains an object of type line." width="560"></p></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-ODE23sWithSingleSolutionComponentExample"><meta itemprop="exampletitle" content="ODE with Single Solution Component"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_bu654ce"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu654ce" data-bs-target="#expand_accordion_body_bu654ce" aria-controls="expand_accordion_body_bu654ce" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="bu654ce">Solve Stiff ODE</h3></button></div><div role="tabpanel" id="expand_accordion_body_bu654ce" aria-labelledby="expand_accordion_heading_bu654ce" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/SolveStiffODE23sExample')" data-ex-genre="Script">Open Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Solve Stiff ODE",
          "description": "An example of a stiff system of equations is the van der Pol equations in relaxation oscillation. The limit cycle has regions where the solution components change slowly and the problem is quite stiff, alternating with regions of very sharp change where it is not stiff.",
          "thumbnailURL": "../../examples/matlab/win64/SolveStiffODE23sExample_01.png",
          "genre": "Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "ode23s.html"

        },
          "identifier": "matlab.SolveStiffODE23sExample",
          "name": "SolveStiffODE23sExample",
          "url": "ode23s.html#bu654ce"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/SolveStiffODE23sExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "SolveStiffODE23sExample.m",
        "ode45_plot.png"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script>



<p class="shortdesc">An example of a stiff system of equations is the van der Pol equations in relaxation oscillation. The limit cycle has regions where the solution components change slowly and the problem is quite stiff, alternating with regions of very sharp change where it is not stiff.</p>


<p>The system of equations is:</p>


<p>
<span class="inlineequation"><span class="inlinemediaobject"><img src="../../examples/matlab/win64/SolveStiffODE23sExample_eq17163211524433073085.png" alt="$$\begin{array}{cl} y_1' &amp;#38;= y_2\\y_2' &amp;#38;= 1000(1-y_1^2)y_2-y_1\end{array}$$"></span></span></p>


<p>The initial conditions are <span class="inlineequation"><span class="inlinemediaobject"><img src="../../examples/matlab/win64/SolveStiffODE23sExample_eq12252206373934423633.png" alt="$y_1(0)=2$"></span></span> and <span class="inlineequation"><span class="inlinemediaobject"><img src="../../examples/matlab/win64/SolveStiffODE23sExample_eq02376849379263302628.png" alt="$y_2(0)=0$"></span></span>. The function <code class="literal">vdp1000</code> ships with MATLAB&#174; and encodes the equations.</p>


<p><div class="code_responsive"><pre id="d126e1208684" class="programlisting">
<span style="color:#0000FF">function</span> dydt = vdp1000(t,y)
<span style="color:#228B22">%VDP1000  Evaluate the van der Pol ODEs for mu = 1000.</span>
<span style="color:#228B22">%</span>
<span style="color:#228B22">%   See also ODE15S, ODE23S, ODE23T, ODE23TB.</span>

<span style="color:#228B22">%   Jacek Kierzenka and Lawrence F. Shampine</span>
<span style="color:#228B22">%   Copyright 1984-2014 The MathWorks, Inc.</span>

dydt = [y(2); 1000*(1-y(1)^2)*y(2)-y(1)];

</pre></div></p>


<p>Solving this system using <code class="literal">ode45</code> with the default relative and absolute error tolerances (<code class="literal">1e-3</code> and <code class="literal">1e-6</code>, respectively) is extremely slow, requiring several minutes to solve and plot the solution. <code class="literal">ode45</code> requires millions of time steps to complete the integration, due to the areas of stiffness where it struggles to meet the tolerances.</p>


<p>This is a plot of the solution obtained by <code class="literal">ode45</code>, which takes a long time to compute. Notice the enormous number of time steps required to pass through areas of stiffness.</p>


<p></p>
<div class="informalfigure"><div id="d126e1208706" class="mediaobject"><p><img src="../../examples/matlab/win64/xxode45_plot.png"></p></div></div><p>
 </p>


<div class="procedure"><p>Solve the stiff system using the <code class="literal">ode23s</code> solver, and then plot the first column of the solution <code class="literal">y</code> against the time points <code class="literal">t</code>. The <code class="literal">ode23s</code> solver passes through stiff areas with far fewer steps than <code class="literal">ode45</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[t,y] = ode23s(@vdp1000,[0 3000],[2 0]);
plot(t,y(:,1),<span style="color:#A020F0">'-o'</span>)
</pre></div></div></div><div class="informalfigure"><div id="d126e1208728" class="mediaobject"><p><img src="../../examples/matlab/win64/SolveStiffODE23sExample_01.png"></p></div></div></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-SolveStiffODE23sExample"><meta itemprop="exampletitle" content="Solve Stiff ODE"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_bu654cg"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu654cg" data-bs-target="#expand_accordion_body_bu654cg" aria-controls="expand_accordion_body_bu654cg" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="bu654cg">Pass Extra Parameters to ODE Function</h3></button></div><div role="tabpanel" id="expand_accordion_body_bu654cg" aria-labelledby="expand_accordion_heading_bu654cg" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/PassExtraArgumentsToODE23sFunctionExample')" data-ex-genre="Script">Open Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Pass Extra Parameters to ODE Function",
          "description": "ode23s only works with functions that use two input arguments, t and y. However, you can pass in extra parameters by defining them outside the function and passing them in when you specify the function handle.",
          "thumbnailURL": "../../examples/matlab/win64/PassExtraArgumentsToODE23sFunctionExample_01.png",
          "genre": "Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "ode23s.html"

        },
          "identifier": "matlab.PassExtraArgumentsToODE23sFunctionExample",
          "name": "PassExtraArgumentsToODE23sFunctionExample",
          "url": "ode23s.html#bu654cg"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/PassExtraArgumentsToODE23sFunctionExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "PassExtraArgumentsToODE23sFunctionExample.m",
        "odefcn.m"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script>



<p class="shortdesc">
<code class="literal">ode23s</code> only works with functions that use two input arguments, <code class="literal">t</code> and <code class="literal">y</code>. However, you can pass in extra parameters by defining them outside the function and passing them in when you specify the function handle.</p>


<p>Solve the ODE</p>


<p>
<span class="inlineequation"><span class="inlinemediaobject"><img src="../../examples/matlab/win64/PassExtraArgumentsToODE23sFunctionExample_eq00870404811601308238.png" alt="$$y'' = \frac{A}{B} t y.$$"></span></span></p>


<p>Rewriting the equation as a first-order system yields</p>


<p>
<span class="inlineequation"><span class="inlinemediaobject"><img src="../../examples/matlab/win64/PassExtraArgumentsToODE23sFunctionExample_eq16542843604028967409.png" alt="$$\begin{array}{cl} y'_1 &amp;#38;= y_2\\ y'_2 &amp;#38;= \frac{A}{B} t y_1.&amp;#10;\end{array}$$"></span></span></p>


<p>
<code class="literal">odefcn.m</code> represents this system of equations as a function that accepts four input arguments: <code class="literal">t</code>, <code class="literal">y</code>, <code class="literal">A</code>, and <code class="literal">B</code>.</p>


<p><div class="code_responsive"><pre id="d126e1208813" class="programlisting">
<span style="color:#0000FF">function</span> dydt = odefcn(t,y,A,B)
dydt = zeros(2,1);
dydt(1) = y(2);
dydt(2) = (A/B)*t.*y(1);

</pre></div></p>


<div class="procedure"><p>Solve the ODE using <code class="literal">ode23s</code>. Specify the function handle such that it passes in the predefined values for <code class="literal">A</code> and <code class="literal">B</code> to <code class="literal">odefcn</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>A = 1;
B = 2;
tspan = [0 5];
y0 = [0 0.01];
[t,y] = ode23s(@(t,y) odefcn(t,y,A,B), tspan, y0);
</pre></div></div></div><p>Plot the results.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>plot(t,y(:,1),<span style="color:#A020F0">'-o'</span>,t,y(:,2),<span style="color:#A020F0">'-.'</span>)
</pre></div></div></div><div class="informalfigure"><div id="d126e1208834" class="mediaobject"><p><img src="../../examples/matlab/win64/PassExtraArgumentsToODE23sFunctionExample_01.png"></p></div></div></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-PassExtraArgumentsToODE23sFunctionExample"><meta itemprop="exampletitle" content="Pass Extra Parameters to ODE Function"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_bu654ci"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu654ci" data-bs-target="#expand_accordion_body_bu654ci" aria-controls="expand_accordion_body_bu654ci" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="bu654ci">Compare Stiff ODE Solvers</h3></button></div><div role="tabpanel" id="expand_accordion_body_bu654ci" aria-labelledby="expand_accordion_heading_bu654ci" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/CompareStiffODESolversExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Compare Stiff ODE Solvers",
          "description": "The ode15s solver is a good first choice for most stiff problems. However, the other stiff solvers might be more efficient for certain types of problems. This example solves a stiff test equation using all four stiff ODE solvers.",
          "thumbnailURL": "../../examples/matlab/win64/CompareStiffODESolversExample_01.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "ode23s.html"

        },
          "identifier": "matlab.CompareStiffODESolversExample",
          "name": "CompareStiffODESolversExample",
          "url": "ode23s.html#bu654ci"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/CompareStiffODESolversExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "CompareStiffODESolversExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">The <code class="literal">ode15s</code> solver is a good first choice for most stiff problems. However, the other stiff solvers might be more efficient for certain types of problems. This example solves a stiff test equation using all four stiff ODE solvers.</p><p>Consider the test equation</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msup><mrow><mi>y</mi></mrow><mrow><mo>′</mo></mrow></msup><mo>=</mo><mo>-</mo><mi>λ</mi><mi>y</mi><mo stretchy="false">.</mo></mrow></math></p></div><p></p><p>The equation becomes increasingly stiff as the magnitude of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>λ</mi></mrow></math></span> increases. Use <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>λ</mi><mo>=</mo><mn>1</mn><mo>×</mo><mn>1</mn><msup><mrow><mn>0</mn></mrow><mrow><mn>9</mn></mrow></msup></mrow></math></span> and the initial condition <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>y</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow></math></span> over the time interval <code class="literal">[0 0.5]</code>. With these values, the problem is stiff enough that <code class="literal">ode45</code> and <code class="literal">ode23</code> struggle to integrate the equation. Also, use <code class="literal">odeset</code> to pass in the constant Jacobian <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>J</mi><mo>=</mo><mfrac><mrow><mo>∂</mo><mi>f</mi></mrow><mrow><mo>∂</mo><mi>y</mi></mrow></mfrac><mo>=</mo><mo>-</mo><mi>λ</mi></mrow></math></span> and turn on the display of solver statistics.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>lambda = 1e9;
y0 = 1;
tspan = [0 0.5];
opts = odeset(<span style="color:#A020F0">'Jacobian'</span>,-lambda,<span style="color:#A020F0">'Stats'</span>,<span style="color:#A020F0">'on'</span>);</pre></div></div></div><p>Solve the equation with <code class="literal">ode15s</code>, <code class="literal">ode23s</code>, <code class="literal">ode23t</code>, and <code class="literal">ode23tb</code>. Make subplots for comparison.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>subplot(2,2,1)
tic, ode15s(@(t,y) -lambda*y, tspan, y0, opts), toc</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>104 successful steps
1 failed attempts
212 function evaluations
0 partial derivatives
21 LU decompositions
210 solutions of linear systems
Elapsed time is 3.261408 seconds.
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>title(<span style="color:#A020F0">'ode15s'</span>)
subplot(2,2,2)
tic, ode23s(@(t,y) -lambda*y, tspan, y0, opts), toc</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>63 successful steps
0 failed attempts
191 function evaluations
0 partial derivatives
63 LU decompositions
189 solutions of linear systems
Elapsed time is 0.633155 seconds.
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>title(<span style="color:#A020F0">'ode23s'</span>)
subplot(2,2,3)
tic, ode23t(@(t,y) -lambda*y, tspan, y0, opts), toc</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>95 successful steps
0 failed attempts
125 function evaluations
0 partial derivatives
28 LU decompositions
123 solutions of linear systems
Elapsed time is 0.372408 seconds.
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>title(<span style="color:#A020F0">'ode23t'</span>)
subplot(2,2,4)
tic, ode23tb(@(t,y) -lambda*y, tspan, y0, opts), toc</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>71 successful steps
0 failed attempts
167 function evaluations
0 partial derivatives
23 LU decompositions
236 solutions of linear systems
Elapsed time is 0.601404 seconds.
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>title(<span style="color:#A020F0">'ode23tb'</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e1208965" class="mediaobject"><p><img src="../../examples/matlab/win64/CompareStiffODESolversExample_01.png" alt="Figure contains 4 axes objects. Axes object 1 with title ode15s contains 2 objects of type line. Axes object 2 with title ode23s contains 2 objects of type line. Axes object 3 with title ode23t contains 2 objects of type line. Axes object 4 with title ode23tb contains 2 objects of type line." width="560"></p></div></div><p>The stiff solvers all perform well, but <code class="literal">ode23s</code> completes the integration with the fewest steps and runs the fastest for this particular problem. Since the constant Jacobian is specified, none of the solvers need to calculate partial derivatives to compute the solution. Specifying the Jacobian benefits <code class="literal">ode23s</code> the most since it normally evaluates the Jacobian in every step.</p><p>For general stiff problems, the performance of the stiff solvers varies depending on the format of the problem and specified options. Providing the Jacobian matrix or sparsity pattern always improves solver efficiency for stiff problems. But since the stiff solvers use the Jacobian differently, the improvement can vary significantly. Practically speaking, if a system of equations is very large or needs to be solved many times, then it is worthwhile to investigate the performance of the different solvers to minimize execution time.</p><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-CompareStiffODESolversExample"><meta itemprop="exampletitle" content="Compare Stiff ODE Solvers"></div></div></div></div><div class="ref_sect"><h2 id="bu8tov6">Input Arguments</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="bu8tov6_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="bu5ypsh_sep_shared-odefun"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu5ypsh_sep_shared-odefun" data-bs-target="#expand_accordion_body_bu5ypsh_sep_shared-odefun" aria-controls="expand_accordion_body_bu5ypsh_sep_shared-odefun" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_odefun" class="anchor_target"></span><h3 id="bu5ypsh_sep_shared-odefun"><code itemprop="name">odefun</code> &#8212; <span itemprop="purpose">Functions to solve</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">function handle</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_bu5ypsh_sep_shared-odefun" aria-labelledby="expand_accordion_heading_bu5ypsh_sep_shared-odefun" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_bu5ypsh.shared-odefun"><p>Functions to solve, specified as a function handle that defines the functions to be
                integrated.</p><p>The function <code class="literal">dydt = odefun(t,y)</code>, for a scalar <code class="literal">t</code> and a
                column vector <code class="literal">y</code>, must return a column vector
                    <code class="literal">dydt</code> of data type <code class="literal">single</code> or
                    <code class="literal">double</code> that corresponds to <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><mi>f</mi><mrow><mo>(</mo><mrow><mi>t</mi><mo>,</mo><mi>y</mi></mrow><mo>)</mo></mrow></mrow></math></span></span>. <code class="literal">odefun</code> must accept both input arguments
                    <code class="literal">t</code> and <code class="literal">y</code>, even if one of the arguments is
                not used in the function.</p><p>For example, to solve <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-7px" display="block"><mrow><mi>y</mi><mo>'</mo><mo>=</mo><mn>5</mn><mi>y</mi><mo>−</mo><mn>3</mn></mrow></math></span></span>,
use the function:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> dydt = odefun(t,y)
dydt = 5*y-3;
<span style="color:#0000FF">end</span></pre></div></div></div><p>For a system of equations, the output of <code class="literal">odefun</code> is a vector. Each element
                in the vector is the computed value of the right side of one equation. For example,
                consider the system of two equations</p><div id="d126e1208127" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-17px" display="block"><mtable columnalign="left"><mtr><mtd><mi>y</mi><msub><mo>'</mo><mn>1</mn></msub><mo>=</mo><msub><mi>y</mi><mn>1</mn></msub><mo>+</mo><mn>2</mn><msub><mi>y</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><mi>y</mi><msub><mo>'</mo><mn>2</mn></msub><mo>=</mo><mn>3</mn><msub><mi>y</mi><mn>1</mn></msub><mo>+</mo><mn>2</mn><msub><mi>y</mi><mn>2</mn></msub></mtd></mtr></mtable></math></p></div></div><p>A function that calculates the value of the right side of each equation at each time step
                is</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> dydt = odefun(t,y)
dydt = zeros(2,1);
dydt(1) = y(1)+2*y(2);
dydt(2) = 3*y(1)+2*y(2);
<span style="color:#0000FF">end</span></pre></div></div></div><p>For information on how to provide additional parameters to the
function <code class="function">odefun</code>, see <a href="../math/parameterizing-functions.html" class="a">Parameterizing Functions</a>.</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">@myFcn</code></p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">function_handle</code></p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="bu5ypsh_sep_shared-tspan"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu5ypsh_sep_shared-tspan" data-bs-target="#expand_accordion_body_bu5ypsh_sep_shared-tspan" aria-controls="expand_accordion_body_bu5ypsh_sep_shared-tspan" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_tspan" class="anchor_target"></span><h3 id="bu5ypsh_sep_shared-tspan"><code itemprop="name">tspan</code> &#8212; <span itemprop="purpose">Interval of integration</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">vector</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_bu5ypsh_sep_shared-tspan" aria-labelledby="expand_accordion_heading_bu5ypsh_sep_shared-tspan" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_bu5ypsh.shared-tspan"><p>Interval of integration, specified as a vector. At a minimum, <code class="literal">tspan</code> must be
                a two-element vector <code class="literal">[t0 tf]</code> specifying the initial and final
                times. To obtain solutions at specific times between <code class="literal">t0</code> and
                    <code class="literal">tf</code>, use a longer vector of the form
                    <code class="literal">[t0,t1,t2,...,tf]</code>. The elements in <code class="literal">tspan</code>
                must be all increasing or all decreasing.</p><p>The solver imposes the initial conditions given by <code class="literal">y0</code> at the initial time
                    <code class="literal">tspan(1)</code>, and then integrates from
                    <code class="literal">tspan(1)</code> to <code class="literal">tspan(end)</code>:</p><div class="itemizedlist"><ul><li><p>If <code class="literal">tspan</code> has two elements <code class="literal">[t0 tf]</code>,
                        then the solver returns the solution evaluated at each internal integration
                        step within the interval.</p></li><li><p>If <code class="literal">tspan</code> has more than two elements
                            <code class="literal">[t0,t1,t2,...,tf]</code>, then the solver returns the
                        solution evaluated at the given points. However, the solver does not step
                        precisely to each point specified in <code class="literal">tspan</code>. Instead, the
                        solver uses its own internal steps to compute the solution, and then
                        evaluates the solution at the requested points in <code class="literal">tspan</code>.
                        The solutions produced at the specified points are of the same order of
                        accuracy as the solutions computed at each internal step.</p><p>Specifying several intermediate points has little effect on the efficiency
                        of computation, but can affect memory management for large systems.</p></li></ul></div><p>The values of <code class="literal">tspan</code> are used by the solver to calculate
                suitable values for <code class="literal">InitialStep</code> and <code class="literal">MaxStep</code>:</p>
<div class="itemizedlist"><ul><li><p>If <code class="literal">tspan</code> contains several intermediate points
                                <code class="literal">[t0,t1,t2,...,tf]</code>, then the specified points give
                            an indication of the scale for the problem, which can affect the value
                            of <code class="literal">InitialStep</code> used by the solver. Therefore, the
                            solution obtained by the solver might be different depending on whether
                            you specify <code class="literal">tspan</code> as a two-element vector or as a
                            vector with intermediate points.</p></li><li><p>The initial and final values in <code class="literal">tspan</code> are used to
                            calculate the maximum step size <code class="literal">MaxStep</code>. Therefore,
                            changing the initial or final values in <code class="literal">tspan</code> can
                            cause the solver to use a different step sequence, which might change
                            the solution.</p></li></ul></div><p>
</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">[1 10]</code></p><p class="description_valueexample"><strong>Example: </strong><code class="literal">[1
3 5 7 9 10]</code></p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code></p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="bu5ypsh_sep_shared-y0"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu5ypsh_sep_shared-y0" data-bs-target="#expand_accordion_body_bu5ypsh_sep_shared-y0" aria-controls="expand_accordion_body_bu5ypsh_sep_shared-y0" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_y0" class="anchor_target"></span><h3 id="bu5ypsh_sep_shared-y0"><code itemprop="name">y0</code> &#8212; <span itemprop="purpose">Initial conditions</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">vector</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_bu5ypsh_sep_shared-y0" aria-labelledby="expand_accordion_heading_bu5ypsh_sep_shared-y0" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_bu5ypsh.shared-y0"><p>Initial conditions, specified as a vector. <code class="literal">y0</code> must
be the same length as the vector output of <code class="literal">odefun</code>,
so that <code class="literal">y0</code> contains an initial condition for each
equation defined in <code class="literal">odefun</code>.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code></p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="bu5ypsh_sep_shared-options"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu5ypsh_sep_shared-options" data-bs-target="#expand_accordion_body_bu5ypsh_sep_shared-options" aria-controls="expand_accordion_body_bu5ypsh_sep_shared-options" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_options" class="anchor_target"></span><h3 id="bu5ypsh_sep_shared-options"><code itemprop="name">options</code> &#8212; <span itemprop="purpose">Option structure</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">structure array</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_bu5ypsh_sep_shared-options" aria-labelledby="expand_accordion_heading_bu5ypsh_sep_shared-options" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_bu5ypsh.shared-options"><p>Option structure, specified as a structure array. Use the <a href="odeset.html"><code class="function">odeset</code></a> function to create or modify the <code class="literal">options</code>
                structure. See <a href="../math/summary-of-ode-options.html" class="a">Summary of ODE Options</a> for a list of
                the options compatible with each solver.</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">options = odeset('RelTol',1e-5,'Stats','on','OutputFcn',@odeplot)</code> specifies
a relative error tolerance of <code class="literal">1e-5</code>, turns on the
display of solver statistics, and specifies the output function <code class="literal">@odeplot</code> to
plot the solution as it is computed.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">struct</code></p></div></div></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="bu8towe">Output Arguments</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="bu8towe_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu5ypsh_sep_shared-t" data-bs-target="#expand_accordion_body_bu5ypsh_sep_shared-t" aria-controls="expand_accordion_body_bu5ypsh_sep_shared-t" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_t" class="anchor_target"></span><h3 id="bu5ypsh_sep_shared-t"><code class="name">t</code> &#8212; Evaluation points<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">column vector</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_bu5ypsh_sep_shared-t" aria-labelledby="expand_accordion_heading_bu5ypsh_sep_shared-t" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_bu5ypsh.shared-t"><p>Evaluation points, returned as a column vector.</p><div class="itemizedlist"><ul><li><p>If <code class="literal">tspan</code> contains two elements <code class="literal">[t0
                            tf]</code>, then <code class="literal">t</code> contains the internal
                        evaluation points used to perform the integration.</p></li><li><p>If <code class="literal">tspan</code> contains more than two
elements, then <code class="literal">t</code> is the same as <code class="literal">tspan</code>.</p></li></ul></div></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu5ypsh_sep_shared-y" data-bs-target="#expand_accordion_body_bu5ypsh_sep_shared-y" aria-controls="expand_accordion_body_bu5ypsh_sep_shared-y" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_y" class="anchor_target"></span><h3 id="bu5ypsh_sep_shared-y"><code class="name">y</code> &#8212; Solutions<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">array</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_bu5ypsh_sep_shared-y" aria-labelledby="expand_accordion_heading_bu5ypsh_sep_shared-y" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_bu5ypsh.shared-y"><p>Solutions, returned as an array. Each row in <code class="literal">y</code> corresponds
to the solution at the value returned in the corresponding row of <code class="literal">t</code>.</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu5ypsh_sep_shared-te" data-bs-target="#expand_accordion_body_bu5ypsh_sep_shared-te" aria-controls="expand_accordion_body_bu5ypsh_sep_shared-te" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_te" class="anchor_target"></span><h3 id="bu5ypsh_sep_shared-te"><code class="name">te</code> &#8212; Time of events<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">column vector</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_bu5ypsh_sep_shared-te" aria-labelledby="expand_accordion_heading_bu5ypsh_sep_shared-te" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_bu5ypsh.shared-te"><p>Time of events, returned as a column vector. The event times
in <code class="literal">te</code> correspond to the solutions returned in <code class="literal">ye</code>,
and <code class="literal">ie</code> specifies which event occurred.</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu5ypsh_sep_shared-ye" data-bs-target="#expand_accordion_body_bu5ypsh_sep_shared-ye" aria-controls="expand_accordion_body_bu5ypsh_sep_shared-ye" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_ye" class="anchor_target"></span><h3 id="bu5ypsh_sep_shared-ye"><code class="name">ye</code> &#8212; Solution at time of events<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">array</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_bu5ypsh_sep_shared-ye" aria-labelledby="expand_accordion_heading_bu5ypsh_sep_shared-ye" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_bu5ypsh.shared-ye"><p>Solution at time of events, returned as an array. The event
times in <code class="literal">te</code> correspond to the solutions returned
in <code class="literal">ye</code>, and <code class="literal">ie</code> specifies which
event occurred.</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu5ypsh_sep_shared-ie" data-bs-target="#expand_accordion_body_bu5ypsh_sep_shared-ie" aria-controls="expand_accordion_body_bu5ypsh_sep_shared-ie" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_ie" class="anchor_target"></span><h3 id="bu5ypsh_sep_shared-ie"><code class="name">ie</code> &#8212; Index of triggered event function<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">column vector</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_bu5ypsh_sep_shared-ie" aria-labelledby="expand_accordion_heading_bu5ypsh_sep_shared-ie" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_bu5ypsh.shared-ie"><p>Index of triggered event function, returned as a column vector. The event times in
                    <code class="literal">te</code> correspond to the solutions returned in
                    <code class="literal">ye</code>, and <code class="literal">ie</code> specifies which event
                occurred.</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_bu5ypsh_sep_shared-sol" data-bs-target="#expand_accordion_body_bu5ypsh_sep_shared-sol" aria-controls="expand_accordion_body_bu5ypsh_sep_shared-sol" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_sol" class="anchor_target"></span><h3 id="bu5ypsh_sep_shared-sol"><code class="name">sol</code> &#8212; Structure for evaluation<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">structure array</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_bu5ypsh_sep_shared-sol" aria-labelledby="expand_accordion_heading_bu5ypsh_sep_shared-sol" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_bu5ypsh.shared-sol"><p>Structure for evaluation, returned as a structure array. Use this structure with the <a href="deval.html"><code class="function">deval</code></a> function to evaluate the solution at any point in the interval
                    <code class="literal">[t0 tf]</code>. The <code class="literal">sol</code> structure array always
                includes these fields:</p>
<div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="50%"><col class="tcol2" width="50%"></colgroup><thead><tr><th>Structure Field</th><th>Description</th></tr></thead><tbody><tr><td><p><code class="literal">sol.x</code></p></td><td><p>Row vector of the steps chosen by the
                                    solver.</p></td></tr><tr><td><p><code class="literal">sol.y</code></p></td><td><p>Solutions. Each column <code class="literal">sol.y(:,i)</code>
                                        contains the solution at time
                                        <code class="literal">sol.x(i)</code>.</p></td></tr><tr><td><p><code class="literal">sol.solver</code></p></td><td><p>Solver name.</p></td></tr></tbody></table></div><p>
Additionally, if you specify the <code class="literal">Events</code> option of
                    <code class="function">odeset</code> and events are detected, then <code class="literal">sol</code>
                also includes these fields:</p>
<div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="50%"><col class="tcol2" width="50%"></colgroup><thead><tr><th>Structure Field</th><th>Description</th></tr></thead><tbody><tr><td><p><code class="literal">sol.xe</code></p></td><td><p>Points when events occurred.
                                            <code class="literal">sol.xe(end)</code> contains the exact point
                                        of a terminal event, if any.</p></td></tr><tr><td><p><code class="literal">sol.ye</code></p></td><td><p>Solutions that correspond to events in
                                            <code class="literal">sol.xe</code>.</p></td></tr><tr><td><p><code class="literal">sol.ie</code></p></td><td><p>Indices into the vector returned by the function
                                        specified in the <code class="literal">Events</code> option. The
                                        values indicate which event the solver
                                    detected.</p></td></tr></tbody></table></div><p>
</p></div></div></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="bu8towx">Algorithms</h2><p><code class="function">ode23s</code> is based on a modified Rosenbrock
formula of order 2. Because it is a single-step solver, it may be
more efficient than <code class="function">ode15s</code> at solving problems
that permit crude tolerances or problems with solutions that change
rapidly. It can solve some kinds of stiff problems for which <code class="function">ode15s</code> is
not effective. The <code class="function">ode23s</code> solver evaluates the
Jacobian during each step of the integration, so supplying it with
the Jacobian matrix is critical to its reliability and efficiency <a href="ode23s.html#bu2m56l-1" class="intrnllnk">[1]</a>.</p></div><div class="bibliography"><h2 id="References">References</h2><div id="bu2m56l-1" class="bibliomixed"><p>[1] Shampine, L. F. and M. W. Reichelt, “<a href="https://www.mathworks.com/help/pdf_doc/otherdocs/ode_suite.pdf" target="_blank">The
MATLAB ODE Suite</a>,” <em class="citetitle">SIAM  Journal on Scientific
Computing</em>, Vol. 18, 1997, pp. 1&#8211;22.</p></div></div><div class="ref_sect"><h2 id="refsect-extended-capabilities">Extended Capabilities</h2><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink">expand all</a></p><div id="accordion_refsect-extended-capabilities" role="tablist" aria-multiselectable="true"><span id="mw_550cbe48-7075-4f46-8075-5046fa8ea764" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="bu5ypsh" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_bu5ypsh_codegen" aria-controls="expand_body_bu5ypsh_codegen" class="accordion-button collapsed" aria-expanded="false"><h3 id="bu5ypsh_codegen">C/C++ Code Generation<br/> <span class=" remove_bold add_font_color_general">Generate C and C++ code using MATLAB&#174; Coder&#8482;.</span></h3></button></div><div id="expand_body_bu5ypsh_codegen" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p><span>Usage notes and limitations:</span></p><div class="itemizedlist"><ul><li><p>To generate code you must specify at least the two output arguments evaluation
            points <code class="literal">t</code> and solutions <code class="literal">y</code>.</p></li><li><p>Variable-sizing support must be enabled because code generation requires dynamic
            memory allocation when <code class="argument">tspan</code> has two elements or when you use event
            functions.</p></li><li><p><a href="odeset.html"><code class="function">odeset</code></a> name-value arguments
              <code class="literal">Vectorized</code> and <code class="literal">NormControl</code> must be constant
            during code generation.</p></li></ul></div></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="mw_fc44b089-93c7-4621-8721-5a9779909cd3">Version History</h2><strong>Introduced before R2006a</strong><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink">expand all</a></p><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_mw_6eadd880-6bb0-4279-aa19-dd94b64e83f9" aria-controls="expand_body_mw_6eadd880-6bb0-4279-aa19-dd94b64e83f9" class="accordion-button collapsed" aria-expanded="false"><h3 id="mw_6eadd880-6bb0-4279-aa19-dd94b64e83f9">R2025a: <span class="remove_bold">Code generation support</span></h3></button></div><div id="expand_body_mw_6eadd880-6bb0-4279-aa19-dd94b64e83f9" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>You can generate C/C++ code for the
                                                  <code class="literal">ode23s</code> function.</p></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="bu5ypsh_seealso">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="ode15s.html"><span itemprop="name"><code class="function">ode15s</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="odeset.html"><span itemprop="name"><code class="function">odeset</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="odeget.html"><span itemprop="name"><code class="function">odeget</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="deval.html"><span itemprop="name"><code class="function">deval</code></span></a></span></p><div class="examples_container"><h3 class="remove_border">Topics</h3><div itemprop="content"><ul class="list-unstyled"><li><a href="../math/choose-an-ode-solver.html" class="a">Choose an ODE Solver</a></li><li><a href="../math/summary-of-ode-options.html" class="a">Summary of ODE Options</a></li><li><a href="../math/solve-stiff-odes.html" class="a">Solve Stiff ODEs</a></li><li><a href="../matlab_prog/anonymous-functions.html" class="a">Anonymous Functions</a></li><li><a href="../math/troubleshoot-common-ode-problems.html" class="a">Troubleshoot Common ODE Problems</a></li></ul></div></div></div>
    </div></div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

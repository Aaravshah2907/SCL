<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>bvp4c</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../numerical-integration-and-differential-equations.html",
          "name": "Numerical Integration and Differential Equations"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../boundary-value-problems.html",
          "name": "Boundary Value Problems"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "boundary-value-problems"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExtendedCapabilities",

        "itemListElement":
        [
{
          "@type": "ListItem",
          "position": 1,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "threadsupport",
          "value": "full"

        }
          }
        ]
        }
        </script>
<meta xmlns="http://www.w3.org/1999/xhtml" name="chunktype" content="refpage"><meta xmlns="http://www.w3.org/1999/xhtml" name="refentity" itemprop="refentity" content="function:bvp4c"><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="fcn">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ref/function">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This MATLAB function integrates a system of differential equations of the form y′ = f(x,y) specified by odefun, subject to the boundary conditions described by bcfun and the initial solution guess solinit."><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "refentry";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../numerical-integration-and-differential-equations.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Numerical Integration and Differential Equations</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../boundary-value-problems.html?s_tid=CRUX_lftnav" itemprop="url" id="boundary-value-problems"><span itemprop="title">Boundary Value Problems</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item notranslate"><a href="#responsive_offcanvas"><span class="refname">bvp4c</span></a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-refentry">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li><a href="#mw_e1bc8585-694e-4c6a-b3cd-a93d2c8c0de0" class="intrnllnk">Syntax</a></li><li class="nav-item"><a href="#description" class="nav-link intrnllnk">Description</a></li><li class="nav-item"><a href="#mw_7a30da11-6b84-4714-92cb-8725789f8ff2" class="nav-link intrnllnk">Examples</a><ul class="nav"><li class="nav-item"><a href="#mw_9083ab4d-6cde-4491-95b6-cd9b6313a459" class="nav-link intrnllnk">Solve Second-Order BVP</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_98a60189-597b-435f-96bb-a8f1c64768b1" class="nav-link intrnllnk">Compare <code class="literal">bvp4c</code> and <code class="literal">bvp5c</code> Solvers</a></li></ul></li><li class="nav-item"><a href="#mw_fd7da3f2-44a5-4ee9-aba7-6ffb3f8ae46c" class="nav-link intrnllnk">Input Arguments</a><ul class="nav"><li class="nav-item"><a href="#mw_c99d73e8-d91a-4163-a731-e226641bd259" class="nav-link intrnllnk">odefun</a></li><li class="nav-item"><a href="#mw_7ba7c38a-2ca2-4a8a-9b61-1c2823754fc5" class="nav-link intrnllnk">bcfun</a></li><li class="nav-item"><a href="#mw_72ad7c51-262e-44e2-b88f-e0189720bfb1" class="nav-link intrnllnk">solinit</a></li><li class="nav-item"><a href="#mw_dac0fc70-db47-4b64-8acf-7db8fd3357b8" class="nav-link intrnllnk">options</a></li></ul></li><li class="nav-item"><a href="#mw_166ce972-c0a0-437b-9c66-f08bf2a4ff3d" class="nav-link intrnllnk">Output Arguments</a><ul class="nav"><li class="nav-item"><a href="#mw_b1290b75-2d8f-4755-a71e-914d14935ebc" class="nav-link intrnllnk">sol</a></li></ul></li><li class="nav-item"><a href="#mw_1119c222-d5cc-4a25-bbd5-1bc4318a650e" class="nav-link intrnllnk">More About</a><ul class="nav"><li class="nav-item"><a href="#mw_48e1fd92-2b39-42ce-8a6c-d641415ad659" class="nav-link intrnllnk">Multipoint Boundary Value Problems</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_a0eda3ca-f9d0-4e93-b12d-3cd80fcc5798" class="nav-link intrnllnk">Singular Boundary Value Problems</a></li></ul></li><li class="nav-item"><a href="#mw_d36d3e91-2c5e-4174-91fd-8cfb6ffe1fc2" class="nav-link intrnllnk">Algorithms</a></li><li><a href="#References" class="intrnllnk">References</a></li><li class="nav-item"><a href="#refsect-extended-capabilities" class="nav-link intrnllnk">Extended Capabilities</a></li><li class="nav-item"><a href="#bt5uoob-1_vh" class="nav-link intrnllnk">Version History</a></li><li class="nav-item"><a href="#bt5uoob-1_seealso" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=boundary-value-problems&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=boundary-value-problems&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=boundary-value-problems&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=boundary-value-problems&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=boundary-value-problems&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=boundary-value-problems&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-ref-function"><div class="function_ref"><span id="bt5uoob-1" class="anchor_target"></span><h1 class="r2025b notranslate" itemprop="title"><span class="refname">bvp4c</span></h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">Solve boundary value problem &#8212; fourth-order method</p><div class="switch"><a href="javascript:void(0);" id="expandAllPage" data-allexpanded="true1">collapse all in page</a></div></div></div>
<span id="mw_e1bc8585-694e-4c6a-b3cd-a93d2c8c0de0" class="anchor_target"></span><div class="ref_sect"><h2 id="mw_e1bc8585-694e-4c6a-b3cd-a93d2c8c0de0">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><div class="code_responsive"><code class="synopsis"><a href="#d126e163384" class="intrnllnk">sol = bvp4c(odefun,bcfun,solinit)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e163428" class="intrnllnk">sol = bvp4c(odefun,bcfun,solinit,options)</a></code></div></div></div></div><div class="clear"></div><span id="mw_bb0308a1-741f-4c6f-be28-32407b850abe" class="anchor_target"></span><h2 id="description">Description</h2><div class="descriptions"><div class="cshsummary" id="csh_bt5uoob-1"><div class="description_module"><div class="description_element"><div class="code_responsive"><p><span id="d126e163384" itemprop="syntax"><code class="synopsis"><a href="#mw_b1290b75-2d8f-4755-a71e-914d14935ebc" class="intrnllnk"><code class="argument">sol</code></a> = bvp4c(<a href="#mw_c99d73e8-d91a-4163-a731-e226641bd259" class="intrnllnk"><code class="argument">odefun</code></a>,<a href="#mw_7ba7c38a-2ca2-4a8a-9b61-1c2823754fc5" class="intrnllnk"><code class="argument">bcfun</code></a>,<a href="#mw_72ad7c51-262e-44e2-b88f-e0189720bfb1" class="intrnllnk"><code class="argument">solinit</code></a>)</code></span>
        integrates a system of differential equations of the form <span class="inlineequation"><em class="varname">y</em>′ =
              <em class="varname">f</em>(<em class="varname">x</em>,<em class="varname">y</em>)</span> specified by <code class="literal">odefun</code>, subject to the boundary conditions
        described by <code class="literal">bcfun</code> and the initial solution guess
          <code class="literal">solinit</code>. Use the <a href="bvpinit.html"><code class="function">bvpinit</code></a> function to create the initial guess <code class="literal">solinit</code>, which
        also defines the points at which the boundary conditions in <code class="literal">bcfun</code> are
        enforced.</p></div><p class="syntax_example"><a href="bvp4c.html#mw_9083ab4d-6cde-4491-95b6-cd9b6313a459" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e163428" itemprop="syntax"><code class="synopsis"><a href="#mw_b1290b75-2d8f-4755-a71e-914d14935ebc" class="intrnllnk"><code class="argument">sol</code></a> = bvp4c(<a href="#mw_c99d73e8-d91a-4163-a731-e226641bd259" class="intrnllnk"><code class="argument">odefun</code></a>,<a href="#mw_7ba7c38a-2ca2-4a8a-9b61-1c2823754fc5" class="intrnllnk"><code class="argument">bcfun</code></a>,<a href="#mw_72ad7c51-262e-44e2-b88f-e0189720bfb1" class="intrnllnk"><code class="argument">solinit</code></a>,<a href="#mw_dac0fc70-db47-4b64-8acf-7db8fd3357b8" class="intrnllnk"><code class="argument">options</code></a>)</code></span>
        also uses the integration settings defined by <code class="literal">options</code>, which is an
        argument created using the <a href="bvpset.html"><code class="function">bvpset</code></a> function. For example, use the
          <code class="literal">AbsTol</code> and <code class="literal">RelTol</code> options to specify absolute and
        relative error tolerances, or the <code class="literal">FJacobian</code> option to provide the
        analytical partial derivatives of <code class="literal">odefun</code>.</p></div><p class="syntax_example"><a href="bvp4c.html#mw_98a60189-597b-435f-96bb-a8f1c64768b1" class="intrnllnk">example</a></p></div></div></div></div><div class="clear"></div><div class="examples"><h2 id="mw_7a30da11-6b84-4714-92cb-8725789f8ff2">Examples</h2><div class="expandableContent" id="expandableExamples"><p class="switch"><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true3">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_9083ab4d-6cde-4491-95b6-cd9b6313a459"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_9083ab4d-6cde-4491-95b6-cd9b6313a459" data-bs-target="#expand_accordion_body_mw_9083ab4d-6cde-4491-95b6-cd9b6313a459" aria-controls="expand_accordion_body_mw_9083ab4d-6cde-4491-95b6-cd9b6313a459" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_9083ab4d-6cde-4491-95b6-cd9b6313a459">Solve Second-Order BVP</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_9083ab4d-6cde-4491-95b6-cd9b6313a459" aria-labelledby="expand_accordion_heading_mw_9083ab4d-6cde-4491-95b6-cd9b6313a459" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/SolveSecondOrderBVP4CExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Solve Second-Order BVP",
          "description": "Solve a second-order BVP in MATLAB&#174; using functions. For this example, use the second-order equation",
          "thumbnailURL": "../../examples/matlab/win64/SolveSecondOrderBVP4CExample_01.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "bvp4c.html"

        },
          "identifier": "matlab.SolveSecondOrderBVP4CExample",
          "name": "SolveSecondOrderBVP4CExample",
          "url": "bvp4c.html#mw_9083ab4d-6cde-4491-95b6-cd9b6313a459"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/SolveSecondOrderBVP4CExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "SolveSecondOrderBVP4CExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Solve a second-order BVP in MATLAB&#174; using functions. For this example, use the second-order equation</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><msup><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mo>′</mo></mrow></msup></mrow><mrow><mo>′</mo></mrow></msup><mo>+</mo><mi mathvariant="italic">y</mi><mo>=</mo><mn>0</mn></mrow></math></span>.</p><p>The equation is defined on the interval <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mrow><mo>[</mo><mrow><mn>0</mn><mo>,</mo><mi>π</mi><mo>/</mo><mn>2</mn></mrow><mo>]</mo></mrow></mrow></math></span> subject to the boundary conditions</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">y</mi><mrow><mo>(</mo><mrow><mn>0</mn></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn></mrow></math></span>,</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">y</mi><mrow><mo>(</mo><mrow><mi>π</mi><mo>/</mo><mn>2</mn></mrow><mo>)</mo></mrow><mo>=</mo><mn>2</mn></mrow></math></span>.</p><p>To solve this equation in MATLAB, you need to write a function that represents the equation as a system of first-order equations, a function for the boundary conditions, and a function for the initial guess. Then the BVP solver uses these three inputs to solve the equation.</p><div class="procedure"><span id="SolveSecondOrderBVP4CExample-1" class="anchor_target"></span><p class="title" id="SolveSecondOrderBVP4CExample-1"><b>Code Equation</b></p><p>Write a function that codes the equation. Use the substitutions <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>=</mo><mi mathvariant="italic">y</mi></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>=</mo><msup><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mo>′</mo></mrow></msup></mrow></math></span> to rewrite the equation as a system of first-order equations.</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mrow><mo>′</mo></mrow></msup><mo>=</mo><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></math></span>,</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow><mrow><mo>′</mo></mrow></msup><mo>=</mo><mo>-</mo><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></math></span>.</p><p>The corresponding function is</p><div class="code_responsive"><pre id="d126e163628" class="programlisting"><span style="color:#0000FF">function</span> dydx = bvpfcn(x,y)
dydx = zeros(2,1);
dydx = [y(2)
       -y(1)];
<span style="color:#0000FF">end</span>
</pre></div><p><span class="emphasis"><em>Note: All functions are included at the end of the example as local functions.</em></span></p><span id="SolveSecondOrderBVP4CExample-2" class="anchor_target"></span><p class="title" id="SolveSecondOrderBVP4CExample-2"><b>Code Boundary Conditions</b></p><p>Write a function that codes the boundary conditions in the form <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">g</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">y</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">a</mi></mrow><mo>)</mo></mrow><mo>,</mo><mi mathvariant="italic">y</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">b</mi></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn></mrow></math></span>. In this form the boundary conditions are</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">y</mi><mrow><mo>(</mo><mrow><mn>0</mn></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn></mrow></math></span>,</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">y</mi><mrow><mo>(</mo><mrow><mi>π</mi><mo>/</mo><mn>2</mn></mrow><mo>)</mo></mrow><mo>-</mo><mn>2</mn><mo>=</mo><mn>0</mn></mrow></math></span>.</p><p>The corresponding function is</p><div class="code_responsive"><pre id="d126e163698" class="programlisting"><span style="color:#0000FF">function</span> res = bcfcn(ya,yb)
res = [ya(1)
       yb(1)-2];
<span style="color:#0000FF">end</span>
</pre></div><span id="SolveSecondOrderBVP4CExample-3" class="anchor_target"></span><p class="title" id="SolveSecondOrderBVP4CExample-3"><b>Create Initial Guess</b></p><p>Use the <code class="literal">bvpinit</code> function to create an initial guess for the solution of the equation. Since the equation relates <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><msup><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mo>′</mo></mrow></msup></mrow><mrow><mo>′</mo></mrow></msup></mrow></math></span> to <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">y</mi></mrow></math></span>, a reasonable guess is that the solution involves trigonometric functions. Use a mesh of five points in the interval of integration. The first and last values in the mesh are where the solver applies the boundary conditions.</p><p>The function for the initial guess accepts <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi></mrow></math></span> as an input and returns a guess for the value of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></math></span>. The function is</p><div class="code_responsive"><pre id="d126e163754" class="programlisting"><span style="color:#0000FF">function</span> g = guess(x)
g = [sin(x)
     cos(x)];
<span style="color:#0000FF">end</span>
</pre></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>xmesh = linspace(0,pi/2,5);
solinit = bvpinit(xmesh, @guess);</pre></div></div></div><span id="SolveSecondOrderBVP4CExample-4" class="anchor_target"></span><p class="title" id="SolveSecondOrderBVP4CExample-4"><b>Solve Equation</b></p><p>Use <code class="literal">bvp4c</code> with the derivative function, boundary condition function, and initial guess to solve the problem.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>sol = bvp4c(@bvpfcn, @bcfcn, solinit);</pre></div></div></div><span id="SolveSecondOrderBVP4CExample-5" class="anchor_target"></span><p class="title" id="SolveSecondOrderBVP4CExample-5"><b>Plot Solution</b></p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>plot(sol.x, sol.y, <span style="color:#A020F0">'-o'</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e163771" class="mediaobject"><p><img src="../../examples/matlab/win64/SolveSecondOrderBVP4CExample_01.png" alt="Figure contains an axes object. The axes object contains 2 objects of type line." width="560"></p></div></div><span id="SolveSecondOrderBVP4CExample-6" class="anchor_target"></span><p class="title" id="SolveSecondOrderBVP4CExample-6"><b>Local Functions</b></p><p>Listed here are the local functions that <code class="literal">bvp4c</code> uses to solve the equation.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> dydx = bvpfcn(x,y) <span style="color:#228B22">% equation to solve</span>
dydx = zeros(2,1);
dydx = [y(2)
       -y(1)];
<span style="color:#0000FF">end</span>
<span style="color:#228B22">%--------------------------------</span>
<span style="color:#0000FF">function</span> res = bcfcn(ya,yb) <span style="color:#228B22">% boundary conditions</span>
res = [ya(1)
       yb(1)-2];
<span style="color:#0000FF">end</span>
<span style="color:#228B22">%--------------------------------</span>
<span style="color:#0000FF">function</span> g = guess(x) <span style="color:#228B22">% initial guess for y and y'</span>
g = [sin(x)
     cos(x)];
<span style="color:#0000FF">end</span>
<span style="color:#228B22">%--------------------------------</span></pre></div></div></div></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-SolveSecondOrderBVP4CExample"><meta itemprop="exampletitle" content="Solve SecondOrder BVP"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_98a60189-597b-435f-96bb-a8f1c64768b1"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_98a60189-597b-435f-96bb-a8f1c64768b1" data-bs-target="#expand_accordion_body_mw_98a60189-597b-435f-96bb-a8f1c64768b1" aria-controls="expand_accordion_body_mw_98a60189-597b-435f-96bb-a8f1c64768b1" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_98a60189-597b-435f-96bb-a8f1c64768b1">Compare <code class="literal">bvp4c</code> and <code class="literal">bvp5c</code> Solvers</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_98a60189-597b-435f-96bb-a8f1c64768b1" aria-labelledby="expand_accordion_heading_mw_98a60189-597b-435f-96bb-a8f1c64768b1" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/CompareBvp4cAndBvp5cSolversExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Compare bvp4c and bvp5c Solvers",
          "description": "Solve a BVP at a crude error tolerance with two different solvers and compare the results.",
          "thumbnailURL": "../../examples/matlab/win64/CompareBvp4cAndBvp5cSolversExample_01.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "bvp4c.html"

        },
          "identifier": "matlab.CompareBvp4cAndBvp5cSolversExample",
          "name": "CompareBvp4cAndBvp5cSolversExample",
          "url": "bvp4c.html#mw_98a60189-597b-435f-96bb-a8f1c64768b1"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/CompareBvp4cAndBvp5cSolversExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "CompareBvp4cAndBvp5cSolversExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Solve a BVP at a crude error tolerance with two different solvers and compare the results.</p><p>Consider the second-order ODE </p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><msup><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mo>′</mo></mrow></msup></mrow><mrow><mo>′</mo></mrow></msup><mo>+</mo><mfrac><mrow><mn>2</mn></mrow><mrow><mi mathvariant="italic">x</mi></mrow></mfrac><msup><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mo>′</mo></mrow></msup><mo>+</mo><mfrac><mrow><mn>1</mn></mrow><mrow><msup><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>4</mn></mrow></msup></mrow></mfrac><mi mathvariant="italic">y</mi><mo>=</mo><mn>0</mn></mrow></math></span>.</p><p>The equation is defined on the interval <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mrow><mo>[</mo><mrow><mfrac><mrow><mn>1</mn></mrow><mrow><mn>3</mn><mi>π</mi></mrow></mfrac><mo>,</mo><mn>1</mn></mrow><mo>]</mo></mrow></mrow></math></span> subject to the boundary conditions</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">y</mi><mrow><mo>(</mo><mrow><mfrac><mrow><mn>1</mn></mrow><mrow><mn>3</mn><mi>π</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn></mrow></math></span>,</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">y</mi><mrow><mo>(</mo><mrow><mn>1</mn></mrow><mo>)</mo></mrow><mo>=</mo><mi mathvariant="normal">sin</mi><mrow><mo>(</mo><mrow><mn>1</mn></mrow><mo>)</mo></mrow></mrow></math></span>.</p><p>To solve this equation in MATLAB&#174;, you need to write a function that represents the equation as a system of first-order equations, write a function for the boundary conditions, set some option values, and create an initial guess. Then the BVP solver uses these four inputs to solve the equation.</p><div class="procedure"><span id="bt5uoob-1.CompareBvp4cAndBvp5cSolversExample-1" class="anchor_target"></span><p class="title" id="bt5uoob-1_sep_CompareBvp4cAndBvp5cSolversExample-1"><b>Code Equation</b></p><p>With the substitutions <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>=</mo><mi mathvariant="italic">y</mi></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>=</mo><msup><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mo>′</mo></mrow></msup></mrow></math></span>, you can rewrite the ODE as a system of first-order equations</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mrow><mo>′</mo></mrow></msup><mo>=</mo><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></math></span>,</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow><mrow><mo>′</mo></mrow></msup><mo>=</mo><mo>-</mo><mfrac><mrow><mn>2</mn></mrow><mrow><mi mathvariant="italic">x</mi></mrow></mfrac><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>-</mo><mfrac><mrow><mn>1</mn></mrow><mrow><msup><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>4</mn></mrow></msup></mrow></mfrac><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></math></span>.</p><p>The corresponding function is</p><div class="code_responsive"><pre id="d126e164014" class="programlisting"><span style="color:#0000FF">function</span> dydx = bvpfcn(x,y)
dydx = [y(2)
       -2*y(2)/x - y(1)/x^4];
<span style="color:#0000FF">end</span>
</pre></div><p><span class="emphasis"><em>Note: All functions are included at the end of the example as local functions.</em></span></p><span id="bt5uoob-1.CompareBvp4cAndBvp5cSolversExample-2" class="anchor_target"></span><p class="title" id="bt5uoob-1_sep_CompareBvp4cAndBvp5cSolversExample-2"><b>Code Boundary Conditions</b></p><p>The boundary condition function requires that the boundary conditions are in the form <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">g</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">y</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">a</mi></mrow><mo>)</mo></mrow><mo>,</mo><mi mathvariant="italic">y</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">b</mi></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn></mrow></math></span>. In this form, the boundary conditions are</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">y</mi><mrow><mo>(</mo><mrow><mfrac><mrow><mn>1</mn></mrow><mrow><mn>3</mn><mi>π</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn></mrow></math></span>,</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">y</mi><mrow><mo>(</mo><mrow><mn>1</mn></mrow><mo>)</mo></mrow><mo>-</mo><mi mathvariant="normal">sin</mi><mrow><mo>(</mo><mrow><mn>1</mn></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn></mrow></math></span>.</p><p>The corresponding function is</p><div class="code_responsive"><pre id="d126e164093" class="programlisting"><span style="color:#0000FF">function</span> res = bcfcn(ya,yb)
res = [ya(1)
       yb(1)-sin(1)];
<span style="color:#0000FF">end</span>
</pre></div><span id="bt5uoob-1.CompareBvp4cAndBvp5cSolversExample-3" class="anchor_target"></span><p class="title" id="bt5uoob-1_sep_CompareBvp4cAndBvp5cSolversExample-3"><b>Set Options</b></p><p>Use <code class="literal">bvpset</code> to turn on the display of solver statistics, and specify crude error tolerances to highlight the difference in error control between the solvers. Also, for efficiency, specify the analytical Jacobian</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">J</mi><mo>=</mo><mfrac><mrow><mo>∂</mo><msub><mrow><mi mathvariant="italic">f</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub></mrow><mrow><mo>∂</mo><mi mathvariant="italic">y</mi></mrow></mfrac><mo>=</mo><mrow><mo>[</mo><mtable><mtr><mtd><mrow><mfrac><mrow><mo>∂</mo><msub><mrow><mi mathvariant="italic">f</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mrow><mo>∂</mo><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mfrac><mrow><mo>∂</mo><msub><mrow><mi mathvariant="italic">f</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mrow><mo>∂</mo><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mfrac></mrow></mtd></mtr><mtr><mtd><mrow><mfrac><mrow><mo>∂</mo><msub><mrow><mi mathvariant="italic">f</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow><mrow><mo>∂</mo><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mfrac><mrow><mo>∂</mo><msub><mrow><mi mathvariant="italic">f</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow><mrow><mo>∂</mo><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mfrac></mrow></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable><mtr><mtd><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mn>0</mn></mrow></mtd><mtd><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mn>1</mn></mrow></mtd></mtr><mtr><mtd><mrow><mo>-</mo><mfrac><mrow><mn>1</mn></mrow><mrow><msup><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>4</mn></mrow></msup></mrow></mfrac></mrow></mtd><mtd><mrow><mo>-</mo><mfrac><mrow><mn>2</mn></mrow><mrow><mi mathvariant="italic">x</mi></mrow></mfrac></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow></math></span>.</p><p>The corresponding function that returns the value of the Jacobian is</p><div class="code_responsive"><pre id="d126e164250" class="programlisting"><span style="color:#0000FF">function</span> dfdy = jac(x,y)
dfdy = [0      1
       -1/x^4 -2/x];
<span style="color:#0000FF">end</span>
</pre></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>opts = bvpset(<span style="color:#A020F0">'FJacobian'</span>,@jac,<span style="color:#A020F0">'RelTol'</span>,0.1,<span style="color:#A020F0">'AbsTol'</span>,0.1,<span style="color:#A020F0">'Stats'</span>,<span style="color:#A020F0">'on'</span>);</pre></div></div></div><span id="bt5uoob-1.CompareBvp4cAndBvp5cSolversExample-4" class="anchor_target"></span><p class="title" id="bt5uoob-1_sep_CompareBvp4cAndBvp5cSolversExample-4"><b>Create Initial Guess</b></p><p>Use <code class="literal">bvpinit</code> to create an initial guess of the solution. Specify a constant function as the initial guess with an initial mesh of 10 points in the interval <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mrow><mo>[</mo><mrow><mn>1</mn><mo>/</mo><mn>3</mn><mi>π</mi><mo>,</mo><mn>1</mn></mrow><mo>]</mo></mrow></mrow></math></span>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>xmesh = linspace(1/(3*pi), 1, 10);
solinit = bvpinit(xmesh, [1; 1]);</pre></div></div></div><span id="bt5uoob-1.CompareBvp4cAndBvp5cSolversExample-5" class="anchor_target"></span><p class="title" id="bt5uoob-1_sep_CompareBvp4cAndBvp5cSolversExample-5"><b>Solve Equation</b></p><p>Solve the equation with both <code class="literal">bvp4c</code> and <code class="literal">bvp5c</code>. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>sol4c = bvp4c(@bvpfcn, @bcfcn, solinit, opts);</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>The solution was obtained on a mesh of 9 points.
The maximum residual is  9.794e-02. 
There were 157 calls to the ODE function. 
There were 28 calls to the BC function. 
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>sol5c = bvp5c(@bvpfcn, @bcfcn, solinit, opts);</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>The solution was obtained on a mesh of 11 points.
The maximum error is  6.742e-02. 
There were 244 calls to the ODE function. 
There were 29 calls to the BC function. 
</pre></div></div></div><span id="bt5uoob-1.CompareBvp4cAndBvp5cSolversExample-6" class="anchor_target"></span><p class="title" id="bt5uoob-1_sep_CompareBvp4cAndBvp5cSolversExample-6"><b>Plot Results</b></p><p>Plot the results of the two calculations for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></math></span> with the analytic solution for comparison. The analytic solution is</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>=</mo><mi mathvariant="normal">sin</mi><mrow><mo>(</mo><mrow><mfrac><mrow><mn>1</mn></mrow><mrow><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow></mrow></math></span>,</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>=</mo><mo>-</mo><mfrac><mrow><mn>1</mn></mrow><mrow><msup><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac><mi mathvariant="normal">cos</mi><mrow><mo>(</mo><mrow><mfrac><mrow><mn>1</mn></mrow><mrow><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow></mrow></math></span>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>xplot = linspace(1/(3*pi),1,200);
yplot = [sin(1./xplot); -cos(1./xplot)./xplot.^2];

plot(xplot,yplot(1,:),<span style="color:#A020F0">'k'</span>,sol4c.x,sol4c.y(1,:),<span style="color:#A020F0">'r*'</span>,sol5c.x,sol5c.y(1,:),<span style="color:#A020F0">'bo'</span>)
title(<span style="color:#A020F0">'Comparison of BVP Solvers with Crude Error Tolerance'</span>)
legend(<span style="color:#A020F0">'True'</span>,<span style="color:#A020F0">'BVP4C'</span>,<span style="color:#A020F0">'BVP5C'</span>)
xlabel(<span style="color:#A020F0">'x'</span>)
ylabel(<span style="color:#A020F0">'solution y'</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e164368" class="mediaobject"><p><img src="../../examples/matlab/win64/CompareBvp4cAndBvp5cSolversExample_01.png" alt="Figure contains an axes object. The axes object with title Comparison of BVP Solvers with Crude Error Tolerance, xlabel x, ylabel solution y contains 3 objects of type line. One or more of the lines displays its values using only markers These objects represent True, BVP4C, BVP5C." width="560"></p></div></div><p>The plot confirms that <code class="literal">bvp5c</code> directly controls the true error in the calculation, while <code class="literal">bvp4c</code> controls it only indirectly. At more stringent error tolerances, this difference between the solvers is not as apparent.</p><span id="bt5uoob-1.CompareBvp4cAndBvp5cSolversExample-7" class="anchor_target"></span><p class="title" id="bt5uoob-1_sep_CompareBvp4cAndBvp5cSolversExample-7"><b>Local Functions</b></p><p>Listed here are the local functions that the BVP solvers use to solve the problem.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> dydx = bvpfcn(x,y) <span style="color:#228B22">% equation to solve</span>
dydx = [y(2)
       -2*y(2)/x - y(1)/x^4];
<span style="color:#0000FF">end</span>
<span style="color:#228B22">%---------------------------------</span>
<span style="color:#0000FF">function</span> res = bcfcn(ya,yb) <span style="color:#228B22">% boundary conditions</span>
res = [ya(1)
       yb(1)-sin(1)];
<span style="color:#0000FF">end</span>
<span style="color:#228B22">%---------------------------------</span>
<span style="color:#0000FF">function</span> dfdy = jac(x,y) <span style="color:#228B22">% analytical jacobian for f</span>
dfdy = [0      1
       -1/x^4 -2/x];
<span style="color:#0000FF">end</span>
<span style="color:#228B22">%---------------------------------</span></pre></div></div></div></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-CompareBvp4cAndBvp5cSolversExample"><meta itemprop="exampletitle" content="Compare bvp4c and bvp5c Solvers"></div></div></div></div><div class="ref_sect"><h2 id="mw_fd7da3f2-44a5-4ee9-aba7-6ffb3f8ae46c">Input Arguments</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="mw_fd7da3f2-44a5-4ee9-aba7-6ffb3f8ae46c_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="mw_c99d73e8-d91a-4163-a731-e226641bd259"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_c99d73e8-d91a-4163-a731-e226641bd259" data-bs-target="#expand_accordion_body_mw_c99d73e8-d91a-4163-a731-e226641bd259" aria-controls="expand_accordion_body_mw_c99d73e8-d91a-4163-a731-e226641bd259" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_odefun" class="anchor_target"></span><h3 id="mw_c99d73e8-d91a-4163-a731-e226641bd259"><code itemprop="name">odefun</code> &#8212; <span itemprop="purpose">Functions to solve</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">function handle</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_c99d73e8-d91a-4163-a731-e226641bd259" aria-labelledby="expand_accordion_heading_mw_c99d73e8-d91a-4163-a731-e226641bd259" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_c99d73e8-d91a-4163-a731-e226641bd259"><p>Functions to solve, specified as a function handle that defines the functions to be
            integrated. <code class="literal">odefun</code> and <code class="literal">bcfun</code> must accept the same
            number of input arguments.</p><p>To code <code class="literal">odefun</code>, use the functional signature <code class="literal">dydx =
              odefun(x,y)</code> for a scalar <code class="literal">x</code> and column vector
              <code class="literal">y</code>. The return value <code class="literal">dydx</code> is a column vector of
            data type <code class="literal">single</code> or <code class="literal">double</code> that corresponds to <span class="inlineequation"><em class="varname">f</em>(<em class="varname">x</em>,<em class="varname">y</em>)</span>. <code class="literal">odefun</code> must accept both input arguments
              <code class="literal">x</code> and <code class="literal">y</code>, even if one of the arguments is not
            used in the function.</p><p>For example, to solve <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-7px" display="block"><mrow><mi>y</mi><mo>'</mo><mo>=</mo><mn>5</mn><mi>y</mi><mo>−</mo><mn>3</mn></mrow></math></span></span>, use the function:</p><div class="code_responsive"><pre class="programlisting">function dydx = odefun(x,y)
dydx = 5*y-3;
end</pre></div><p>For a system of equations, the output of <code class="literal">odefun</code> is a vector. Each
            element in the vector is the solution to one equation. For example, to solve</p><div id="d126e164458" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-17px" display="block"><mtable columnalign="left"><mtr><mtd><mi>y</mi><msub><mo>'</mo><mn>1</mn></msub><mo>=</mo><msub><mi>y</mi><mn>1</mn></msub><mo>+</mo><mn>2</mn><msub><mi>y</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><mi>y</mi><msub><mo>'</mo><mn>2</mn></msub><mo>=</mo><mn>3</mn><msub><mi>y</mi><mn>1</mn></msub><mo>+</mo><mn>2</mn><msub><mi>y</mi><mn>2</mn></msub></mtd></mtr></mtable></math></p></div></div><p>use the function:</p><div class="code_responsive"><pre class="programlisting">function dydx = odefun(x,y)
dydx = zeros(2,1);
dydx(1) = y(1)+2*y(2);
dydx(2) = 3*y(1)+2*y(2);
end</pre></div><p><code class="function">bvp4c</code> also can solve problems with <a href="bvp4c.html#mw_a0eda3ca-f9d0-4e93-b12d-3cd80fcc5798" class="intrnllnk">singularities in the
              solution</a> or <a href="bvp4c.html#mw_48e1fd92-2b39-42ce-8a6c-d641415ad659" class="intrnllnk">multipoint boundary
              conditions</a>.</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">sol = bvp4c(@odefun, @bcfun, solinit)</code></p>
            <h4 class="descriptionsect">Unknown Parameters</h4>
            <p>If the BVP being solved includes unknown parameters, you instead can use the
              functional signature <code class="literal">dydx = odefun(x,y,p)</code>, where
                <code class="literal">p</code> is a vector of parameter values. When you use this functional
              signature the BVP solver calculates the values of the unknown parameters starting from
              the initial guess for the parameter values provided in
              <code class="literal">solinit</code>.</p>
          </div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">function_handle</code></p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="mw_7ba7c38a-2ca2-4a8a-9b61-1c2823754fc5"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_7ba7c38a-2ca2-4a8a-9b61-1c2823754fc5" data-bs-target="#expand_accordion_body_mw_7ba7c38a-2ca2-4a8a-9b61-1c2823754fc5" aria-controls="expand_accordion_body_mw_7ba7c38a-2ca2-4a8a-9b61-1c2823754fc5" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_bcfun" class="anchor_target"></span><h3 id="mw_7ba7c38a-2ca2-4a8a-9b61-1c2823754fc5"><code itemprop="name">bcfun</code> &#8212; <span itemprop="purpose">Boundary conditions</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">function handle</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_7ba7c38a-2ca2-4a8a-9b61-1c2823754fc5" aria-labelledby="expand_accordion_heading_mw_7ba7c38a-2ca2-4a8a-9b61-1c2823754fc5" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_7ba7c38a-2ca2-4a8a-9b61-1c2823754fc5"><p>Boundary conditions, specified as a function handle that computes the residual error
            in the boundary conditions. <code class="literal">odefun</code> and <code class="literal">bcfun</code> must
            accept the same number of input arguments.</p><p>To code <code class="literal">bcfun</code>, use the functional signature <code class="literal">res =
              bcfun(ya,yb)</code> for column vectors <code class="literal">ya</code> and
              <code class="literal">yb</code>. The return value <code class="literal">res</code> is a column vector of
            data type <code class="literal">single</code> or <code class="literal">double</code> that corresponds to the
            residual value of the boundary conditions at the boundary points.</p><p>For example, if <em class="varname">y(a) = 1</em> and <em class="varname">y(b) = 0</em>, then
            the boundary condition function
            is<div class="code_responsive"><pre class="programlisting">function res = bcfun(ya,yb)
res = [ya(1)-1
       yb(1)];
end</pre></div>Since
              <em class="varname">y(a) = 1</em>, the residual value of <code class="literal">ya(1)-1</code> should
            be <code class="literal">0</code> at the point <em class="varname">x = a</em>. Similarly, since
              <em class="varname">y(b) = 0</em>, the residual value of <code class="literal">yb(1)</code> should be
              <code class="literal">0</code> at the point <em class="varname">x = b</em>.</p><p>The boundary points <em class="varname">x = a</em> and <em class="varname">x = b</em> where the
            boundary conditions are enforced are defined in the initial guess structure
              <code class="literal">solinit</code>. For two-point boundary value problems, <code class="literal">a =
              solinit.x(1)</code> and <code class="literal">b = solinit.x(end)</code>.</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">sol = bvp4c(@odefun, @bcfun, solinit)</code></p>
            <h4 class="descriptionsect">Unknown Parameters</h4>
            <p>If the BVP being solved includes unknown parameters, you instead can use the
              functional signature <code class="literal">res = bcfun(ya,yb,p)</code>, where
                <code class="literal">p</code> is a vector of parameter values. When you use this functional
              signature the BVP solver calculates the values of the unknown parameters starting from
              the initial guess for the parameter values provided in
              <code class="literal">solinit</code>.</p>
          </div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">function_handle</code></p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="mw_72ad7c51-262e-44e2-b88f-e0189720bfb1"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_72ad7c51-262e-44e2-b88f-e0189720bfb1" data-bs-target="#expand_accordion_body_mw_72ad7c51-262e-44e2-b88f-e0189720bfb1" aria-controls="expand_accordion_body_mw_72ad7c51-262e-44e2-b88f-e0189720bfb1" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_solinit" class="anchor_target"></span><h3 id="mw_72ad7c51-262e-44e2-b88f-e0189720bfb1"><code itemprop="name">solinit</code> &#8212; <span itemprop="purpose">Initial guess of solution</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">structure</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_72ad7c51-262e-44e2-b88f-e0189720bfb1" aria-labelledby="expand_accordion_heading_mw_72ad7c51-262e-44e2-b88f-e0189720bfb1" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_72ad7c51-262e-44e2-b88f-e0189720bfb1"><p>Initial guess of solution, specified as a structure. Use <a href="bvpinit.html"><code class="function">bvpinit</code></a> to create <code class="literal">solinit</code>.</p><p>Unlike initial value problems, a boundary value problem can have no solution, a
            finite number of solutions, or infinitely many solutions. An important part of the
            process of solving a BVP is providing a guess for the required solution. The quality of
            this guess can be critical for the solver performance and even for a successful
            computation. For some guidelines on creating a good initial guess, see <a href="../math/boundary-value-problems.html#f1-694073" class="a">Initial Guess of Solution</a>.</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">sol = bvp4c(@odefun, @bcfun, solinit)</code></p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">struct</code></p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="mw_dac0fc70-db47-4b64-8acf-7db8fd3357b8"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_dac0fc70-db47-4b64-8acf-7db8fd3357b8" data-bs-target="#expand_accordion_body_mw_dac0fc70-db47-4b64-8acf-7db8fd3357b8" aria-controls="expand_accordion_body_mw_dac0fc70-db47-4b64-8acf-7db8fd3357b8" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_options" class="anchor_target"></span><h3 id="mw_dac0fc70-db47-4b64-8acf-7db8fd3357b8"><code itemprop="name">options</code> &#8212; <span itemprop="purpose">Option structure</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">structure</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_dac0fc70-db47-4b64-8acf-7db8fd3357b8" aria-labelledby="expand_accordion_heading_mw_dac0fc70-db47-4b64-8acf-7db8fd3357b8" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_dac0fc70-db47-4b64-8acf-7db8fd3357b8"><p>Option structure. Use the <a href="bvpset.html"><code class="function">bvpset</code></a> function to create or modify the
            options structure.</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">options = bvpset('RelTol',1e-5,'Stats','on')</code> specifies a
            relative error tolerance of <code class="literal">1e-5</code> and turns on the display of solver
            statistics.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">struct</code></p></div></div></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="mw_166ce972-c0a0-437b-9c66-f08bf2a4ff3d">Output Arguments</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="mw_166ce972-c0a0-437b-9c66-f08bf2a4ff3d_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_b1290b75-2d8f-4755-a71e-914d14935ebc" data-bs-target="#expand_accordion_body_mw_b1290b75-2d8f-4755-a71e-914d14935ebc" aria-controls="expand_accordion_body_mw_b1290b75-2d8f-4755-a71e-914d14935ebc" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_sol" class="anchor_target"></span><h3 id="mw_b1290b75-2d8f-4755-a71e-914d14935ebc"><code class="name">sol</code> &#8212; Solution structure<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">structure</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_b1290b75-2d8f-4755-a71e-914d14935ebc" aria-labelledby="expand_accordion_heading_mw_b1290b75-2d8f-4755-a71e-914d14935ebc" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_b1290b75-2d8f-4755-a71e-914d14935ebc"><p>Solution structure. You can access the fields in <code class="literal">sol</code> with
            dot-indexing, such as <code class="literal">sol.field1</code>. The solution
              (<code class="literal">sol.x</code>,<code class="literal">sol.y</code>) is continuous on the interval of
            integration defined in the initial mesh <code class="literal">solinit.x</code> and has a
            continuous first derivative there. You can use <code class="literal">sol</code> with the <a href="deval.html"><code class="function">deval</code></a> function to evaluate the solution at other points in the
            interval.</p><p>The structure <code class="literal">sol</code> has these fields.</p>
<div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="50%"><col class="tcol2" width="50%"></colgroup><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><p id="bt5uooc-13"><code class="literal">x</code></p></td><td><p>Mesh selected by <code class="function">bvp4c</code>. This mesh typically
                        contains different points than the initial mesh
                        <code class="literal">solinit.x</code>.</p></td></tr><tr><td><p id="bt5uooc-14"><code class="literal">y</code></p></td><td><p>Approximation to <span class="inlineequation"><em class="varname">y</em>(<em class="varname">x</em>)</span> at the mesh points of
                      <code class="literal">sol.x</code>.</p></td></tr><tr><td><p id="bt5uooc-15"><code class="literal">yp</code></p></td><td><p>Approximation to <span class="inlineequation"><em class="varname">y</em>′(<em class="varname">x</em>)</span> at the mesh points of
                      <code class="literal">sol.x</code>.</p></td></tr><tr><td><p id="bt5uooc-16"><code class="literal">parameters</code></p></td><td><p>Final values for the unknown parameters specified in
                          <code class="literal">solinit.parameters</code>.</p></td></tr><tr><td><p id="bt5uooc-17"><code class="literal">solver</code></p></td><td><p id="bt5uooc-18"><code class="literal">'bvp4c'</code></p></td></tr><tr><td><p id="bt5uooc-19"><code class="literal">stats</code></p></td><td><p>Computational cost statistics related to the solution: the number
                        of mesh points, residual error, and number of calls to
                          <code class="literal">odefun</code> and <code class="literal">bcfun</code>.</p></td></tr></tbody></table></div><p>
</p></div></div></div></div></div></div></div></div></div></div><div class="moreabout ref_sect"><h2 id="mw_1119c222-d5cc-4a25-bbd5-1bc4318a650e">More About</h2><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true2">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_mw_48e1fd92-2b39-42ce-8a6c-d641415ad659" aria-controls="expand_body_mw_48e1fd92-2b39-42ce-8a6c-d641415ad659" class="accordion-button" aria-expanded="true"><h3 id="mw_48e1fd92-2b39-42ce-8a6c-d641415ad659">Multipoint Boundary Value Problems</h3></button></div><div id="expand_body_mw_48e1fd92-2b39-42ce-8a6c-d641415ad659" class="accordion-collapse collapsed collapse show"><div class="accordion-body"><p class="shortdesc">For multipoint boundary value problems, the boundary conditions are
        enforced at several points in the interval of integration.</p><p><code class="function">bvp4c</code> can solve multipoint boundary value problems where <span class="inlineequation"><em class="varname">a</em>&nbsp;=&nbsp;<em class="varname">a</em><sub>0</sub>&nbsp;&lt;&nbsp;<em class="varname">a</em><sub>1</sub>&nbsp;&lt;&nbsp;<em class="varname">a</em><sub>2</sub>&nbsp;&lt;&nbsp;...&lt;&nbsp;<em class="varname">a</em><sub><em class="varname">n</em></sub>&nbsp;=&nbsp;<em class="varname">b</em></span> are boundary points in the interval
          [<em class="varname">a</em>,<em class="varname">b</em>]. The points <span class="inlineequation"><em class="varname">a</em><sub>1</sub>,<em class="varname">a</em><sub>2</sub>,...<em class="varname">,a</em><sub><em class="varname">n</em>−1</sub></span> represent interfaces that divide
          [<em class="varname">a</em>,<em class="varname">b</em>] into regions. <code class="literal">bvp4c</code>
        enumerates the regions from left to right (from <em class="varname">a</em> to
        <em class="varname">b</em>), with indices starting from 1. In region <em class="varname">k</em>,
          [<em class="varname">a</em><sub><em class="varname">k</em>−1</sub>,<em class="varname">a</em><em class="varname"><sub>k</sub></em>],
          <code class="literal">bvp4c</code> evaluates the derivative as </p><div class="code_responsive"><pre class="programlisting">yp = odefun(x,y,k) </pre></div><p>In the boundary conditions function <code class="literal">bcfun(yleft,yright)</code>,
          <code class="literal">yleft(:,k)</code> is the solution at the left boundary of
          [<em class="varname">a</em><sub><em class="varname">k</em>−1</sub>,<em class="varname">a</em><em class="varname"><sub>k</sub></em>].
        Similarly, <code class="literal">yright(:,k)</code> is the solution at the right boundary of region
          <em class="varname">k</em>. In particular, <code class="literal">yleft(:,1) = y(a)</code> and
          <code class="literal">yright(:,end) = y(b)</code>.</p><p>When you create an initial guess with <code class="function">bvpinit</code>, use double entries
        in <code class="literal">xinit</code> for each interface point. See the reference page for <a href="bvpinit.html"><code class="function">bvpinit</code></a> for more information.</p><p>If <code class="function">yinit</code> is a function, <code class="literal">bvpinit</code> calls <code class="literal">y
          = yinit(x,k)</code> to get an initial guess for the solution at <code class="literal">x</code> in
        region <code class="literal">k</code>. In the solution structure <code class="literal">sol</code> returned by
          <code class="literal">bpv4c</code>, <code class="literal">sol.x</code> has double entries for each interface
        point. The corresponding columns of <code class="literal">sol.y</code> contain the left and right
        solution at the interface, respectively.</p><p>See <a href="../math/solve-bvp-with-multiple-boundary-conditions.html" class="a">Solve BVP with Multiple Boundary Conditions</a> for an example that solves a three-point boundary
        value problem.</p></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_mw_a0eda3ca-f9d0-4e93-b12d-3cd80fcc5798" aria-controls="expand_body_mw_a0eda3ca-f9d0-4e93-b12d-3cd80fcc5798" class="accordion-button" aria-expanded="true"><h3 id="mw_a0eda3ca-f9d0-4e93-b12d-3cd80fcc5798">Singular Boundary Value Problems</h3></button></div><div id="expand_body_mw_a0eda3ca-f9d0-4e93-b12d-3cd80fcc5798" class="accordion-collapse collapsed collapse show"><div class="accordion-body"><p class="shortdesc"><code class="function">bvp4c</code> solves a class of singular boundary value
        problems, including problems with unknown parameters <code class="literal">p</code>, of the
        form</p><div id="d126e164948" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-27px" display="block"><mtable columnalign="left"><mtr><mtd><mi>y</mi><mo>'</mo><mo>=</mo><mi>S</mi><mfrac><mi>y</mi><mi>x</mi></mfrac><mo>+</mo><mi>f</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>p</mi></mrow><mo>)</mo></mrow><mo>,</mo></mtd></mtr><mtr><mtd><mn>0</mn><mo>=</mo><mi>b</mi><mi>c</mi><mrow><mo>(</mo><mrow><mi>y</mi><mrow><mo>(</mo><mn>0</mn><mo>)</mo></mrow><mo>,</mo><mi>y</mi><mrow><mo>(</mo><mi>b</mi><mo>)</mo></mrow><mo>,</mo><mi>p</mi></mrow><mo>)</mo></mrow><mo>.</mo></mtd></mtr></mtable></math></p></div></div><p>The interval is required to be [0, <em class="varname">b</em>] with <em class="varname">b</em> &gt;
        0. Often such problems arise when computing a smooth solution of ODEs that result from
        partial differential equations (PDEs) due to cylindrical or spherical symmetry. For singular
        problems, you specify the (constant) matrix <code class="literal">S</code> as the value of the
          <code class="literal">'SingularTerm'</code> option of <a href="bvpset.html"><code class="function">bvpset</code></a>, and <code class="literal">odefun</code> evaluates only
          <em class="varname">f</em>(<em class="varname">x</em>,<em class="varname">y</em>,<em class="varname">p</em>). The
        boundary conditions and initial guess must be consistent with the necessary condition for
        smoothness <span class="inlineequation"><em class="varname">S</em>·<em class="varname">y</em>(0)&nbsp;=&nbsp;0</span>.</p><p>See <a href="../math/solve-bvp-with-singular-term.html" class="a">Solve BVP with Singular Term</a> for an example that solves a singular boundary value
        problem.</p></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="mw_d36d3e91-2c5e-4174-91fd-8cfb6ffe1fc2">Algorithms</h2><p><code class="function">bvp4c</code> is a finite difference code that implements the three-stage
      Lobatto IIIa formula <a href="bvp4c.html#mw_78012aaf-84dd-4ed0-98b3-8b511a0dd1e3" class="intrnllnk">[1]</a>, <a href="bvp4c.html#mw_555b7dc1-2da4-4d72-8ea5-5f598bde1562" class="intrnllnk">[2]</a>. This is a collocation
      formula and the collocation polynomial provides a C<sup>1</sup>-continuous
      solution that is fourth-order accurate uniformly in the interval of integration. Mesh
      selection and error control are based on the residual of the continuous solution.</p><p>The collocation technique uses a mesh of points to divide the interval of integration into
      subintervals. The solver determines a numerical solution by solving a global system of
      algebraic equations resulting from the boundary conditions, and the collocation conditions
      imposed on all the subintervals. The solver then estimates the error of the numerical solution
      on each subinterval. If the solution does not satisfy the tolerance criteria, the solver
      adapts the mesh and repeats the process. You <span class="emphasis"><em>must</em></span> provide
      the points of the initial mesh, as well as an initial approximation of the solution at the
      mesh points.</p></div><div class="bibliography"><h2 id="References">References</h2><div id="mw_78012aaf-84dd-4ed0-98b3-8b511a0dd1e3" class="bibliomixed"><p>[1] Shampine, L.F., and J. Kierzenka.
      "A BVP Solver based on residual control and the MATLAB PSE." <span class="emphasis"><em>ACM
        Trans. Math. Softw.</em></span> Vol. 27, Number 3, 2001, pp. 299&#8211;316.</p></div><div id="mw_555b7dc1-2da4-4d72-8ea5-5f598bde1562" class="bibliomixed"><p>[2] Shampine, L.F., M.W. Reichelt, and
      J. Kierzenka. "<a href="https://www.mathworks.com/matlabcentral/fileexchange/3819-tutorial-on-solving-bvps-with-bvp4c">Solving Boundary Value Problems for Ordinary Differential Equations in MATLAB with
        bvp4c</a>." <em class="citetitle">MATLAB File Exchange</em>, 2004.</p></div></div><div class="ref_sect"><h2 id="refsect-extended-capabilities">Extended Capabilities</h2><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink">expand all</a></p><div id="accordion_refsect-extended-capabilities" role="tablist" aria-multiselectable="true"><span id="mw_2b133e9d-2bf7-4a20-ae05-1fc56217d086" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="bt5uoob-1" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_bt5uoob-1_threadsupport" aria-controls="expand_body_bt5uoob-1_threadsupport" class="accordion-button collapsed" aria-expanded="false"><h3 id="bt5uoob-1_threadsupport">Thread-Based Environment<br/> <span class=" remove_bold add_font_color_general">Run code in the background using MATLAB&#174; <code class="function">backgroundPool</code> or accelerate code with Parallel Computing Toolbox&#8482; <code class="function">ThreadPool</code>.</span></h3></button></div><div id="expand_body_bt5uoob-1_threadsupport" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>This function fully supports thread-based environments. For
                more information, see <a href="../matlab_prog/run-functions-on-threads.html" class="a">Run MATLAB Functions in Thread-Based Environment</a>.</p></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="bt5uoob-1_vh">Version History</h2><p><strong>Introduced before R2006a</strong></p></div><div class="ref_sect"><h2 id="bt5uoob-1_seealso">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="bvp5c.html"><span itemprop="name"><code class="function">bvp5c</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="bvpget.html"><span itemprop="name"><code class="function">bvpget</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="bvpinit.html"><span itemprop="name"><code class="function">bvpinit</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="bvpset.html"><span itemprop="name"><code class="function">bvpset</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="bvpxtend.html"><span itemprop="name"><code class="function">bvpxtend</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="deval.html"><span itemprop="name"><code class="function">deval</code></span></a></span></p><div class="examples_container"><h3 class="remove_border">Topics</h3><div itemprop="content"><ul class="list-unstyled"><li><a href="../math/boundary-value-problems.html" class="a">Solving Boundary Value Problems</a></li></ul></div></div></div>
    </div></div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>lsqr</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../sparse-matrices.html",
          "name": "Sparse Matrices"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "sparse-matrices"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExtendedCapabilities",

        "itemListElement":
        [
{
          "@type": "ListItem",
          "position": 1,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "distributedarrays",
          "value": "limited"

        }
          },
{
          "@type": "ListItem",
          "position": 2,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "gpuarrays",
          "value": "limited"

        }
          },
{
          "@type": "ListItem",
          "position": 3,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "threadsupport",
          "value": "full"

        }
          }
        ]
        }
        </script>
<meta xmlns="http://www.w3.org/1999/xhtml" name="chunktype" content="refpage"><meta xmlns="http://www.w3.org/1999/xhtml" name="refentity" itemprop="refentity" content="function:lsqr"><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="fcn">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ref/function">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This MATLAB function attempts to solve the system of linear equations A*x = b for x using the Least Squares Method."><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "refentry";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../sparse-matrices.html?s_tid=CRUX_lftnav" itemprop="url" id="sparse-matrices"><span itemprop="title">Sparse Matrices</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item notranslate"><a href="#responsive_offcanvas"><span class="refname">lsqr</span></a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-refentry">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li><a href="#mw_a24d7a9d-6e63-43e3-8f5e-cfe164e66329" class="intrnllnk">Syntax</a></li><li class="nav-item"><a href="#description" class="nav-link intrnllnk">Description</a></li><li class="nav-item"><a href="#mw_63136ef0-3d7a-46be-8571-1cdc4c63d0fb" class="nav-link intrnllnk">Examples</a><ul class="nav"><li class="nav-item"><a href="#mw_ddd73a34-5aa5-4fee-85dc-cbb1da014c9c" class="nav-link intrnllnk">Iterative Solution to Linear System</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_1623f240-80ec-4c6e-b5b4-d849eeeae472" class="nav-link intrnllnk">Using <code class="literal">lsqr</code> with Preconditioner</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_42ba30c9-0255-4c93-89c2-78b8d0b16b87" class="nav-link intrnllnk">Supplying Initial Guess</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_dc900168-8ddd-4512-9ad1-42e971327073" class="nav-link intrnllnk">Using Function Handle Instead of Numeric Matrix</a></li></ul></li><li class="nav-item"><a href="#mw_a0d08df6-302d-4f96-8a09-1d164db65d16" class="nav-link intrnllnk">Input Arguments</a><ul class="nav"><li class="nav-item"><a href="#mw_3eec56d0-e068-49a8-8dff-01d7ab9782d9" class="nav-link intrnllnk">A</a></li><li class="nav-item"><a href="#f89-999296_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" class="nav-link intrnllnk">b</a></li><li class="nav-item"><a href="#f89-999296_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="nav-link intrnllnk">tol</a></li><li class="nav-item"><a href="#f89-999296_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" class="nav-link intrnllnk">maxit</a></li><li class="nav-item"><a href="#f89-999296_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" class="nav-link intrnllnk">M</a><a href="#f89-999296_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" class="nav-link intrnllnk">M1</a><a href="#f89-999296_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" class="nav-link intrnllnk">M2</a></li><li class="nav-item"><a href="#f89-999296_sep_mw_40e27791-2264-4d42-8cb6-b8bf869783bc" class="nav-link intrnllnk">x0</a></li></ul></li><li class="nav-item"><a href="#mw_b0415add-c660-426a-a08c-5a7fc650e469" class="nav-link intrnllnk">Output Arguments</a><ul class="nav"><li class="nav-item"><a href="#f89-999296_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="nav-link intrnllnk">x</a></li><li class="nav-item"><a href="#f89-999296_sep_mw_1f278699-812f-4628-8d99-e8f6ae362e34" class="nav-link intrnllnk">flag</a></li><li class="nav-item"><a href="#f89-999296_sep_mw_6de229ba-091b-4137-acf4-6c7691a0398c" class="nav-link intrnllnk">relres</a></li><li class="nav-item"><a href="#f89-999296_sep_mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4" class="nav-link intrnllnk">iter</a></li><li class="nav-item"><a href="#f89-999296_sep_mw_e2a3240f-74d0-4b34-943e-502f3dd9d174" class="nav-link intrnllnk">resvec</a></li><li class="nav-item"><a href="#mw_e22e7d07-6c93-446d-8811-040d5523a7c6" class="nav-link intrnllnk">lsvec</a></li></ul></li><li class="nav-item"><a href="#mw_fcea744a-710d-4c19-a075-f60d83635d03" class="nav-link intrnllnk">More About</a><ul class="nav"><li class="nav-item"><a href="#mw_783f22d5-a612-4382-acb8-a4635fb42b52" class="nav-link intrnllnk">Least Squares Method</a></li></ul></li><li class="nav-item"><a href="#f89-999296_sep_mw_021450b1-4be9-4d57-b903-c4a2d800c810" class="nav-link intrnllnk">Tips</a></li><li><a href="#References" class="intrnllnk">References</a></li><li class="nav-item"><a href="#refsect-extended-capabilities" class="nav-link intrnllnk">Extended Capabilities</a></li><li class="nav-item"><a href="#mw_30ca6faa-b156-4980-9d0a-1c9d612db7d1" class="nav-link intrnllnk">Version History</a><ul class="nav"><li class="nav-item"><a href="#f89-999296_sep_mw_7463413e-98d4-46c3-a401-f17c5cf7a6c1" class="nav-link intrnllnk">Specify single-precision input arguments</a></li></ul></li><li class="nav-item"><a href="#f89-999296_seealso" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=sparse-matrices&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=sparse-matrices&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=sparse-matrices&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=sparse-matrices&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=sparse-matrices&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=sparse-matrices&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-ref-function"><div class="function_ref"><span id="f89-999296" class="anchor_target"></span><h1 class="r2025b notranslate" itemprop="title"><span class="refname">lsqr</span></h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">Solve system of linear equations &#8212; least-squares method</p><div class="switch"><a href="javascript:void(0);" id="expandAllPage" data-allexpanded="true1">collapse all in page</a></div></div></div>
<span id="mw_a24d7a9d-6e63-43e3-8f5e-cfe164e66329" class="anchor_target"></span><div class="ref_sect"><h2 id="mw_a24d7a9d-6e63-43e3-8f5e-cfe164e66329">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><div class="code_responsive"><code class="synopsis"><a href="#d126e1022763" class="intrnllnk">x = lsqr(A,b)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1022801" class="intrnllnk">x = lsqr(A,b,tol)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1022822" class="intrnllnk">x = lsqr(A,b,tol,maxit)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1022847" class="intrnllnk">x = lsqr(A,b,tol,maxit,M)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1022886" class="intrnllnk">x = lsqr(A,b,tol,maxit,M1,M2)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1022916" class="intrnllnk">x = lsqr(A,b,tol,maxit,M1,M2,x0)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1022946" class="intrnllnk">[x,flag] = lsqr(<span class="argument_placeholder">___</span>)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1022970" class="intrnllnk">[x,flag,relres] = lsqr(<span class="argument_placeholder">___</span>)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1023009" class="intrnllnk">[x,flag,relres,iter] = lsqr(<span class="argument_placeholder">___</span>)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1023035" class="intrnllnk">[x,flag,relres,iter,resvec] = lsqr(<span class="argument_placeholder">___</span>)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1023063" class="intrnllnk">[x,flag,relres,iter,resvec,lsvec] = lsqr(<span class="argument_placeholder">___</span>)</a></code></div></div></div></div><div class="clear"></div><span id="mw_fd0ecc60-080d-4f71-bb55-f5532f10a8e9" class="anchor_target"></span><h2 id="description">Description</h2><div class="descriptions"><div class="cshsummary" id="csh_f89-999296"><div class="description_module"><div class="description_element"><div class="code_responsive"><p><span id="d126e1022763" itemprop="syntax"><code class="synopsis"><a href="#f89-999296_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a> = lsqr(<a href="#mw_3eec56d0-e068-49a8-8dff-01d7ab9782d9" class="intrnllnk"><code class="argument">A</code></a>,<a href="#f89-999296_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" class="intrnllnk"><code class="argument">b</code></a>)</code></span>
        attempts to solve the system of linear equations <code class="literal">A*x = b</code> for
          <code class="literal">x</code> using the <a href="lsqr.html#mw_783f22d5-a612-4382-acb8-a4635fb42b52" class="intrnllnk">Least Squares Method</a>.
          <code class="function">lsqr</code> finds a least squares solution for <code class="literal">x</code> that
        minimizes <code class="literal">norm(b-A*x)</code>. When <code class="literal">A</code> is consistent, the least
        squares solution is also a solution of the linear system. When the attempt is successful,
          <code class="function">lsqr</code> displays a message to confirm convergence. If
          <code class="function">lsqr</code> fails to converge after the maximum number of iterations or
        halts for any reason, it displays a diagnostic message that includes the relative residual
          <code class="literal">norm(b-A*x)/norm(b)</code> and the iteration number at which the method
        stopped.</p></div><p class="syntax_example"><a href="lsqr.html#mw_ddd73a34-5aa5-4fee-85dc-cbb1da014c9c" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e1022801" itemprop="syntax"><code class="synopsis"><a href="#f89-999296_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a> = lsqr(<a href="#mw_3eec56d0-e068-49a8-8dff-01d7ab9782d9" class="intrnllnk"><code class="argument">A</code></a>,<a href="#f89-999296_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" class="intrnllnk"><code class="argument">b</code></a>,<a href="#f89-999296_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="intrnllnk"><code class="argument">tol</code></a>)</code></span>
        specifies a tolerance for the method. The default tolerance is
        <code class="literal">1e-6</code>.</p></div><p class="syntax_example"><a href="lsqr.html#mw_ddd73a34-5aa5-4fee-85dc-cbb1da014c9c" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e1022822" itemprop="syntax"><code class="synopsis"><a href="#f89-999296_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a> = lsqr(<a href="#mw_3eec56d0-e068-49a8-8dff-01d7ab9782d9" class="intrnllnk"><code class="argument">A</code></a>,<a href="#f89-999296_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" class="intrnllnk"><code class="argument">b</code></a>,<a href="#f89-999296_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="intrnllnk"><code class="argument">tol</code></a>,<a href="#f89-999296_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" class="intrnllnk"><code class="argument">maxit</code></a>)</code></span>
        specifies the maximum number of iterations to use. <code class="function">lsqr</code> displays a
        diagnostic message if it fails to converge within <code class="literal">maxit</code>
        iterations.</p></div><p class="syntax_example"><a href="lsqr.html#mw_ddd73a34-5aa5-4fee-85dc-cbb1da014c9c" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e1022847" itemprop="syntax"><code class="synopsis"><a href="#f89-999296_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a> = lsqr(<a href="#mw_3eec56d0-e068-49a8-8dff-01d7ab9782d9" class="intrnllnk"><code class="argument">A</code></a>,<a href="#f89-999296_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" class="intrnllnk"><code class="argument">b</code></a>,<a href="#f89-999296_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="intrnllnk"><code class="argument">tol</code></a>,<a href="#f89-999296_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" class="intrnllnk"><code class="argument">maxit</code></a>,<a href="#f89-999296_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" class="intrnllnk"><code class="argument">M</code></a>)</code></span>
        specifies a preconditioner matrix <code class="literal">M</code> and computes <code class="literal">x</code> by
        effectively solving the system <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-7px" display="block"><mrow><mi>A</mi><msup><mi>M</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>y</mi><mo>=</mo><mi>b</mi></mrow></math></span></span> for <em class="varname">y</em>, where <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-7px" display="block"><mrow><mi>y</mi><mo>=</mo><mi>M</mi><mi>x</mi></mrow></math></span></span>. Using a preconditioner matrix can improve the numerical properties of the
        problem and the efficiency of the calculation.</p></div><p class="syntax_example"><a href="lsqr.html#mw_1623f240-80ec-4c6e-b5b4-d849eeeae472" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e1022886" itemprop="syntax"><code class="synopsis"><a href="#f89-999296_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a> = lsqr(<a href="#mw_3eec56d0-e068-49a8-8dff-01d7ab9782d9" class="intrnllnk"><code class="argument">A</code></a>,<a href="#f89-999296_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" class="intrnllnk"><code class="argument">b</code></a>,<a href="#f89-999296_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="intrnllnk"><code class="argument">tol</code></a>,<a href="#f89-999296_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" class="intrnllnk"><code class="argument">maxit</code></a>,<a href="#f89-999296_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" class="intrnllnk"><code class="argument">M1</code></a>,<a href="#f89-999296_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" class="intrnllnk"><code class="argument">M2</code></a>)</code></span>
        specifies factors of the preconditioner matrix <code class="literal">M</code> such that <code class="literal">M =
          M1*M2</code>.</p></div><p class="syntax_example"><a href="lsqr.html#mw_1623f240-80ec-4c6e-b5b4-d849eeeae472" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e1022916" itemprop="syntax"><code class="synopsis"><a href="#f89-999296_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a> = lsqr(<a href="#mw_3eec56d0-e068-49a8-8dff-01d7ab9782d9" class="intrnllnk"><code class="argument">A</code></a>,<a href="#f89-999296_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" class="intrnllnk"><code class="argument">b</code></a>,<a href="#f89-999296_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="intrnllnk"><code class="argument">tol</code></a>,<a href="#f89-999296_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" class="intrnllnk"><code class="argument">maxit</code></a>,<a href="#f89-999296_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" class="intrnllnk"><code class="argument">M1</code></a>,<a href="#f89-999296_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" class="intrnllnk"><code class="argument">M2</code></a>,<a href="#f89-999296_sep_mw_40e27791-2264-4d42-8cb6-b8bf869783bc" class="intrnllnk"><code class="argument">x0</code></a>)</code></span>
        specifies an initial guess for the solution vector <code class="literal">x</code>. The default is a
        vector of zeros.</p></div><p class="syntax_example"><a href="lsqr.html#mw_42ba30c9-0255-4c93-89c2-78b8d0b16b87" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e1022946" itemprop="syntax"><code class="synopsis">[<a href="#f89-999296_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a>,<a href="#f89-999296_sep_mw_1f278699-812f-4628-8d99-e8f6ae362e34" class="intrnllnk"><code class="argument">flag</code></a>] = lsqr(<span class="argument_placeholder">___</span>)</code></span>
        returns a flag that specifies whether the algorithm successfully converged. When
          <code class="literal">flag = 0</code>, convergence was successful. You can use this output syntax
        with any of the previous input argument combinations. When you specify the
          <code class="literal">flag</code> output, <code class="function">lsqr</code> does not display any diagnostic
        messages.</p></div><p class="syntax_example"><a href="lsqr.html#mw_1623f240-80ec-4c6e-b5b4-d849eeeae472" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e1022970" itemprop="syntax"><code class="synopsis">[<a href="#f89-999296_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a>,<a href="#f89-999296_sep_mw_1f278699-812f-4628-8d99-e8f6ae362e34" class="intrnllnk"><code class="argument">flag</code></a>,<a href="#f89-999296_sep_mw_6de229ba-091b-4137-acf4-6c7691a0398c" class="intrnllnk"><code class="argument">relres</code></a>] = lsqr(<span class="argument_placeholder">___</span>)</code></span>
        also returns the residual error of the computed solution <code class="literal">x</code>. If
          <code class="literal">flag</code> is <code class="literal">0</code>, then <code class="literal">x</code> is a
        least-squares solution that minimizes <code class="literal">norm(b-A*x)</code>. If
          <code class="literal">relres</code> is small, then <code class="literal">x</code> is also a consistent
        solution, since <code class="literal">relres</code> represents
        <code class="literal">norm(b-A*x)/norm(b)</code>.</p></div><p class="syntax_example"><a href="lsqr.html#mw_1623f240-80ec-4c6e-b5b4-d849eeeae472" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e1023009" itemprop="syntax"><code class="synopsis">[<a href="#f89-999296_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a>,<a href="#f89-999296_sep_mw_1f278699-812f-4628-8d99-e8f6ae362e34" class="intrnllnk"><code class="argument">flag</code></a>,<a href="#f89-999296_sep_mw_6de229ba-091b-4137-acf4-6c7691a0398c" class="intrnllnk"><code class="argument">relres</code></a>,<a href="#f89-999296_sep_mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4" class="intrnllnk"><code class="argument">iter</code></a>] = lsqr(<span class="argument_placeholder">___</span>)</code></span>
        also returns the iteration number <code class="literal">iter</code> at which <code class="literal">x</code> was
        computed.</p></div><p class="syntax_example"><a href="lsqr.html#mw_1623f240-80ec-4c6e-b5b4-d849eeeae472" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e1023035" itemprop="syntax"><code class="synopsis">[<a href="#f89-999296_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a>,<a href="#f89-999296_sep_mw_1f278699-812f-4628-8d99-e8f6ae362e34" class="intrnllnk"><code class="argument">flag</code></a>,<a href="#f89-999296_sep_mw_6de229ba-091b-4137-acf4-6c7691a0398c" class="intrnllnk"><code class="argument">relres</code></a>,<a href="#f89-999296_sep_mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4" class="intrnllnk"><code class="argument">iter</code></a>,<a href="#f89-999296_sep_mw_e2a3240f-74d0-4b34-943e-502f3dd9d174" class="intrnllnk"><code class="argument">resvec</code></a>] = lsqr(<span class="argument_placeholder">___</span>)</code></span>
        also returns a vector of the residual norms at each iteration, including the first residual
          <code class="literal">norm(b-A*x0)</code>.</p></div><p class="syntax_example"><a href="lsqr.html#mw_1623f240-80ec-4c6e-b5b4-d849eeeae472" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e1023063" itemprop="syntax"><code class="synopsis">[<a href="#f89-999296_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a>,<a href="#f89-999296_sep_mw_1f278699-812f-4628-8d99-e8f6ae362e34" class="intrnllnk"><code class="argument">flag</code></a>,<a href="#f89-999296_sep_mw_6de229ba-091b-4137-acf4-6c7691a0398c" class="intrnllnk"><code class="argument">relres</code></a>,<a href="#f89-999296_sep_mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4" class="intrnllnk"><code class="argument">iter</code></a>,<a href="#f89-999296_sep_mw_e2a3240f-74d0-4b34-943e-502f3dd9d174" class="intrnllnk"><code class="argument">resvec</code></a>,<a href="#mw_e22e7d07-6c93-446d-8811-040d5523a7c6" class="intrnllnk"><code class="argument">lsvec</code></a>] = lsqr(<span class="argument_placeholder">___</span>)</code></span>
        also returns <code class="literal">lsvec</code>, which is an estimate of the scaled normal equation
        error at each iteration.</p></div><p class="syntax_example"><a href="lsqr.html#mw_1623f240-80ec-4c6e-b5b4-d849eeeae472" class="intrnllnk">example</a></p></div></div></div></div><div class="clear"></div><div class="examples"><h2 id="mw_63136ef0-3d7a-46be-8571-1cdc4c63d0fb">Examples</h2><div class="expandableContent" id="expandableExamples"><p class="switch"><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true3">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_ddd73a34-5aa5-4fee-85dc-cbb1da014c9c"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_ddd73a34-5aa5-4fee-85dc-cbb1da014c9c" data-bs-target="#expand_accordion_body_mw_ddd73a34-5aa5-4fee-85dc-cbb1da014c9c" aria-controls="expand_accordion_body_mw_ddd73a34-5aa5-4fee-85dc-cbb1da014c9c" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_ddd73a34-5aa5-4fee-85dc-cbb1da014c9c">Iterative Solution to Linear System</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_ddd73a34-5aa5-4fee-85dc-cbb1da014c9c" aria-labelledby="expand_accordion_heading_mw_ddd73a34-5aa5-4fee-85dc-cbb1da014c9c" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/LSQRLinearSystemExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Iterative Solution to Linear System",
          "description": "Solve a rectangular linear system using lsqr with default settings, and then adjust the tolerance and number of iterations used in the solution process.",
          "thumbnailURL": "../../examples/matlab/win64/LSQRLinearSystemExample_01.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "lsqr.html"

        },
          "identifier": "matlab.LSQRLinearSystemExample",
          "name": "LSQRLinearSystemExample",
          "url": "lsqr.html#mw_ddd73a34-5aa5-4fee-85dc-cbb1da014c9c"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/LSQRLinearSystemExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "LSQRLinearSystemExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Solve a rectangular linear system using <code class="literal">lsqr</code> with default settings, and then adjust the tolerance and number of iterations used in the solution process.</p><p>Create a random sparse matrix <code class="literal">A</code> with 50% density. Also create a random vector <code class="literal">b</code> for the right-hand side of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">Ax</mi><mo>=</mo><mi mathvariant="italic">b</mi></mrow></math></span>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>rng <span style="color:#A020F0">default</span>
A = sprand(400,300,.5);
b = rand(400,1);</pre></div></div></div><p>Solve <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">Ax</mi><mo>=</mo><mi mathvariant="italic">b</mi></mrow></math></span> using <code class="literal">lsqr</code>. The output display includes the value of the relative residual error <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mfrac><mrow><mrow><mo>‖</mo><mrow><mi mathvariant="italic">b</mi><mo>-</mo><mi mathvariant="normal">Ax</mi></mrow><mo>‖</mo></mrow></mrow><mrow><mrow><mo>‖</mo><mrow><mi mathvariant="italic">b</mi></mrow><mo>‖</mo></mrow></mrow></mfrac></mrow></math></span>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>x = lsqr(A,b);</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>lsqr stopped at iteration 20 without converging to the desired tolerance 1e-06
because the maximum number of iterations was reached.
The iterate returned (number 20) has relative residual 0.26.
</pre></div></div></div><p>By default <code class="literal">lsqr</code> uses 20 iterations and a tolerance of <code class="literal">1e-6</code>, but the algorithm is unable to converge in those 20 iterations for this matrix. Since the residual is still large, it is a good indicator that more iterations (or a preconditioner matrix) are needed. You also can use a larger tolerance to make it easier for the algorithm to converge.</p><p>Solve the system again using a tolerance of <code class="literal">1e-4</code> and 70 iterations. Specify six outputs to return the relative residual <code class="literal">relres</code> of the calculated solution, as well as the residual history <code class="literal">resvec</code> and the least-squares residual history <code class="literal">lsvec</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[x,flag,relres,iter,resvec,lsvec] = lsqr(A,b,1e-4,70);
flag</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>flag = 
0
</pre></div></div></div><p>Since <code class="literal">flag</code> is 0, the algorithm was able to meet the desired error tolerance in the specified number of iterations. You can generally adjust the tolerance and number of iterations together to make tradeoffs between speed and precision in this manner.</p><p>Examine the relative residual and least-squares residual of the calculated solution.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>relres</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>relres = 
0.2625
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>lsres = lsvec(end)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>lsres = 
2.7640e-04
</pre></div></div></div><p>These residual norms indicate that <code class="literal">x</code> is a least-squares solution, because <code class="literal">relres</code> is not smaller than the specified tolerance of <code class="literal">1e-4</code>. Since no consistent solution to the linear system exists, the best the solver can do is to make the least-squares residual satisfy the tolerance.</p><p>Plot the residual histories. The relative residual <code class="literal">resvec</code> quickly reaches a minimum and cannot make further progress, while the least-squares residual <code class="literal">lsvec</code> continues to be minimized on subsequent iterations.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>N = length(resvec);
semilogy(0:N-1,lsvec,<span style="color:#A020F0">'--o'</span>,0:N-1,resvec,<span style="color:#A020F0">'-o'</span>)
legend(<span style="color:#A020F0">"Least-squares residual"</span>,<span style="color:#A020F0">"Relative residual"</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e1023219" class="mediaobject"><p><img src="../../examples/matlab/win64/LSQRLinearSystemExample_01.png" alt="Figure contains an axes object. The axes object contains 2 objects of type line. These objects represent Least-squares residual, Relative residual." width="560"></p></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-LSQRLinearSystemExample"><meta itemprop="exampletitle" content="Iterative Solution to Linear System"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_1623f240-80ec-4c6e-b5b4-d849eeeae472"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_1623f240-80ec-4c6e-b5b4-d849eeeae472" data-bs-target="#expand_accordion_body_mw_1623f240-80ec-4c6e-b5b4-d849eeeae472" aria-controls="expand_accordion_body_mw_1623f240-80ec-4c6e-b5b4-d849eeeae472" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_1623f240-80ec-4c6e-b5b4-d849eeeae472">Using <code class="literal">lsqr</code> with Preconditioner</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_1623f240-80ec-4c6e-b5b4-d849eeeae472" aria-labelledby="expand_accordion_heading_mw_1623f240-80ec-4c6e-b5b4-d849eeeae472" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/LSQRPreconditionerMatrixExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Using lsqr with Preconditioner",
          "description": "Examine the effect of using a preconditioner matrix with lsqr to solve a linear system.",
          "thumbnailURL": "../../examples/matlab/win64/LSQRPreconditionerMatrixExample_01.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "lsqr.html"

        },
          "identifier": "matlab.LSQRPreconditionerMatrixExample",
          "name": "LSQRPreconditionerMatrixExample",
          "url": "lsqr.html#mw_1623f240-80ec-4c6e-b5b4-d849eeeae472"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/LSQRPreconditionerMatrixExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "LSQRPreconditionerMatrixExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Examine the effect of using a preconditioner matrix with <code class="literal">lsqr</code> to solve a linear system.</p><p>Load west0479, a real 479-by-479 nonsymmetric sparse matrix.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>load <span style="color:#A020F0">west0479</span>
A = west0479;</pre></div></div></div><p>Define <code class="literal">b</code> so that the true solution to <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">Ax</mi><mo>=</mo><mi mathvariant="italic">b</mi></mrow></math></span> is a vector of all ones.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>b = sum(A,2);</pre></div></div></div><p>Set the tolerance and maximum number of iterations.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>tol = 1e-12;
maxit = 20;</pre></div></div></div><p>Use <code class="literal">lsqr</code> to find a solution at the requested tolerance and number of iterations. Specify six outputs to return information about the solution process:</p><div class="itemizedlist"><ul><li><p><code class="literal">x</code> is the computed solution to <code class="literal">A*x = b</code>.</p></li><li><p><code class="literal">fl</code> is a flag indicating whether the algorithm converged.</p></li><li><p><code class="literal">rr</code> is the relative residual of the computed answer <code class="literal">x</code>.</p></li><li><p><code class="literal">it</code> is the iteration number when <code class="literal">x</code> was computed.</p></li><li><p><code class="literal">rv</code> is a vector of the residual history for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mrow><mo>‖</mo><mrow><mi mathvariant="italic">b</mi><mo>-</mo><mi mathvariant="normal">Ax</mi></mrow><mo>‖</mo></mrow></mrow></math></span>.</p></li><li><p><code class="literal">lsrv</code> is a vector of the least squares residual history.</p></li></ul></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[x,fl,rr,it,rv,lsrv] = lsqr(A,b,tol,maxit);
fl</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>fl = 
1
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>rr</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>rr = 
0.0017
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>it</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>it = 
20
</pre></div></div></div><p>Since <code class="literal">fl = 1</code>, the algorithm did not converge to the specified tolerance within the maximum number of iterations.</p><p>To aid with the slow convergence, you can specify a preconditioner matrix. Since <code class="literal">A</code> is nonsymmetric, use <code class="literal">ilu</code> to generate the preconditioner <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">M</mi><mo>=</mo><mi mathvariant="italic">L</mi><mtext> </mtext><mi mathvariant="italic">U</mi></mrow></math></span> in factorized form. Specify a drop tolerance to ignore nondiagonal entries with values smaller than <code class="literal">1e-6</code>. Solve the preconditioned system <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><mi mathvariant="normal">AM</mi></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup><mrow><mo>(</mo><mrow><mi mathvariant="italic">M</mi><mtext> </mtext><mi mathvariant="italic">x</mi></mrow><mo>)</mo></mrow><mo>=</mo><mi mathvariant="italic">b</mi></mrow></math></span> for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">y</mi><mo>=</mo><mi mathvariant="normal">Mx</mi></mrow></math></span> by specifying <code class="literal">L</code> and <code class="literal">U</code> as the <code class="literal">M1</code> and <code class="literal">M2</code> inputs to <code class="literal">lsqr</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>setup = struct(<span style="color:#A020F0">'type'</span>,<span style="color:#A020F0">'ilutp'</span>,<span style="color:#A020F0">'droptol'</span>,1e-6);
[L,U] = ilu(A,setup);
[x1,fl1,rr1,it1,rv1,lsrv1] = lsqr(A,b,tol,maxit,L,U);
fl1</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>fl1 = 
0
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>rr1</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>rr1 = 
7.0954e-14
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>it1</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>it1 = 
13
</pre></div></div></div><p>The use of an ilu preconditioner produces a relative residual less than the prescribed tolerance of <code class="literal">1e-12</code> at the 13th iteration. The output <code class="literal">rv1(1)</code> is <code class="literal">norm(b)</code>, and the output <code class="literal">rv1(end)</code> is <code class="literal">norm(b-A*x1)</code>. </p><p>You can follow the progress of <code class="literal">lsqr</code> by plotting the relative residuals at each iteration. Plot the residual history of each solution with a line for the specified tolerance.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>semilogy(0:length(rv)-1,rv/norm(b),<span style="color:#A020F0">'-o'</span>)
hold <span style="color:#A020F0">on</span>
semilogy(0:length(rv1)-1,rv1/norm(b),<span style="color:#A020F0">'-o'</span>)
yline(tol,<span style="color:#A020F0">'r--'</span>);
legend(<span style="color:#A020F0">'No preconditioner'</span>,<span style="color:#A020F0">'ILU preconditioner'</span>,<span style="color:#A020F0">'Tolerance'</span>,<span style="color:#A020F0">'Location'</span>,<span style="color:#A020F0">'East'</span>)
xlabel(<span style="color:#A020F0">'Iteration number'</span>)
ylabel(<span style="color:#A020F0">'Relative residual'</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e1023430" class="mediaobject"><p><img src="../../examples/matlab/win64/LSQRPreconditionerMatrixExample_01.png" alt="Figure contains an axes object. The axes object with xlabel Iteration number, ylabel Relative residual contains 3 objects of type line, constantline. These objects represent No preconditioner, ILU preconditioner, Tolerance." width="560"></p></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-LSQRPreconditionerMatrixExample"><meta itemprop="exampletitle" content="Using lsqr with Preconditioner"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_42ba30c9-0255-4c93-89c2-78b8d0b16b87"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_42ba30c9-0255-4c93-89c2-78b8d0b16b87" data-bs-target="#expand_accordion_body_mw_42ba30c9-0255-4c93-89c2-78b8d0b16b87" aria-controls="expand_accordion_body_mw_42ba30c9-0255-4c93-89c2-78b8d0b16b87" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_42ba30c9-0255-4c93-89c2-78b8d0b16b87">Supplying Initial Guess</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_42ba30c9-0255-4c93-89c2-78b8d0b16b87" aria-labelledby="expand_accordion_heading_mw_42ba30c9-0255-4c93-89c2-78b8d0b16b87" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/LSQRInitialGuessExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Supplying Initial Guess",
          "description": "Examine the effect of supplying lsqr with an initial guess of the solution.",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "lsqr.html"

        },
          "identifier": "matlab.LSQRInitialGuessExample",
          "name": "LSQRInitialGuessExample",
          "url": "lsqr.html#mw_42ba30c9-0255-4c93-89c2-78b8d0b16b87"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/LSQRInitialGuessExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "LSQRInitialGuessExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Examine the effect of supplying <code class="literal">lsqr</code> with an initial guess of the solution.</p><p>Create a random rectangular sparse matrix. Use the sum of each row as the vector for the right-hand side of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">Ax</mi><mo>=</mo><mi mathvariant="italic">b</mi></mrow></math></span> so that the expected solution for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi></mrow></math></span> is a vector of ones.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>A = sprand(700,900,0.1);
b = sum(A,2);</pre></div></div></div><p>Use <code class="literal">lsqr</code> to solve <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">Ax</mi><mo>=</mo><mi mathvariant="italic">b</mi></mrow></math></span> twice: one time with the default initial guess, and one time with a good initial guess of the solution. Use 75 iterations and the default tolerance for both solutions. Specify the initial guess in the second solution as a vector with all elements equal to 0.99. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>maxit = 75;
x1 = lsqr(A,b,[],maxit);</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>lsqr converged at iteration 64 to a solution with relative residual 8.7e-07.
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>x0 = 0.99*ones(size(A,2),1);
x2 = lsqr(A,b,[],maxit,[],[],x0);</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>lsqr converged at iteration 26 to a solution with relative residual 9.6e-07.
</pre></div></div></div><p>With an initial guess close to the expected solution, <code class="literal">lsqr</code> is able to converge in fewer iterations.</p><div class="procedure"><span id="LSQRInitialGuessExample-1" class="anchor_target"></span><p class="title" id="LSQRInitialGuessExample-1"><b>Returning Intermediate Results</b></p><p>You also can use the initial guess to get intermediate results by calling <code class="literal">lsqr</code> in a for-loop. Each call to the solver performs a few iterations and stores the calculated solution. Then you use that solution as the initial vector for the next batch of iterations. </p><p>For example, this code performs 100 iterations four times and stores the solution vector after each pass in the for-loop:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>x0 = zeros(size(A,2),1);
tol = 1e-8;
maxit = 100;
<span style="color:#0000FF">for</span> k = 1:4
    [x,flag,relres] = lsqr(A,b,tol,maxit,[],[],x0);
    X(:,k) = x;
    R(k) = relres;
    x0 = x;
<span style="color:#0000FF">end</span></pre></div></div></div><p><code class="literal">X(:,k)</code> is the solution vector computed at iteration <code class="literal">k</code> of the for-loop, and <code class="literal">R(k)</code> is the relative residual of that solution.</p></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-LSQRInitialGuessExample"><meta itemprop="exampletitle" content="Supplying Initial Guess"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_dc900168-8ddd-4512-9ad1-42e971327073"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_dc900168-8ddd-4512-9ad1-42e971327073" data-bs-target="#expand_accordion_body_mw_dc900168-8ddd-4512-9ad1-42e971327073" aria-controls="expand_accordion_body_mw_dc900168-8ddd-4512-9ad1-42e971327073" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_dc900168-8ddd-4512-9ad1-42e971327073">Using Function Handle Instead of Numeric Matrix</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_dc900168-8ddd-4512-9ad1-42e971327073" aria-labelledby="expand_accordion_heading_mw_dc900168-8ddd-4512-9ad1-42e971327073" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/LSQRFunctionHandleExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Using Function Handle Instead of Numeric Matrix",
          "description": "Solve a linear system by providing lsqr with a function handle that computes A*x and A'*x in place of the coefficient matrix A.",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "lsqr.html"

        },
          "identifier": "matlab.LSQRFunctionHandleExample",
          "name": "LSQRFunctionHandleExample",
          "url": "lsqr.html#mw_dc900168-8ddd-4512-9ad1-42e971327073"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/LSQRFunctionHandleExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "LSQRFunctionHandleExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Solve a linear system by providing <code class="literal">lsqr</code> with a function handle that computes <code class="literal">A*x</code> and <code class="literal">A'*x</code> in place of the coefficient matrix <code class="literal">A</code>.</p><p>Create a nonsymmetric tridiagonal matrix. Preview the matrix.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>A = gallery(<span style="color:#A020F0">'wilk'</span>,21) + diag(ones(20,1),1)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>A = <span class="emphasis"><em>21×21</em></span>

    10     2     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     1     9     2     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     1     8     2     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     1     7     2     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     1     6     2     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     1     5     2     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     1     4     2     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     1     3     2     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     1     2     2     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     1     1     2     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     1     0     2     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     1     1     2     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     1     2     2     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0     1     3     2     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0     0     1     4     2     0     0     0     0     0
      &#x22EE;

</pre></div></div></div><p>Since this tridiagonal matrix has a special structure, you can represent the operation <code class="literal">A*x</code> with a function handle. When <code class="literal">A</code> multiplies a vector, most of the elements in the resulting vector are zeros. The nonzero elements in the result correspond with the nonzero tridiagonal elements of <code class="literal">A</code>. </p><p>The expression <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">A</mi><mtext> </mtext><mi mathvariant="italic">x</mi></mrow></math></span> becomes:</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">A</mi><mtext> </mtext><mi mathvariant="italic">x</mi><mo>=</mo><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><mn>10</mn></mrow></mtd><mtd><mrow><mn>2</mn></mrow></mtd><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mo>&#x22EF;</mo></mrow></mtd><mtd><mrow><mi data-category="placeholder-atom"/></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mo data-category="structure">&#x22EF;</mo></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>0</mn></mrow></mtd></mtr><mtr data-category="structure-part"><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>1</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>9</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>2</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>0</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mi data-category="placeholder-atom"/></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mi data-category="placeholder-atom"/></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mo data-category="structure">&#x22EE;</mo></mrow></mtd></mtr><mtr data-category="structure-part"><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>0</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>1</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mo data-category="structure">⋱</mo></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>2</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>0</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mi data-category="placeholder-atom"/></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mi data-category="placeholder-atom"/></mrow></mtd></mtr><mtr data-category="structure-part"><mtd data-category="structure-part"><mrow data-category="placeholder"><mo data-category="structure">&#x22EE;</mo></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>0</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>1</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>0</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mo data-category="structure">⋱</mo></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mo data-category="structure">⋱</mo></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mo data-category="structure">&#x22EE;</mo></mrow></mtd></mtr><mtr data-category="structure-part"><mtd data-category="structure-part"><mrow data-category="placeholder"><mi data-category="placeholder-atom"/></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mi id="5AFD8FA7" data-category="placeholder-atom"/></mrow></mtd><mtd id="801B26D4" data-category="structure-part"><mrow id="88428166" data-category="placeholder"><mn id="2706756D">0</mn></mrow></mtd><mtd id="801B26D4" data-category="structure-part"><mrow id="AEAB7B46" data-category="placeholder"><mo id="E7E6DC0B" data-category="structure">⋱</mo></mrow></mtd><mtd id="801B26D4" data-category="structure-part"><mrow id="3842B474" data-category="placeholder"><mn id="8F15C9FC">1</mn></mrow></mtd><mtd id="801B26D4" data-category="structure-part"><mrow id="E47BDADF" data-category="placeholder"><mo id="38F07F90" data-category="structure">⋱</mo></mrow></mtd><mtd id="801B26D4" data-category="structure-part"><mrow id="DE1072E5" data-category="placeholder"><mn id="937FF173">0</mn></mrow></mtd></mtr><mtr id="801B26D4" data-category="structure-part"><mtd id="801B26D4" data-category="structure-part"><mrow id="68425216" data-category="placeholder"><mo id="33B85679" data-category="structure">&#x22EE;</mo></mrow></mtd><mtd id="801B26D4" data-category="structure-part"><mrow id="525FEAF6" data-category="placeholder"><mi id="F57C1E50" data-category="placeholder-atom"/></mrow></mtd><mtd id="801B26D4" data-category="structure-part"><mrow id="52DC6302" data-category="placeholder"><mi id="56EA2B8D" data-category="placeholder-atom"/></mrow></mtd><mtd id="801B26D4" data-category="structure-part"><mrow id="90B2301B" data-category="placeholder"><mo id="84032201" data-category="structure">⋱</mo></mrow></mtd><mtd id="801B26D4" data-category="structure-part"><mrow id="ABA6F389" data-category="placeholder"><mo id="6A892A7C" data-category="structure">⋱</mo></mrow></mtd><mtd id="801B26D4" data-category="structure-part"><mrow id="071B03F6" data-category="placeholder"><mo id="8DC7A386" data-category="structure">⋱</mo></mrow></mtd><mtd id="801B26D4" data-category="structure-part"><mrow id="DA037425" data-category="placeholder"><mn id="91E87FA7">2</mn></mrow></mtd></mtr><mtr id="801B26D4" data-category="structure-part"><mtd id="801B26D4" data-category="structure-part"><mrow id="110CC30C" data-category="placeholder"><mn id="0A369691">0</mn></mrow></mtd><mtd id="801B26D4" data-category="structure-part"><mrow id="4636ADC7" data-category="placeholder"><mo id="F1BACE68" data-category="structure">&#x22EF;</mo></mrow></mtd><mtd id="801B26D4" data-category="structure-part"><mrow id="64FA3BC8" data-category="placeholder"><mi id="7F890B66" data-category="placeholder-atom"/></mrow></mtd><mtd id="801B26D4" data-category="structure-part"><mrow id="D1E87CE2" data-category="placeholder"><mo id="F9DCBC4A" data-category="structure">&#x22EF;</mo></mrow></mtd><mtd id="801B26D4" data-category="structure-part"><mrow id="15ADDCD4" data-category="placeholder"><mn id="27E8257B">0</mn></mrow></mtd><mtd id="801B26D4" data-category="structure-part"><mrow id="33CC9E28" data-category="placeholder"><mn id="916DE739">1</mn></mrow></mtd><mtd id="801B26D4" data-category="structure-part"><mrow id="3115CAFE" data-category="placeholder"><mn id="4E0A063A">10</mn></mrow></mtd></mtr></mtable><mo id="8BFFE595" data-category="static">]</mo></mrow><mrow id="44CD5888" data-category="structure"><mo id="1CB30477" data-category="static">[</mo><mtable id="34C05A0E" data-category="structure-part" columnalign="center"><mtr id="34C05A0E" data-category="structure-part"><mtd id="34C05A0E" data-category="structure-part"><mrow id="30BF4D6B" data-category="placeholder"><msub id="40D9EF61" data-category="structure"><mrow id="E7CDD373" data-category="placeholder"><mi mathvariant="italic" id="F0D7F9A9">x</mi></mrow><mrow id="9C4FE405" data-category="placeholder"><mn id="D335B3A8">1</mn></mrow></msub></mrow></mtd></mtr><mtr id="34C05A0E" data-category="structure-part"><mtd id="34C05A0E" data-category="structure-part"><mrow id="066532A9" data-category="placeholder"><msub id="9BB7AAA7" data-category="structure"><mrow id="E00C09EB" data-category="placeholder"><mi mathvariant="italic" id="B854B9F0">x</mi></mrow><mrow id="B200BEF3" data-category="placeholder"><mn id="5D977CC2">2</mn></mrow></msub></mrow></mtd></mtr><mtr id="34C05A0E" data-category="structure-part"><mtd id="34C05A0E" data-category="structure-part"><mrow id="9CEBF3DD" data-category="placeholder"><msub id="3EA1C8CA" data-category="structure"><mrow id="1F014723" data-category="placeholder"><mi mathvariant="italic" id="F2AF454B">x</mi></mrow><mrow id="30CE1584" data-category="placeholder"><mn id="FA3BA8DF">3</mn></mrow></msub></mrow></mtd></mtr><mtr id="34C05A0E" data-category="structure-part"><mtd id="34C05A0E" data-category="structure-part"><mrow id="C5503711" data-category="placeholder"><mo id="0DE42F8D" data-category="structure">&#x22EE;</mo></mrow></mtd></mtr><mtr id="34C05A0E" data-category="structure-part"><mtd id="34C05A0E" data-category="structure-part"><mrow id="3812787F" data-category="placeholder"><mo id="F3539F6F" data-category="structure">&#x22EE;</mo></mrow></mtd></mtr><mtr id="34C05A0E" data-category="structure-part"><mtd id="34C05A0E" data-category="structure-part"><mrow id="A8F30FD4" data-category="placeholder"><msub id="4DFBF0A3" data-category="structure"><mrow id="B4E51C36" data-category="placeholder"><mi mathvariant="italic" id="35CFAE4B">x</mi></mrow><mrow id="53DEDE90" data-category="placeholder"><mn id="E058824A">21</mn></mrow></msub></mrow></mtd></mtr></mtable><mo id="47666DCF" data-category="static">]</mo></mrow><mo id="61E8DAC1">=</mo><mrow id="DB34E92E" data-category="structure"><mo id="B875C848" data-category="static">[</mo><mtable id="CD0F8075" data-category="structure-part" columnalign="center"><mtr id="CD0F8075" data-category="structure-part"><mtd id="CD0F8075" data-category="structure-part"><mrow id="EF9A00E3" data-category="placeholder"><msub id="3DADAE84" data-category="structure"><mrow id="CB9FC6B9" data-category="placeholder"><mn id="8816AD3B">10</mn><mi mathvariant="italic" id="3A176018">x</mi></mrow><mrow id="3C5131BD" data-category="placeholder"><mn id="0C1AF9DF">1</mn></mrow></msub><mo id="C3BB2E75">+</mo><mn id="2D56E9A9">2</mn><msub id="2689183D" data-category="structure"><mrow id="D9FA2E51" data-category="placeholder"><mi mathvariant="italic" id="FB4D033A">x</mi></mrow><mrow id="6C3D9FDB" data-category="placeholder"><mn id="67B1E946">2</mn></mrow></msub></mrow></mtd></mtr><mtr id="CD0F8075" data-category="structure-part"><mtd id="CD0F8075" data-category="structure-part"><mrow id="A2BA91A0" data-category="placeholder"><msub id="9E1B2AE5" data-category="structure"><mrow id="A72060BF" data-category="placeholder"><mi mathvariant="italic" id="E9FD121F">x</mi></mrow><mrow id="024D783B" data-category="placeholder"><mn id="EBBC187A">1</mn></mrow></msub><mo id="35B3BB8A">+</mo><mn id="4FC993E3">9</mn><msub id="F1751276" data-category="structure"><mrow id="C48970DE" data-category="placeholder"><mi mathvariant="italic" id="A1012D85">x</mi></mrow><mrow id="EE1F8088" data-category="placeholder"><mn id="82A52409">2</mn></mrow></msub><mo id="7624B1CD">+</mo><mn id="0680CC8C">2</mn><msub id="C4C76C3F" data-category="structure"><mrow id="DD57CAE5" data-category="placeholder"><mi mathvariant="italic" id="EAD5E40D">x</mi></mrow><mrow id="02FF0DD1" data-category="placeholder"><mn id="F7CED172">3</mn></mrow></msub></mrow></mtd></mtr><mtr id="CD0F8075" data-category="structure-part"><mtd id="CD0F8075" data-category="structure-part"><mrow id="D75DAF12" data-category="placeholder"><mo id="5FAFF3F9" data-category="structure">&#x22EE;</mo></mrow></mtd></mtr><mtr id="CD0F8075" data-category="structure-part"><mtd id="CD0F8075" data-category="structure-part"><mrow id="7AF033EC" data-category="placeholder"><mo id="F769079D" data-category="structure">&#x22EE;</mo></mrow></mtd></mtr><mtr id="CD0F8075" data-category="structure-part"><mtd id="CD0F8075" data-category="structure-part"><mrow id="35FEB673" data-category="placeholder"><msub id="1C48BB38" data-category="structure"><mrow id="98B97B35" data-category="placeholder"><mi mathvariant="italic" id="06FBD642">x</mi></mrow><mrow id="4DAE1E74" data-category="placeholder"><mn id="FA9CFE37">19</mn></mrow></msub><mo id="44F7675A">+</mo><mn id="61DC9A71">9</mn><msub id="ADA3851C" data-category="structure"><mrow id="EFE922C5" data-category="placeholder"><mi mathvariant="italic" id="CDC0C07A">x</mi></mrow><mrow id="5446CCAE" data-category="placeholder"><mn id="064508C0">20</mn></mrow></msub><mo id="D559979C">+</mo><mn id="AD81C844">2</mn><msub id="4B23CCEB" data-category="structure"><mrow id="C1E283CC" data-category="placeholder"><mi mathvariant="italic" id="00D1B157">x</mi></mrow><mrow id="F30EB3B8" data-category="placeholder"><mn id="263DA98F">21</mn></mrow></msub></mrow></mtd></mtr><mtr id="CD0F8075" data-category="structure-part"><mtd id="CD0F8075" data-category="structure-part"><mrow id="D2F9198C" data-category="placeholder"><msub id="C700D1B9" data-category="structure"><mrow id="B426BB1F" data-category="placeholder"><mi mathvariant="italic" id="5A1DF52E">x</mi></mrow><mrow id="CB9C67D6" data-category="placeholder"><mn id="C664D8F2">20</mn></mrow></msub><mo id="2BFB7D10">+</mo><mn id="5FE3ACB6">10</mn><msub id="B1C743F9" data-category="structure"><mrow id="AA72B12B" data-category="placeholder"><mi mathvariant="italic" id="65856DF5">x</mi></mrow><mrow id="840B56A5" data-category="placeholder"><mn id="AA695EA9">21</mn></mrow></msub></mrow></mtd></mtr></mtable><mo id="2AF56D32" data-category="static">]</mo></mrow></mrow></math></span>.</p><p>The resulting vector can be written as the sum of three vectors:</p><p><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">A</mi><mtext> </mtext><mi mathvariant="italic">x</mi><mo>=</mo><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><msub><mrow><mn>10</mn><mi mathvariant="italic">x</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>+</mo><mn>2</mn><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>+</mo><mn>9</mn><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>+</mo><mn>2</mn><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>3</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mo>&#x22EE;</mo></mrow></mtd></mtr><mtr><mtd><mrow><mo>&#x22EE;</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>19</mn></mrow></msub><mo>+</mo><mn>9</mn><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>20</mn></mrow></msub><mo>+</mo><mn>2</mn><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>21</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>20</mn></mrow></msub><mo>+</mo><mn>10</mn><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>21</mn></mrow></msub></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow></math></span>=<span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mo>&#x22EE;</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>20</mn></mrow></msub></mrow></mtd></mtr></mtable><mo>]</mo></mrow><mo>+</mo><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><msub><mrow><mn>10</mn><mi mathvariant="italic">x</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mn>9</mn><mi mathvariant="italic">x</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mo>&#x22EE;</mo></mrow></mtd></mtr><mtr><mtd><mrow><mn>9</mn><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>20</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mn>10</mn><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>21</mn></mrow></msub></mrow></mtd></mtr></mtable><mo>]</mo></mrow><mo>+</mo><mn>2</mn><mo>⋅</mo><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>3</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mo>&#x22EE;</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>21</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mn>0</mn></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow></math></span>.</p><p>Likewise, the expression for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><mi mathvariant="italic">A</mi></mrow><mrow><mi mathvariant="italic">T</mi></mrow></msup><mtext> </mtext><mi mathvariant="italic">x</mi></mrow></math></span> becomes:</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><mi mathvariant="italic">A</mi></mrow><mrow><mi mathvariant="italic">T</mi></mrow></msup><mtext> </mtext><mi mathvariant="italic">x</mi><mo>=</mo><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><mn>10</mn></mrow></mtd><mtd><mrow><mn>1</mn></mrow></mtd><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mo>&#x22EF;</mo></mrow></mtd><mtd><mrow><mi data-category="placeholder-atom"/></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mo data-category="structure">&#x22EF;</mo></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>0</mn></mrow></mtd></mtr><mtr data-category="structure-part"><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>2</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>9</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>1</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>0</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mi data-category="placeholder-atom"/></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mi data-category="placeholder-atom"/></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mo data-category="structure">&#x22EE;</mo></mrow></mtd></mtr><mtr data-category="structure-part"><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>0</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>2</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mo data-category="structure">⋱</mo></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>1</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>0</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mi data-category="placeholder-atom"/></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mi data-category="placeholder-atom"/></mrow></mtd></mtr><mtr data-category="structure-part"><mtd data-category="structure-part"><mrow data-category="placeholder"><mo data-category="structure">&#x22EE;</mo></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>0</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>2</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>0</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mo data-category="structure">⋱</mo></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mo data-category="structure">⋱</mo></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mo data-category="structure">&#x22EE;</mo></mrow></mtd></mtr><mtr data-category="structure-part"><mtd data-category="structure-part"><mrow data-category="placeholder"><mi data-category="placeholder-atom"/></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mi id="1C7CF40C" data-category="placeholder-atom"/></mrow></mtd><mtd id="2C7676C2" data-category="structure-part"><mrow id="62691504" data-category="placeholder"><mn id="013DE641">0</mn></mrow></mtd><mtd id="2C7676C2" data-category="structure-part"><mrow id="4AF16E12" data-category="placeholder"><mo id="B6AD97B5" data-category="structure">⋱</mo></mrow></mtd><mtd id="2C7676C2" data-category="structure-part"><mrow id="0B69DB9F" data-category="placeholder"><mn id="F0D8A035">1</mn></mrow></mtd><mtd id="2C7676C2" data-category="structure-part"><mrow id="D95081B8" data-category="placeholder"><mo id="A5BD60C6" data-category="structure">⋱</mo></mrow></mtd><mtd id="2C7676C2" data-category="structure-part"><mrow id="AF8DBEBC" data-category="placeholder"><mn id="FB493D4B">0</mn></mrow></mtd></mtr><mtr id="2C7676C2" data-category="structure-part"><mtd id="2C7676C2" data-category="structure-part"><mrow id="B692301E" data-category="placeholder"><mo id="D58AC5D4" data-category="structure">&#x22EE;</mo></mrow></mtd><mtd id="2C7676C2" data-category="structure-part"><mrow id="AB9D319E" data-category="placeholder"><mi id="5B2A2909" data-category="placeholder-atom"/></mrow></mtd><mtd id="2C7676C2" data-category="structure-part"><mrow id="24711F71" data-category="placeholder"><mi id="DB3B4C07" data-category="placeholder-atom"/></mrow></mtd><mtd id="2C7676C2" data-category="structure-part"><mrow id="61CB0342" data-category="placeholder"><mo id="C8641691" data-category="structure">⋱</mo></mrow></mtd><mtd id="2C7676C2" data-category="structure-part"><mrow id="40CDDB17" data-category="placeholder"><mo id="AFA0DF98" data-category="structure">⋱</mo></mrow></mtd><mtd id="2C7676C2" data-category="structure-part"><mrow id="3C75B1F5" data-category="placeholder"><mo id="311E4914" data-category="structure">⋱</mo></mrow></mtd><mtd id="2C7676C2" data-category="structure-part"><mrow id="C102672C" data-category="placeholder"><mn id="0D7DEA45">1</mn></mrow></mtd></mtr><mtr id="2C7676C2" data-category="structure-part"><mtd id="2C7676C2" data-category="structure-part"><mrow id="8117798C" data-category="placeholder"><mn id="6DE0368C">0</mn></mrow></mtd><mtd id="2C7676C2" data-category="structure-part"><mrow id="C1E355DF" data-category="placeholder"><mo id="73B3ECAA" data-category="structure">&#x22EF;</mo></mrow></mtd><mtd id="2C7676C2" data-category="structure-part"><mrow id="E7CE5B25" data-category="placeholder"><mi id="2192AB1B" data-category="placeholder-atom"/></mrow></mtd><mtd id="2C7676C2" data-category="structure-part"><mrow id="395B15DB" data-category="placeholder"><mo id="330BDD1B" data-category="structure">&#x22EF;</mo></mrow></mtd><mtd id="2C7676C2" data-category="structure-part"><mrow id="5C53F4C4" data-category="placeholder"><mn id="27C57B36">0</mn></mrow></mtd><mtd id="2C7676C2" data-category="structure-part"><mrow id="99F966BD" data-category="placeholder"><mn id="DE6C69CE">2</mn></mrow></mtd><mtd id="2C7676C2" data-category="structure-part"><mrow id="374E55FE" data-category="placeholder"><mn id="05129DEF">10</mn></mrow></mtd></mtr></mtable><mo id="5AD98D7F" data-category="static">]</mo></mrow><mrow id="7D2AB9DA" data-category="structure"><mo id="CF32DF6E" data-category="static">[</mo><mtable id="A7E2DE00" data-category="structure-part" columnalign="center"><mtr id="A7E2DE00" data-category="structure-part"><mtd id="A7E2DE00" data-category="structure-part"><mrow id="07A77DDE" data-category="placeholder"><msub id="AC8B242E" data-category="structure"><mrow id="299C8004" data-category="placeholder"><mi mathvariant="italic" id="FB197CF6">x</mi></mrow><mrow id="CBA69217" data-category="placeholder"><mn id="5F383A83">1</mn></mrow></msub></mrow></mtd></mtr><mtr id="A7E2DE00" data-category="structure-part"><mtd id="A7E2DE00" data-category="structure-part"><mrow id="229A8525" data-category="placeholder"><msub id="C15DD8B6" data-category="structure"><mrow id="D48802F2" data-category="placeholder"><mi mathvariant="italic" id="15383548">x</mi></mrow><mrow id="40D846E7" data-category="placeholder"><mn id="CE76ED15">2</mn></mrow></msub></mrow></mtd></mtr><mtr id="A7E2DE00" data-category="structure-part"><mtd id="A7E2DE00" data-category="structure-part"><mrow id="04AC09B5" data-category="placeholder"><msub id="80E2281A" data-category="structure"><mrow id="DABFB1B9" data-category="placeholder"><mi mathvariant="italic" id="076374DC">x</mi></mrow><mrow id="4D4BA9CA" data-category="placeholder"><mn id="C47DE662">3</mn></mrow></msub></mrow></mtd></mtr><mtr id="A7E2DE00" data-category="structure-part"><mtd id="A7E2DE00" data-category="structure-part"><mrow id="2816707E" data-category="placeholder"><mo id="FAC8C90E" data-category="structure">&#x22EE;</mo></mrow></mtd></mtr><mtr id="A7E2DE00" data-category="structure-part"><mtd id="A7E2DE00" data-category="structure-part"><mrow id="7A204418" data-category="placeholder"><mo id="BA2A5FE2" data-category="structure">&#x22EE;</mo></mrow></mtd></mtr><mtr id="A7E2DE00" data-category="structure-part"><mtd id="A7E2DE00" data-category="structure-part"><mrow id="6960E158" data-category="placeholder"><msub id="050F59FA" data-category="structure"><mrow id="F90BC766" data-category="placeholder"><mi mathvariant="italic" id="31C36EA5">x</mi></mrow><mrow id="0EC70912" data-category="placeholder"><mn id="F22C62AF">21</mn></mrow></msub></mrow></mtd></mtr></mtable><mo id="4C940ECB" data-category="static">]</mo></mrow><mo id="901F026F">=</mo><mrow id="DE008A21" data-category="structure"><mo id="6A6BB872" data-category="static">[</mo><mtable id="99D30208" data-category="structure-part" columnalign="center"><mtr id="99D30208" data-category="structure-part"><mtd id="99D30208" data-category="structure-part"><mrow id="866C3D7F" data-category="placeholder"><msub id="13C35AF7" data-category="structure"><mrow id="917BE557" data-category="placeholder"><mn id="D1935902">10</mn><mi mathvariant="italic" id="2B8C8822">x</mi></mrow><mrow id="8ED72807" data-category="placeholder"><mn id="8EACFA2B">1</mn></mrow></msub><mo id="7FE14BF9">+</mo><msub id="C830AAE4" data-category="structure"><mrow id="7A7B91F0" data-category="placeholder"><mi mathvariant="italic" id="FF6F8D6A">x</mi></mrow><mrow id="B2F47D27" data-category="placeholder"><mn id="BADB653A">2</mn></mrow></msub></mrow></mtd></mtr><mtr id="99D30208" data-category="structure-part"><mtd id="99D30208" data-category="structure-part"><mrow id="7E9115AB" data-category="placeholder"><msub id="4AD04E90" data-category="structure"><mrow id="5137A6B3" data-category="placeholder"><mn id="B942596E">2</mn><mi mathvariant="italic" id="EC4CA208">x</mi></mrow><mrow id="B91DB510" data-category="placeholder"><mn id="F7A6AC49">1</mn></mrow></msub><mo id="4293C33F">+</mo><mn id="959C3BBA">9</mn><msub id="F11FED74" data-category="structure"><mrow id="580C5110" data-category="placeholder"><mi mathvariant="italic" id="2B3A52EF">x</mi></mrow><mrow id="D71DAC2E" data-category="placeholder"><mn id="2583E99A">2</mn></mrow></msub><mo id="221EDF10">+</mo><msub id="33ED92F2" data-category="structure"><mrow id="07290B65" data-category="placeholder"><mi mathvariant="italic" id="F92EF4FF">x</mi></mrow><mrow id="C6D7330C" data-category="placeholder"><mn id="5F6E45D2">3</mn></mrow></msub></mrow></mtd></mtr><mtr id="99D30208" data-category="structure-part"><mtd id="99D30208" data-category="structure-part"><mrow id="1AF52358" data-category="placeholder"><mo id="7BBDF943" data-category="structure">&#x22EE;</mo></mrow></mtd></mtr><mtr id="99D30208" data-category="structure-part"><mtd id="99D30208" data-category="structure-part"><mrow id="27E1A281" data-category="placeholder"><mo id="AF7686CF" data-category="structure">&#x22EE;</mo></mrow></mtd></mtr><mtr id="99D30208" data-category="structure-part"><mtd id="99D30208" data-category="structure-part"><mrow id="90DACB52" data-category="placeholder"><msub id="1003B1B8" data-category="structure"><mrow id="0C3ADFE3" data-category="placeholder"><mn id="03524462">2</mn><mi mathvariant="italic" id="C3CD6DC6">x</mi></mrow><mrow id="ADEFF10E" data-category="placeholder"><mn id="CCD12977">19</mn></mrow></msub><mo id="E8E30F5D">+</mo><mn id="62EC7C8A">9</mn><msub id="13C81A06" data-category="structure"><mrow id="5ED436FE" data-category="placeholder"><mi mathvariant="italic" id="607F4929">x</mi></mrow><mrow id="6E5B8EE3" data-category="placeholder"><mn id="3C1B3125">20</mn></mrow></msub><mo id="4F2032BF">+</mo><msub id="1C5094CB" data-category="structure"><mrow id="52CB0E9A" data-category="placeholder"><mi mathvariant="italic" id="06FC8C2A">x</mi></mrow><mrow id="13C836CC" data-category="placeholder"><mn id="3C714978">21</mn></mrow></msub></mrow></mtd></mtr><mtr id="99D30208" data-category="structure-part"><mtd id="99D30208" data-category="structure-part"><mrow id="7A5E9BAD" data-category="placeholder"><msub id="B3E47D40" data-category="structure"><mrow id="83FADDEF" data-category="placeholder"><mn id="7F54AEC8">2</mn><mi mathvariant="italic" id="845E8036">x</mi></mrow><mrow id="F4934749" data-category="placeholder"><mn id="53046BF4">20</mn></mrow></msub><mo id="E5939E84">+</mo><mn id="E7BF97FD">10</mn><msub id="8C72676B" data-category="structure"><mrow id="B47929C7" data-category="placeholder"><mi mathvariant="italic" id="1EA90FF6">x</mi></mrow><mrow id="C9C897E9" data-category="placeholder"><mn id="F37E998C">21</mn></mrow></msub></mrow></mtd></mtr></mtable><mo id="AEBDC220" data-category="static">]</mo></mrow></mrow></math></span>.</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><mi mathvariant="italic">A</mi></mrow><mrow><mi mathvariant="italic">T</mi></mrow></msup><mtext> </mtext><mi mathvariant="italic">x</mi><mo>=</mo><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><msub><mrow><mn>10</mn><mi mathvariant="italic">x</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>+</mo><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mn>2</mn><mi mathvariant="italic">x</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>+</mo><mn>9</mn><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>+</mo><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>3</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mo>&#x22EE;</mo></mrow></mtd></mtr><mtr><mtd><mrow><mo>&#x22EE;</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mn>2</mn><mi mathvariant="italic">x</mi></mrow><mrow><mn>19</mn></mrow></msub><mo>+</mo><mn>9</mn><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>20</mn></mrow></msub><mo>+</mo><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>21</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mn>2</mn><mi mathvariant="italic">x</mi></mrow><mrow><mn>20</mn></mrow></msub><mo>+</mo><mn>10</mn><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>21</mn></mrow></msub></mrow></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><mn>2</mn><mo>⋅</mo><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mo>&#x22EE;</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>20</mn></mrow></msub></mrow></mtd></mtr></mtable><mo>]</mo></mrow><mo>+</mo><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><msub><mrow><mn>10</mn><mi mathvariant="italic">x</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mn>9</mn><mi mathvariant="italic">x</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mo>&#x22EE;</mo></mrow></mtd></mtr><mtr><mtd><mrow><mn>9</mn><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>20</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mn>10</mn><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>21</mn></mrow></msub></mrow></mtd></mtr></mtable><mo>]</mo></mrow><mo>+</mo><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>3</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mo>&#x22EE;</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>21</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mn>0</mn></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow></math></span>.</p><p>In MATLAB&#174;, write a function that creates these vectors and adds them together, thus giving the value of <code class="literal">A*x</code> or <code class="literal">A'*x</code>, depending on the flag input:</p><div class="code_responsive"><pre id="d126e1024836" class="programlisting"><span style="color:#0000FF">function</span> y = afun(x,flag)
<span style="color:#0000FF">if</span> strcmp(flag,<span style="color:#A020F0">'notransp'</span>) <span style="color:#228B22">% Compute A*x</span>
    y = [0; x(1:20)] <span style="color:#0000FF">...</span>
        + [(10:-1:0)'; (1:10)'].*x <span style="color:#0000FF">...</span>
        + 2*[x(2:end); 0];
<span style="color:#0000FF">elseif</span> strcmp(flag,<span style="color:#A020F0">'transp'</span>) <span style="color:#228B22">% Compute A'*x</span>
    y = 2*[0; x(1:20)] <span style="color:#0000FF">...</span>
        + [(10:-1:0)'; (1:10)'].*x <span style="color:#0000FF">...</span>
        + [x(2:end); 0];
<span style="color:#0000FF">end</span>
<span style="color:#0000FF">end</span>
</pre></div><p>(This function is saved as a local function at the end of the example.)</p><p>Now, solve the linear system <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">Ax</mi><mo>=</mo><mi mathvariant="italic">b</mi></mrow></math></span> by providing <code class="literal">lsqr</code> with the function handle that calculates <code class="literal">A*x</code> and <code class="literal">A'*x</code>. Use a tolerance of <code class="literal">1e-6</code> and 25 iterations. Specify <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">b</mi></mrow></math></span> as the row sums of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">A</mi></mrow></math></span> so that the true solution for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi></mrow></math></span> is a vector of ones.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>b = full(sum(A,2));
tol = 1e-6;  
maxit = 25;
x1 = lsqr(@afun,b,tol,maxit)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>lsqr converged at iteration 21 to a solution with relative residual 5.4e-13.
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>x1 = <span class="emphasis"><em>21×1</em></span>

    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
      &#x22EE;

</pre></div></div></div><div class="procedure"><span id="LSQRFunctionHandleExample-1" class="anchor_target"></span><p class="title" id="LSQRFunctionHandleExample-1"><b>Local Functions</b></p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> y = afun(x,flag)
<span style="color:#0000FF">if</span> strcmp(flag,<span style="color:#A020F0">'notransp'</span>) <span style="color:#228B22">% Compute A*x</span>
    y = [0; x(1:20)] <span style="color:#0000FF">...</span>
        + [(10:-1:0)'; (1:10)'].*x <span style="color:#0000FF">...</span>
        + 2*[x(2:end); 0];
<span style="color:#0000FF">elseif</span> strcmp(flag,<span style="color:#A020F0">'transp'</span>) <span style="color:#228B22">% Compute A'*x</span>
    y = 2*[0; x(1:20)] <span style="color:#0000FF">...</span>
        + [(10:-1:0)'; (1:10)'].*x <span style="color:#0000FF">...</span>
        + [x(2:end); 0];
<span style="color:#0000FF">end</span>
<span style="color:#0000FF">end</span></pre></div></div></div></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-LSQRFunctionHandleExample"><meta itemprop="exampletitle" content="Using Function Handle Instead of Numeric Matrix"></div></div></div></div><div class="ref_sect"><h2 id="mw_a0d08df6-302d-4f96-8a09-1d164db65d16">Input Arguments</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="mw_a0d08df6-302d-4f96-8a09-1d164db65d16_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="mw_3eec56d0-e068-49a8-8dff-01d7ab9782d9"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_3eec56d0-e068-49a8-8dff-01d7ab9782d9" data-bs-target="#expand_accordion_body_mw_3eec56d0-e068-49a8-8dff-01d7ab9782d9" aria-controls="expand_accordion_body_mw_3eec56d0-e068-49a8-8dff-01d7ab9782d9" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_A" class="anchor_target"></span><h3 id="mw_3eec56d0-e068-49a8-8dff-01d7ab9782d9"><code itemprop="name">A</code> &#8212; <span itemprop="purpose">Coefficient matrix</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">matrix</span> | <span itemprop="inputvalue">function handle</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_3eec56d0-e068-49a8-8dff-01d7ab9782d9" aria-labelledby="expand_accordion_heading_mw_3eec56d0-e068-49a8-8dff-01d7ab9782d9" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_3eec56d0-e068-49a8-8dff-01d7ab9782d9"><p>Coefficient matrix, specified as a matrix or function handle. This matrix is the
            coefficient matrix in the linear system <code class="literal">A*x = b</code>. Generally,
              <code class="literal">A</code> is a large sparse matrix or a function handle that returns the
            product of a large sparse matrix and column vector.</p><h4 class="descriptionsect">Specifying <code class="literal">A</code> as a Function Handle</h4>
    <p>You can optionally specify the coefficient matrix as a function handle instead of a matrix.
        The function handle returns matrix-vector products instead of forming the entire coefficient
        matrix, making the calculation more efficient.</p><p>To use a function handle, use the function signature <code class="literal">function y =
            afun(x,opt)</code>. <a href="../math/parameterizing-functions.html" class="a">Parameterizing Functions</a> explains how to
        provide additional parameters to the function <code class="function">afun</code>, if necessary. The
        function <code class="literal">afun</code> must satisfy these conditions:</p>
<div class="itemizedlist"><ul><li><p><code class="literal">afun(x,'notransp')</code> returns the product
                        <code class="literal">A*x</code>.</p></li><li><p><code class="literal">afun(x,'transp')</code> returns the product
                        <code class="literal">A'*x</code>.</p></li></ul></div><p>
An example of an acceptable function
        is:<div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> y = afun(x,opt,B,C,n)
<span style="color:#0000FF">if</span> strcmp(opt,<span style="color:#A020F0">'notransp'</span>)
    y = [B*x(n+1:end); C*x(1:n)];
<span style="color:#0000FF">else</span>
    y = [C'*x(n+1:end); B'*x(1:n)];
<span style="color:#0000FF">end</span></pre></div></div></div>The
        function <code class="literal">afun</code> uses the values in <code class="literal">B</code> and
            <code class="literal">C</code> to compute either <code class="literal">A*x</code> or <code class="literal">A'*x</code>
        (depending on the specified flag) without actually forming the entire matrix.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code> | <code itemprop="datatype">function_handle</code><br/>
<strong>Complex Number Support: </strong>Yes</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="f89-999296_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_f89-999296_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" data-bs-target="#expand_accordion_body_f89-999296_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" aria-controls="expand_accordion_body_f89-999296_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_b" class="anchor_target"></span><h3 id="f89-999296_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab"><code itemprop="name">b</code> &#8212; <span itemprop="purpose">Right side of linear equation</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">column vector</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_f89-999296_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" aria-labelledby="expand_accordion_heading_f89-999296_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f89-999296.mw_3800dea9-6306-44ef-9490-f16e20ceb7ab"><p>Right side of linear equation, specified as a
                                                  column vector. The length of <code class="literal">b</code>
                                                  must be equal to
                                                  <code class="literal">size(A,1)</code>.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code><br/>
<strong>Complex Number Support: </strong>Yes</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="f89-999296_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_f89-999296_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" data-bs-target="#expand_accordion_body_f89-999296_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" aria-controls="expand_accordion_body_f89-999296_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_tol" class="anchor_target"></span><h3 id="f89-999296_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b"><code itemprop="name">tol</code> &#8212; <span itemprop="purpose">Method tolerance</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue defaultvalue"><code class="literal">[]</code> or
                                    <code class="literal">1e-6</code></span> (default) | <span itemprop="inputvalue">positive scalar</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_f89-999296_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" aria-labelledby="expand_accordion_heading_f89-999296_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f89-999296.mw_b797b123-ccd8-4b99-a496-07d543d1a21b"><p>Method tolerance, specified as a positive scalar. Use this input to trade off accuracy and
                                    runtime in the calculation. <code class="function">lsqr</code>
                                    must meet the tolerance within the number of allowed iterations
                                    to be successful. A smaller value of <code class="literal">tol</code>
                                    means the answer must be more precise for the calculation to be
                                    successful.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code></p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="f89-999296_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_f89-999296_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" data-bs-target="#expand_accordion_body_f89-999296_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" aria-controls="expand_accordion_body_f89-999296_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_maxit" class="anchor_target"></span><h3 id="f89-999296_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16"><code itemprop="name">maxit</code> &#8212; <span itemprop="purpose">Maximum number of iterations</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue defaultvalue"><code class="literal">[]</code> or <code class="literal">min(size(A,1),20)</code></span> (default) | <span itemprop="inputvalue">positive scalar integer</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_f89-999296_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" aria-labelledby="expand_accordion_heading_f89-999296_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f89-999296.mw_843917a7-f520-49f0-8815-7ffb3f307a16"><p>Maximum number of iterations, specified as a positive scalar integer. Increase the value of
                <code class="literal">maxit</code> to allow more iterations for
                <code class="function">lsqr</code> to meet the tolerance <a href="#f89-999296_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="intrnllnk"><code class="argument">tol</code></a>.
            Generally, a smaller value of <code class="argument">tol</code> means more iterations are
            required to successfully complete the calculation.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code></p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="f89-999296_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_f89-999296_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" data-bs-target="#expand_accordion_body_f89-999296_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" aria-controls="expand_accordion_body_f89-999296_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_M" class="anchor_target"></span><span id="inputarg_M1" class="anchor_target"></span><span id="inputarg_M2" class="anchor_target"></span><h3 id="f89-999296_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667"><code itemprop="name">M</code>, <code itemprop="name">M1</code>, <code itemprop="name">M2</code> &#8212; <span itemprop="purpose">Preconditioner matrices (as separate arguments)</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue defaultvalue"><code class="literal">eye(size(A))</code></span> (default) | <span itemprop="inputvalue">matrices</span> | <span itemprop="inputvalue">function handles</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_f89-999296_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" aria-labelledby="expand_accordion_heading_f89-999296_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f89-999296.mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667"><p>Preconditioner matrices, specified as separate arguments of matrices or function
            handles. You can specify a preconditioner matrix <code class="literal">M</code> or its matrix
            factors <code class="literal">M = M1*M2</code> to improve the numerical aspects of the linear
            system and make it easier for <code class="function">lsqr</code> to converge quickly. For
            square coefficient matrices, you can use the incomplete matrix factorization functions
                <a href="ilu.html"><code class="function">ilu</code></a> and <a href="ichol.html"><code class="function">ichol</code></a> to generate preconditioner matrices. You also can use <a href="equilibrate.html"><code class="function">equilibrate</code></a> prior to factorization to improve the condition number of
            the coefficient matrix. For more information on preconditioners, see <a href="../math/iterative-methods-for-linear-systems.html" class="a">Iterative Methods for Linear Systems</a>.</p><p><code class="function">lsqr</code> treats unspecified preconditioners as identity
            matrices.</p>
            <h4 class="descriptionsect">Specifying <code class="literal">M</code> as a Function Handle</h4>
            <p>You can optionally specify any of <code class="literal">M</code>, <code class="literal">M1</code>, or
                    <code class="literal">M2</code> as function handles instead of matrices. The function
                handle performs matrix-vector operations instead of forming the entire
                preconditioner matrix, making the calculation more efficient.</p>
            <p>To use a function handle, first create a function with the signature
                    <code class="literal">function y = mfun(x,opt)</code>. <a href="../math/parameterizing-functions.html" class="a">Parameterizing Functions</a> explains
                how to provide additional parameters to the function <code class="function">mfun</code>, if
                necessary. The function <code class="literal">mfun</code> must satisfy these conditions:</p>
<div class="itemizedlist"><ul><li><p><code class="literal">mfun(x,'notransp')</code> returns the value of
                                <code class="literal">M\x</code> or <code class="literal">M2\(M1\x)</code>.</p></li><li><p><code class="literal">mfun(x,'transp')</code> returns the value of
                                <code class="literal">M'\x</code> or <code class="literal">M1'\(M2'\x)</code>.</p></li></ul></div><p>
An example of an acceptable function
                is:<div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> y = mfun(x,opt,a,b)  
<span style="color:#0000FF">if</span> strcmp(opt,<span style="color:#A020F0">'notransp'</span>)
    y = x.*a;
<span style="color:#0000FF">else</span>
    y = x.*b;
<span style="color:#0000FF">end</span>
<span style="color:#0000FF">end</span></pre></div></div></div>In
                this example the function <code class="literal">mfun</code> uses <code class="literal">a</code> and
                    <code class="literal">b</code> to compute either <code class="literal">M\x = x*a</code> or
                    <code class="literal">M'\x = x*b</code> (depending on the specified flag) without actually
                forming the entire matrix <code class="literal">M</code>.</p>
        </div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code> | <code itemprop="datatype">function_handle</code><br/>
<strong>Complex Number Support: </strong>Yes</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="f89-999296_sep_mw_40e27791-2264-4d42-8cb6-b8bf869783bc"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_f89-999296_sep_mw_40e27791-2264-4d42-8cb6-b8bf869783bc" data-bs-target="#expand_accordion_body_f89-999296_sep_mw_40e27791-2264-4d42-8cb6-b8bf869783bc" aria-controls="expand_accordion_body_f89-999296_sep_mw_40e27791-2264-4d42-8cb6-b8bf869783bc" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_x0" class="anchor_target"></span><h3 id="f89-999296_sep_mw_40e27791-2264-4d42-8cb6-b8bf869783bc"><code itemprop="name">x0</code> &#8212; <span itemprop="purpose">Initial guess</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue defaultvalue"><code class="literal">[]</code> or a column vector of zeros</span> (default) | <span itemprop="inputvalue">column vector</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_f89-999296_sep_mw_40e27791-2264-4d42-8cb6-b8bf869783bc" aria-labelledby="expand_accordion_heading_f89-999296_sep_mw_40e27791-2264-4d42-8cb6-b8bf869783bc" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f89-999296.mw_40e27791-2264-4d42-8cb6-b8bf869783bc"><p>Initial guess, specified as a column vector with length equal to <code class="literal">size(A,2)</code>.
            If you can provide <code class="function">lsqr</code> with a more reasonable initial guess
                <code class="literal">x0</code> than the default vector of zeros, then it can save computation
            time and help the algorithm converge faster.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code><br/>
<strong>Complex Number Support: </strong>Yes</p></div></div></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="mw_b0415add-c660-426a-a08c-5a7fc650e469">Output Arguments</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="mw_b0415add-c660-426a-a08c-5a7fc650e469_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_f89-999296_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" data-bs-target="#expand_accordion_body_f89-999296_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" aria-controls="expand_accordion_body_f89-999296_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_x" class="anchor_target"></span><h3 id="f89-999296_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7"><code class="name">x</code> &#8212; Linear system solution<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">column vector</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_f89-999296_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" aria-labelledby="expand_accordion_heading_f89-999296_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f89-999296.mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7"><p>Linear system solution, returned as a column vector. This output gives the
            approximate solution to the linear system <code class="literal">A*x = b</code>.</p><div class="itemizedlist"><ul><li><p>If <a href="#f89-999296_sep_mw_1f278699-812f-4628-8d99-e8f6ae362e34" class="intrnllnk"><code class="argument">flag</code></a> is <code class="literal">0</code> and <code class="literal">relres &lt;=
                  tol</code>, then <code class="literal">x</code> is a consistent solution to <code class="literal">A*x
                  = b</code>.</p></li><li><p>If <code class="argument">flag</code> is <code class="literal">0</code> but <code class="literal">relres &gt;
                  tol</code>, then <code class="literal">x</code> is the least squares solution that
                minimizes <code class="literal">norm(b-A*x)</code>. In this case, the
                  <a href="#mw_e22e7d07-6c93-446d-8811-040d5523a7c6" class="intrnllnk"><code class="argument">lsvec</code></a> output contains the scaled normal equation error of
                  <code class="literal">x</code>.</p></li></ul></div><p>Whenever the calculation is not successful (<code class="literal">flag ~= 0</code>), the
            solution <code class="literal">x</code> returned by <code class="function">lsqr</code> is the one with
            minimal norm residual computed over all the iterations.</p></div><p class="datatypelist"><strong>Data Types: </strong><code>single</code> | <code>double</code></p></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_f89-999296_sep_mw_1f278699-812f-4628-8d99-e8f6ae362e34" data-bs-target="#expand_accordion_body_f89-999296_sep_mw_1f278699-812f-4628-8d99-e8f6ae362e34" aria-controls="expand_accordion_body_f89-999296_sep_mw_1f278699-812f-4628-8d99-e8f6ae362e34" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_flag" class="anchor_target"></span><h3 id="f89-999296_sep_mw_1f278699-812f-4628-8d99-e8f6ae362e34"><code class="name">flag</code> &#8212; Convergence flag<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">scalar</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_f89-999296_sep_mw_1f278699-812f-4628-8d99-e8f6ae362e34" aria-labelledby="expand_accordion_heading_f89-999296_sep_mw_1f278699-812f-4628-8d99-e8f6ae362e34" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f89-999296.mw_1f278699-812f-4628-8d99-e8f6ae362e34"><p>Convergence flag, returned as one of the scalar values in this table. The convergence flag
            indicates whether the calculation was successful and differentiates between several
            different forms of failure.</p>
<span id="f89-999296.mw_209843fd-4b3b-4dff-acd5-04a205074bab" class="anchor_target"></span><div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="50%"><col class="tcol2" width="50%"></colgroup><thead><tr><th><p>Flag Value</p></th><th><p>Convergence</p></th></tr></thead><tbody><tr><td><p><code class="literal">0</code></p></td><td><p>Success &#8212; <code class="function">lsqr</code> converged to the
                                    desired tolerance <code class="literal">tol</code> within
                                        <code class="literal">maxit</code> iterations. </p></td></tr><tr><td><p><code class="literal">1</code></p></td><td><p>Failure &#8212; <code class="function">lsqr</code> iterated
                                        <code class="literal">maxit</code> iterations but did not
                                    converge.</p></td></tr><tr><td><p><code class="literal">2</code></p></td><td><p>Failure &#8212; The preconditioner matrix <code class="literal">M</code> or
                                        <code class="literal">M = M1*M2</code> is ill
                                conditioned.</p></td></tr><tr><td><p><code class="literal">3</code></p></td><td><p>Failure &#8212; <code class="function">lsqr</code> stagnated after
                                    two consecutive iterations were the same.</p></td></tr><tr><td><p><code class="literal">4</code></p></td><td><p>Failure &#8212; One of the scalar quantities calculated by the
                                        <code class="function">lsqr</code> algorithm became too small
                                    or too large to continue computing.</p></td></tr></tbody></table></div><p>
</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_f89-999296_sep_mw_6de229ba-091b-4137-acf4-6c7691a0398c" data-bs-target="#expand_accordion_body_f89-999296_sep_mw_6de229ba-091b-4137-acf4-6c7691a0398c" aria-controls="expand_accordion_body_f89-999296_sep_mw_6de229ba-091b-4137-acf4-6c7691a0398c" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_relres" class="anchor_target"></span><h3 id="f89-999296_sep_mw_6de229ba-091b-4137-acf4-6c7691a0398c"><code class="name">relres</code> &#8212; Relative residual error<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">scalar</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_f89-999296_sep_mw_6de229ba-091b-4137-acf4-6c7691a0398c" aria-labelledby="expand_accordion_heading_f89-999296_sep_mw_6de229ba-091b-4137-acf4-6c7691a0398c" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f89-999296.mw_6de229ba-091b-4137-acf4-6c7691a0398c"><p>Relative residual error, returned as a scalar. The relative residual error is an
            indication of how accurate the returned answer <code class="literal">x</code> is.
              <code class="function">lsqr</code> tracks the relative residual and least-squares residual at
            each iteration in the solution process, and the algorithm converges when
              <span class="emphasis"><em>either</em></span> residual meets the specified tolerance
              <a href="#f89-999296_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="intrnllnk"><code class="argument">tol</code></a>. The <code class="literal">relres</code> output contains the value of
            the residual that converged, either the relative residual or the least-squares residual:</p>
<div class="itemizedlist"><ul><li><p>The relative residual error is equal to <code class="literal">norm(b-A*x)/norm(b)</code>
                  and is generally the residual that meets the tolerance <code class="argument">tol</code>
                  when <code class="function">lsqr</code> converges. The <a href="#f89-999296_sep_mw_e2a3240f-74d0-4b34-943e-502f3dd9d174" class="intrnllnk"><code class="argument">resvec</code></a> output
                  tracks the history of this residual over all iterations.</p></li><li><p>The least-squares residual error is equal to
                    <code class="literal">norm((A*inv(M))'*(B-A*X))/norm(A*inv(M),'fro')</code>. This residual
                  causes <code class="function">lsqr</code> to converge less frequently than the relative
                  residual. The <a href="#mw_e22e7d07-6c93-446d-8811-040d5523a7c6" class="intrnllnk"><code class="argument">lsvec</code></a> output tracks the history of this
                  residual over all iterations.</p></li></ul></div><p>
</p></div><p class="datatypelist"><strong>Data Types: </strong><code>single</code> | <code>double</code></p></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_f89-999296_sep_mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4" data-bs-target="#expand_accordion_body_f89-999296_sep_mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4" aria-controls="expand_accordion_body_f89-999296_sep_mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_iter" class="anchor_target"></span><h3 id="f89-999296_sep_mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4"><code class="name">iter</code> &#8212; Iteration number<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">scalar</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_f89-999296_sep_mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4" aria-labelledby="expand_accordion_heading_f89-999296_sep_mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f89-999296.mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4"><p>Iteration number, returned as a scalar. This output indicates the iteration number at which
                                    the computed answer for <a href="#f89-999296_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a> was
                                    calculated.</p></div><p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_f89-999296_sep_mw_e2a3240f-74d0-4b34-943e-502f3dd9d174" data-bs-target="#expand_accordion_body_f89-999296_sep_mw_e2a3240f-74d0-4b34-943e-502f3dd9d174" aria-controls="expand_accordion_body_f89-999296_sep_mw_e2a3240f-74d0-4b34-943e-502f3dd9d174" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_resvec" class="anchor_target"></span><h3 id="f89-999296_sep_mw_e2a3240f-74d0-4b34-943e-502f3dd9d174"><code class="name">resvec</code> &#8212; Residual error<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">vector</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_f89-999296_sep_mw_e2a3240f-74d0-4b34-943e-502f3dd9d174" aria-labelledby="expand_accordion_heading_f89-999296_sep_mw_e2a3240f-74d0-4b34-943e-502f3dd9d174" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f89-999296.mw_e2a3240f-74d0-4b34-943e-502f3dd9d174"><p>Residual error, returned as a vector. The residual error <code class="literal">norm(b-A*x)</code>
            reveals how close the algorithm is to converging for a given value of
                <code class="literal">x</code>. The number of elements in <code class="literal">resvec</code> is equal
            to the number of iterations. You can examine the contents of <code class="literal">resvec</code>
            to help decide whether to change the values of <a href="#f89-999296_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="intrnllnk"><code class="argument">tol</code></a> or
                <a href="#f89-999296_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" class="intrnllnk"><code class="argument">maxit</code></a>.</p></div><p class="datatypelist"><strong>Data Types: </strong><code>single</code> | <code>double</code></p></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_e22e7d07-6c93-446d-8811-040d5523a7c6" data-bs-target="#expand_accordion_body_mw_e22e7d07-6c93-446d-8811-040d5523a7c6" aria-controls="expand_accordion_body_mw_e22e7d07-6c93-446d-8811-040d5523a7c6" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_lsvec" class="anchor_target"></span><h3 id="mw_e22e7d07-6c93-446d-8811-040d5523a7c6"><code class="name">lsvec</code> &#8212; Scaled normal equation error<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">vector</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_e22e7d07-6c93-446d-8811-040d5523a7c6" aria-labelledby="expand_accordion_heading_mw_e22e7d07-6c93-446d-8811-040d5523a7c6" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_e22e7d07-6c93-446d-8811-040d5523a7c6"><p>Scaled normal equation error, returned as a vector. For each iteration,
              <code class="literal">lsvec</code> contains an estimate of the scaled normal equation residual
              <code class="literal">norm((A*inv(M))'*(B-A*X))/norm(A*inv(M),'fro')</code>. The number of
            elements in <code class="literal">lsvec</code> is equal to the number of iterations.</p></div><p class="datatypelist"><strong>Data Types: </strong><code>single</code> | <code>double</code></p></div></div></div></div></div></div></div></div></div><div class="moreabout ref_sect"><h2 id="mw_fcea744a-710d-4c19-a075-f60d83635d03">More About</h2><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true2">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_mw_783f22d5-a612-4382-acb8-a4635fb42b52" aria-controls="expand_body_mw_783f22d5-a612-4382-acb8-a4635fb42b52" class="accordion-button" aria-expanded="true"><h3 id="mw_783f22d5-a612-4382-acb8-a4635fb42b52">Least Squares Method</h3></button></div><div id="expand_body_mw_783f22d5-a612-4382-acb8-a4635fb42b52" class="accordion-collapse collapsed collapse show"><div class="accordion-body"><p class="shortdesc">The least squares (LSQR) algorithm is an adaptation of the conjugate
        gradients (CG) method for rectangular matrices. Analytically, LSQR for <code class="literal">A*x =
          b</code> produces the same residuals as CG for the normal equations <code class="literal">A'*A*x =
          A'*b</code>, but LSQR possesses more favorable numeric properties and is thus generally
        more reliable <a href="lsqr.html#bqvpdbm-1" class="intrnllnk">[1]</a>.</p><p>The least squares method is the only iterative linear system solver that can handle
        rectangular and inconsistent coefficient matrices.</p></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="f89-999296_sep_mw_021450b1-4be9-4d57-b903-c4a2d800c810">Tips</h2><div class="itemizedlist"><ul><li><p>Convergence of most iterative methods depends on the condition number of the
                coefficient matrix, <code class="literal">cond(A)</code>. When <code class="literal">A</code> is square,
                you can use <a href="equilibrate.html"><code class="function">equilibrate</code></a> to improve its condition number, and on its own this
                makes it easier for most iterative solvers to converge. However, using
                    <code class="function">equilibrate</code> also leads to better quality preconditioner
                matrices when you subsequently factor the equilibrated matrix <code class="literal">B =
                    R*P*A*C</code>.</p></li><li><p>You can use matrix reordering functions such as <code class="function">dissect</code> and
                    <code class="function">symrcm</code> to permute the rows and columns of the coefficient
                matrix and minimize the number of nonzeros when the coefficient matrix is factored
                to generate a preconditioner. This can reduce the memory and time required to
                subsequently solve the preconditioned linear system.</p></li></ul></div></div><div class="bibliography"><h2 id="References">References</h2><div id="bqvpdbm-1" class="bibliomixed"><p>[1] Barrett, R., M. Berry, T. F. Chan, et al., <em class="citetitle">Templates
        for the Solution of Linear Systems: Building Blocks for Iterative Methods</em>, SIAM,
      Philadelphia, 1994. </p></div><div id="bqvpdbt-1" class="bibliomixed"><p>[2] Paige, C. C. and M. A. Saunders, "LSQR: An Algorithm for Sparse
      Linear Equations And Sparse Least Squares," <em class="citetitle">ACM Trans. Math. Soft.</em>,
      Vol.8, 1982, pp.&nbsp;43-71. </p></div></div><div class="ref_sect"><h2 id="refsect-extended-capabilities">Extended Capabilities</h2><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink">expand all</a></p><div id="accordion_refsect-extended-capabilities" role="tablist" aria-multiselectable="true"><span id="mw_aafe6e62-de11-44ea-a1fd-bdc091b24931" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="f89-999296" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_f89-999296_threadsupport" aria-controls="expand_body_f89-999296_threadsupport" class="accordion-button collapsed" aria-expanded="false"><h3 id="f89-999296_threadsupport">Thread-Based Environment<br/> <span class=" remove_bold add_font_color_general">Run code in the background using MATLAB&#174; <code class="function">backgroundPool</code> or accelerate code with Parallel Computing Toolbox&#8482; <code class="function">ThreadPool</code>.</span></h3></button></div><div id="expand_body_f89-999296_threadsupport" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>This function fully supports thread-based environments. For
                more information, see <a href="../matlab_prog/run-functions-on-threads.html" class="a">Run MATLAB Functions in Thread-Based Environment</a>.</p></div></div></div></div></div><span id="mw_87e6798a-206b-4da6-b7f4-007657ebc163" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="f89-999296" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_f89-999296_gpuarrays" aria-controls="expand_body_f89-999296_gpuarrays" class="accordion-button collapsed" aria-expanded="false"><h3 id="f89-999296_gpuarrays">GPU Arrays<br/> <span class=" remove_bold add_font_color_general">Accelerate code by running on a graphics processing unit (GPU) using Parallel Computing Toolbox&#8482;.</span></h3></button></div><div id="expand_body_f89-999296_gpuarrays" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>The <code class="function">lsqr</code> function
    supports GPU array input with these usage notes and limitations:</p><div class="itemizedlist"><ul><li><p>Output of least squares estimates as a sixth return value is not supported.</p></li><li><p>When input <code class="literal">A</code> is a sparse matrix:</p>
<div class="itemizedlist"><ul><li><p>If
    you use two preconditioners, <code class="literal">M1</code> and <code class="literal">M2</code>, then they must be
    lower triangular and upper triangular matrices, or both of them must be function handles. Using
    lower triangular and upper triangular preconditioner matrices instead of function handles can
    significantly improve computation speed.</p></li></ul></div><p>
</p></li></ul></div><p>For more information, see <a href="../../parallel-computing/run-matlab-functions-on-a-gpu.html" class="a">Run MATLAB Functions on a GPU</a><span role="cross_prod"> (Parallel Computing Toolbox)</span>.</p></div></div></div></div></div><span id="mw_607ca134-49d0-48fa-98a0-0ab51bd3eb5b" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="f89-999296" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_f89-999296_distributedarrays" aria-controls="expand_body_f89-999296_distributedarrays" class="accordion-button collapsed" aria-expanded="false"><h3 id="f89-999296_distributedarrays">Distributed Arrays<br/> <span class=" remove_bold add_font_color_general">Partition large arrays across the combined memory of your cluster using Parallel Computing Toolbox&#8482;.</span></h3></button></div><div id="expand_body_f89-999296_distributedarrays" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>Usage notes and limitations:</p><div class="itemizedlist"><ul><li><p>If <code class="literal">M1</code> is a function, then it is applied independently to each
            row.</p></li></ul></div><p>For more information, see <a href="../../parallel-computing/run-matlab-functions-with-distributed-arrays.html" class="a">Run MATLAB Functions with Distributed Arrays</a><span role="cross_prod"> (Parallel Computing Toolbox)</span>.</p></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="mw_30ca6faa-b156-4980-9d0a-1c9d612db7d1">Version History</h2><strong>Introduced before R2006a</strong><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink">expand all</a></p><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="f89-999296.mw_7463413e-98d4-46c3-a401-f17c5cf7a6c1" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_f89-999296_sep_mw_7463413e-98d4-46c3-a401-f17c5cf7a6c1" aria-controls="expand_body_f89-999296_sep_mw_7463413e-98d4-46c3-a401-f17c5cf7a6c1" class="accordion-button collapsed" aria-expanded="false"><h3 id="f89-999296_sep_mw_7463413e-98d4-46c3-a401-f17c5cf7a6c1">R2025a: <span class="remove_bold">Specify single-precision input arguments</span></h3></button></div><div id="expand_body_f89-999296_sep_mw_7463413e-98d4-46c3-a401-f17c5cf7a6c1" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>You can specify these arguments as single precision:</p>
<div class="itemizedlist"><ul><li><p><code class="argument">A</code> &#8212; Coefficient matrix</p></li><li><p><code class="argument">b</code> &#8212; Right side of linear equation</p></li><li><p><code class="argument">M</code>, <code class="argument">M1</code>, <code class="argument">M2</code> &#8212;
                    Preconditioner matrices</p></li><li><p><code class="argument">x0</code> &#8212; Initial guess</p></li></ul></div><p>
</p><p>If you specify any of these arguments as single precision, the function computes in single
        precision and returns the linear system solution, relative residual error, and residual
        error outputs as type <code class="class">single</code>. For faster computation, specify all arguments,
        including function handle outputs, as the same precision.</p></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="f89-999296_seealso">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="cgs.html"><span itemprop="name"><code class="function">cgs</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="gmres.html"><span itemprop="name"><code class="function">gmres</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="minres.html"><span itemprop="name"><code class="function">minres</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="norm.html"><span itemprop="name"><code class="function">norm</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="pcg.html"><span itemprop="name"><code class="function">pcg</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="qmr.html"><span itemprop="name"><code class="function">qmr</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="symmlq.html"><span itemprop="name"><code class="function">symmlq</code></span></a></span></p><div class="examples_container"><h3 class="remove_border">Topics</h3><div itemprop="content"><ul class="list-unstyled"><li><a href="../math/iterative-methods-for-linear-systems.html" class="a">Iterative Methods for Linear Systems</a></li></ul></div></div></div>
    </div></div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

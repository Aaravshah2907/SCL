<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>chol</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../linear-algebra.html",
          "name": "Linear Algebra"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "linear-algebra"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExtendedCapabilities",

        "itemListElement":
        [
{
          "@type": "ListItem",
          "position": 1,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "codegen",
          "value": "limited"

        }
          },
{
          "@type": "ListItem",
          "position": 2,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "distributedarrays",
          "value": "limited"

        }
          },
{
          "@type": "ListItem",
          "position": 3,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "gpuarrays",
          "value": "limited"

        }
          },
{
          "@type": "ListItem",
          "position": 4,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "gpucodegen",
          "value": "limited"

        }
          },
{
          "@type": "ListItem",
          "position": 5,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "threadsupport",
          "value": "full"

        }
          }
        ]
        }
        </script>
<meta xmlns="http://www.w3.org/1999/xhtml" name="chunktype" content="refpage"><meta xmlns="http://www.w3.org/1999/xhtml" name="refentity" itemprop="refentity" content="function:chol"><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="fcn">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ref/function">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This MATLAB function factorizes symmetric positive definite matrix A into an upper triangular R that satisfies A = R'*R."><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "refentry";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../linear-algebra.html?s_tid=CRUX_lftnav" itemprop="url" id="linear-algebra"><span itemprop="title">Linear Algebra</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item notranslate"><a href="#responsive_offcanvas"><span class="refname">chol</span></a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-refentry">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li><a href="#mw_bcb08821-96ed-4621-b212-83d52e4c5e6b" class="intrnllnk">Syntax</a></li><li class="nav-item"><a href="#description" class="nav-link intrnllnk">Description</a></li><li class="nav-item"><a href="#mw_c9e60a42-9e48-4535-a629-675ac4a63ccc" class="nav-link intrnllnk">Examples</a><ul class="nav"><li class="nav-item"><a href="#mw_e79f7431-e58b-41af-8af3-34a416a9811b" class="nav-link intrnllnk">Solve Linear System with Symmetric Positive Definite Matrix</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_3bd564e7-3c42-4828-9038-8952ff96df3b" class="nav-link intrnllnk">Cholesky Factorization of Matrix</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_0b6a97a3-98ca-4cb2-a993-f6fa105a069f" class="nav-link intrnllnk">Suppress Errors for Nonsymmetric Positive Definite Matrices</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_0bfbea4b-8b32-4dcc-8405-fa5c79701026" class="nav-link intrnllnk">Cholesky Factor of Sparse Matrix</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_e066fd96-2894-4000-ad1e-e510bd567235" class="nav-link intrnllnk">Reorder Sparse Matrix with Permutation Vector</a></li></ul></li><li class="nav-item"><a href="#mw_84e0c107-c850-4f86-9c7a-bd732845521c" class="nav-link intrnllnk">Input Arguments</a><ul class="nav"><li class="nav-item"><a href="#mw_91dc7b0f-768f-4a6b-ab21-391fd8ee5851" class="nav-link intrnllnk">A</a></li><li class="nav-item"><a href="#mw_bd8d494d-1956-4117-a10b-1adaa40cfc91" class="nav-link intrnllnk">S</a></li><li class="nav-item"><a href="#mw_ffc71c97-36a0-4335-8e05-82ecff3e6312" class="nav-link intrnllnk">triangle</a></li><li class="nav-item"><a href="#mw_2bc2adb8-4c9b-4515-9939-7769773a490d" class="nav-link intrnllnk">outputForm</a></li></ul></li><li class="nav-item"><a href="#mw_07d79b8a-27d7-4b11-b79a-62c6317bdce6" class="nav-link intrnllnk">Output Arguments</a><ul class="nav"><li class="nav-item"><a href="#mw_3e727a04-bd5b-42cd-b5bb-a3f7b411912e" class="nav-link intrnllnk">R</a></li><li class="nav-item"><a href="#mw_da905fd8-e0ca-4b83-884e-1216badb7607" class="nav-link intrnllnk">flag</a></li><li class="nav-item"><a href="#mw_9048ccd2-eccf-45df-a23b-5fa1ce84d320" class="nav-link intrnllnk">P</a></li></ul></li><li class="nav-item"><a href="#mw_07d01bf3-fa93-492c-813c-bde4e853f9f4" class="nav-link intrnllnk">More About</a><ul class="nav"><li class="nav-item"><a href="#mw_9b25d49a-49b6-49cb-ab22-c6e8e4d07bf7" class="nav-link intrnllnk">Symmetric Positive Definite Matrix</a></li></ul></li><li class="nav-item"><a href="#mw_e0d7f8e9-8482-454b-b613-266bf049086f" class="nav-link intrnllnk">Tips</a></li><li><a href="#References" class="intrnllnk">References</a></li><li class="nav-item"><a href="#refsect-extended-capabilities" class="nav-link intrnllnk">Extended Capabilities</a></li><li class="nav-item"><a href="#mw_11c60e17-b2fb-42b6-b3b6-07491ac99141" class="nav-link intrnllnk">Version History</a><ul class="nav"><li class="nav-item"><a href="#mw_79623995-8bd5-48b6-99ec-61927c855452" class="nav-link intrnllnk">Code generation support for sparse matrices of type <code class="literal">double</code></a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_ed81ca8e-fb27-4d04-8b2d-1fa0f547f655" class="nav-link intrnllnk">Specify single-precision sparse input argument</a></li></ul></li><li class="nav-item"><a href="#f80-998736_seealso" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=linear-algebra&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=linear-algebra&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=linear-algebra&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=linear-algebra&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=linear-algebra&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=linear-algebra&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-ref-function"><div class="function_ref"><span id="f80-998736" class="anchor_target"></span><h1 class="r2025b notranslate" itemprop="title"><span class="refname">chol</span></h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">Cholesky factorization</p><div class="switch"><a href="javascript:void(0);" id="expandAllPage" data-allexpanded="true1">collapse all in page</a></div></div></div>
<span id="mw_bcb08821-96ed-4621-b212-83d52e4c5e6b" class="anchor_target"></span><div class="ref_sect"><h2 id="mw_bcb08821-96ed-4621-b212-83d52e4c5e6b">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><div class="code_responsive"><code class="synopsis"><a href="#d126e209683" class="intrnllnk">R = chol(A)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e209711" class="intrnllnk">R = chol(A,triangle)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e209747" class="intrnllnk">[R,flag] = chol(<span class="argument_placeholder">___</span>)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e209792" class="intrnllnk">[R,flag,P] = chol(S)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e209827" class="intrnllnk">[R,flag,P] = chol(<span class="argument_placeholder">___</span>,outputForm)</a></code></div></div></div></div><div class="clear"></div><span id="mw_7fed83db-f8af-48b5-8166-1c889b759a8c" class="anchor_target"></span><h2 id="description">Description</h2><div class="descriptions"><div class="cshsummary" id="csh_f80-998736"><div class="description_module"><div class="description_element"><div class="code_responsive"><p><span id="d126e209683" itemprop="syntax"><code class="synopsis"><a href="#mw_3e727a04-bd5b-42cd-b5bb-a3f7b411912e" class="intrnllnk"><code class="argument">R</code></a> = chol(<a href="#mw_91dc7b0f-768f-4a6b-ab21-391fd8ee5851" class="intrnllnk"><code class="argument">A</code></a>)</code></span> factorizes
        symmetric positive definite matrix <code class="literal">A</code> into an upper triangular
          <code class="literal">R</code> that satisfies <code class="literal">A = R'*R</code>. If <code class="literal">A</code>
        is nonsymmetric, then <code class="function">chol</code> treats the matrix as symmetric and uses only
        the diagonal and upper triangle of <code class="literal">A</code>.</p></div><p class="syntax_example"><a href="chol.html#mw_e79f7431-e58b-41af-8af3-34a416a9811b" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e209711" itemprop="syntax"><code class="synopsis"><a href="#mw_3e727a04-bd5b-42cd-b5bb-a3f7b411912e" class="intrnllnk"><code class="argument">R</code></a> = chol(<a href="#mw_91dc7b0f-768f-4a6b-ab21-391fd8ee5851" class="intrnllnk"><code class="argument">A</code></a>,<a href="#mw_ffc71c97-36a0-4335-8e05-82ecff3e6312" class="intrnllnk"><code class="argument">triangle</code></a>)</code></span>
        specifies which triangular factor of <code class="literal">A</code> to use in computing the
        factorization. For example, if <code class="literal">triangle</code> is <code class="literal">'lower'</code>,
        then <code class="function">chol</code> uses only the diagonal and lower triangular portion of
          <code class="literal">A</code> to produce a lower triangular matrix <code class="literal">R</code> that
        satisfies <code class="literal">A = R*R'</code>. The default value of <code class="literal">triangle</code> is
          <code class="literal">'upper'</code>.</p></div><p class="syntax_example"><a href="chol.html#mw_3bd564e7-3c42-4828-9038-8952ff96df3b" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e209747" itemprop="syntax"><code class="synopsis">[<a href="#mw_3e727a04-bd5b-42cd-b5bb-a3f7b411912e" class="intrnllnk"><code class="argument">R</code></a>,<a href="#mw_da905fd8-e0ca-4b83-884e-1216badb7607" class="intrnllnk"><code class="argument">flag</code></a>] = chol(<span class="argument_placeholder">___</span>)</code></span>
        also returns the output <code class="literal">flag</code> indicating whether <code class="literal">A</code> is
          <a href="chol.html#mw_9b25d49a-49b6-49cb-ab22-c6e8e4d07bf7" class="intrnllnk">symmetric positive
          definite</a>. You can use any of the input argument combinations in previous syntaxes.
        When you specify the <code class="literal">flag</code> output, <code class="function">chol</code> does not
        generate an error if the input matrix is not symmetric positive definite. </p>
<div class="itemizedlist"><ul><li><p>If <code class="literal">flag = 0</code> then the input matrix is symmetric positive
              definite and the factorization was successful.</p></li><li><p>If <code class="literal">flag</code> is not zero, then the input matrix is
                <span class="emphasis"><em>not</em></span> symmetric positive definite and <code class="literal">flag</code> is
              an integer indicating the index of the pivot position where the factorization
              failed.</p></li></ul></div><p>
</p></div><p class="syntax_example"><a href="chol.html#mw_0b6a97a3-98ca-4cb2-a993-f6fa105a069f" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e209792" itemprop="syntax"><code class="synopsis">[<a href="#mw_3e727a04-bd5b-42cd-b5bb-a3f7b411912e" class="intrnllnk"><code class="argument">R</code></a>,<a href="#mw_da905fd8-e0ca-4b83-884e-1216badb7607" class="intrnllnk"><code class="argument">flag</code></a>,<a href="#mw_9048ccd2-eccf-45df-a23b-5fa1ce84d320" class="intrnllnk"><code class="argument">P</code></a>] = chol(<a href="#mw_bd8d494d-1956-4117-a10b-1adaa40cfc91" class="intrnllnk"><code class="argument">S</code></a>)</code></span>
        additionally returns a permutation matrix <code class="literal">P</code>, which is a preordering of
        sparse matrix <code class="literal">S</code> obtained by <code class="function">amd</code>. If <code class="literal">flag =
          0</code>, then <code class="literal">S</code> is symmetric positive definite and
          <code class="literal">R</code> is an upper triangular matrix satisfying <code class="literal">R'*R =
          P'*S*P</code>.</p></div><p class="syntax_example"><a href="chol.html#mw_0bfbea4b-8b32-4dcc-8405-fa5c79701026" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e209827" itemprop="syntax"><code class="synopsis">[<a href="#mw_3e727a04-bd5b-42cd-b5bb-a3f7b411912e" class="intrnllnk"><code class="argument">R</code></a>,<a href="#mw_da905fd8-e0ca-4b83-884e-1216badb7607" class="intrnllnk"><code class="argument">flag</code></a>,<a href="#mw_9048ccd2-eccf-45df-a23b-5fa1ce84d320" class="intrnllnk"><code class="argument">P</code></a>] = chol(<span class="argument_placeholder">___</span>,<a href="#mw_2bc2adb8-4c9b-4515-9939-7769773a490d" class="intrnllnk"><code class="argument">outputForm</code></a>)</code></span>
        specifies whether to return the permutation information <code class="literal">P</code> as a matrix or
        vector, using any of the input argument combinations in previous syntaxes. This option is
        only available for sparse matrix inputs. For example, if <code class="literal">outputForm</code> is
          <code class="literal">'vector'</code> and <code class="literal">flag = 0</code>, then <code class="literal">S(p,p) =
          R'*R</code>. The default value of <code class="literal">outputForm</code> is
          <code class="literal">'matrix'</code> such that <code class="literal">R'*R = P'*S*P</code>.</p></div><p class="syntax_example"><a href="chol.html#mw_e066fd96-2894-4000-ad1e-e510bd567235" class="intrnllnk">example</a></p></div></div></div></div><div class="clear"></div><div class="examples"><h2 id="mw_c9e60a42-9e48-4535-a629-675ac4a63ccc">Examples</h2><div class="expandableContent" id="expandableExamples"><p class="switch"><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true3">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_e79f7431-e58b-41af-8af3-34a416a9811b"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_e79f7431-e58b-41af-8af3-34a416a9811b" data-bs-target="#expand_accordion_body_mw_e79f7431-e58b-41af-8af3-34a416a9811b" aria-controls="expand_accordion_body_mw_e79f7431-e58b-41af-8af3-34a416a9811b" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_e79f7431-e58b-41af-8af3-34a416a9811b">Solve Linear System with Symmetric Positive Definite Matrix</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_e79f7431-e58b-41af-8af3-34a416a9811b" aria-labelledby="expand_accordion_heading_mw_e79f7431-e58b-41af-8af3-34a416a9811b" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/SolveLinSysWithSymMatrixExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Solve Linear System with Symmetric Positive Definite Matrix",
          "description": "Use chol to factorize a symmetric coefficient matrix, and then solve a linear system using the Cholesky factor.",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "chol.html"

        },
          "identifier": "matlab.SolveLinSysWithSymMatrixExample",
          "name": "SolveLinSysWithSymMatrixExample",
          "url": "chol.html#mw_e79f7431-e58b-41af-8af3-34a416a9811b"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/SolveLinSysWithSymMatrixExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "SolveLinSysWithSymMatrixExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Use <code class="literal">chol</code> to factorize a symmetric coefficient matrix, and then solve a linear system using the Cholesky factor.</p><p>Create a symmetric matrix with positive values on the diagonal.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>A = [1 0 1; 0 2 0; 1 0 3]</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>A = <span class="emphasis"><em>3×3</em></span>

     1     0     1
     0     2     0
     1     0     3

</pre></div></div></div><p>Calculate the Cholesky factor of the matrix.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>R = chol(A)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>R = <span class="emphasis"><em>3×3</em></span>

    1.0000         0    1.0000
         0    1.4142         0
         0         0    1.4142

</pre></div></div></div><p>Create a vector for the right-hand side of the equation <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">Ax</mi><mo>=</mo><mi mathvariant="italic">b</mi></mrow></math></span>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>b = sum(A,2);</pre></div></div></div><p>Since <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">A</mi><mo>=</mo><msup><mrow><mi mathvariant="italic">R</mi></mrow><mrow><mi mathvariant="italic">T</mi></mrow></msup><mi mathvariant="italic">R</mi></mrow></math></span> with the Cholesky decomposition, the linear equation becomes <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><mi mathvariant="italic">R</mi></mrow><mrow><mi mathvariant="italic">T</mi></mrow></msup><mi mathvariant="italic">R</mi><mtext> </mtext><mi mathvariant="italic">x</mi><mo>=</mo><mi mathvariant="italic">b</mi></mrow></math></span>. Solve for <code class="literal">x</code> using the backslash operator.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>x = R\(R'\b)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>x = <span class="emphasis"><em>3×1</em></span>

    1.0000
    1.0000
    1.0000

</pre></div></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-SolveLinSysWithSymMatrixExample"><meta itemprop="exampletitle" content="Solve Linear System with Symmetric Positive Definite Matrix"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_3bd564e7-3c42-4828-9038-8952ff96df3b"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_3bd564e7-3c42-4828-9038-8952ff96df3b" data-bs-target="#expand_accordion_body_mw_3bd564e7-3c42-4828-9038-8952ff96df3b" aria-controls="expand_accordion_body_mw_3bd564e7-3c42-4828-9038-8952ff96df3b" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_3bd564e7-3c42-4828-9038-8952ff96df3b">Cholesky Factorization of Matrix</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_3bd564e7-3c42-4828-9038-8952ff96df3b" aria-labelledby="expand_accordion_heading_mw_3bd564e7-3c42-4828-9038-8952ff96df3b" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/CholeskyFactorsOfMatrixExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Cholesky Factorization of Matrix",
          "description": "Calculate the upper and lower Cholesky factorizations of a matrix and verify the results.",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "chol.html"

        },
          "identifier": "matlab.CholeskyFactorsOfMatrixExample",
          "name": "CholeskyFactorsOfMatrixExample",
          "url": "chol.html#mw_3bd564e7-3c42-4828-9038-8952ff96df3b"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/CholeskyFactorsOfMatrixExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "CholeskyFactorsOfMatrixExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Calculate the upper and lower Cholesky factorizations of a matrix and verify the results.</p><p>Create a 6-by-6 symmetric positive definite test matrix using the <code class="literal">gallery</code> function.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>A = gallery(<span style="color:#A020F0">'lehmer'</span>,6);</pre></div></div></div><p>Calculate the Cholesky factor using the upper triangle of <code class="literal">A</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>R = chol(A)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>R = <span class="emphasis"><em>6×6</em></span>

    1.0000    0.5000    0.3333    0.2500    0.2000    0.1667
         0    0.8660    0.5774    0.4330    0.3464    0.2887
         0         0    0.7454    0.5590    0.4472    0.3727
         0         0         0    0.6614    0.5292    0.4410
         0         0         0         0    0.6000    0.5000
         0         0         0         0         0    0.5528

</pre></div></div></div><p>Verify that the upper triangular factor satisfies <code class="literal">R'*R - A = 0</code>, within round-off error.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>norm(R'*R - A)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans = 
2.5801e-16
</pre></div></div></div><p>Now, specify the <code class="literal">'lower'</code> option to calculate the Cholesky factor using the lower triangle of <code class="literal">A</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>L = chol(A,<span style="color:#A020F0">'lower'</span>)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>L = <span class="emphasis"><em>6×6</em></span>

    1.0000         0         0         0         0         0
    0.5000    0.8660         0         0         0         0
    0.3333    0.5774    0.7454         0         0         0
    0.2500    0.4330    0.5590    0.6614         0         0
    0.2000    0.3464    0.4472    0.5292    0.6000         0
    0.1667    0.2887    0.3727    0.4410    0.5000    0.5528

</pre></div></div></div><p>Verify that the lower triangular factor satisfies <code class="literal">L*L' - A = 0</code>, within round-off error.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>norm(L*L' - A)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans = 
2.5801e-16
</pre></div></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-CholeskyFactorsOfMatrixExample"><meta itemprop="exampletitle" content="Cholesky Factorization of Matrix"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_0b6a97a3-98ca-4cb2-a993-f6fa105a069f"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_0b6a97a3-98ca-4cb2-a993-f6fa105a069f" data-bs-target="#expand_accordion_body_mw_0b6a97a3-98ca-4cb2-a993-f6fa105a069f" aria-controls="expand_accordion_body_mw_0b6a97a3-98ca-4cb2-a993-f6fa105a069f" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_0b6a97a3-98ca-4cb2-a993-f6fa105a069f">Suppress Errors for Nonsymmetric Positive Definite Matrices</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_0b6a97a3-98ca-4cb2-a993-f6fa105a069f" aria-labelledby="expand_accordion_heading_mw_0b6a97a3-98ca-4cb2-a993-f6fa105a069f" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/SuppressErrorsForNonSPDMatricesExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Suppress Errors for Nonsymmetric Positive Definite Matrices",
          "description": "Use chol with two outputs to suppress errors when the input matrix is not symmetric positive definite.",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "chol.html"

        },
          "identifier": "matlab.SuppressErrorsForNonSPDMatricesExample",
          "name": "SuppressErrorsForNonSPDMatricesExample",
          "url": "chol.html#mw_0b6a97a3-98ca-4cb2-a993-f6fa105a069f"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/SuppressErrorsForNonSPDMatricesExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "SuppressErrorsForNonSPDMatricesExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Use <code class="literal">chol</code> with two outputs to suppress errors when the input matrix is not symmetric positive definite.</p><p>Create a 5-by-5 matrix of binomial coefficients. This matrix is symmetric positive definite, so subtract 1 from the last element to ensure it is no longer positive definite.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>A = pascal(5);
A(end) = A(end) - 1</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>A = <span class="emphasis"><em>5×5</em></span>

     1     1     1     1     1
     1     2     3     4     5
     1     3     6    10    15
     1     4    10    20    35
     1     5    15    35    69

</pre></div></div></div><p>Calculate the Cholesky factor for <code class="literal">A</code>. Specify two outputs to avoid generating an error if <code class="literal">A</code> is not symmetric positive definite.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[R,flag] = chol(A)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>R = <span class="emphasis"><em>4×4</em></span>

     1     1     1     1
     0     1     2     3
     0     0     1     3
     0     0     0     1

</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>flag = 
5
</pre></div></div></div><p>Since <code class="literal">flag</code> is nonzero, it gives the pivot index where the factorization fails. <code class="literal">chol</code> is able to calculate <code class="literal">q = flag-1 = 4</code> rows and columns correctly before failing when it encounters the part of the matrix that changed.</p><p>Verify that <code class="literal">R'*R</code> returns four rows and columns that agree with <code class="literal">A(1:q,1:q)</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>q = flag-1;
R'*R</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans = <span class="emphasis"><em>4×4</em></span>

     1     1     1     1
     1     2     3     4
     1     3     6    10
     1     4    10    20

</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>A(1:q,1:q)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans = <span class="emphasis"><em>4×4</em></span>

     1     1     1     1
     1     2     3     4
     1     3     6    10
     1     4    10    20

</pre></div></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-SuppressErrorsForNonSPDMatricesExample"><meta itemprop="exampletitle" content="Suppress Errors for Nonsymmetric Positive Definite Matrices"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_0bfbea4b-8b32-4dcc-8405-fa5c79701026"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_0bfbea4b-8b32-4dcc-8405-fa5c79701026" data-bs-target="#expand_accordion_body_mw_0bfbea4b-8b32-4dcc-8405-fa5c79701026" aria-controls="expand_accordion_body_mw_0bfbea4b-8b32-4dcc-8405-fa5c79701026" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_0bfbea4b-8b32-4dcc-8405-fa5c79701026">Cholesky Factor of Sparse Matrix</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_0bfbea4b-8b32-4dcc-8405-fa5c79701026" aria-labelledby="expand_accordion_heading_mw_0bfbea4b-8b32-4dcc-8405-fa5c79701026" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/CholeskyFactorOfSparseMatrixExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Cholesky Factor of Sparse Matrix",
          "description": "Calculate the Cholesky factor of a sparse matrix, and use the permutation output to create a Cholesky factor with fewer nonzeros.",
          "thumbnailURL": "../../examples/matlab/win64/CholeskyFactorOfSparseMatrixExample_01.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "chol.html"

        },
          "identifier": "matlab.CholeskyFactorOfSparseMatrixExample",
          "name": "CholeskyFactorOfSparseMatrixExample",
          "url": "chol.html#mw_0bfbea4b-8b32-4dcc-8405-fa5c79701026"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/CholeskyFactorOfSparseMatrixExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "CholeskyFactorOfSparseMatrixExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Calculate the Cholesky factor of a sparse matrix, and use the permutation output to create a Cholesky factor with fewer nonzeros.</p><p>Create a sparse positive definite matrix based on the <code class="literal">west0479</code> matrix.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>load <span style="color:#A020F0">west0479</span>
A = west0479;
S = A'*A;</pre></div></div></div><p>Calculate the Cholesky factor of the matrix two different ways. First specify two outputs, and then specify three outputs to enable row and column reordering. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[R,flag] = chol(S);
[RP,flagP,P] = chol(S);</pre></div></div></div><p>For each calculation, check that <code class="literal">flag = 0</code> to confirm the calculation is successful.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">if</span> ~flag &amp;&amp; ~flagP
    disp(<span style="color:#A020F0">'Factorizations successful.'</span>)
<span style="color:#0000FF">else</span>
    disp(<span style="color:#A020F0">'Factorizations failed.'</span>)
<span style="color:#0000FF">end</span></pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>Factorizations successful.
</pre></div></div></div><p>Compare the number of nonzeros in <code class="literal">chol(S)</code> vs. the reordered matrix <code class="literal">chol(P'*S*P)</code>. Best practice is to use the three output syntax of <code class="literal">chol</code> with sparse matrices, since reordering the rows and columns can greatly reduce the number of nonzeros in the Cholesky factor.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>subplot(1,2,1)
spy(R)
title(<span style="color:#A020F0">'Nonzeros in chol(S)'</span>)
subplot(1,2,2)
spy(RP)
title(<span style="color:#A020F0">'Nonzeros in chol(P''*S*P)'</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e210142" class="mediaobject"><p><img src="../../examples/matlab/win64/CholeskyFactorOfSparseMatrixExample_01.png" alt="Figure contains 2 axes objects. Axes object 1 with title Nonzeros in chol(S), xlabel nz = 59551 contains a line object which displays its values using only markers. Axes object 2 with title Nonzeros in chol(P'*S*P), xlabel nz = 7637 contains a line object which displays its values using only markers." width="560"></p></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-CholeskyFactorOfSparseMatrixExample"><meta itemprop="exampletitle" content="Cholesky Factor of Sparse Matrix"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_e066fd96-2894-4000-ad1e-e510bd567235"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_e066fd96-2894-4000-ad1e-e510bd567235" data-bs-target="#expand_accordion_body_mw_e066fd96-2894-4000-ad1e-e510bd567235" aria-controls="expand_accordion_body_mw_e066fd96-2894-4000-ad1e-e510bd567235" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_e066fd96-2894-4000-ad1e-e510bd567235">Reorder Sparse Matrix with Permutation Vector</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_e066fd96-2894-4000-ad1e-e510bd567235" aria-labelledby="expand_accordion_heading_mw_e066fd96-2894-4000-ad1e-e510bd567235" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/ReorderSparseWithPermVectorExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Reorder Sparse Matrix with Permutation Vector",
          "description": "Use the 'vector' option of chol to return the permutation information as a vector rather than a matrix.",
          "thumbnailURL": "../../examples/matlab/win64/ReorderSparseWithPermVectorExample_01.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "chol.html"

        },
          "identifier": "matlab.ReorderSparseWithPermVectorExample",
          "name": "ReorderSparseWithPermVectorExample",
          "url": "chol.html#mw_e066fd96-2894-4000-ad1e-e510bd567235"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/ReorderSparseWithPermVectorExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "ReorderSparseWithPermVectorExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Use the <code class="literal">'vector'</code> option of <code class="literal">chol</code> to return the permutation information as a vector rather than a matrix.</p><p>Create a sparse finite element matrix.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>S = gallery(<span style="color:#A020F0">'wathen'</span>,10,10);
spy(S)</pre></div></div></div><div class="informalfigure"><div id="d126e210175" class="mediaobject"><p><img src="../../examples/matlab/win64/ReorderSparseWithPermVectorExample_01.png" alt="Figure contains an axes object. The axes object with xlabel nz = 4861 contains a line object which displays its values using only markers." width="560"></p></div></div><p>Calculate the Cholesky factor for the matrix, and specify the <code class="literal">'vector'</code> option to return a permutation vector <code class="literal">p</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[R,flag,p] = chol(S,<span style="color:#A020F0">'vector'</span>);</pre></div></div></div><p>Verify that <code class="literal">flag = 0</code>, indicating the calculation is successful. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">if</span> ~flag
    disp(<span style="color:#A020F0">'Factorization successful.'</span>)
<span style="color:#0000FF">else</span>
    disp(<span style="color:#A020F0">'Factorization failed.'</span>)
<span style="color:#0000FF">end</span></pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>Factorization successful.
</pre></div></div></div><p>Verify that <code class="literal">S(p,p) = R'*R</code>, within round-off error.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>norm(S(p,p) - R'*R,<span style="color:#A020F0">'fro'</span>)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans = 
2.1039e-13
</pre></div></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-ReorderSparseWithPermVectorExample"><meta itemprop="exampletitle" content="Reorder Sparse Matrix with Permutation Vector"></div></div></div></div><div class="ref_sect"><h2 id="mw_84e0c107-c850-4f86-9c7a-bd732845521c">Input Arguments</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="mw_84e0c107-c850-4f86-9c7a-bd732845521c_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="mw_91dc7b0f-768f-4a6b-ab21-391fd8ee5851"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_91dc7b0f-768f-4a6b-ab21-391fd8ee5851" data-bs-target="#expand_accordion_body_mw_91dc7b0f-768f-4a6b-ab21-391fd8ee5851" aria-controls="expand_accordion_body_mw_91dc7b0f-768f-4a6b-ab21-391fd8ee5851" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_A" class="anchor_target"></span><h3 id="mw_91dc7b0f-768f-4a6b-ab21-391fd8ee5851"><code itemprop="name">A</code> &#8212; <span itemprop="purpose">Input matrix</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">matrix</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_91dc7b0f-768f-4a6b-ab21-391fd8ee5851" aria-labelledby="expand_accordion_heading_mw_91dc7b0f-768f-4a6b-ab21-391fd8ee5851" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_91dc7b0f-768f-4a6b-ab21-391fd8ee5851"><p>Input matrix. Argument <code class="literal">A</code> can use full or sparse storage, but must
            be square and symmetric positive definite.</p><p><code class="function">chol</code> assumes that <code class="literal">A</code> is symmetric for real
            matrices or Hermitian for complex matrices. <code class="function">chol</code> uses only the
            upper or lower triangle of <code class="literal">A</code> to perform its computations, depending
            on the value of <a href="#mw_ffc71c97-36a0-4335-8e05-82ecff3e6312" class="intrnllnk"><code class="argument">triangle</code></a>.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code><br/>
<strong>Complex Number Support: </strong>Yes</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="mw_bd8d494d-1956-4117-a10b-1adaa40cfc91"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_bd8d494d-1956-4117-a10b-1adaa40cfc91" data-bs-target="#expand_accordion_body_mw_bd8d494d-1956-4117-a10b-1adaa40cfc91" aria-controls="expand_accordion_body_mw_bd8d494d-1956-4117-a10b-1adaa40cfc91" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_S" class="anchor_target"></span><h3 id="mw_bd8d494d-1956-4117-a10b-1adaa40cfc91"><code itemprop="name">S</code> &#8212; <span itemprop="purpose">Sparse input matrix</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">sparse matrix</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_bd8d494d-1956-4117-a10b-1adaa40cfc91" aria-labelledby="expand_accordion_heading_mw_bd8d494d-1956-4117-a10b-1adaa40cfc91" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_bd8d494d-1956-4117-a10b-1adaa40cfc91"><p>Sparse input matrix. <code class="literal">S</code> must be square and symmetric positive
            definite.</p><p><code class="function">chol</code> assumes that <code class="literal">S</code> is symmetric for real
            matrices or Hermitian for complex matrices. <code class="function">chol</code> uses only the
            upper or lower triangle of <code class="literal">S</code> to perform its computations, depending
            on the value of <a href="#mw_ffc71c97-36a0-4335-8e05-82ecff3e6312" class="intrnllnk"><code class="argument">triangle</code></a>.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code><br/>
<strong>Complex Number Support: </strong>Yes</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="mw_ffc71c97-36a0-4335-8e05-82ecff3e6312"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_ffc71c97-36a0-4335-8e05-82ecff3e6312" data-bs-target="#expand_accordion_body_mw_ffc71c97-36a0-4335-8e05-82ecff3e6312" aria-controls="expand_accordion_body_mw_ffc71c97-36a0-4335-8e05-82ecff3e6312" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_triangle" class="anchor_target"></span><h3 id="mw_ffc71c97-36a0-4335-8e05-82ecff3e6312"><code itemprop="name">triangle</code> &#8212; <span itemprop="purpose">Triangular factor of input matrix</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue defaultvalue"><code class="literal">'upper'</code></span> (default) | <span itemprop="inputvalue"><code class="literal">'lower'</code></span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_ffc71c97-36a0-4335-8e05-82ecff3e6312" aria-labelledby="expand_accordion_heading_mw_ffc71c97-36a0-4335-8e05-82ecff3e6312" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_ffc71c97-36a0-4335-8e05-82ecff3e6312"><p>Triangular factor of input matrix, specified as <code class="literal">'upper'</code> or
              <code class="literal">'lower'</code>. Use this option to specify that <code class="function">chol</code>
            should use the upper or lower triangle of the input matrix to compute the factorization.
              <code class="function">chol</code> assumes that the input matrix is symmetric for real matrices
            or Hermitian for complex matrices. <code class="function">chol</code> uses only the upper or
            lower triangle to perform its computations.</p><p>Using the <code class="literal">'lower'</code> option is equivalent to calling
              <code class="function">chol</code> with the <code class="literal">'upper'</code> option and the transpose
            of the input matrix, and then transposing the output <code class="literal">R</code>.</p><p class="description_valueexample"><strong>Example: </strong><code class="literal">R = chol(A,'lower')</code></p></div></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="mw_2bc2adb8-4c9b-4515-9939-7769773a490d"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_2bc2adb8-4c9b-4515-9939-7769773a490d" data-bs-target="#expand_accordion_body_mw_2bc2adb8-4c9b-4515-9939-7769773a490d" aria-controls="expand_accordion_body_mw_2bc2adb8-4c9b-4515-9939-7769773a490d" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_outputForm" class="anchor_target"></span><h3 id="mw_2bc2adb8-4c9b-4515-9939-7769773a490d"><code itemprop="name">outputForm</code> &#8212; <span itemprop="purpose">Shape of permutation output</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue defaultvalue"><code class="literal">'matrix'</code></span> (default) | <span itemprop="inputvalue"><code class="literal">'vector'</code></span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_2bc2adb8-4c9b-4515-9939-7769773a490d" aria-labelledby="expand_accordion_heading_mw_2bc2adb8-4c9b-4515-9939-7769773a490d" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_2bc2adb8-4c9b-4515-9939-7769773a490d"><p>Shape of permutation output, specified as <code class="literal">'matrix'</code> or
              <code class="literal">'vector'</code>. This flag controls whether the permutation output
              <code class="literal">P</code> is returned as a permutation matrix or permutation vector.</p><p>
            </p>
<div class="itemizedlist"><ul><li><p>If <code class="literal">flag = 0</code>, then <code class="literal">S</code> is symmetric
                  positive definite and <code class="literal">P'*S*P = R'*R</code> (if <code class="literal">P</code> is
                  a matrix) or <code class="literal">S(p,p) = R'*R</code> (if <code class="literal">p</code> is a
                  vector).</p></li><li><p>If <code class="literal">flag</code> is not zero, then <code class="literal">S</code> is not
                  symmetric positive definite. <code class="literal">R</code> is an upper triangular matrix of
                  size <code class="literal">q</code>-by-<code class="literal">n</code>, where <code class="literal">q =
                    flag-1</code>. The L-shaped region of the first <code class="literal">q</code> rows and
                  first <code class="literal">q</code> columns of <code class="literal">R'*R</code> agree with those of
                    <code class="literal">P'*S*P</code> (if <code class="literal">P</code> is a matrix) or
                    <code class="literal">S(p,p)</code> (if <code class="literal">p</code> is a vector). </p></li><li><p>If the <code class="literal">'lower'</code> option is specified, then
                    <code class="literal">R</code> is a lower triangular matrix and you can replace
                    <code class="literal">R'*R</code> with <code class="literal">R*R'</code> in the previous
                  identities.</p></li></ul></div><p>

          </p><p>The Cholesky factor of <code class="literal">P'*S*P</code> (if <code class="literal">P</code> is a
            matrix) or <code class="literal">S(p,p)</code> (if <code class="literal">p</code> is a vector) tends to be
            sparser than the Cholesky factor of <code class="literal">S</code>. </p><p class="description_valueexample"><strong>Example: </strong><code class="literal">[R,flag,p] = chol(S,'vector')</code></p></div></div></div></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="mw_07d79b8a-27d7-4b11-b79a-62c6317bdce6">Output Arguments</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="mw_07d79b8a-27d7-4b11-b79a-62c6317bdce6_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_3e727a04-bd5b-42cd-b5bb-a3f7b411912e" data-bs-target="#expand_accordion_body_mw_3e727a04-bd5b-42cd-b5bb-a3f7b411912e" aria-controls="expand_accordion_body_mw_3e727a04-bd5b-42cd-b5bb-a3f7b411912e" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_R" class="anchor_target"></span><h3 id="mw_3e727a04-bd5b-42cd-b5bb-a3f7b411912e"><code class="name">R</code> &#8212; Cholesky factor<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">matrix</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_3e727a04-bd5b-42cd-b5bb-a3f7b411912e" aria-labelledby="expand_accordion_heading_mw_3e727a04-bd5b-42cd-b5bb-a3f7b411912e" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_3e727a04-bd5b-42cd-b5bb-a3f7b411912e"><p>Cholesky factor, returned as a matrix.</p>
<div class="itemizedlist"><ul><li><p>If <code class="literal">R</code> is upper triangular, then <code class="literal">A = R'*R</code>.
                  If you specify the <code class="literal">P</code> output for sparse matrices, then
                    <code class="literal">P'*S*P = R'*R</code> or <code class="literal">S(p,p) = R'*R</code>, depending
                  on the value of <a href="#mw_2bc2adb8-4c9b-4515-9939-7769773a490d" class="intrnllnk"><code class="argument">outputForm</code></a>.</p></li><li><p>If <code class="literal">R</code> is lower triangular, then <code class="literal">A = R*R'</code>.
                  If you specify the <code class="literal">P</code> output for sparse matrices, then
                    <code class="literal">P'*S*P = R*R'</code> or <code class="literal">S(p,p) = R*R'</code>, depending
                  on the value of <code class="argument">outputForm</code>..</p></li><li><p>Whenever <code class="literal">flag</code> is not zero, <code class="literal">R</code> contains
                  only partial results. <code class="literal">flag</code> indicates the pivot position where
                  the factorization failed, and <code class="literal">R</code> contains the partially
                  completed factorization.</p></li></ul></div><p>
</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_da905fd8-e0ca-4b83-884e-1216badb7607" data-bs-target="#expand_accordion_body_mw_da905fd8-e0ca-4b83-884e-1216badb7607" aria-controls="expand_accordion_body_mw_da905fd8-e0ca-4b83-884e-1216badb7607" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_flag" class="anchor_target"></span><h3 id="mw_da905fd8-e0ca-4b83-884e-1216badb7607"><code class="name">flag</code> &#8212; Symmetric positive definite flag<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">scalar</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_da905fd8-e0ca-4b83-884e-1216badb7607" aria-labelledby="expand_accordion_heading_mw_da905fd8-e0ca-4b83-884e-1216badb7607" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_da905fd8-e0ca-4b83-884e-1216badb7607"><p>Symmetric positive definite flag, returned as a scalar.</p><div class="itemizedlist"><ul><li><p>If <code class="literal">flag = 0</code>, then the input matrix is symmetric positive
                definite. <code class="literal">R</code> is an upper triangular matrix such that <code class="literal">R'*R
                  = A</code>.</p></li><li><p>If <code class="literal">A</code> is not symmetric positive definite, then
                  <code class="literal">flag</code> is a positive integer indicating the pivot position where
                the factorization failed, and MATLAB<sup>&#x00AE;</sup> does not generate an error. <code class="literal">R</code> is an upper
                triangular matrix of size <code class="literal">q = flag-1</code> such that <code class="literal">R'*R =
                  A(1:q,1:q)</code>.</p></li><li><p>If <code class="literal">A</code> is sparse, then <code class="literal">R</code> is an upper
                triangular matrix of size <code class="literal">q</code>-by-<code class="literal">n</code> such that the
                L-shaped region of the first <code class="literal">q</code> rows and first
                  <code class="literal">q</code> columns of <code class="literal">R'*R</code> agree with those of
                  <code class="literal">A</code> or <code class="literal">S</code>.</p></li><li><p>If the <code class="literal">'lower'</code> option is specified, then <code class="literal">R</code>
                is a lower triangular matrix and you can replace <code class="literal">R'*R</code> with
                  <code class="literal">R*R'</code> in the previous identities.</p></li></ul></div></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_9048ccd2-eccf-45df-a23b-5fa1ce84d320" data-bs-target="#expand_accordion_body_mw_9048ccd2-eccf-45df-a23b-5fa1ce84d320" aria-controls="expand_accordion_body_mw_9048ccd2-eccf-45df-a23b-5fa1ce84d320" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_P" class="anchor_target"></span><h3 id="mw_9048ccd2-eccf-45df-a23b-5fa1ce84d320"><code class="name">P</code> &#8212; Permutation for sparse matrices<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">matrix | vector</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_9048ccd2-eccf-45df-a23b-5fa1ce84d320" aria-labelledby="expand_accordion_heading_mw_9048ccd2-eccf-45df-a23b-5fa1ce84d320" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_9048ccd2-eccf-45df-a23b-5fa1ce84d320"><p>Permutation for sparse matrices, returned as a matrix or vector depending on the
            value of <a href="#mw_2bc2adb8-4c9b-4515-9939-7769773a490d" class="intrnllnk"><code class="argument">outputForm</code></a>. See <code class="argument">outputForm</code> for a
            description of the identities that this output satisfies.</p><p>This permutation matrix is based on the approximate minimum degree ordering computed
            by <code class="function">amd</code>. However, this preordering can differ from the one obtained
            directly by <a href="amd.html"><code class="function">amd</code></a> since <code class="function">chol</code>
            slightly changes the ordering for increased performance.</p></div></div></div></div></div></div></div></div></div></div><div class="moreabout ref_sect"><h2 id="mw_07d01bf3-fa93-492c-813c-bde4e853f9f4">More About</h2><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true2">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_mw_9b25d49a-49b6-49cb-ab22-c6e8e4d07bf7" aria-controls="expand_body_mw_9b25d49a-49b6-49cb-ab22-c6e8e4d07bf7" class="accordion-button" aria-expanded="true"><h3 id="mw_9b25d49a-49b6-49cb-ab22-c6e8e4d07bf7">Symmetric Positive Definite Matrix</h3></button></div><div id="expand_body_mw_9b25d49a-49b6-49cb-ab22-c6e8e4d07bf7" class="accordion-collapse collapsed collapse show"><div class="accordion-body"><p class="shortdesc">A <span class="emphasis"><em>symmetric positive definite matrix</em></span> is a
        symmetric matrix with all positive eigenvalues.</p><p>For any real invertible matrix <code class="literal">A</code>, you can construct a symmetric
        positive definite matrix with the product <code class="literal">B = A'*A</code>. The Cholesky
        factorization reverses this formula by saying that any symmetric positive definite matrix
          <code class="literal">B</code> can be factored into the product <code class="literal">R'*R</code>.</p><p>A <span class="emphasis"><em>symmetric positive semi-definite</em></span> matrix is defined in a similar
        manner, except that the eigenvalues must all be positive or zero.</p><p>The line between positive definite and positive semi-definite matrices is blurred in the
        context of numeric computation. It is rare for eigenvalues to be exactly equal to zero, but
        they can be numerically zero (on the order of machine precision). For this reason,
          <code class="function">chol</code> might be able to factorize one positive semi-definite matrix,
        but could fail with another matrix that has very similar eigenvalues.</p></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="mw_e0d7f8e9-8482-454b-b613-266bf049086f">Tips</h2><div class="itemizedlist"><ul><li><p>Use <code class="function">chol</code> (instead of <a href="eig.html"><code class="function">eig</code></a>) to efficiently determine whether a matrix is symmetric positive
          definite. See <a href="../math/determine-whether-matrix-is-positive-definite.html" class="a">Determine Whether Matrix Is Symmetric Positive Definite</a> for more
          information.</p></li></ul></div></div><div class="bibliography"><h2 id="References">References</h2><div id="mw_d2906758-4452-4b49-8bbe-2c19a6de6e53" class="bibliomixed"><p>[1] Anderson, E., ed. <em class="citetitle italic">LAPACK Users’ Guide</em>. 3rd ed. Software, Environments, Tools.
      Philadelphia: Society for Industrial and Applied Mathematics, 1999. <a href="https://doi.org/10.1137/1.9780898719604" target="_blank">https://doi.org/10.1137/1.9780898719604</a>.</p></div><div id="mw_0cfd5c6c-a1c8-450f-9778-3d85d7bc257f" class="bibliomixed"><p>[2] Chen, Yanqing, Timothy A. Davis,
      William W. Hager, and Sivasankaran Rajamanickam. “Algorithm 887: CHOLMOD, Supernodal Sparse
      Cholesky Factorization and Update/Downdate.” <em class="citetitle">ACM Transactions on Mathematical
        Software</em> 35, no. 3 (October 2008): 1&#8211;14. <a href="https://doi.org/10.1145/1391989.1391995" target="_blank">https://doi.org/10.1145/1391989.1391995</a>.</p></div></div><div class="ref_sect"><h2 id="refsect-extended-capabilities">Extended Capabilities</h2><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink">expand all</a></p><div id="accordion_refsect-extended-capabilities" role="tablist" aria-multiselectable="true"><span id="bvlo49h-1" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="f80-998736" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_f80-998736_codegen" aria-controls="expand_body_f80-998736_codegen" class="accordion-button collapsed" aria-expanded="false"><h3 id="f80-998736_codegen">C/C++ Code Generation<br/> <span class=" remove_bold add_font_color_general">Generate C and C++ code using MATLAB&#174; Coder&#8482;.</span></h3></button></div><div id="expand_body_f80-998736_codegen" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>
        <span>Usage notes and limitations:</span>
      </p><p>
        </p>
<div class="itemizedlist"><ul><li><p>For sparse matrix inputs, the language standard must be C99 or later. Only the
              first two syntaxes <code class="literal">chol(A)</code> and <code class="literal">chol(A,triangle)</code>
              with one output argument are supported.</p></li><li><p>If you use the two-output syntax, make sure that support for variable-size arrays
              is enabled.</p></li><li><p>For sparse matrix inputs, code generation supports only matrices of type
                <code class="literal">double</code>.</p></li></ul></div><p>

      </p></div></div></div></div></div><span id="mw_97e98faf-5c81-400d-b309-833d8e195a8c" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="f80-998736" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_f80-998736_gpucodegen" aria-controls="expand_body_f80-998736_gpucodegen" class="accordion-button collapsed" aria-expanded="false"><h3 id="f80-998736_gpucodegen">GPU Code Generation<br/> <span class=" remove_bold add_font_color_general">Generate CUDA&#174; code for NVIDIA&#174; GPUs using GPU Coder&#8482;.</span></h3></button></div><div id="expand_body_f80-998736_gpucodegen" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>Usage notes and limitations:</p><div class="itemizedlist"><ul><li><p>Only the first two syntaxes <code class="literal">chol(A)</code> and
              <code class="literal">chol(A,triangle)</code> with one output argument are supported.</p></li></ul></div></div></div></div></div></div><span id="mw_7850d1e2-fa71-491b-a287-cc074c7514a8" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="f80-998736" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_f80-998736_threadsupport" aria-controls="expand_body_f80-998736_threadsupport" class="accordion-button collapsed" aria-expanded="false"><h3 id="f80-998736_threadsupport">Thread-Based Environment<br/> <span class=" remove_bold add_font_color_general">Run code in the background using MATLAB&#174; <code class="function">backgroundPool</code> or accelerate code with Parallel Computing Toolbox&#8482; <code class="function">ThreadPool</code>.</span></h3></button></div><div id="expand_body_f80-998736_threadsupport" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>This function fully supports thread-based environments. For
                more information, see <a href="../matlab_prog/run-functions-on-threads.html" class="a">Run MATLAB Functions in Thread-Based Environment</a>.</p></div></div></div></div></div><span id="mw_eae7324f-45bc-41d9-a1a2-4fb8323af9c1" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="f80-998736" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_f80-998736_gpuarrays" aria-controls="expand_body_f80-998736_gpuarrays" class="accordion-button collapsed" aria-expanded="false"><h3 id="f80-998736_gpuarrays">GPU Arrays<br/> <span class=" remove_bold add_font_color_general">Accelerate code by running on a graphics processing unit (GPU) using Parallel Computing Toolbox&#8482;.</span></h3></button></div><div id="expand_body_f80-998736_gpuarrays" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>The <code class="function">chol</code> function
    supports GPU array input with these usage notes and limitations:</p><div class="itemizedlist"><ul><li><p>The input <code class="literal">A</code> must be nonsparse.</p></li><li><p>The <code class="literal">'vector'</code> option is not supported.</p></li><li><p>The software returns the <code class="literal">flag</code> output as a scalar of type
              <code class="literal">double</code> stored in host memory and not as a
              <code class="literal">gpuArray</code>.</p></li></ul></div><p>For more information, see <a href="../../parallel-computing/run-matlab-functions-on-a-gpu.html" class="a">Run MATLAB Functions on a GPU</a><span role="cross_prod"> (Parallel Computing Toolbox)</span>.</p></div></div></div></div></div><span id="mw_ccf10a8c-e22a-4d56-9285-dd9f31c87e01" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="f80-998736" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_f80-998736_distributedarrays" aria-controls="expand_body_f80-998736_distributedarrays" class="accordion-button collapsed" aria-expanded="false"><h3 id="f80-998736_distributedarrays">Distributed Arrays<br/> <span class=" remove_bold add_font_color_general">Partition large arrays across the combined memory of your cluster using Parallel Computing Toolbox&#8482;.</span></h3></button></div><div id="expand_body_f80-998736_distributedarrays" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>Usage notes and limitations:</p><div class="itemizedlist"><ul><li><p>The input <code class="literal">A</code> must be nonsparse.</p></li><li><p>The <code class="literal">'vector'</code> option is not supported.</p></li><li><p>For sparse matrix inputs, matrix <code class="literal">A</code> must be of the
              <code class="literal">double</code> data type.</p></li></ul></div><p>For more information, see <a href="../../parallel-computing/run-matlab-functions-with-distributed-arrays.html" class="a">Run MATLAB Functions with Distributed Arrays</a><span role="cross_prod"> (Parallel Computing Toolbox)</span>.</p></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="mw_11c60e17-b2fb-42b6-b3b6-07491ac99141">Version History</h2><strong>Introduced before R2006a</strong><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink">expand all</a></p><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_mw_79623995-8bd5-48b6-99ec-61927c855452" aria-controls="expand_body_mw_79623995-8bd5-48b6-99ec-61927c855452" class="accordion-button collapsed" aria-expanded="false"><h3 id="mw_79623995-8bd5-48b6-99ec-61927c855452">R2025a: <span class="remove_bold">Code generation support for sparse matrices of type <code class="literal">double</code></span></h3></button></div><div id="expand_body_mw_79623995-8bd5-48b6-99ec-61927c855452" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>Sparse matrices of type <code class="literal">double</code> are supported for code
        generation.</p></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_mw_ed81ca8e-fb27-4d04-8b2d-1fa0f547f655" aria-controls="expand_body_mw_ed81ca8e-fb27-4d04-8b2d-1fa0f547f655" class="accordion-button collapsed" aria-expanded="false"><h3 id="mw_ed81ca8e-fb27-4d04-8b2d-1fa0f547f655">R2025a: <span class="remove_bold">Specify single-precision sparse input argument</span></h3></button></div><div id="expand_body_mw_ed81ca8e-fb27-4d04-8b2d-1fa0f547f655" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>You can specify the sparse input matrix <code class="argument">S</code> as single precision. If
          <code class="argument">S</code> is <code class="class">single</code>, the output arguments are also
          <code class="class">single</code> except those that are related to indexing, such as ordering and
        permutation vectors.</p></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="f80-998736_seealso">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="ichol.html"><span itemprop="name"><code class="function">ichol</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="cholupdate.html"><span itemprop="name"><code class="function">cholupdate</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="ldl.html"><span itemprop="name"><code class="function">ldl</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="qr.html"><span itemprop="name"><code class="function">qr</code></span></a></span></p><div class="examples_container"><h3 class="remove_border">Topics</h3><div itemprop="content"><ul class="list-unstyled"><li><a href="../math/factorizations.html" class="a">Factorizations</a></li></ul></div></div></div>
    </div></div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

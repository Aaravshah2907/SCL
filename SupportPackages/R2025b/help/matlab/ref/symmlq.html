<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>symmlq</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../sparse-matrices.html",
          "name": "Sparse Matrices"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "sparse-matrices"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExtendedCapabilities",

        "itemListElement":
        [
{
          "@type": "ListItem",
          "position": 1,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "distributedarrays",
          "value": "limited"

        }
          },
{
          "@type": "ListItem",
          "position": 2,
"item": 
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "threadsupport",
          "value": "full"

        }
          }
        ]
        }
        </script>
<meta xmlns="http://www.w3.org/1999/xhtml" name="chunktype" content="refpage"><meta xmlns="http://www.w3.org/1999/xhtml" name="refentity" itemprop="refentity" content="function:symmlq"><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="fcn">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ref/function">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This MATLAB function attempts to solve the system of linear equations A*x = b for x using the Symmetric LQ Method."><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "refentry";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../sparse-matrices.html?s_tid=CRUX_lftnav" itemprop="url" id="sparse-matrices"><span itemprop="title">Sparse Matrices</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item notranslate"><a href="#responsive_offcanvas"><span class="refname">symmlq</span></a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-refentry">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li><a href="#mw_91541275-6416-44b5-bf53-5b2f0855f4b1" class="intrnllnk">Syntax</a></li><li class="nav-item"><a href="#description" class="nav-link intrnllnk">Description</a></li><li class="nav-item"><a href="#mw_198c5636-7486-4721-b85d-ed0cbb3b7b73" class="nav-link intrnllnk">Examples</a><ul class="nav"><li class="nav-item"><a href="#mw_16c51ac3-24df-427e-8922-43f11fb0fec7" class="nav-link intrnllnk">Iterative Solution to Linear System</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_b2fe246e-1448-432b-97cf-487ec5e1ab98" class="nav-link intrnllnk">Using <code class="literal">symmlq</code> with Preconditioner</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_b01e1750-342b-43bd-a26e-f7d40778dd31" class="nav-link intrnllnk">Supplying Initial Guess</a></li></ul><ul class="nav"><li class="nav-item"><a href="#mw_04c99d2b-c732-43b6-9e08-8064c136e6d2" class="nav-link intrnllnk">Using Function Handle Instead of Numeric Matrix</a></li></ul></li><li class="nav-item"><a href="#mw_0aaaac8c-8fb6-4cea-9fd3-da54ecc2ec27" class="nav-link intrnllnk">Input Arguments</a><ul class="nav"><li class="nav-item"><a href="#mw_3e5039bc-ef18-476b-b23a-d6673527a9bf" class="nav-link intrnllnk">A</a></li><li class="nav-item"><a href="#f96-1000445_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" class="nav-link intrnllnk">b</a></li><li class="nav-item"><a href="#f96-1000445_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="nav-link intrnllnk">tol</a></li><li class="nav-item"><a href="#f96-1000445_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" class="nav-link intrnllnk">maxit</a></li><li class="nav-item"><a href="#f96-1000445_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" class="nav-link intrnllnk">M</a><a href="#f96-1000445_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" class="nav-link intrnllnk">M1</a><a href="#f96-1000445_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" class="nav-link intrnllnk">M2</a></li><li class="nav-item"><a href="#f96-1000445_sep_mw_40e27791-2264-4d42-8cb6-b8bf869783bc" class="nav-link intrnllnk">x0</a></li></ul></li><li class="nav-item"><a href="#mw_cf6d8a42-502b-4fd2-ae44-dbe33f69eeed" class="nav-link intrnllnk">Output Arguments</a><ul class="nav"><li class="nav-item"><a href="#f96-1000445_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="nav-link intrnllnk">x</a></li><li class="nav-item"><a href="#f96-1000445_sep_mw_e24d5713-a2f6-4b00-8515-4f96f166409e" class="nav-link intrnllnk">flag</a></li><li class="nav-item"><a href="#f96-1000445_sep_mw_1b807afe-eb58-4932-87f4-8db68de91460" class="nav-link intrnllnk">relres</a></li><li class="nav-item"><a href="#f96-1000445_sep_mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4" class="nav-link intrnllnk">iter</a></li><li class="nav-item"><a href="#f96-1000445_sep_mw_e2a3240f-74d0-4b34-943e-502f3dd9d174" class="nav-link intrnllnk">resvec</a></li><li class="nav-item"><a href="#f96-1000445_sep_mw_dd615089-e68e-4119-8889-58e540490774" class="nav-link intrnllnk">resveccg</a></li></ul></li><li class="nav-item"><a href="#mw_32b85137-d419-49cb-b371-c63bcbb4a52a" class="nav-link intrnllnk">More About</a><ul class="nav"><li class="nav-item"><a href="#mw_974b824c-350e-478b-8c10-c925110ad3bf" class="nav-link intrnllnk">Symmetric LQ Method</a></li></ul></li><li class="nav-item"><a href="#f96-1000445_sep_mw_021450b1-4be9-4d57-b903-c4a2d800c810" class="nav-link intrnllnk">Tips</a></li><li><a href="#References" class="intrnllnk">References</a></li><li class="nav-item"><a href="#refsect-extended-capabilities" class="nav-link intrnllnk">Extended Capabilities</a></li><li class="nav-item"><a href="#mw_89a391d2-4a87-4e91-ae22-91acce1be113" class="nav-link intrnllnk">Version History</a><ul class="nav"><li class="nav-item"><a href="#f96-1000445_sep_mw_7463413e-98d4-46c3-a401-f17c5cf7a6c1" class="nav-link intrnllnk">Specify single-precision input arguments</a></li></ul></li><li class="nav-item"><a href="#f96-1000445_seealso" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=sparse-matrices&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=sparse-matrices&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=sparse-matrices&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=sparse-matrices&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=sparse-matrices&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=sparse-matrices&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-ref-function"><div class="function_ref"><span id="f96-1000445" class="anchor_target"></span><h1 class="r2025b notranslate" itemprop="title"><span class="refname">symmlq</span></h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">Solve system of linear equations &#8212; symmetric LQ method</p><div class="switch"><a href="javascript:void(0);" id="expandAllPage" data-allexpanded="true1">collapse all in page</a></div></div></div>
<span id="mw_91541275-6416-44b5-bf53-5b2f0855f4b1" class="anchor_target"></span><div class="ref_sect"><h2 id="mw_91541275-6416-44b5-bf53-5b2f0855f4b1">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><div class="code_responsive"><code class="synopsis"><a href="#d126e1788220" class="intrnllnk">x = symmlq(A,b)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1788250" class="intrnllnk">x = symmlq(A,b,tol)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1788271" class="intrnllnk">x = symmlq(A,b,tol,maxit)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1788296" class="intrnllnk">x = symmlq(A,b,tol,maxit,M)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1788343" class="intrnllnk">x = symmlq(A,b,tol,maxit,M1,M2)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1788373" class="intrnllnk">x = symmlq(A,b,tol,maxit,M1,M2,x0)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1788403" class="intrnllnk">[x,flag] = symmlq(<span class="argument_placeholder">___</span>)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1788427" class="intrnllnk">[x,flag,relres] = symmlq(<span class="argument_placeholder">___</span>)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1788453" class="intrnllnk">[x,flag,relres,iter] = symmlq(<span class="argument_placeholder">___</span>)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1788479" class="intrnllnk">[x,flag,relres,iter,resvec] = symmlq(<span class="argument_placeholder">___</span>)</a></code></div><div class="code_responsive"><code class="synopsis"><a href="#d126e1788507" class="intrnllnk">[x,flag,relres,iter,resvec,resveccg] = symmlq(<span class="argument_placeholder">___</span>)</a></code></div></div></div></div><div class="clear"></div><span id="mw_40614051-b8ad-4aa4-ae12-e55293c24deb" class="anchor_target"></span><h2 id="description">Description</h2><div class="descriptions"><div class="cshsummary" id="csh_f96-1000445"><div class="description_module"><div class="description_element"><div class="code_responsive"><p><span id="d126e1788220" itemprop="syntax"><code class="synopsis"><a href="#f96-1000445_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a> = symmlq(<a href="#mw_3e5039bc-ef18-476b-b23a-d6673527a9bf" class="intrnllnk"><code class="argument">A</code></a>,<a href="#f96-1000445_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" class="intrnllnk"><code class="argument">b</code></a>)</code></span>
        attempts to solve the system of linear equations <code class="literal">A*x = b</code> for
          <code class="literal">x</code> using the <a href="symmlq.html#mw_974b824c-350e-478b-8c10-c925110ad3bf" class="intrnllnk">Symmetric LQ Method</a>. When the attempt is
        successful, <code class="function">symmlq</code> displays a message to confirm convergence. If
          <code class="function">symmlq</code> fails to converge after the maximum number of iterations or
        halts for any reason, it displays a diagnostic message that includes the relative residual
          <code class="literal">norm(b-A*x)/norm(b)</code> and the iteration number at which the method
        stopped.</p></div><p class="syntax_example"><a href="symmlq.html#mw_16c51ac3-24df-427e-8922-43f11fb0fec7" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e1788250" itemprop="syntax"><code class="synopsis"><a href="#f96-1000445_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a> = symmlq(<a href="#mw_3e5039bc-ef18-476b-b23a-d6673527a9bf" class="intrnllnk"><code class="argument">A</code></a>,<a href="#f96-1000445_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" class="intrnllnk"><code class="argument">b</code></a>,<a href="#f96-1000445_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="intrnllnk"><code class="argument">tol</code></a>)</code></span>
        specifies a tolerance for the method. The default tolerance is
        <code class="literal">1e-6</code>.</p></div><p class="syntax_example"><a href="symmlq.html#mw_16c51ac3-24df-427e-8922-43f11fb0fec7" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e1788271" itemprop="syntax"><code class="synopsis"><a href="#f96-1000445_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a> = symmlq(<a href="#mw_3e5039bc-ef18-476b-b23a-d6673527a9bf" class="intrnllnk"><code class="argument">A</code></a>,<a href="#f96-1000445_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" class="intrnllnk"><code class="argument">b</code></a>,<a href="#f96-1000445_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="intrnllnk"><code class="argument">tol</code></a>,<a href="#f96-1000445_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" class="intrnllnk"><code class="argument">maxit</code></a>)</code></span>
        specifies the maximum number of iterations to use. <code class="function">symmlq</code> displays a
        diagnostic message if it fails to converge within <code class="literal">maxit</code>
        iterations.</p></div><p class="syntax_example"><a href="symmlq.html#mw_16c51ac3-24df-427e-8922-43f11fb0fec7" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e1788296" itemprop="syntax"><code class="synopsis"><a href="#f96-1000445_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a> = symmlq(<a href="#mw_3e5039bc-ef18-476b-b23a-d6673527a9bf" class="intrnllnk"><code class="argument">A</code></a>,<a href="#f96-1000445_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" class="intrnllnk"><code class="argument">b</code></a>,<a href="#f96-1000445_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="intrnllnk"><code class="argument">tol</code></a>,<a href="#f96-1000445_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" class="intrnllnk"><code class="argument">maxit</code></a>,<a href="#f96-1000445_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" class="intrnllnk"><code class="argument">M</code></a>)</code></span>
        specifies a preconditioner matrix <code class="literal">M</code> and computes <code class="literal">x</code> by
        effectively solving the system <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-7px" display="block"><mrow><msup><mi>H</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>A</mi><mtext> </mtext><msup><mi>H</mi><mrow><mo>−</mo><mi>T</mi></mrow></msup><mi>y</mi><mo>=</mo><msup><mi>H</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>b</mi></mrow></math></span></span> for <em class="varname">y</em>, where <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-7px" display="block"><mrow><mi>y</mi><mo>=</mo><msup><mi>H</mi><mi>T</mi></msup><mi>x</mi></mrow></math></span></span> and <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-9px" display="block"><mrow><mi>H</mi><mo>=</mo><msup><mi>M</mi><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow></msup><mo>=</mo><msup><mrow><mrow><mo>(</mo><mrow><msub><mi>M</mi><mn>1</mn></msub><msub><mi>M</mi><mn>2</mn></msub></mrow><mo>)</mo></mrow></mrow><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow></msup></mrow></math></span></span>. The algorithm does not form <em class="varname">H</em> explicitly. Using a
        preconditioner matrix can improve the numerical properties of the problem and the efficiency
        of the calculation.</p></div><p class="syntax_example"><a href="symmlq.html#mw_b2fe246e-1448-432b-97cf-487ec5e1ab98" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e1788343" itemprop="syntax"><code class="synopsis"><a href="#f96-1000445_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a> = symmlq(<a href="#mw_3e5039bc-ef18-476b-b23a-d6673527a9bf" class="intrnllnk"><code class="argument">A</code></a>,<a href="#f96-1000445_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" class="intrnllnk"><code class="argument">b</code></a>,<a href="#f96-1000445_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="intrnllnk"><code class="argument">tol</code></a>,<a href="#f96-1000445_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" class="intrnllnk"><code class="argument">maxit</code></a>,<a href="#f96-1000445_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" class="intrnllnk"><code class="argument">M1</code></a>,<a href="#f96-1000445_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" class="intrnllnk"><code class="argument">M2</code></a>)</code></span>
        specifies factors of the preconditioner matrix <code class="literal">M</code> such that <code class="literal">M =
          M1*M2</code>.</p></div><p class="syntax_example"><a href="symmlq.html#mw_b2fe246e-1448-432b-97cf-487ec5e1ab98" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e1788373" itemprop="syntax"><code class="synopsis"><a href="#f96-1000445_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a> = symmlq(<a href="#mw_3e5039bc-ef18-476b-b23a-d6673527a9bf" class="intrnllnk"><code class="argument">A</code></a>,<a href="#f96-1000445_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" class="intrnllnk"><code class="argument">b</code></a>,<a href="#f96-1000445_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="intrnllnk"><code class="argument">tol</code></a>,<a href="#f96-1000445_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" class="intrnllnk"><code class="argument">maxit</code></a>,<a href="#f96-1000445_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" class="intrnllnk"><code class="argument">M1</code></a>,<a href="#f96-1000445_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" class="intrnllnk"><code class="argument">M2</code></a>,<a href="#f96-1000445_sep_mw_40e27791-2264-4d42-8cb6-b8bf869783bc" class="intrnllnk"><code class="argument">x0</code></a>)</code></span>
        specifies an initial guess for the solution vector <code class="literal">x</code>. The default is a
        vector of zeros.</p></div><p class="syntax_example"><a href="symmlq.html#mw_b01e1750-342b-43bd-a26e-f7d40778dd31" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e1788403" itemprop="syntax"><code class="synopsis">[<a href="#f96-1000445_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a>,<a href="#f96-1000445_sep_mw_e24d5713-a2f6-4b00-8515-4f96f166409e" class="intrnllnk"><code class="argument">flag</code></a>] = symmlq(<span class="argument_placeholder">___</span>)</code></span>
        returns a flag that specifies whether the algorithm successfully converged. When
          <code class="literal">flag = 0</code>, convergence was successful. You can use this output syntax
        with any of the previous input argument combinations. When you specify the
          <code class="literal">flag</code> output, <code class="function">symmlq</code> does not display any
        diagnostic messages.</p></div><p class="syntax_example"><a href="symmlq.html#mw_b2fe246e-1448-432b-97cf-487ec5e1ab98" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e1788427" itemprop="syntax"><code class="synopsis">[<a href="#f96-1000445_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a>,<a href="#f96-1000445_sep_mw_e24d5713-a2f6-4b00-8515-4f96f166409e" class="intrnllnk"><code class="argument">flag</code></a>,<a href="#f96-1000445_sep_mw_1b807afe-eb58-4932-87f4-8db68de91460" class="intrnllnk"><code class="argument">relres</code></a>] = symmlq(<span class="argument_placeholder">___</span>)</code></span>
        also returns the residual error in the computed solution. If <code class="literal">flag</code> is
          <code class="literal">0</code>, then <code class="literal">relres &lt;= tol</code>.</p></div><p class="syntax_example"><a href="symmlq.html#mw_b2fe246e-1448-432b-97cf-487ec5e1ab98" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e1788453" itemprop="syntax"><code class="synopsis">[<a href="#f96-1000445_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a>,<a href="#f96-1000445_sep_mw_e24d5713-a2f6-4b00-8515-4f96f166409e" class="intrnllnk"><code class="argument">flag</code></a>,<a href="#f96-1000445_sep_mw_1b807afe-eb58-4932-87f4-8db68de91460" class="intrnllnk"><code class="argument">relres</code></a>,<a href="#f96-1000445_sep_mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4" class="intrnllnk"><code class="argument">iter</code></a>] = symmlq(<span class="argument_placeholder">___</span>)</code></span>
        also returns the iteration number <code class="literal">iter</code> at which <code class="literal">x</code> was
        computed.</p></div><p class="syntax_example"><a href="symmlq.html#mw_b2fe246e-1448-432b-97cf-487ec5e1ab98" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e1788479" itemprop="syntax"><code class="synopsis">[<a href="#f96-1000445_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a>,<a href="#f96-1000445_sep_mw_e24d5713-a2f6-4b00-8515-4f96f166409e" class="intrnllnk"><code class="argument">flag</code></a>,<a href="#f96-1000445_sep_mw_1b807afe-eb58-4932-87f4-8db68de91460" class="intrnllnk"><code class="argument">relres</code></a>,<a href="#f96-1000445_sep_mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4" class="intrnllnk"><code class="argument">iter</code></a>,<a href="#f96-1000445_sep_mw_e2a3240f-74d0-4b34-943e-502f3dd9d174" class="intrnllnk"><code class="argument">resvec</code></a>] = symmlq(<span class="argument_placeholder">___</span>)</code></span>
        also returns a vector of the residual norm at each iteration, including the first residual
          <code class="literal">norm(b-A*x0)</code>.</p></div><p class="syntax_example"><a href="symmlq.html#mw_b2fe246e-1448-432b-97cf-487ec5e1ab98" class="intrnllnk">example</a></p></div><div class="description_element"><div class="code_responsive"><p><span id="d126e1788507" itemprop="syntax"><code class="synopsis">[<a href="#f96-1000445_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a>,<a href="#f96-1000445_sep_mw_e24d5713-a2f6-4b00-8515-4f96f166409e" class="intrnllnk"><code class="argument">flag</code></a>,<a href="#f96-1000445_sep_mw_1b807afe-eb58-4932-87f4-8db68de91460" class="intrnllnk"><code class="argument">relres</code></a>,<a href="#f96-1000445_sep_mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4" class="intrnllnk"><code class="argument">iter</code></a>,<a href="#f96-1000445_sep_mw_e2a3240f-74d0-4b34-943e-502f3dd9d174" class="intrnllnk"><code class="argument">resvec</code></a>,<a href="#f96-1000445_sep_mw_dd615089-e68e-4119-8889-58e540490774" class="intrnllnk"><code class="argument">resveccg</code></a>] = symmlq(<span class="argument_placeholder">___</span>)</code></span>
        also returns a vector of the conjugate gradients residual norms at each iteration.</p></div><p class="syntax_example"><a href="symmlq.html#mw_b2fe246e-1448-432b-97cf-487ec5e1ab98" class="intrnllnk">example</a></p></div></div></div></div><div class="clear"></div><div class="examples"><h2 id="mw_198c5636-7486-4721-b85d-ed0cbb3b7b73">Examples</h2><div class="expandableContent" id="expandableExamples"><p class="switch"><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true3">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_16c51ac3-24df-427e-8922-43f11fb0fec7"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_16c51ac3-24df-427e-8922-43f11fb0fec7" data-bs-target="#expand_accordion_body_mw_16c51ac3-24df-427e-8922-43f11fb0fec7" aria-controls="expand_accordion_body_mw_16c51ac3-24df-427e-8922-43f11fb0fec7" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_16c51ac3-24df-427e-8922-43f11fb0fec7">Iterative Solution to Linear System</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_16c51ac3-24df-427e-8922-43f11fb0fec7" aria-labelledby="expand_accordion_heading_mw_16c51ac3-24df-427e-8922-43f11fb0fec7" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/SYMMLQLinearSystemExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Iterative Solution to Linear System",
          "description": "Solve a square linear system using symmlq with default settings, and then adjust the tolerance and number of iterations used in the solution process.",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "symmlq.html"

        },
          "identifier": "matlab.SYMMLQLinearSystemExample",
          "name": "SYMMLQLinearSystemExample",
          "url": "symmlq.html#mw_16c51ac3-24df-427e-8922-43f11fb0fec7"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/SYMMLQLinearSystemExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "SYMMLQLinearSystemExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Solve a square linear system using <code class="literal">symmlq</code> with default settings, and then adjust the tolerance and number of iterations used in the solution process.</p><p>Create a sparse tridiagonal matrix <code class="literal">A</code> as the coefficient matrix. Use the dense row sums of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">A</mi></mrow></math></span> as the vector for the right-hand side of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">Ax</mi><mo>=</mo><mi mathvariant="italic">b</mi></mrow></math></span> so that the solution <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi></mrow></math></span> is expected to be a vector of ones.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>n = 400; 
on = ones(n,1); 
A = spdiags([-2*on 4*on -2*on],-1:1,n,n);
b = full(sum(A,2));</pre></div></div></div><p>Solve <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">Ax</mi><mo>=</mo><mi mathvariant="italic">b</mi></mrow></math></span> using <code class="literal">symmlq</code>. The output display includes the value of the relative residual error <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mfrac><mrow><mrow><mo>‖</mo><mrow><mi mathvariant="italic">b</mi><mo>-</mo><mi mathvariant="normal">Ax</mi></mrow><mo>‖</mo></mrow></mrow><mrow><mrow><mo>‖</mo><mrow><mi mathvariant="italic">b</mi></mrow><mo>‖</mo></mrow></mrow></mfrac></mrow></math></span>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>x = symmlq(A,b);</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>symmlq stopped at iteration 20 without converging to the desired tolerance 1e-06
because the maximum number of iterations was reached.
The iterate returned (number 20) has relative residual 0.045.
</pre></div></div></div><p>By default <code class="literal">symmlq</code> uses 20 iterations and a tolerance of <code class="literal">1e-6</code>, and the algorithm is unable to converge in those 20 iterations for this matrix. Since the residual is on the order of <code class="literal">1e-2</code>, it is a good indicator that more iterations are needed. You also can use a larger tolerance to make it easier for the algorithm to converge.</p><p>Solve the system again using a tolerance of <code class="literal">1e-4</code> and 250 iterations.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>x = symmlq(A,b,1e-4,250);</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>symmlq converged at iteration 199 to a solution with relative residual 1.5e-14.
</pre></div></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-SYMMLQLinearSystemExample"><meta itemprop="exampletitle" content="Iterative Solution to Linear System"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_b2fe246e-1448-432b-97cf-487ec5e1ab98"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_b2fe246e-1448-432b-97cf-487ec5e1ab98" data-bs-target="#expand_accordion_body_mw_b2fe246e-1448-432b-97cf-487ec5e1ab98" aria-controls="expand_accordion_body_mw_b2fe246e-1448-432b-97cf-487ec5e1ab98" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_b2fe246e-1448-432b-97cf-487ec5e1ab98">Using <code class="literal">symmlq</code> with Preconditioner</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_b2fe246e-1448-432b-97cf-487ec5e1ab98" aria-labelledby="expand_accordion_heading_mw_b2fe246e-1448-432b-97cf-487ec5e1ab98" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/SYMMLQPreconditionerExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Using symmlq with Preconditioner",
          "description": "Examine the effect of using a preconditioner matrix with symmlq to solve a linear system.",
          "thumbnailURL": "../../examples/matlab/win64/SYMMLQPreconditionerExample_01.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "symmlq.html"

        },
          "identifier": "matlab.SYMMLQPreconditionerExample",
          "name": "SYMMLQPreconditionerExample",
          "url": "symmlq.html#mw_b2fe246e-1448-432b-97cf-487ec5e1ab98"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/SYMMLQPreconditionerExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "SYMMLQPreconditionerExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Examine the effect of using a preconditioner matrix with <code class="literal">symmlq</code> to solve a linear system.</p><p>Create a symmetric positive definite, banded coefficient matrix.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>A = delsq(numgrid(<span style="color:#A020F0">'S'</span>,102));</pre></div></div></div><p>Define <code class="literal">b</code> so that the true solution to <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">Ax</mi><mo>=</mo><mi mathvariant="italic">b</mi></mrow></math></span> is a vector of all ones.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>b = sum(A,2);</pre></div></div></div><p>Set the tolerance and maximum number of iterations.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>tol = 1e-12;
maxit = 100;</pre></div></div></div><p>Use <code class="literal">symmlq</code> to find a solution at the requested tolerance and number of iterations. Specify six outputs to return information about the solution process:</p><div class="itemizedlist"><ul><li><p><code class="literal">x</code> is the computed solution to <code class="literal">A*x = b</code>.</p></li><li><p><code class="literal">fl0</code> is a flag indicating whether the algorithm converged.</p></li><li><p><code class="literal">rr0</code> is the relative residual of the computed answer <code class="literal">x</code>.</p></li><li><p><code class="literal">it0</code> is the iteration number when <code class="literal">x</code> was computed.</p></li><li><p><code class="literal">rv0</code> is a vector of the residual history for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mrow><mo>‖</mo><mrow><mi mathvariant="italic">b</mi><mo>-</mo><mi mathvariant="normal">Ax</mi></mrow><mo>‖</mo></mrow></mrow></math></span>.</p></li><li><p><code class="literal">rvcg0</code> is a vector of the conjugate gradient residual history for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mrow><mo>‖</mo><mrow><msup><mrow><mi mathvariant="italic">A</mi></mrow><mrow><mi mathvariant="italic">T</mi></mrow></msup><mi mathvariant="italic">A</mi><mtext> </mtext><mi mathvariant="italic">x</mi><mo>-</mo><msup><mrow><mi mathvariant="italic">A</mi></mrow><mrow><mi mathvariant="italic">T</mi></mrow></msup><mi mathvariant="italic">b</mi></mrow><mo>‖</mo></mrow></mrow></math></span>.</p></li></ul></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[x,fl0,rr0,it0,rv0,rvcg0] = symmlq(A,b,tol,maxit);
fl0</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>fl0 = 
1
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>rr0</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>rr0 = 
0.0031
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>it0</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>it0 = 
100
</pre></div></div></div><p><code class="literal">fl0</code> is 1 because <code class="literal">symmlq</code> does not converge to the requested tolerance <code class="literal">1e-12</code> within the requested 100 iterations.</p><p>To aid with convergence, you can specify a preconditioner matrix. Since <code class="literal">A</code> is symmetric, use <code class="literal">ichol</code> to generate the preconditioner <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">M</mi><mo>=</mo><mi mathvariant="italic">L</mi><mtext> </mtext><msup><mrow><mi mathvariant="italic">L</mi></mrow><mrow><mi mathvariant="italic">T</mi></mrow></msup></mrow></math></span>. Specify the <code class="literal">'ict'</code> option to use incomplete Cholesky factorization with threshold dropping, and specify a diagonal shift value of <code class="literal">1e-6</code> to avoid nonpositive pivots. Solve the preconditioned system by specifying <code class="literal">L</code> and <code class="literal">L'</code> as inputs to <code class="literal">symmlq</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>setup = struct(<span style="color:#A020F0">'type'</span>,<span style="color:#A020F0">'ict'</span>,<span style="color:#A020F0">'diagcomp'</span>,1e-6,<span style="color:#A020F0">'droptol'</span>,1e-14);
L = ichol(A,setup);
[x1,fl1,rr1,it1,rv1,rvcg1] = symmlq(A,b,tol,maxit,L,L');
fl1</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>fl1 = 
0
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>rr1</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>rr1 = 
2.7572e-15
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>it1</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>it1 = 
3
</pre></div></div></div><p>The use of an <code class="literal">ichol</code> preconditioner greatly improves the numerical properties of the problem, and <code class="literal">symmlq</code> is able to converge quickly. The output <code class="literal">rv1(1)</code> is <code class="literal">norm(b)</code>, and the output <code class="literal">rv1(end)</code> is <code class="literal">norm(b-A*x1)</code>. </p><p>You can follow the progress of <code class="literal">symmlq</code> by plotting the relative residuals at each iteration. Plot the conjugate gradient residual history of each solution with a line for the specified tolerance.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>semilogy(0:length(rvcg0)-1,rvcg0/norm(b),<span style="color:#A020F0">'-o'</span>)
hold <span style="color:#A020F0">on</span>
semilogy(0:length(rvcg1)-1,rvcg1/norm(b),<span style="color:#A020F0">'-o'</span>)
yline(tol,<span style="color:#A020F0">'r--'</span>);
legend(<span style="color:#A020F0">'No preconditioner'</span>,<span style="color:#A020F0">'ICHOL preconditioner'</span>,<span style="color:#A020F0">'Tolerance'</span>,<span style="color:#A020F0">'Location'</span>,<span style="color:#A020F0">'SouthEast'</span>)
xlabel(<span style="color:#A020F0">'Iteration number'</span>)
ylabel(<span style="color:#A020F0">'Relative residual'</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e1788849" class="mediaobject"><p><img src="../../examples/matlab/win64/SYMMLQPreconditionerExample_01.png" alt="Figure contains an axes object. The axes object with xlabel Iteration number, ylabel Relative residual contains 3 objects of type line, constantline. These objects represent No preconditioner, ICHOL preconditioner, Tolerance." width="560"></p></div></div><div class="procedure"></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-SYMMLQPreconditionerExample"><meta itemprop="exampletitle" content="Using symmlq with Preconditioner"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_b01e1750-342b-43bd-a26e-f7d40778dd31"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_b01e1750-342b-43bd-a26e-f7d40778dd31" data-bs-target="#expand_accordion_body_mw_b01e1750-342b-43bd-a26e-f7d40778dd31" aria-controls="expand_accordion_body_mw_b01e1750-342b-43bd-a26e-f7d40778dd31" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_b01e1750-342b-43bd-a26e-f7d40778dd31">Supplying Initial Guess</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_b01e1750-342b-43bd-a26e-f7d40778dd31" aria-labelledby="expand_accordion_heading_mw_b01e1750-342b-43bd-a26e-f7d40778dd31" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/SYMMLQInitialGuessExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Supplying Initial Guess",
          "description": "Examine the effect of supplying symmlq with an initial guess of the solution.",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "symmlq.html"

        },
          "identifier": "matlab.SYMMLQInitialGuessExample",
          "name": "SYMMLQInitialGuessExample",
          "url": "symmlq.html#mw_b01e1750-342b-43bd-a26e-f7d40778dd31"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/SYMMLQInitialGuessExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "SYMMLQInitialGuessExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Examine the effect of supplying <code class="literal">symmlq</code> with an initial guess of the solution.</p><p>Create a tridiagonal sparse matrix. Use the sum of each row as the vector for the right-hand side of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">Ax</mi><mo>=</mo><mi mathvariant="italic">b</mi></mrow></math></span> so that the expected solution for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi></mrow></math></span> is a vector of ones.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>n = 900;
e = ones(n,1);
A = spdiags([e 2*e e],-1:1,n,n);
b = sum(A,2);</pre></div></div></div><p>Use <code class="literal">symmlq</code> to solve <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">Ax</mi><mo>=</mo><mi mathvariant="italic">b</mi></mrow></math></span> twice: one time with the default initial guess, and one time with a good initial guess of the solution. Use 200 iterations and the default tolerance for both solutions. Specify the initial guess in the second solution as a vector with all elements equal to <code class="literal">0.99</code>. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>maxit = 200;
x1 = symmlq(A,b,[],maxit);</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>symmlq converged at iteration 34 to a solution with relative residual 9.5e-07.
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>x0 = 0.99*e;
x2 = symmlq(A,b,[],maxit,[],[],x0);</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>symmlq converged at iteration 6 to a solution with relative residual 8.7e-07.
</pre></div></div></div><p>In this case supplying an initial guess enables <code class="literal">symmlq</code> to converge more quickly.</p><div class="procedure"><span id="SYMMLQInitialGuessExample-1" class="anchor_target"></span><p class="title" id="SYMMLQInitialGuessExample-1"><b>Returning Intermediate Results</b></p><p>You also can use the initial guess to get intermediate results by calling <code class="literal">symmlq</code> in a for-loop. Each call to the solver performs a few iterations and stores the calculated solution. Then you use that solution as the initial vector for the next batch of iterations. </p><p>For example, this code performs 100 iterations four times and stores the solution vector after each pass in the for-loop:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>x0 = zeros(size(A,2),1);
tol = 1e-8;
maxit = 100;
<span style="color:#0000FF">for</span> k = 1:4
    [x,flag,relres] = symmlq(A,b,tol,maxit,[],[],x0);
    X(:,k) = x;
    R(k) = relres;
    x0 = x;
<span style="color:#0000FF">end</span></pre></div></div></div><p><code class="literal">X(:,k)</code> is the solution vector computed at iteration <code class="literal">k</code> of the for-loop, and <code class="literal">R(k)</code> is the relative residual of that solution.</p></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-SYMMLQInitialGuessExample"><meta itemprop="exampletitle" content="Supplying Initial Guess"></div><div class="accordion" role="tablist" aria-multiselectable="true" id="expand_accordion_heading_mw_04c99d2b-c732-43b6-9e08-8064c136e6d2"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_04c99d2b-c732-43b6-9e08-8064c136e6d2" data-bs-target="#expand_accordion_body_mw_04c99d2b-c732-43b6-9e08-8064c136e6d2" aria-controls="expand_accordion_body_mw_04c99d2b-c732-43b6-9e08-8064c136e6d2" class="accordion-button add_cursor_pointer" aria-expanded="true"><h3 id="mw_04c99d2b-c732-43b6-9e08-8064c136e6d2">Using Function Handle Instead of Numeric Matrix</h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_04c99d2b-c732-43b6-9e08-8064c136e6d2" aria-labelledby="expand_accordion_heading_mw_04c99d2b-c732-43b6-9e08-8064c136e6d2" class="accordion-collapse collapse show"><div class="accordion-body"><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/SYMMLQFunctionHandleExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Using Function Handle Instead of Numeric Matrix",
          "description": "Solve a linear system by providing symmlq with a function handle that computes A*x in place of the coefficient matrix A.",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "symmlq.html"

        },
          "identifier": "matlab.SYMMLQFunctionHandleExample",
          "name": "SYMMLQFunctionHandleExample",
          "url": "symmlq.html#mw_04c99d2b-c732-43b6-9e08-8064c136e6d2"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/SYMMLQFunctionHandleExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "SYMMLQFunctionHandleExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><p class="shortdesc">Solve a linear system by providing <code class="literal">symmlq</code> with a function handle that computes <code class="literal">A*x</code> in place of the coefficient matrix <code class="literal">A</code>.</p><p>One of the Wilkinson test matrices generated by <code class="literal">gallery</code> is a 21-by-21 tridiagonal matrix. Preview the matrix.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>A = gallery(<span style="color:#A020F0">'wilk'</span>,21)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>A = <span class="emphasis"><em>21×21</em></span>

    10     1     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     1     9     1     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     1     8     1     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     1     7     1     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     1     6     1     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     1     5     1     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     1     4     1     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     1     3     1     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     1     2     1     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     1     1     1     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     1     0     1     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     1     1     1     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     1     2     1     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0     1     3     1     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0     0     1     4     1     0     0     0     0     0
      &#x22EE;

</pre></div></div></div><p>The Wilkinson matrix has a special structure, so you can represent the operation <code class="literal">A*x</code> with a function handle. When <code class="literal">A</code> multiplies a vector, most of the elements in the resulting vector are zeros. The nonzero elements in the result correspond with the nonzero tridiagonal elements of <code class="literal">A</code>. Moreover, only the main diagonal has nonzeros that are not equal to 1. </p><p>The expression <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">Ax</mi></mrow></math></span> becomes:</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">Ax</mi><mo>=</mo><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><mn>10</mn></mrow></mtd><mtd><mrow><mn>1</mn></mrow></mtd><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mo>&#x22EF;</mo></mrow></mtd><mtd><mrow><mi data-category="placeholder-atom"/></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mo data-category="structure">&#x22EF;</mo></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mi data-category="placeholder-atom"/></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mo data-category="structure">&#x22EF;</mo></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>0</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>0</mn></mrow></mtd></mtr><mtr data-category="structure-part"><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>1</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>9</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>1</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mn>0</mn></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mi data-category="placeholder-atom"/></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mi data-category="placeholder-atom"/></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mi data-category="placeholder-atom"/></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mi data-category="placeholder-atom"/></mrow></mtd><mtd data-category="structure-part"><mrow data-category="placeholder"><mi id="5CFAFBEB" data-category="placeholder-atom"/></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="54E037D8" data-category="placeholder"><mn id="B38EC078">0</mn></mrow></mtd></mtr><mtr id="31CD751D" data-category="structure-part"><mtd id="31CD751D" data-category="structure-part"><mrow id="BB73F7D0" data-category="placeholder"><mn id="59689744">0</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="4A76FE70" data-category="placeholder"><mn id="3A9F4CC5">1</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="3639FA53" data-category="placeholder"><mn id="CA922D61">8</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="D7BF07BC" data-category="placeholder"><mn id="83C6278F">1</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="05FCA501" data-category="placeholder"><mn id="CF11BD39">0</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="E51EA33A" data-category="placeholder"><mi id="EF995190" data-category="placeholder-atom"/></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="6C535183" data-category="placeholder"><mi id="6B91ABF6" data-category="placeholder-atom"/></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="B99A0443" data-category="placeholder"><mi id="E6E374EA" data-category="placeholder-atom"/></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="A382FCD5" data-category="placeholder"><mi id="40506BFE" data-category="placeholder-atom"/></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="15B3577B" data-category="placeholder"><mo id="42E59279" data-category="structure">&#x22EE;</mo></mrow></mtd></mtr><mtr id="31CD751D" data-category="structure-part"><mtd id="31CD751D" data-category="structure-part"><mrow id="E328089B" data-category="placeholder"><mo id="A90817EE" data-category="structure">&#x22EE;</mo></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="A741CB93" data-category="placeholder"><mn id="1EE570DC">0</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="3A2FE26D" data-category="placeholder"><mn id="194D27FB">1</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="40C72515" data-category="placeholder"><mn id="87AC19AF">7</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="FE315CAA" data-category="placeholder"><mn id="88F8B9A7">1</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="17C8D22F" data-category="placeholder"><mn id="5D3237E3">0</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="87802F84" data-category="placeholder"><mi id="192EB106" data-category="placeholder-atom"/></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="1C7D3AE1" data-category="placeholder"><mi id="FA4D3D50" data-category="placeholder-atom"/></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="9FF23EA3" data-category="placeholder"><mi id="5FD39F37" data-category="placeholder-atom"/></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="7C2463FF" data-category="placeholder"><mi id="7C2FFFAE" data-category="placeholder-atom"/></mrow></mtd></mtr><mtr id="31CD751D" data-category="structure-part"><mtd id="31CD751D" data-category="structure-part"><mrow id="BFD00C04" data-category="placeholder"><mi id="80C6712A" data-category="placeholder-atom"/></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="8312CC91" data-category="placeholder"><mi id="EF33355A" data-category="placeholder-atom"/></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="1E7F8456" data-category="placeholder"><mn id="55870011">0</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="7E454958" data-category="placeholder"><mn id="16998AE2">1</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="34925E55" data-category="placeholder"><mn id="26C14B1E">6</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="1CFE2C98" data-category="placeholder"><mn id="A47DBA25">1</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="5F63CF0A" data-category="placeholder"><mn id="87275F61">0</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="FCD428CD" data-category="placeholder"><mi id="CA21787F" data-category="placeholder-atom"/></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="10FEA04C" data-category="placeholder"><mi id="41BF87CC" data-category="placeholder-atom"/></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="A7DD3DDC" data-category="placeholder"><mo id="4A5A8985" data-category="structure">&#x22EE;</mo></mrow></mtd></mtr><mtr id="31CD751D" data-category="structure-part"><mtd id="31CD751D" data-category="structure-part"><mrow id="43265F28" data-category="placeholder"><mo id="E7E2DB83" data-category="structure">&#x22EE;</mo></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="B40B5A9B" data-category="placeholder"><mi id="5B7D0E2C" data-category="placeholder-atom"/></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="56ABFAD2" data-category="placeholder"><mi id="382F1581" data-category="placeholder-atom"/></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="3529B57C" data-category="placeholder"><mn id="0A2AB65D">0</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="7E03D67F" data-category="placeholder"><mn id="1B618848">1</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="6AE36434" data-category="placeholder"><mn id="72A0577B">5</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="4A84C550" data-category="placeholder"><mn id="909B5844">1</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="29115B52" data-category="placeholder"><mn id="6A6C71CD">0</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="73C39CDC" data-category="placeholder"><mi id="43E21FB5" data-category="placeholder-atom"/></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="507955C7" data-category="placeholder"><mi id="9CCF5F3B" data-category="placeholder-atom"/></mrow></mtd></mtr><mtr id="31CD751D" data-category="structure-part"><mtd id="31CD751D" data-category="structure-part"><mrow id="B9A3E708" data-category="placeholder"><mi id="29730948" data-category="placeholder-atom"/></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="C50EE130" data-category="placeholder"><mi id="0D7D28F8" data-category="placeholder-atom"/></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="5D724EE6" data-category="placeholder"><mi id="19627BB9" data-category="placeholder-atom"/></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="EB69A299" data-category="placeholder"><mi id="793B0157" data-category="placeholder-atom"/></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="764007E9" data-category="placeholder"><mn id="083C6E02">0</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="160333FE" data-category="placeholder"><mn id="D17439C8">1</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="BE4235CF" data-category="placeholder"><mn id="951C126F">4</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="CCBE0953" data-category="placeholder"><mn id="BD0AA8B3">1</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="814C1C85" data-category="placeholder"><mn id="55A98D87">0</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="61DA6428" data-category="placeholder"><mo id="70416F50" data-category="structure">&#x22EE;</mo></mrow></mtd></mtr><mtr id="31CD751D" data-category="structure-part"><mtd id="31CD751D" data-category="structure-part"><mrow id="1F08157F" data-category="placeholder"><mo id="1C2948AC" data-category="structure">&#x22EE;</mo></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="37D5FABC" data-category="placeholder"><mi id="40EA947B" data-category="placeholder-atom"/></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="AF0F27E3" data-category="placeholder"><mi id="7255C9C8" data-category="placeholder-atom"/></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="63BD0D9E" data-category="placeholder"><mi id="7A2AFF2A" data-category="placeholder-atom"/></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="63E1516A" data-category="placeholder"><mi id="0F19DF1D" data-category="placeholder-atom"/></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="DA8D68B6" data-category="placeholder"><mn id="925E2D20">0</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="4AF81FE1" data-category="placeholder"><mn id="60E6637F">1</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="0C483420" data-category="placeholder"><mn id="B4D3CFC6">3</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="E014400F" data-category="placeholder"><mo id="05E1AC98" data-category="structure">⋱</mo></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="793DD800" data-category="placeholder"><mn id="2BCD4DE9">0</mn></mrow></mtd></mtr><mtr id="31CD751D" data-category="structure-part"><mtd id="31CD751D" data-category="structure-part"><mrow id="6555D8D9" data-category="placeholder"><mn id="E6E744B6">0</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="06854A28" data-category="placeholder"><mi id="568B0A6F" data-category="placeholder-atom"/></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="8B0A3860" data-category="placeholder"><mi id="9F575435" data-category="placeholder-atom"/></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="620190CD" data-category="placeholder"><mi id="5582BFFE" data-category="placeholder-atom"/></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="573552FD" data-category="placeholder"><mi id="251F9680" data-category="placeholder-atom"/></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="CBDF68E5" data-category="placeholder"><mi id="04254524" data-category="placeholder-atom"/></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="32E43178" data-category="placeholder"><mn id="C9BE766C">0</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="0D3A326A" data-category="placeholder"><mo id="255E5C0C" data-category="structure">⋱</mo></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="DD3D69E7" data-category="placeholder"><mo id="D66D2855" data-category="structure">⋱</mo></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="E731310C" data-category="placeholder"><mn id="398EA705">1</mn></mrow></mtd></mtr><mtr id="31CD751D" data-category="structure-part"><mtd id="31CD751D" data-category="structure-part"><mrow id="6F0BE83D" data-category="placeholder"><mn id="C92DEB34">0</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="49203E59" data-category="placeholder"><mn id="67C0DC24">0</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="9DF6A5D2" data-category="placeholder"><mo id="DC423457" data-category="structure">&#x22EF;</mo></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="6B22AF0C" data-category="placeholder"><mi id="386A3C21" data-category="placeholder-atom"/></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="F8B25BA1" data-category="placeholder"><mo id="7E3E0A06" data-category="structure">&#x22EF;</mo></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="B8CAD8FA" data-category="placeholder"><mi id="3E6D442D" data-category="placeholder-atom"/></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="884F256B" data-category="placeholder"><mo id="BFCE6B52" data-category="structure">&#x22EF;</mo></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="874CDA10" data-category="placeholder"><mn id="FBDD1EF4">0</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="22144029" data-category="placeholder"><mn id="694E5F66">1</mn></mrow></mtd><mtd id="31CD751D" data-category="structure-part"><mrow id="97FF4968" data-category="placeholder"><mn id="F6494C5F">10</mn></mrow></mtd></mtr></mtable><mo id="D3005C25" data-category="static">]</mo></mrow><mrow id="006182B5" data-category="structure"><mo id="39AF232E" data-category="static">[</mo><mtable id="5BB26425" data-category="structure-part" columnalign="center"><mtr id="5BB26425" data-category="structure-part"><mtd id="5BB26425" data-category="structure-part"><mrow id="D23E3CCD" data-category="placeholder"><msub id="38C5381E" data-category="structure"><mrow id="26DF51B1" data-category="placeholder"><mi mathvariant="italic" id="14A6189A">x</mi></mrow><mrow id="B940992C" data-category="placeholder"><mn id="91BF8524">1</mn></mrow></msub></mrow></mtd></mtr><mtr id="5BB26425" data-category="structure-part"><mtd id="5BB26425" data-category="structure-part"><mrow id="41C23F81" data-category="placeholder"><msub id="DCB78510" data-category="structure"><mrow id="92AFB4CC" data-category="placeholder"><mi mathvariant="italic" id="12E00368">x</mi></mrow><mrow id="70E518B3" data-category="placeholder"><mn id="4CCC501F">2</mn></mrow></msub></mrow></mtd></mtr><mtr id="5BB26425" data-category="structure-part"><mtd id="5BB26425" data-category="structure-part"><mrow id="1CF96941" data-category="placeholder"><msub id="BE05D2DC" data-category="structure"><mrow id="06797D46" data-category="placeholder"><mi mathvariant="italic" id="CF5A65C3">x</mi></mrow><mrow id="C0CBC88C" data-category="placeholder"><mn id="BF0D199D">3</mn></mrow></msub></mrow></mtd></mtr><mtr id="5BB26425" data-category="structure-part"><mtd id="5BB26425" data-category="structure-part"><mrow id="95D7D346" data-category="placeholder"><msub id="C121A755" data-category="structure"><mrow id="3DFB0C57" data-category="placeholder"><mi mathvariant="italic" id="07762A61">x</mi></mrow><mrow id="FA432737" data-category="placeholder"><mn id="939C61C6">4</mn></mrow></msub></mrow></mtd></mtr><mtr id="5BB26425" data-category="structure-part"><mtd id="5BB26425" data-category="structure-part"><mrow id="CC3301C4" data-category="placeholder"><msub id="3ABF524D" data-category="structure"><mrow id="05632F78" data-category="placeholder"><mi mathvariant="italic" id="07373F4D">x</mi></mrow><mrow id="2AE67084" data-category="placeholder"><mn id="F459E945">5</mn></mrow></msub></mrow></mtd></mtr><mtr id="5BB26425" data-category="structure-part"><mtd id="5BB26425" data-category="structure-part"><mrow id="23DFA5AA" data-category="placeholder"><mo id="0A0A7A81" data-category="structure">&#x22EE;</mo></mrow></mtd></mtr><mtr id="5BB26425" data-category="structure-part"><mtd id="5BB26425" data-category="structure-part"><mrow id="EC7B0072" data-category="placeholder"><mi id="82B56C0C" data-category="placeholder-atom"/></mrow></mtd></mtr><mtr id="5BB26425" data-category="structure-part"><mtd id="5BB26425" data-category="structure-part"><mrow id="F8F31236" data-category="placeholder"><mo id="5D472B6D" data-category="structure">&#x22EE;</mo></mrow></mtd></mtr><mtr id="5BB26425" data-category="structure-part"><mtd id="5BB26425" data-category="structure-part"><mrow id="8B09902B" data-category="placeholder"><mi id="FB4E5703" data-category="placeholder-atom"/></mrow></mtd></mtr><mtr id="5BB26425" data-category="structure-part"><mtd id="5BB26425" data-category="structure-part"><mrow id="1E2C891A" data-category="placeholder"><msub id="CEC43083" data-category="structure"><mrow id="4C0C4B6E" data-category="placeholder"><mi mathvariant="italic" id="350F74E9">x</mi></mrow><mrow id="66631887" data-category="placeholder"><mn id="88C9145B">21</mn></mrow></msub></mrow></mtd></mtr></mtable><mo id="AEE5E522" data-category="static">]</mo></mrow><mo id="07971FA7">=</mo><mrow id="26893028" data-category="structure"><mo id="282A75A5" data-category="static">[</mo><mtable id="C8396102" data-category="structure-part" columnalign="center"><mtr id="C8396102" data-category="structure-part"><mtd id="C8396102" data-category="structure-part"><mrow id="1301743F"><mn id="ED0DBEE9">10</mn><msub id="8781D911" data-category="structure"><mrow id="667BCB65" data-category="placeholder"><mi mathvariant="italic" id="97F75651">x</mi></mrow><mrow id="0A30DA2F" data-category="placeholder"><mn id="7FE7792A">1</mn></mrow></msub><mo id="D5652660">+</mo><msub id="028AEE8E" data-category="structure"><mrow id="AF60D2F8" data-category="placeholder"><mi mathvariant="italic" id="0D18BC0E">x</mi></mrow><mrow id="EB3E1595" data-category="placeholder"><mn id="976C183C">2</mn></mrow></msub></mrow></mtd></mtr><mtr id="C8396102" data-category="structure-part"><mtd id="C8396102" data-category="structure-part"><mrow id="9D4541B0"><msub id="B8C09DF1" data-category="structure"><mrow id="D4AADD86" data-category="placeholder"><mi mathvariant="italic" id="0FBBFDF7">x</mi></mrow><mrow id="90B12A6C" data-category="placeholder"><mn id="CC6C4285">1</mn></mrow></msub><mo id="2DD065FA">+</mo><mn id="E07B173E">9</mn><msub id="8BEBCC7D" data-category="structure"><mrow id="9335EFBF" data-category="placeholder"><mi mathvariant="italic" id="89DA14FF">x</mi></mrow><mrow id="BBA9FDEF" data-category="placeholder"><mn id="A39A56BB">2</mn></mrow></msub><mo id="E81006DE">+</mo><msub id="045A2E8E" data-category="structure"><mrow id="90625DDB" data-category="placeholder"><mi mathvariant="italic" id="E9071955">x</mi></mrow><mrow id="846C1FE6" data-category="placeholder"><mn id="802943D6">3</mn></mrow></msub></mrow></mtd></mtr><mtr id="C8396102" data-category="structure-part"><mtd id="C8396102" data-category="structure-part"><mrow id="8E033F16"><msub id="8BE20F52" data-category="structure"><mrow id="A66C7F8E" data-category="placeholder"><mi mathvariant="italic" id="87FDEF3A">x</mi></mrow><mrow id="EC4C354D" data-category="placeholder"><mn id="845EB523">2</mn></mrow></msub><mo id="F991227D">+</mo><mn id="601ABB34">8</mn><msub id="1091EA59" data-category="structure"><mrow id="282096FC" data-category="placeholder"><mi mathvariant="italic" id="3B3E1192">x</mi></mrow><mrow id="53D737F1" data-category="placeholder"><mn id="4AEA2663">3</mn></mrow></msub><mo id="27957827">+</mo><msub id="2A57E167" data-category="structure"><mrow id="8DDCAFD9" data-category="placeholder"><mi mathvariant="italic" id="5E9294E7">x</mi></mrow><mrow id="AF489F13" data-category="placeholder"><mn id="5C345AB3">4</mn></mrow></msub></mrow></mtd></mtr><mtr id="C8396102" data-category="structure-part"><mtd id="C8396102" data-category="structure-part"><mrow id="33D14808"><mo id="27183012" data-category="structure">&#x22EE;</mo></mrow></mtd></mtr><mtr id="C8396102" data-category="structure-part"><mtd id="C8396102" data-category="structure-part"><mrow id="0527E965" data-category="placeholder"><msub id="D2D6A29E" data-category="structure"><mrow id="6C53D1B6" data-category="placeholder"><mi mathvariant="italic" id="D2BF5230">x</mi></mrow><mrow id="367112AD" data-category="placeholder"><mn id="5E8AD942">19</mn></mrow></msub><mo id="74381363">+</mo><mn id="84B714F2">9</mn><msub id="900C1D15" data-category="structure"><mrow id="B0BBC4CA" data-category="placeholder"><mi mathvariant="italic" id="515F1604">x</mi></mrow><mrow id="8500C808" data-category="placeholder"><mn id="66D00FF5">20</mn></mrow></msub><mo id="B0241696">+</mo><msub id="82910A0B" data-category="structure"><mrow id="E47B6FC9" data-category="placeholder"><mi mathvariant="italic" id="2E2AA06E">x</mi></mrow><mrow id="B1A462D4" data-category="placeholder"><mn id="F5361042">21</mn></mrow></msub></mrow></mtd></mtr><mtr id="C8396102" data-category="structure-part"><mtd id="C8396102" data-category="structure-part"><mrow id="DF1FD969" data-category="placeholder"><msub id="61237A8F" data-category="structure"><mrow id="473A13EC" data-category="placeholder"><mi mathvariant="italic" id="408D8046">x</mi></mrow><mrow id="C65C336D" data-category="placeholder"><mn id="43DA4605">20</mn></mrow></msub><mo id="3088AA97">+</mo><mn id="E1DBFBA1">10</mn><msub id="47342202" data-category="structure"><mrow id="90035D40" data-category="placeholder"><mi mathvariant="italic" id="4E8D728E">x</mi></mrow><mrow id="DE7F3E36" data-category="placeholder"><mn id="BB16AC15">21</mn></mrow></msub></mrow></mtd></mtr></mtable><mo id="C52495D4" data-category="static">]</mo></mrow></mrow></math></span>.</p><p>The resulting vector can be written as the sum of three vectors:</p><p><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">Ax</mi><mo>=</mo><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><mn>0</mn><mo>+</mo><mn>10</mn><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>+</mo><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>+</mo><mn>9</mn><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>+</mo><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>3</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>+</mo><mn>8</mn><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>3</mn></mrow></msub><mo>+</mo><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>4</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mo>&#x22EE;</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>19</mn></mrow></msub><mo>+</mo><mn>9</mn><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>20</mn></mrow></msub><mo>+</mo><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>21</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>20</mn></mrow></msub><mo>+</mo><mn>10</mn><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>21</mn></mrow></msub><mo>+</mo><mn>0</mn></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow></math></span>=<span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mo>&#x22EE;</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>20</mn></mrow></msub></mrow></mtd></mtr></mtable><mo>]</mo></mrow><mo>+</mo><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><mn>10</mn><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mn>9</mn><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mo>&#x22EE;</mo></mrow></mtd></mtr><mtr><mtd><mrow><mn>10</mn><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>21</mn></mrow></msub></mrow></mtd></mtr></mtable><mo>]</mo></mrow><mo>+</mo><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mo>&#x22EE;</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>21</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mn>0</mn></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow></math></span>.</p><p>In MATLAB&#174;, write a function that creates these vectors and adds them together, thus giving the value of <code class="literal">A*x</code>:</p><div class="code_responsive"><pre id="d126e1789828" class="programlisting"><span style="color:#0000FF">function</span> y = afun(x)
y = [0; x(1:20)] + <span style="color:#0000FF">...</span>
    [(10:-1:0)'; (1:10)'].*x + <span style="color:#0000FF">...</span>
    [x(2:21); 0];
<span style="color:#0000FF">end</span>
</pre></div><p>(This function is saved as a local function at the end of the example.)</p><p>Now, solve the linear system <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">Ax</mi><mo>=</mo><mi mathvariant="italic">b</mi></mrow></math></span> by providing <code class="literal">symmlq</code> with the function handle that calculates <code class="literal">A*x</code>. Use a tolerance of <code class="literal">1e-12</code> and 50 iterations.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>b = ones(21,1);
tol = 1e-12;  
maxit = 50;
x1 = symmlq(@afun,b,tol,maxit)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>symmlq converged at iteration 10 to a solution with relative residual 4.5e-16.
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>x1 = <span class="emphasis"><em>21×1</em></span>

    0.0910
    0.0899
    0.0999
    0.1109
    0.1241
    0.1443
    0.1544
    0.2383
    0.1309
    0.5000
    0.3691
    0.5000
    0.1309
    0.2383
    0.1544
      &#x22EE;

</pre></div></div></div><p>Check that <code class="literal">afun(x1)</code> produces a vector of ones.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>afun(x1)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans = <span class="emphasis"><em>21×1</em></span>

    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
      &#x22EE;

</pre></div></div></div><div class="procedure"><span id="SYMMLQFunctionHandleExample-1" class="anchor_target"></span><p class="title" id="SYMMLQFunctionHandleExample-1"><b>Local Functions</b></p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> y = afun(x)
y = [0; x(1:20)] + <span style="color:#0000FF">...</span>
    [(10:-1:0)'; (1:10)'].*x + <span style="color:#0000FF">...</span>
    [x(2:21); 0];
<span style="color:#0000FF">end</span></pre></div></div></div></div></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-SYMMLQFunctionHandleExample"><meta itemprop="exampletitle" content="Using Function Handle Instead of Numeric Matrix"></div></div></div></div><div class="ref_sect"><h2 id="mw_0aaaac8c-8fb6-4cea-9fd3-da54ecc2ec27">Input Arguments</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="mw_0aaaac8c-8fb6-4cea-9fd3-da54ecc2ec27_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="mw_3e5039bc-ef18-476b-b23a-d6673527a9bf"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_mw_3e5039bc-ef18-476b-b23a-d6673527a9bf" data-bs-target="#expand_accordion_body_mw_3e5039bc-ef18-476b-b23a-d6673527a9bf" aria-controls="expand_accordion_body_mw_3e5039bc-ef18-476b-b23a-d6673527a9bf" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_A" class="anchor_target"></span><h3 id="mw_3e5039bc-ef18-476b-b23a-d6673527a9bf"><code itemprop="name">A</code> &#8212; <span itemprop="purpose">Coefficient matrix</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">matrix</span> | <span itemprop="inputvalue">function handle</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_mw_3e5039bc-ef18-476b-b23a-d6673527a9bf" aria-labelledby="expand_accordion_heading_mw_3e5039bc-ef18-476b-b23a-d6673527a9bf" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_mw_3e5039bc-ef18-476b-b23a-d6673527a9bf"><p>Coefficient matrix, specified as a symmetric matrix or function handle. This matrix
            is the coefficient matrix in the linear system <code class="literal">A*x = b</code>. Generally,
              <code class="literal">A</code> is a large sparse matrix or a function handle that returns the
            product of a large sparse matrix and column vector. You can use <a href="issymmetric.html"><code class="function">issymmetric</code></a> to confirm that <code class="literal">A</code> is symmetric.</p><h4 class="descriptionsect">Specifying <code class="literal">A</code> as a Function Handle</h4>
        <p>You can optionally specify the coefficient matrix as a function handle instead of a matrix.
        The function handle returns matrix-vector products instead of forming the entire coefficient
        matrix, making the calculation more efficient.</p><p>To use a function handle, use the function signature <code class="literal">function y = afun(x)</code>. <a href="../math/parameterizing-functions.html" class="a">Parameterizing Functions</a> explains how to provide additional parameters to the function <code class="function">afun</code>, if necessary. The function call <code class="literal">afun(x)</code> must return the value of <code class="literal">A*x</code>.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code> | <code itemprop="datatype">function_handle</code><br/>
<strong>Complex Number Support: </strong>Yes</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="f96-1000445_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_f96-1000445_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" data-bs-target="#expand_accordion_body_f96-1000445_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" aria-controls="expand_accordion_body_f96-1000445_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_b" class="anchor_target"></span><h3 id="f96-1000445_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab"><code itemprop="name">b</code> &#8212; <span itemprop="purpose">Right side of linear equation</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue">column vector</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_f96-1000445_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" aria-labelledby="expand_accordion_heading_f96-1000445_sep_mw_3800dea9-6306-44ef-9490-f16e20ceb7ab" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f96-1000445.mw_3800dea9-6306-44ef-9490-f16e20ceb7ab"><p>Right side of linear equation, specified as a
                                                  column vector. The length of <code class="literal">b</code>
                                                  must be equal to
                                                  <code class="literal">size(A,1)</code>.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code><br/>
<strong>Complex Number Support: </strong>Yes</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="f96-1000445_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_f96-1000445_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" data-bs-target="#expand_accordion_body_f96-1000445_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" aria-controls="expand_accordion_body_f96-1000445_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_tol" class="anchor_target"></span><h3 id="f96-1000445_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b"><code itemprop="name">tol</code> &#8212; <span itemprop="purpose">Method tolerance</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue defaultvalue"><code class="literal">[]</code> or
                                    <code class="literal">1e-6</code></span> (default) | <span itemprop="inputvalue">positive scalar</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_f96-1000445_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" aria-labelledby="expand_accordion_heading_f96-1000445_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f96-1000445.mw_b797b123-ccd8-4b99-a496-07d543d1a21b"><p>Method tolerance, specified as a positive scalar. Use this input to trade off accuracy and
                                    runtime in the calculation. <code class="function">symmlq</code>
                                    must meet the tolerance within the number of allowed iterations
                                    to be successful. A smaller value of <code class="literal">tol</code>
                                    means the answer must be more precise for the calculation to be
                                    successful.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code></p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="f96-1000445_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_f96-1000445_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" data-bs-target="#expand_accordion_body_f96-1000445_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" aria-controls="expand_accordion_body_f96-1000445_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_maxit" class="anchor_target"></span><h3 id="f96-1000445_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16"><code itemprop="name">maxit</code> &#8212; <span itemprop="purpose">Maximum number of iterations</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue defaultvalue"><code class="literal">[]</code> or <code class="literal">min(size(A,1),20)</code></span> (default) | <span itemprop="inputvalue">positive scalar integer</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_f96-1000445_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" aria-labelledby="expand_accordion_heading_f96-1000445_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f96-1000445.mw_843917a7-f520-49f0-8815-7ffb3f307a16"><p>Maximum number of iterations, specified as a positive scalar integer. Increase the value of
                <code class="literal">maxit</code> to allow more iterations for
                <code class="function">symmlq</code> to meet the tolerance <a href="#f96-1000445_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="intrnllnk"><code class="argument">tol</code></a>.
            Generally, a smaller value of <code class="argument">tol</code> means more iterations are
            required to successfully complete the calculation.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code></p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="f96-1000445_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_f96-1000445_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" data-bs-target="#expand_accordion_body_f96-1000445_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" aria-controls="expand_accordion_body_f96-1000445_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_M" class="anchor_target"></span><span id="inputarg_M1" class="anchor_target"></span><span id="inputarg_M2" class="anchor_target"></span><h3 id="f96-1000445_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667"><code itemprop="name">M</code>, <code itemprop="name">M1</code>, <code itemprop="name">M2</code> &#8212; <span itemprop="purpose">Preconditioner matrices (as separate arguments)</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue defaultvalue"><code class="literal">eye(size(A))</code></span> (default) | <span itemprop="inputvalue">matrices</span> | <span itemprop="inputvalue">function handles</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_f96-1000445_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" aria-labelledby="expand_accordion_heading_f96-1000445_sep_mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f96-1000445.mw_a88cd7b1-4dcd-46dd-8611-81acb80fe667"><p>Preconditioner matrices, specified as separate arguments of matrices or function
            handles. You can specify a preconditioner matrix <code class="literal">M</code> or its matrix
            factors <code class="literal">M = M1*M2</code> to improve the numerical aspects of the linear
            system and make it easier for <code class="function">symmlq</code> to converge quickly. You
            can use the incomplete matrix factorization functions <a href="ilu.html"><code class="function">ilu</code></a> and <a href="ichol.html"><code class="function">ichol</code></a> to generate preconditioner
            matrices. You also can use <a href="equilibrate.html"><code class="function">equilibrate</code></a> prior to factorization to improve the condition number of
            the coefficient matrix. For more information on preconditioners, see <a href="../math/iterative-methods-for-linear-systems.html" class="a">Iterative Methods for Linear Systems</a>.</p><p><code class="function">symmlq</code> treats unspecified preconditioners as identity
            matrices.</p>
            <h4 class="descriptionsect">Specifying <code class="literal">M</code> as a Function Handle</h4>
            <p>You can optionally specify any of <code class="literal">M</code>, <code class="literal">M1</code>, or
                    <code class="literal">M2</code> as function handles instead of matrices. The function
                handle performs matrix-vector operations instead of forming the entire
                preconditioner matrix, making the calculation more efficient.</p>
            <p>To use a function handle, use the function signature <code class="literal">function y =
                    mfun(x)</code>. <a href="../math/parameterizing-functions.html" class="a">Parameterizing Functions</a> explains
                how to provide additional parameters to the function <code class="function">mfun</code>, if
                necessary. The function call <code class="literal">mfun(x)</code> must return the value of
                    <code class="literal">M\x</code> or <code class="literal">M2\(M1\x)</code>.</p>
        </div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code> | <code itemprop="datatype">function_handle</code><br/>
<strong>Complex Number Support: </strong>Yes</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div itemscope="" itemprop="inputargument" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/NamedInputArgument" itemid="f96-1000445_sep_mw_40e27791-2264-4d42-8cb6-b8bf869783bc"><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_f96-1000445_sep_mw_40e27791-2264-4d42-8cb6-b8bf869783bc" data-bs-target="#expand_accordion_body_f96-1000445_sep_mw_40e27791-2264-4d42-8cb6-b8bf869783bc" aria-controls="expand_accordion_body_f96-1000445_sep_mw_40e27791-2264-4d42-8cb6-b8bf869783bc" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="inputarg_x0" class="anchor_target"></span><h3 id="f96-1000445_sep_mw_40e27791-2264-4d42-8cb6-b8bf869783bc"><code itemprop="name">x0</code> &#8212; <span itemprop="purpose">Initial guess</span><br/> <span class="add_font_color_general remove_bold"><span class="example_desc"><span itemprop="inputvalue defaultvalue"><code class="literal">[]</code> or a column vector of zeros</span> (default) | <span itemprop="inputvalue">column vector</span></span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_f96-1000445_sep_mw_40e27791-2264-4d42-8cb6-b8bf869783bc" aria-labelledby="expand_accordion_heading_f96-1000445_sep_mw_40e27791-2264-4d42-8cb6-b8bf869783bc" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f96-1000445.mw_40e27791-2264-4d42-8cb6-b8bf869783bc"><p>Initial guess, specified as a column vector with length equal to <code class="literal">size(A,2)</code>.
            If you can provide <code class="function">symmlq</code> with a more reasonable initial guess
                <code class="literal">x0</code> than the default vector of zeros, then it can save computation
            time and help the algorithm converge faster.</p></div><p class="datatypelist"><strong>Data Types: </strong><code itemprop="datatype">single</code> | <code itemprop="datatype">double</code><br/>
<strong>Complex Number Support: </strong>Yes</p></div></div></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="mw_cf6d8a42-502b-4fd2-ae44-dbe33f69eeed">Output Arguments</h2><div class="expandableContent"><p class="switch "><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion" id="mw_cf6d8a42-502b-4fd2-ae44-dbe33f69eeed_accordion-group" role="tablist" aria-multiselectable="true"><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_f96-1000445_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" data-bs-target="#expand_accordion_body_f96-1000445_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" aria-controls="expand_accordion_body_f96-1000445_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_x" class="anchor_target"></span><h3 id="f96-1000445_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7"><code class="name">x</code> &#8212; Linear system solution<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">column vector</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_f96-1000445_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" aria-labelledby="expand_accordion_heading_f96-1000445_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f96-1000445.mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7"><p>Linear system solution, returned as a column vector. This output gives the approximate
            solution to the linear system <code class="literal">A*x = b</code>. If the calculation is
            successful (<code class="literal">flag = 0</code>), then <a href="#f96-1000445_sep_mw_1b807afe-eb58-4932-87f4-8db68de91460" class="intrnllnk"><code class="argument">relres</code></a> is less than
            or equal to <a href="#f96-1000445_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="intrnllnk"><code class="argument">tol</code></a>.</p><p>Whenever the calculation is not successful (<code class="literal">flag ~= 0</code>), the solution
                <code class="literal">x</code> returned by <code class="function">symmlq</code> is the one with
            minimal residual norm computed over all the iterations.</p></div><p class="datatypelist"><strong>Data Types: </strong><code>single</code> | <code>double</code></p></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_f96-1000445_sep_mw_e24d5713-a2f6-4b00-8515-4f96f166409e" data-bs-target="#expand_accordion_body_f96-1000445_sep_mw_e24d5713-a2f6-4b00-8515-4f96f166409e" aria-controls="expand_accordion_body_f96-1000445_sep_mw_e24d5713-a2f6-4b00-8515-4f96f166409e" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_flag" class="anchor_target"></span><h3 id="f96-1000445_sep_mw_e24d5713-a2f6-4b00-8515-4f96f166409e"><code class="name">flag</code> &#8212; Convergence flag<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">scalar</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_f96-1000445_sep_mw_e24d5713-a2f6-4b00-8515-4f96f166409e" aria-labelledby="expand_accordion_heading_f96-1000445_sep_mw_e24d5713-a2f6-4b00-8515-4f96f166409e" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f96-1000445.mw_e24d5713-a2f6-4b00-8515-4f96f166409e"><p>Convergence flag, returned as one of the scalar values in this table. The convergence flag
            indicates whether the calculation was successful and differentiates between several
            different forms of failure.</p>
<span id="f96-1000445.mw_e55e9745-fce6-4c82-a333-d56186f5d3ea" class="anchor_target"></span><div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="50%"><col class="tcol2" width="50%"></colgroup><thead><tr><th><p>Flag Value</p></th><th><p>Convergence</p></th></tr></thead><tbody><tr><td><p><code class="literal">0</code></p></td><td><p>Success &#8212; <code class="function">symmlq</code> converged to the
                                    desired tolerance <code class="literal">tol</code> within
                                        <code class="literal">maxit</code> iterations. </p></td></tr><tr><td><p><code class="literal">1</code></p></td><td><p>Failure &#8212; <code class="function">symmlq</code> iterated
                                        <code class="literal">maxit</code> iterations but did not
                                    converge.</p></td></tr><tr><td><p><code class="literal">2</code></p></td><td><p>Failure &#8212; The preconditioner matrix <code class="literal">M</code> or
                                        <code class="literal">M = M1*M2</code> is ill
                                conditioned.</p></td></tr><tr><td><p><code class="literal">3</code></p></td><td><p>Failure &#8212; <code class="function">symmlq</code> stagnated after
                                    two consecutive iterations were the same.</p></td></tr><tr><td><p><code class="literal">4</code></p></td><td><p>Failure &#8212; One of the scalar quantities calculated by the
                                        <code class="function">symmlq</code> algorithm became too small
                                    or too large to continue computing.</p></td></tr><tr><td><p><code class="literal">5</code></p></td><td><p>Failure &#8212; Preconditioner matrix <code class="literal">M</code> is not
                                    symmetric positive definite.</p></td></tr></tbody></table></div><p>
</p></div></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_f96-1000445_sep_mw_1b807afe-eb58-4932-87f4-8db68de91460" data-bs-target="#expand_accordion_body_f96-1000445_sep_mw_1b807afe-eb58-4932-87f4-8db68de91460" aria-controls="expand_accordion_body_f96-1000445_sep_mw_1b807afe-eb58-4932-87f4-8db68de91460" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_relres" class="anchor_target"></span><h3 id="f96-1000445_sep_mw_1b807afe-eb58-4932-87f4-8db68de91460"><code class="name">relres</code> &#8212; Relative residual error<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">scalar</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_f96-1000445_sep_mw_1b807afe-eb58-4932-87f4-8db68de91460" aria-labelledby="expand_accordion_heading_f96-1000445_sep_mw_1b807afe-eb58-4932-87f4-8db68de91460" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f96-1000445.mw_1b807afe-eb58-4932-87f4-8db68de91460"><p>Relative residual error, returned as a scalar. The relative residual error is an indication of
            how accurate the returned answer <code class="literal">x</code> is.
                <code class="function">symmlq</code> tracks the relative residual and conjugate
            gradients residual at each iteration in the solution process, and the algorithm
            converges when <span class="emphasis"><em>either</em></span> residual meets the specified tolerance
                <a href="#f96-1000445_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="intrnllnk"><code class="argument">tol</code></a>. The <code class="literal">relres</code> output contains the value of
            the residual that converged, either the relative residual or the conjugate gradients residual:</p>
<div class="itemizedlist"><ul><li><p>The relative residual error is equal to
                            <code class="literal">norm(b-A*x)/norm(b)</code> and is generally the residual
                        that meets the tolerance <code class="argument">tol</code> when
                            <code class="function">symmlq</code> converges. The
                            <a href="#f96-1000445_sep_mw_e2a3240f-74d0-4b34-943e-502f3dd9d174" class="intrnllnk"><code class="argument">resvec</code></a> output tracks the history of this residual
                        over all iterations.</p></li><li><p>The conjugate gradients residual error is equal to <code class="literal">norm(A'*A*x -
                            A'*b)</code>. This residual causes <code class="function">symmlq</code>
                        to converge less frequently than the relative residual. The
                            <a href="#f96-1000445_sep_mw_dd615089-e68e-4119-8889-58e540490774" class="intrnllnk"><code class="argument">resveccg</code></a> output tracks the history of this residual
                        over all iterations.</p></li></ul></div><p>
</p></div><p class="datatypelist"><strong>Data Types: </strong><code>single</code> | <code>double</code></p></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_f96-1000445_sep_mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4" data-bs-target="#expand_accordion_body_f96-1000445_sep_mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4" aria-controls="expand_accordion_body_f96-1000445_sep_mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_iter" class="anchor_target"></span><h3 id="f96-1000445_sep_mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4"><code class="name">iter</code> &#8212; Iteration number<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">scalar</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_f96-1000445_sep_mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4" aria-labelledby="expand_accordion_heading_f96-1000445_sep_mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f96-1000445.mw_98f428f1-5bc3-491c-bdce-7d3acf5e0ed4"><p>Iteration number, returned as a scalar. This output indicates the iteration number at which
                                    the computed answer for <a href="#f96-1000445_sep_mw_b2afce71-ce1a-494a-85e3-71dd5f36e7d7" class="intrnllnk"><code class="argument">x</code></a> was
                                    calculated.</p></div><p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_f96-1000445_sep_mw_e2a3240f-74d0-4b34-943e-502f3dd9d174" data-bs-target="#expand_accordion_body_f96-1000445_sep_mw_e2a3240f-74d0-4b34-943e-502f3dd9d174" aria-controls="expand_accordion_body_f96-1000445_sep_mw_e2a3240f-74d0-4b34-943e-502f3dd9d174" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_resvec" class="anchor_target"></span><h3 id="f96-1000445_sep_mw_e2a3240f-74d0-4b34-943e-502f3dd9d174"><code class="name">resvec</code> &#8212; Residual error<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">vector</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_f96-1000445_sep_mw_e2a3240f-74d0-4b34-943e-502f3dd9d174" aria-labelledby="expand_accordion_heading_f96-1000445_sep_mw_e2a3240f-74d0-4b34-943e-502f3dd9d174" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f96-1000445.mw_e2a3240f-74d0-4b34-943e-502f3dd9d174"><p>Residual error, returned as a vector. The residual error <code class="literal">norm(b-A*x)</code>
            reveals how close the algorithm is to converging for a given value of
                <code class="literal">x</code>. The number of elements in <code class="literal">resvec</code> is equal
            to the number of iterations. You can examine the contents of <code class="literal">resvec</code>
            to help decide whether to change the values of <a href="#f96-1000445_sep_mw_b797b123-ccd8-4b99-a496-07d543d1a21b" class="intrnllnk"><code class="argument">tol</code></a> or
                <a href="#f96-1000445_sep_mw_843917a7-f520-49f0-8815-7ffb3f307a16" class="intrnllnk"><code class="argument">maxit</code></a>.</p></div><p class="datatypelist"><strong>Data Types: </strong><code>single</code> | <code>double</code></p></div></div></div></div></div><div class="mw_ws_accordion_container"><div class="accordion" role="tablist" aria-multiselectable="true"><div class="accordion-item "><div class="accordion-header"><button role="tab" data-bs-toggle="collapse" id="expand_accordion_heading_f96-1000445_sep_mw_dd615089-e68e-4119-8889-58e540490774" data-bs-target="#expand_accordion_body_f96-1000445_sep_mw_dd615089-e68e-4119-8889-58e540490774" aria-controls="expand_accordion_body_f96-1000445_sep_mw_dd615089-e68e-4119-8889-58e540490774" class="accordion-button add_cursor_pointer" aria-expanded="true"><span id="outputarg_resveccg" class="anchor_target"></span><h3 id="f96-1000445_sep_mw_dd615089-e68e-4119-8889-58e540490774"><code class="name">resveccg</code> &#8212; Conjugate gradients residual norms<br/> <span class="add_font_color_general remove_bold"><span class="example_desc">vector</span></span></h3></button></div><div role="tabpanel" id="expand_accordion_body_f96-1000445_sep_mw_dd615089-e68e-4119-8889-58e540490774" aria-labelledby="expand_accordion_heading_f96-1000445_sep_mw_dd615089-e68e-4119-8889-58e540490774" class="accordion-collapse collapse show"><div class="accordion-body"><div class="cshsummary" id="csh_f96-1000445.mw_dd615089-e68e-4119-8889-58e540490774"><p>Conjugate gradients residual norms, returned as a vector. The number of elements in
                <code class="literal">resveccg</code> is equal to the number of iterations.</p></div><p class="datatypelist"><strong>Data Types: </strong><code>single</code> | <code>double</code></p></div></div></div></div></div></div></div></div></div><div class="moreabout ref_sect"><h2 id="mw_32b85137-d419-49cb-b371-c63bcbb4a52a">More About</h2><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink" data-allexpanded="true2">collapse all</a></p><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_mw_974b824c-350e-478b-8c10-c925110ad3bf" aria-controls="expand_body_mw_974b824c-350e-478b-8c10-c925110ad3bf" class="accordion-button" aria-expanded="true"><h3 id="mw_974b824c-350e-478b-8c10-c925110ad3bf">Symmetric LQ Method</h3></button></div><div id="expand_body_mw_974b824c-350e-478b-8c10-c925110ad3bf" class="accordion-collapse collapsed collapse show"><div class="accordion-body"><p class="shortdesc">The MINRES and SYMMLQ methods are variants of the Lanczos method that
        underpins the conjugate gradients method PCG. Like PCG, the coefficient matrix still needs
        to be symmetric, but MINRES and SYMMLQ allow it to be indefinite (not all eigenvalues need
        to be positive). This is achieved by avoiding the implicit LU factorization normally present
        in the Lanczos method, which is prone to breakdowns when zero pivots are encountered.</p><p>MINRES minimizes the residual in the 2-norm, while SYMMLQ solves a projected system
        using an LQ factorization and keeps the residual orthogonal to all previous ones <a href="symmlq.html#bqvh9tl-1" class="intrnllnk">[1]</a>.</p></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="f96-1000445_sep_mw_021450b1-4be9-4d57-b903-c4a2d800c810">Tips</h2><div class="itemizedlist"><ul><li><p>Convergence of most iterative methods depends on the condition number of the
                coefficient matrix, <code class="literal">cond(A)</code>. When <code class="literal">A</code> is square,
                you can use <a href="equilibrate.html"><code class="function">equilibrate</code></a> to improve its condition number, and on its own this
                makes it easier for most iterative solvers to converge. However, using
                    <code class="function">equilibrate</code> also leads to better quality preconditioner
                matrices when you subsequently factor the equilibrated matrix <code class="literal">B =
                    R*P*A*C</code>.</p></li><li><p>You can use matrix reordering functions such as <code class="function">dissect</code> and
                    <code class="function">symrcm</code> to permute the rows and columns of the coefficient
                matrix and minimize the number of nonzeros when the coefficient matrix is factored
                to generate a preconditioner. This can reduce the memory and time required to
                subsequently solve the preconditioned linear system.</p></li></ul></div></div><div class="bibliography"><h2 id="References">References</h2><div id="bqvh9tl-1" class="bibliomixed"><p>[1] Barrett, R., M. Berry, T. F. Chan, et al., <em class="citetitle">Templates
        for the Solution of Linear Systems: Building Blocks for Iterative Methods</em>, SIAM,
      Philadelphia, 1994.</p></div><div id="bqvh9un-1" class="bibliomixed"><p>[2] Paige, C. C. and M. A. Saunders, "Solution of Sparse Indefinite
      Systems of Linear Equations." <em class="citetitle">SIAM J. Numer. Anal.</em>, Vol.12, 1975, pp.
      617-629. </p></div></div><div class="ref_sect"><h2 id="refsect-extended-capabilities">Extended Capabilities</h2><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink">expand all</a></p><div id="accordion_refsect-extended-capabilities" role="tablist" aria-multiselectable="true"><span id="mw_9c3f7967-fbb3-4704-b7e0-83b2721731d5" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="f96-1000445" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_f96-1000445_threadsupport" aria-controls="expand_body_f96-1000445_threadsupport" class="accordion-button collapsed" aria-expanded="false"><h3 id="f96-1000445_threadsupport">Thread-Based Environment<br/> <span class=" remove_bold add_font_color_general">Run code in the background using MATLAB&#174; <code class="function">backgroundPool</code> or accelerate code with Parallel Computing Toolbox&#8482; <code class="function">ThreadPool</code>.</span></h3></button></div><div id="expand_body_f96-1000445_threadsupport" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>This function fully supports thread-based environments. For
                more information, see <a href="../matlab_prog/run-functions-on-threads.html" class="a">Run MATLAB Functions in Thread-Based Environment</a>.</p></div></div></div></div></div><span id="mw_fc0f47f5-af19-456c-812c-190cb907d4e0" class="anchor_target"></span><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="f96-1000445" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_f96-1000445_distributedarrays" aria-controls="expand_body_f96-1000445_distributedarrays" class="accordion-button collapsed" aria-expanded="false"><h3 id="f96-1000445_distributedarrays">Distributed Arrays<br/> <span class=" remove_bold add_font_color_general">Partition large arrays across the combined memory of your cluster using Parallel Computing Toolbox&#8482;.</span></h3></button></div><div id="expand_body_f96-1000445_distributedarrays" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>Usage notes and limitations:</p><div class="itemizedlist"><ul><li><p>If <code class="literal">M1</code> is a function, then it is applied independently to each
            row.</p></li></ul></div><p>For more information, see <a href="../../parallel-computing/run-matlab-functions-with-distributed-arrays.html" class="a">Run MATLAB Functions with Distributed Arrays</a><span role="cross_prod"> (Parallel Computing Toolbox)</span>.</p></div></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="mw_89a391d2-4a87-4e91-ae22-91acce1be113">Version History</h2><strong>Introduced before R2006a</strong><div class="expandableContent"><p class="switch"><a href="javascript:void(0);" class="expandAllLink">expand all</a></p><div class="mw_ws_accordion_container"><div class="accordion -presentation_expander -presentation_condensed"><div class="accordion-item"><span id="f96-1000445.mw_7463413e-98d4-46c3-a401-f17c5cf7a6c1" class="anchor_target"></span><div class="accordion-header"><button data-bs-toggle="collapse" data-bs-target="#expand_body_f96-1000445_sep_mw_7463413e-98d4-46c3-a401-f17c5cf7a6c1" aria-controls="expand_body_f96-1000445_sep_mw_7463413e-98d4-46c3-a401-f17c5cf7a6c1" class="accordion-button collapsed" aria-expanded="false"><h3 id="f96-1000445_sep_mw_7463413e-98d4-46c3-a401-f17c5cf7a6c1">R2025a: <span class="remove_bold">Specify single-precision input arguments</span></h3></button></div><div id="expand_body_f96-1000445_sep_mw_7463413e-98d4-46c3-a401-f17c5cf7a6c1" class="accordion-collapse collapsed collapse"><div class="accordion-body"><p>You can specify these arguments as single precision:</p>
<div class="itemizedlist"><ul><li><p><code class="argument">A</code> &#8212; Coefficient matrix</p></li><li><p><code class="argument">b</code> &#8212; Right side of linear equation</p></li><li><p><code class="argument">M</code>, <code class="argument">M1</code>, <code class="argument">M2</code> &#8212;
                    Preconditioner matrices</p></li><li><p><code class="argument">x0</code> &#8212; Initial guess</p></li></ul></div><p>
</p><p>If you specify any of these arguments as single precision, the function computes in single
        precision and returns the linear system solution, relative residual error, and residual
        error outputs as type <code class="class">single</code>. For faster computation, specify all arguments,
        including function handle outputs, as the same precision.</p></div></div></div></div></div></div></div><div class="ref_sect"><h2 id="f96-1000445_seealso">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="bicg.html"><span itemprop="name"><code class="function">bicg</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="bicgstab.html"><span itemprop="name"><code class="function">bicgstab</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="cgs.html"><span itemprop="name"><code class="function">cgs</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="gmres.html"><span itemprop="name"><code class="function">gmres</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="lsqr.html"><span itemprop="name"><code class="function">lsqr</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="minres.html"><span itemprop="name"><code class="function">minres</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="pcg.html"><span itemprop="name"><code class="function">pcg</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="qmr.html"><span itemprop="name"><code class="function">qmr</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="double.mldivide.html"><span itemprop="name"><code class="function">mldivide</code></span></a></span></p><div class="examples_container"><h3 class="remove_border">Topics</h3><div itemprop="content"><ul class="list-unstyled"><li><a href="../math/iterative-methods-for-linear-systems.html" class="a">Iterative Methods for Linear Systems</a></li></ul></div></div></div>
    </div></div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

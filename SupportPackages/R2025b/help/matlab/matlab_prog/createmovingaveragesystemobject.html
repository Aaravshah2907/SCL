<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Create Moving Average System Object</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../programming-and-data-types.html",
          "name": "Programming"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../object-oriented-programming.html",
          "name": "Classes"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../system-objects.html",
          "name": "System Objects"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 5,

          "item": {
          "@id": "../create-system-objects.html",
          "name": "Create System Objects"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "create-system-objects"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Create Moving Average System Object",
          "description": "Walks through how to create a System object that computes a moving average.",
          "thumbnailURL": "../../examples/matlab/win64/CreateMovingAverageSystemObjectExample_01.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "identifier": "matlab.CreateMovingAverageSystemObjectExample",
          "name": "CreateMovingAverageSystemObjectExample",
          "url": "createmovingaveragesystemobject.html"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/CreateMovingAverageSystemObjectExample')"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "CreateMovingAverageSystemObjectExample.mlx",
        "movingAverageFilter.m"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="ug">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="other">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This example walks through how to create a System object that computes a moving average."><meta xmlns="http://www.w3.org/1999/xhtml" content="../../examples/matlab/win64/CreateMovingAverageSystemObjectExample_01.png" itemprop="thumbnailUrl">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../programming-and-data-types.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Programming</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../object-oriented-programming.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Classes</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../system-objects.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">System Objects</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../create-system-objects.html?s_tid=CRUX_lftnav" itemprop="url" id="bvla9m7-1"><span itemprop="title">Create System Objects</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item"><a href="#responsive_offcanvas">Create Moving Average System Object</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#CreateMovingAverageSystemObjectExample-1" class="nav-link intrnllnk">Introduction</a></li><li class="nav-item"><a href="#CreateMovingAverageSystemObjectExample-2" class="nav-link intrnllnk">Create the System Object File</a></li><li class="nav-item"><a href="#CreateMovingAverageSystemObjectExample-3" class="nav-link intrnllnk">Add Properties</a></li><li class="nav-item"><a href="#CreateMovingAverageSystemObjectExample-4" class="nav-link intrnllnk">Add Constructor for Easy Creation</a></li><li class="nav-item"><a href="#CreateMovingAverageSystemObjectExample-5" class="nav-link intrnllnk">Set Up and Initialization in setupImpl</a></li><li class="nav-item"><a href="#CreateMovingAverageSystemObjectExample-6" class="nav-link intrnllnk">Define the Algorithm in stepImpl</a></li><li class="nav-item"><a href="#CreateMovingAverageSystemObjectExample-7" class="nav-link intrnllnk">Reset and Release</a></li><li class="nav-item"><a href="#CreateMovingAverageSystemObjectExample-8" class="nav-link intrnllnk">Validate Input</a></li><li class="nav-item"><a href="#CreateMovingAverageSystemObjectExample-9" class="nav-link intrnllnk">Object Saving and Loading</a></li><li class="nav-item"><a href="#CreateMovingAverageSystemObjectExample-10" class="nav-link intrnllnk">Use movingAverageFilter in MATLAB</a></li><li class="nav-item"><a href="#CreateMovingAverageSystemObjectExample-11" class="nav-link intrnllnk">Extend Your System Object for Simulink</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=create-system-objects&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=create-system-objects&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=create-system-objects&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=create-system-objects&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=create-system-objects&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=create-system-objects&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-topic">
<section><h1 class="r2025b" itemprop="title content" id="mw_cc5bd7b0-834d-4b98-9a4b-f0d83e709e77">Create Moving Average System Object</h1><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/CreateMovingAverageSystemObjectExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-CreateMovingAverageSystemObjectExample"><meta itemprop="exampletitle" content="Create Moving Average System Object"></div><span id="CreateMovingAverageSystemObjectExample" class="anchor_target"></span><p class="shortdesc">This example shows how to create a System object&#8482; that implements a moving average filter.  </p><div class="procedure"><h3 class="title" id="CreateMovingAverageSystemObjectExample-1">Introduction</h3><p>System objects are MATLAB&#174; classes that derive from <code class="literal">matlab.System</code>. As a result, System objects all inherit a common public interface, which includes standard methods:</p><div class="itemizedlist"><ul><li><p><code class="literal">setup</code> &#8212; Initialize the object, typically at the beginning of a simulation</p></li><li><p><code class="literal">reset</code> &#8212; Clear the internal state of the object, bringing it back to its default post-initialization status</p></li><li><p><code class="literal">release</code> &#8212;  Release any resources (memory, hardware, or OS-specific resources) used internally by the object</p></li></ul></div><p>When you create new kinds of System objects, you provide specific implementations for all the preceding methods to determine its behavior.</p><p>In this example, you create and use the <code class="literal">movingAverageFilter</code> System object. <code class="literal">movingAverageFilter</code> is a System object that computes the unweighted mean of the previous <code class="literal">WindowLength</code> input samples. <code class="literal">WindowLength</code> is the length of the moving average window. <code class="literal">movingAverageFilter</code> accepts single-precision and double-precision 2-D input matrices. Each column of the input matrix is treated as an independent (1-D) channel. The first dimension of the input defines the length of the channel (or the input frame size). <code class="literal">movingAverageFilter</code> independently computes the moving average of each input channel over time.</p><h3 class="title" id="CreateMovingAverageSystemObjectExample-2">Create the System Object File</h3><p>In the MATLAB <strong class="emphasis bold">Home</strong> tab, create a new System object class by selecting <strong class="emphasis bold">New &gt; System Object &gt; Basic</strong>. The basic template for a System object opens in the MATLAB editor to guide you as you create the <code class="literal">movingAverageFilter</code> System object.</p><p>Rename the class <code class="literal">movingAverageFilter</code> and save the file as <code class="literal">movingAverageFilter.m</code>. To ensure you can use the System object, make sure you save the System object in a folder that is on the MATLAB path.</p><p>For your convenience, a complete <code class="literal">movingAverageFilter</code> System object file is available with this example. To open the completed class, enter:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>edit <span style="color:#A020F0">movingAverageFilter.m</span></pre></div></div></div><h3 class="title" id="CreateMovingAverageSystemObjectExample-3">Add Properties</h3><p>This System object needs four properties. First, add a public property <code class="literal">WindowLength</code> to control the length of the moving average window. Because the algorithm depends on this value being constant once data processing begins, the property is defined as nontunable. Additionally, the property only accepts real, positive integers. To ensure input satisfies these conditions, add property validators (see <a href="../matlab_oop/validate-property-values.html" data-docid="matlab_oop#bu3l65b" class="a">Validate Property Values</a>). Set the default value of this property to 5.</p><div class="code_responsive"><pre id="d126e106316" class="programlisting">properties(Nontunable)
    WindowLength (1,1){mustBeInteger,mustBePositive} = 5
<span style="color:#0000FF">end</span>
</pre></div><p>Second, add two properties called <code class="literal">State</code> and <code class="literal">pNumChannels</code>. Users should not access either property, so use the <code class="literal">Access = private</code> attribute. <code class="literal">State</code> saves the state of the moving average filter. <code class="literal">pNumChannels</code> stores the number of channels in your input. The value of this property is determined from the number of columns in the input.</p><div class="code_responsive"><pre id="d126e106330" class="programlisting">properties(Access = private)
    State;
    pNumChannels = -1;
<span style="color:#0000FF">end</span>
</pre></div><p>Finally, you need a property to store the FIR numerator coefficients. Add a property called <code class="literal">pCoefficients</code>. Because the coefficients do not change during data processing and you do not want users of the System object to access the coefficients, set the property attributes as <code class="literal">Nontunable, Access = private</code>.</p><div class="code_responsive"><pre id="d126e106338" class="programlisting">properties(Access = private, Nontunable)
    pCoefficients
<span style="color:#0000FF">end</span>
</pre></div><h3 class="title" id="CreateMovingAverageSystemObjectExample-4">Add Constructor for Easy Creation</h3><p>The System object constructor is a method that has the same name as the class (<code class="literal">movingAverageFilter</code> in this example). You implement a System object constructor to allow name-value pair inputs to the System object with the <code class="literal">setProperties</code> method. For example, with the constructor, users can use this syntax to create an instance of the System object: <code class="literal">filter = movingAverageFilter('WindowLength',10)</code>. Do not use the constructor for anything else. All other setup tasks should be written in the <code class="literal">setupImpl</code> method.</p><div class="code_responsive"><pre id="d126e106352" class="programlisting">methods
    <span style="color:#0000FF">function</span> obj = movingAverageFilter(varargin)
        <span style="color:#228B22">% Support name-value pair arguments when constructing object</span>
        setProperties(obj,nargin,varargin{:})
    <span style="color:#0000FF">end</span>
<span style="color:#0000FF">end</span>
</pre></div><h3 class="title" id="CreateMovingAverageSystemObjectExample-5">Set Up and Initialization in <code class="literal">setupImpl</code></h3><p>The <code class="literal">setupImpl</code> method sets up the object and implements one-time initialization tasks. For this System object, modify the default <code class="literal">setupImpl</code> method to calculate the filter coefficients, the state, and the number of channels. The filter coefficients are computed based on the specified <code class="literal">WindowLength</code>. The filter state is initialized to zero. (Note that there are <code class="literal">WindowLength-1</code> states per input channel.) Finally, the number of channels is determined from the number of columns in the input.</p><p>For <code class="literal">setupImpl</code> and all <code class="literal">Impl</code> methods, you must set the method attribute <code class="literal">Access = protected</code> because users of the System object do not call these methods directly. Instead the back-end of the System object calls these methods through other user-facing functions.</p><div class="code_responsive"><pre id="d126e106376" class="programlisting"><span style="color:#0000FF">function</span> setupImpl(obj,x)
    <span style="color:#228B22">% Perform one-time calculations, such as computing constants</span>
    obj.pNumChannels = size(x,2);
    obj.pCoefficients = ones(1,obj.WindowLength)/obj.WindowLength;
    obj.State = zeros(obj.WindowLength-1,obj.pNumChannels,<span style="color:#A020F0">'like'</span>,x);
<span style="color:#0000FF">end</span>
</pre></div><h3 class="title" id="CreateMovingAverageSystemObjectExample-6">Define the Algorithm in <code class="literal">stepImpl</code></h3><p>The object's algorithm is defined in the <code class="literal">stepImpl</code> method. The algorithm in <code class="literal">stepImpl</code> is executed when the user of the System object calls the object at the command line. In this example, modify <code class="literal">stepImpl</code> to calculate the output and update the object's state values using the <code class="literal">filter</code> function.</p><div class="code_responsive"><pre id="d126e106392" class="programlisting"><span style="color:#0000FF">function</span> y = stepImpl(obj,u)
    [y,obj.State] = filter(obj.pCoefficients,1,u,obj.State);
<span style="color:#0000FF">end</span>
</pre></div><h3 class="title" id="CreateMovingAverageSystemObjectExample-7">Reset and Release</h3><p>The state reset equations are defined in the <code class="literal">resetImpl</code> method. In this example, reset states to zero. Additionally, you need to add a <code class="literal">releaseImpl</code> method. From the <strong class="emphasis bold">Editor</strong> toolstrip, select <strong class="emphasis bold">Insert Method &gt; Release resources</strong>. The <code class="literal">releaseImpl</code> method is added to your System object. Modify <code class="literal">releaseImpl</code> to set the number of channels to <code class="literal remove_text_wrapping">-1</code>, which allows new input to be used with the filter.</p><div class="code_responsive"><pre id="d126e106415" class="programlisting"><span style="color:#0000FF">function</span> resetImpl(obj)
    <span style="color:#228B22">% Initialize / reset discrete-state properties</span>
    obj.State(:) = 0;
<span style="color:#0000FF">end</span>
<span style="color:#0000FF">function</span> releaseImpl(obj)
    obj.pNumChannels = -1;
<span style="color:#0000FF">end</span>
</pre></div><h3 class="title" id="CreateMovingAverageSystemObjectExample-8">Validate Input</h3><p>To validate inputs to your System object, you must implement a <code class="literal">validateInputsImpl</code> method. This method validates inputs at initialization and at each subsequent call where the input attributes (such as dimensions, data type, or complexity) change. From the toolstrip, select <strong class="emphasis bold">Insert Method &gt; Validate inputs</strong>. In the newly inserted <code class="literal">validateInputsImpl</code> method, call <code class="literal">validateattributes</code> to ensure that the input is a 2-D matrix with floating-point data.</p><div class="code_responsive"><pre id="d126e106430" class="programlisting"><span style="color:#0000FF">function</span> validateInputsImpl(~, u)
    validateattributes(u,{<span style="color:#A020F0">'double'</span>,<span style="color:#A020F0">'single'</span>}, {<span style="color:#A020F0">'2d'</span>,<span style="color:#0000FF">...</span>
        <span style="color:#A020F0">'nonsparse'</span>},<span style="color:#A020F0">''</span>,<span style="color:#A020F0">'input'</span>);
<span style="color:#0000FF">end</span>
</pre></div><h3 class="title" id="CreateMovingAverageSystemObjectExample-9">Object Saving and Loading</h3><p>When you save an instance of a System object, <code class="literal">saveObjectImpl</code> defines what property and state values are saved in a MAT-file. If you do not define a <code class="literal">saveObjectImpl</code> method for your System object class, only public properties and properties with the <code class="literal">DiscreteState</code> attribute are saved. Select <strong class="emphasis bold">Insert Method &gt; Save in MAT-file</strong>. Modify <code class="literal">saveObjectImpl</code> so that if the object is locked, the coefficients and number of channels is saved. </p><div class="code_responsive"><pre id="d126e106447" class="programlisting"><span style="color:#0000FF">function</span> s = saveObjectImpl(obj)
    s = saveObjectImpl@matlab.System(obj);
    <span style="color:#0000FF">if</span> isLocked(obj)
        s.pCoefficients = obj.pCoefficients;
        s.pNumChannels = obj.pNumChannels;
    <span style="color:#0000FF">end</span>
<span style="color:#0000FF">end</span>
</pre></div><p><code class="literal">loadObjectImpl</code> is the companion to <code class="literal">saveObjectImpl</code> because it defines how a saved object loads. When you load the saved object, the object loads in the same locked state. Select <strong class="emphasis bold">Insert Method &gt; Load from MAT-file</strong>. Modify <code class="literal">loadObjectImpl</code> so that if the object is locked, the coefficients and number of channels are loaded.</p><div class="code_responsive"><pre id="d126e106459" class="programlisting"><span style="color:#0000FF">function</span> loadObjectImpl(obj,s,wasLocked)
    <span style="color:#0000FF">if</span> wasLocked
        obj.pCoefficients = s.pCoefficients;
        obj.pNumChannels = s.pNumChannels;
    <span style="color:#0000FF">end</span>
    loadObjectImpl@matlab.System(obj,s,wasLocked);
<span style="color:#0000FF">end</span>
</pre></div><h3 class="title" id="CreateMovingAverageSystemObjectExample-10">Use <code class="literal">movingAverageFilter</code> in MATLAB</h3><p>Now that you have defined the System object, you can use the object in MATLAB. For example, use <code class="literal">movingAverageFilter</code> to remove noise from a noisy pulse sequence.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>movingAverageFilter = movingAverageFilter(<span style="color:#A020F0">'WindowLength'</span>,10);

t = (1:250)';
signal = randn(250,1);
smoothedSignal = movingAverageFilter(signal);

plot(t,signal,t,smoothedSignal);
legend([<span style="color:#A020F0">"Input"</span>,<span style="color:#A020F0">"Smoothed Signal"</span>])</pre></div></div></div><div class="informalfigure"><div id="d126e106473" class="mediaobject"><p><img src="../../examples/matlab/win64/CreateMovingAverageSystemObjectExample_01.png" alt="Figure contains an axes object. The axes object contains 2 objects of type line. These objects represent Input, Smoothed Signal." width="560"></p></div></div><h3 class="title" id="CreateMovingAverageSystemObjectExample-11">Extend Your System Object for Simulink</h3><p>To use your System object in Simulink&#174;, see <a href="../../simulink/ug/createmovingaveragefilterblocksystemobject.html" data-docid="simulink_ug#mw_161d6e4e-97f5-44c5-b8c1-a9f6519d4fc3" class="a">Create Moving Average Filter Block with System Object</a><span role="cross_prod"> (Simulink)</span>. </p></div></section>
    </div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">Â© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Create New System Objects for File Input and Output</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../programming-and-data-types.html",
          "name": "Programming"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../object-oriented-programming.html",
          "name": "Classes"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../system-objects.html",
          "name": "System Objects"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 5,

          "item": {
          "@id": "../create-system-objects.html",
          "name": "Create System Objects"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "create-system-objects"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Create New System Objects for File Input and Output",
          "description": "Define new System objects for file input and output.",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "identifier": "matlab.CreatingNewKindsOfSystemObjectsForFileInputAndOutputExample",
          "name": "CreatingNewKindsOfSystemObjectsForFileInputAndOutputExample",
          "url": "createnewsystemobjectsforfileinputandoutput.html"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/CreatingNewKindsOfSystemObjectsForFileInputAndOutputExample')"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "CreatingNewKindsOfSystemObjectsForFileInputAndOutputExample.mlx",
        "TextFileReader.m",
        "TextFileWriter.m"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="ug">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="other">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="Define new System objects for file input and output."><meta xmlns="http://www.w3.org/1999/xhtml" content="../../includes/product/images/doc_center/DefaultImage.png" itemprop="thumbnailUrl">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../programming-and-data-types.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Programming</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../object-oriented-programming.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Classes</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../system-objects.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">System Objects</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../create-system-objects.html?s_tid=CRUX_lftnav" itemprop="url" id="bvla9m7-1"><span itemprop="title">Create System Objects</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item"><a href="#responsive_offcanvas">Create New System Objects for File Input and Output</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#CreatingNewKindsOfSystemObjectsForFileInputAndOutputExample-1" class="nav-link intrnllnk">Introduction</a></li><li class="nav-item"><a href="#CreatingNewKindsOfSystemObjectsForFileInputAndOutputExample-2" class="nav-link intrnllnk">Definition of the Class TextFileReader</a></li><li class="nav-item"><a href="#CreatingNewKindsOfSystemObjectsForFileInputAndOutputExample-9" class="nav-link intrnllnk">Write and Read Data</a></li><li class="nav-item"><a href="#CreatingNewKindsOfSystemObjectsForFileInputAndOutputExample-12" class="nav-link intrnllnk">Summary</a></li><li class="nav-item"><a href="#seealsoref" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=create-system-objects&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=create-system-objects&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=create-system-objects&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=create-system-objects&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=create-system-objects&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=create-system-objects&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-topic">
<section><h1 class="r2025b" itemprop="title content" id="mw_aab6301a-de6b-42d6-88e2-51ebbdf26690">Create New System Objects for File Input and Output</h1><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/CreatingNewKindsOfSystemObjectsForFileInputAndOutputExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-CreatingNewKindsOfSystemObjectsForFileInputAndOutputExample"><meta itemprop="exampletitle" content="Create New System Objects for File Input and Output"></div><span id="CreatingNewKindsOfSystemObjectsForFileInputAndOutputExample" class="anchor_target"></span><p class="shortdesc">This example shows how to create and use two different System objects to facilitate the streaming of data in and out of MATLAB&#174;: <code class="literal">TextFileReader</code> and <code class="literal">TextFileWriter</code>.</p><p>The objects discussed in this example address a number of realistic use cases, and they can be customized to achieve more advanced and specialized tasks.</p><div class="procedure"><h3 class="title" id="CreatingNewKindsOfSystemObjectsForFileInputAndOutputExample-1">Introduction</h3><p>System objects are MATLAB classes that derive from <code class="literal">matlab.System</code>. As a result, System objects all inherit a common public interface, which includes standard methods:</p><div class="itemizedlist"><ul><li><p><code class="literal">setup</code> &#8212; Initialize the object, typically at the beginning of a simulation</p></li><li><p><code class="literal">reset</code> &#8212; Clear the internal state of the object, bringing it back to its default post-initialization status</p></li><li><p><code class="literal">release</code> &#8212;  Release any resources (memory, hardware, or OS-specific resources) used internally by the object</p></li></ul></div><p>When you create new kinds of System objects, you provide specific implementations for all the preceding methods to determine its behavior.</p><p>In this example we discuss the internal structure and the use of the following two System objects:</p><div class="itemizedlist"><ul><li><p><code class="literal">TextFileReader</code></p></li><li><p><code class="literal">TextFileWriter</code></p></li></ul></div><p>To create these System objects for streaming data in and out of MATLAB, this example uses standard low-level file I/O functions available in MATLAB (like <a href="../ref/fscanf.html" data-docid="matlab_ref#bt_j35z-1" class="a"><code class="olink">fscanf</code></a>, <a href="../ref/fread.html" data-docid="matlab_ref#btp1twt-1" class="a"><code class="olink">fread</code></a>, <a href="../ref/fprintf.html" data-docid="matlab_ref#btf8xsy-1" class="a"><code class="olink">fprintf</code></a>, and <a href="../ref/fwrite.html" data-docid="matlab_ref#buakf91-1" class="a"><code class="olink">fwrite</code></a>). By abstracting away most usage details of those functions, they aim to make the task of reading and writing streamed data simpler and more efficient.</p><p>This example includes the use of a number of advanced constructs to author System objects. For a more basic introduction to authoring System objects, see <a href="../create-system-objects.html" data-docid="matlab_doccenter#bvla9m7-1" class="a">Create System Objects</a>.</p><h3 class="title" id="CreatingNewKindsOfSystemObjectsForFileInputAndOutputExample-2">Definition of the Class <code class="literal">TextFileReader</code></h3><p>The <code class="literal">TextFileReader</code> class includes a class definition, public and private properties, a constructor, protected methods overridden from the <code class="literal">matlab.System</code> base class, and private methods. The <code class="literal">TextFileWriter</code> class is similarly structured. </p><h4 class="title" id="CreatingNewKindsOfSystemObjectsForFileInputAndOutputExample-3">Class Definition</h4><p>The class definition states that the <code class="literal">TextFileReader</code> class is derived from both <code class="literal">matlab.System</code> and <code class="literal">matlab.system.mixin.FiniteSource</code>.</p><div class="code_responsive"><pre class="programlisting">   classdef (StrictDefaults)TextFileReader &lt; matlab.System &amp; matlab.system.mixin.FiniteSource
</pre></div><div class="itemizedlist"><ul><li><p><code class="literal">matlab.System</code> is required and is the base class for all System objects</p></li><li><p><code class="literal">matlab.system.mixin.FiniteSource</code> indicates this class is a signal source with a finite number of data samples. For this type of class, in addition to the usual interface, the System object&#8482; will also expose the <code class="literal">isDone</code> function. When <code class="literal">isDone</code> returns true, the object reached the end of the available data.</p></li></ul></div><h4 class="title" id="CreatingNewKindsOfSystemObjectsForFileInputAndOutputExample-4">Public Properties</h4><p>Public properties can be changed by the user to adjust the behavior of the object to his or her particular application. <code class="literal">TextFileReader</code> has two nontunable public properties (they can only be changed before the first call to the object) and four tunable public properties.  All the public properties have a default value. Default values are assigned to the corresponding properties when nothing else is specified by the user. </p><div class="code_responsive"><pre class="programlisting">   properties (Nontunable)
       Filename   = 'tempfile.txt' 
       HeaderLines = 4
   end
</pre></div><div class="code_responsive"><pre class="programlisting">   properties
       DataFormat = '%g' 
       Delimiter = ',' 
       SamplesPerFrame = 1024
       PlayCount = 1
   end
</pre></div><h4 class="title" id="CreatingNewKindsOfSystemObjectsForFileInputAndOutputExample-5">Private Properties</h4><p>Private properties are not visible to the user and can serve a number of purposes, including</p><div class="itemizedlist"><ul><li><p>To hold values computed only occasionally, then used with subsequent calls to the algorithm. For example, values used at initialization time, when <code class="literal">setup</code> is called or the object is called for the first time. This can save recomputing them at runtime and improve the performance of the core functionality</p></li><li><p>To define the internal state of the object. For example, <code class="literal">pNumEofReached</code> stores the number of times that the end-of-file indicator was reached:</p></li></ul></div><div class="code_responsive"><pre class="programlisting">   properties(Access = private)
       pFID = -1 
       pNumChannels 
       pLineFormat 
       pNumEofReached = 0
   end
</pre></div><h4 class="title" id="CreatingNewKindsOfSystemObjectsForFileInputAndOutputExample-6">Constructor</h4><p>The constructor is defined so that you can construct a <code class="literal">TextFileReader</code> object using name-value pairs. The constructor is called when a new instance of <code class="literal">TextDataReader</code> is created. The call to <code class="literal">setProperties</code> within the constructor allows setting properties with name-value pairs at construction. No other initialization tasks should be specified in the constructor. Instead, use the <code class="literal">setupImpl</code> method.</p><div class="code_responsive"><pre class="programlisting">   methods
       function obj = TextFileReader(varargin)
           setProperties(obj, nargin, varargin{:});
       end
   end
</pre></div><h4 class="title" id="CreatingNewKindsOfSystemObjectsForFileInputAndOutputExample-7">Overriding <code class="literal">matlab.System</code> Base Class Protected Methods</h4><p>The public methods common to all System objects each have corresponding protected methods that they call internally. The names of these protected methods all include an <code class="literal">Impl</code> postfix. They can be implemented when defining the class to program the behavior of your System object.</p><p>For more information on the correspondence between the standard public methods and their internal implementations, refer to <a href="methods-timing.html" data-docid="matlab_prog#bs6lyvb-1" class="a">Summary of Call Sequence</a>.</p><p>For example, <code class="literal">TextFileReader</code> overrides these <code class="literal">Impl</code> methods: </p><div class="itemizedlist"><ul><li><p><code class="literal">setupImpl</code></p></li><li><p><code class="literal">resetImpl</code></p></li><li><p><code class="literal">stepImpl</code></p></li><li><p><code class="literal">releaseImpl</code></p></li><li><p><code class="literal">isDoneImpl</code></p></li><li><p><code class="literal">processTunedPropertiesImpl</code></p></li><li><p><code class="literal">loadObjectImpl</code></p></li><li><p><code class="literal">saveObjectImpl</code></p></li></ul></div><h4 class="title" id="CreatingNewKindsOfSystemObjectsForFileInputAndOutputExample-8">Private Methods</h4><p>Private methods are only accessible from within other methods of the same class. They can be used to make the rest of the code more readable. They can also improve code reusability, by grouping under separate routines code that is used multiple times in different parts of the class. For <code class="literal">TextFileReader</code>, private methods are created for: </p><div class="itemizedlist"><ul><li><p><code class="literal">getWorkingFID</code></p></li><li><p><code class="literal">goToStartOfData</code></p></li><li><p><code class="literal">peekCurrentLine</code></p></li><li><p><code class="literal">lockNumberOfChannelsUsingCurrentLine</code></p></li><li><p><code class="literal">readNDataRows</code></p></li></ul></div><h3 class="title" id="CreatingNewKindsOfSystemObjectsForFileInputAndOutputExample-9">Write and Read Data</h3><p>This example shows how you can use <code class="literal">TextFileReader</code> and <code class="literal">TextFileWriter</code> by:</p><div class="itemizedlist"><ul><li><p>Creating a text file containing the samples of two different sinusoidal signals using <code class="literal">TextFileWriter</code></p></li><li><p>Read from the text file using <code class="literal">TextFileReader</code>.</p></li></ul></div><h4 class="title" id="CreatingNewKindsOfSystemObjectsForFileInputAndOutputExample-10">Create a Simple Text File</h4><p>Create a new file to store two sinusoidal signals with frequencies of 50 Hz and 60 Hz. For each signal, the data stored is composed of 800 samples at a sampling rate of 8 kHz.</p><p>Create data samples:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>fs = 8000;
tmax = 0.1;
t = (0:1/fs:tmax-1/fs)';
N = length(t);
f = [50,60];
data = sin(2*pi*t*f);</pre></div></div></div><p>Form a header string to describe the data in a readable way for future use (optional step):</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>fileheader = sprintf([<span style="color:#A020F0">'The following contains %d samples of two '</span>,<span style="color:#0000FF">...</span>
    <span style="color:#A020F0">'sinusoids,\nwith frequencies %d Hz and %d Hz and a sample rate of'</span>,<span style="color:#0000FF">...</span>
    <span style="color:#A020F0">' %d kHz\n\n'</span>], N, f(1),f(2),fs/1000);</pre></div></div></div><p>To store the signal to a text file, create a <code class="literal">TextFileWriter</code> object. The constructor of <code class="literal">TextFileWriter</code> needs the name of the target file and some optional parameters, which can be passed in as name-value pairs.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>TxtWriter = TextFileWriter(<span style="color:#A020F0">'Filename'</span>,<span style="color:#A020F0">'sinewaves.txt'</span>,<span style="color:#A020F0">'Header'</span>,fileheader)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>TxtWriter = 
  TextFileWriter with properties:

      Filename: 'sinewaves.txt'
        Header: 'The following contains 800 samples of two sinusoids,↵with frequencies 50 Hz and 60 Hz and a sample rate of 8 kHz↵↵'
    DataFormat: '%.18g'
     Delimiter: ','

</pre></div></div></div><p><code class="literal">TextFileWriter</code> writes data to delimiter-separated ASCII files. Its public properties include:</p><div class="itemizedlist"><ul><li><p><code class="literal">Filename</code> &#8212; Name of the file to be written. If a file with this name already exists, it is overwritten. When operations start, the object begins writing to the file immediately following the header. The object then appends new data at each subsequent call to the object, until it is released. Calling reset resumes writing from the beginning of the file.</p></li><li><p><code class="literal">Header</code> &#8212; Character string, often composed of multiple lines and terminated by a newline character (<code class="literal">\n</code>). This is specified by the user and can be modified to embed human-readable information that describes the actual data.</p></li><li><p><code class="literal">DataFormat</code> &#8212; Format used to store each data sample. This can take any value assignable as Conversion Specifier within the <code class="literal">formatSpec</code> string used by the built-in MATLAB function <a href="../ref/fprintf.html" data-docid="matlab_ref#btf8xsy-1" class="a"><code class="olink">fprintf</code></a>. <code class="literal">DataFormat</code> applies to all channels written to the file. The default value for this property is <code class="literal">'%.18g'</code>, which allows saving double precision floating point data in full precision.</p></li><li><p><code class="literal">Delimiter</code> &#8212; Character used to separate samples from different channels at the same time instant. Every line of the written file maps to a time instant, and it includes as many samples as the number of channels provided as input (in other words, the number of columns in the matrix input passed to the object).</p></li></ul></div><p>To write all the available data to the file, a single call to can be used.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>TxtWriter(data)</pre></div></div></div><p>Release control of the file by calling the <code class="literal">release</code> function.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>release(TxtWriter)</pre></div></div></div><p>The data is now stored in the new file. To visually inspect the file, type:</p><div class="code_responsive"><pre id="d126e106771" class="programlisting">edit(<span style="color:#A020F0">'sinewaves.txt'</span>)
</pre></div><p>Because the header takes up three lines, the data starts on line <code class="literal">4</code>.</p><p>In this simple case, the length of the whole signal is small, and it fits comfortably on system memory. Therefore, the data can be created all at once and written to a file in a single step.</p><p>There are cases when this approach is not possible or practical. For example, the data might be too large to fit into a single MATLAB variable (too large to fit on system memory). Alternatively, the data might be created cyclically in a loop or streamed into MATLAB from an external source. In all these cases, streaming the data into the file can be done with an approach similar to the following example. </p><p>Use a streamed sine wave generator to create a frame of data per loop. Run the desired number of iterations to create the data and store it into the file:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>frameLength = 32;
tmax = 10; 
t = (0:1/fs:tmax-1/fs)';
N = length(t);
data = sin(2*pi*t*f);
numCycles = N/frameLength;

<span style="color:#0000FF">for</span> k = 1:10 <span style="color:#228B22">% Long running loop when you replace 10 with numCycles. </span>
    dataFrame = sin(2*pi*t*f);
    TxtWriter(dataFrame)
<span style="color:#0000FF">end</span>

release(TxtWriter)</pre></div></div></div><h4 class="title" id="CreatingNewKindsOfSystemObjectsForFileInputAndOutputExample-11">Read from Existing Text File</h4><p>To read from the text file, create an instance of <code class="literal">TextFileReader</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>TxtReader = TextFileReader(<span style="color:#A020F0">'Filename'</span>,<span style="color:#A020F0">'sinewaves.txt'</span>,<span style="color:#A020F0">'HeaderLines'</span>,3,<span style="color:#A020F0">'SamplesPerFrame'</span>,frameLength)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>TxtReader = 
  TextFileReader with properties:

           Filename: 'sinewaves.txt'
        HeaderLines: 3
         DataFormat: '%g'
          Delimiter: ','
    SamplesPerFrame: 32
          PlayCount: 1

</pre></div></div></div><p><code class="literal">TextFileReader</code> reads numeric data from delimiter-separated ASCII files. Its properties are similar to those of <code class="literal">TextFileWriter</code>. Some differences follow</p><div class="itemizedlist"><ul><li><p><code class="literal">HeaderLines</code> &#8212; Number of lines used by the header within the file specified in <code class="literal">Filename</code>. The first call to the object starts reading from line number <code class="literal">HeaderLines+1</code>. Subsequent calls to the object keep reading from the line immediately following the previously read line. Calling <code class="literal">reset</code> will resume reading from line <code class="literal">HeaderLines+1</code>.</p></li><li><p><code class="literal">Delimiter</code> &#8212; Character used to separate samples from different channels at the same time instant. In this case, the delimiter is also used to determine the number of data channels stored in the file. When the object is first run, the object counts the number of <code class="literal">Delimiter</code> characters at line <code class="literal">HeaderLines+1</code>, say <code class="literal">numDel</code>. Then for every time instant, the object reads <code class="literal">numChan = numDel+1</code> numeric values with format <code class="literal">DataFormat</code>. The matrix returned by the algorithm has size <code class="literal">SamplesPerFrame</code>-by-<code class="literal">numChan</code>.</p></li><li><p><code class="literal">SamplesPerFrame</code> &#8212; Number of lines read by each call to the object. This value is also the number of rows of the matrix returned as output. When the last available data rows are reached, there might be fewer than the required <code class="literal">SamplesPerFrame</code>. In that case, the available data are padded with zeros to obtain a matrix of size <code class="literal">SamplesPerFrame</code>-by-<code class="literal">numChan</code>. Once all the data are read, the algorithm simply returns <code class="literal">zeros(SamplesPerFrame,numChan)</code> until <code class="literal">reset</code> or <code class="literal">release</code> is called.</p></li><li><p><code class="literal">PlayCount</code> &#8212; Number of times the data in the file is read cyclically. If the object reaches the end of the file, and the file has not yet been read a number of times equal to <code class="literal">PlayCount</code>, reading resumes from the beginning of the data (line <code class="literal">HeaderLines+1</code>). If the last lines of the file do not provide enough samples to form a complete output matrix of size <code class="literal">SamplesPerFrame</code>-by-<code class="literal">numChan</code>, then the frame is completed using the initial data. Once the file is read <code class="literal">PlayCount</code> times, the output matrix returned by the algorithm is filled with zeros, and all calls to <code class="literal">isDone</code> return true unless <code class="literal">reset</code> or <code class="literal">release</code> is called. To loop through the available data indefinitely, <code class="literal">PlayCount</code> can be set to <code class="literal">Inf</code>.</p></li></ul></div><p>To read the data from the text file, the more general streamed approach is used. This method of reading data is also relevant to dealing with very large data files. Preallocate a data frame with <code class="literal">frameLength</code> rows and 2 columns.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>dataFrame = zeros(frameLength,2,<span style="color:#A020F0">'single'</span>);</pre></div></div></div><p>Read from the text file and write to the binary file while data is present in the source text file. Notice how the method <code class="literal">isDone</code> is used to control the execution of the while loop.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">while</span>(~isDone(TxtReader))
    dataFrame(:) = TxtReader();
<span style="color:#0000FF">end</span>

release(TxtReader)</pre></div></div></div><h3 class="title" id="CreatingNewKindsOfSystemObjectsForFileInputAndOutputExample-12">Summary</h3><p>This example illustrated how to author and use System objects to read from and write to numeric data files. <code class="literal">TextFileReader</code> and <code class="literal">TextFileWriter</code> can be edited to perform special-purpose file reading and writing operations. You can also combine these custom System objects with built-in System objects such as <code class="literal">dsp.BinaryFileWriter</code> and <code class="literal">dsp.BinaryFileReader</code>. </p><p>For more information on authoring System objects for custom algorithms, see <a href="../create-system-objects.html" data-docid="matlab_doccenter#bvla9m7-1" class="a">Create System Objects</a>.</p></div>
      <h2 id="seealsoref">See Also</h2><h3 id="d126e106903">Topics</h3><ul class="list-unstyled"><li><a href="createmovingaveragesystemobject.html" class="a">Create Moving Average System Object</a></li><li><a href="best-practices-for-defining-system-objects.html" class="a">Tips for Defining System Objects</a></li><li><a href="define-basic-system-objects-1.html" class="a">Define Basic System Objects</a></li></ul>
    </section>
    </div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Data Smoothing and Outlier Detection</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../data-import-and-analysis.html",
          "name": "Data Import and Analysis"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../preprocessing-data.html",
          "name": "Data Preprocessing"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "preprocessing-data"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Data Smoothing and Outlier Detection",
          "description": "Eliminate unwanted noise or behavior in data, and find, fill, and remove outliers.",
          "thumbnailURL": "../../examples/matlab/win64/DataSmoothingAndOutlierDetectionExample_13.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "identifier": "matlab.DataSmoothingAndOutlierDetectionExample",
          "name": "DataSmoothingAndOutlierDetectionExample",
          "url": "data-smoothing-and-outlier-detection.html"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/DataSmoothingAndOutlierDetectionExample')"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "DataSmoothingAndOutlierDetectionExample.mlx",
        "windData.mat"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="ug">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ex">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="Eliminate unwanted noise or behavior in data, and find, fill, and remove outliers."><meta xmlns="http://www.w3.org/1999/xhtml" content="../../examples/matlab/win64/DataSmoothingAndOutlierDetectionExample_13.png" itemprop="thumbnailUrl">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../data-import-and-analysis.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Data Import and Analysis</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../preprocessing-data.html?s_tid=CRUX_lftnav" itemprop="url" id="bvfkbas-1"><span itemprop="title">Data Preprocessing</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item"><a href="#responsive_offcanvas">Data Smoothing and Outlier Detection</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#DataSmoothingAndOutlierDetectionExample-1" class="nav-link intrnllnk">Moving Window Methods</a></li><li class="nav-item"><a href="#DataSmoothingAndOutlierDetectionExample-2" class="nav-link intrnllnk">Common Smoothing Methods</a></li><li class="nav-item"><a href="#DataSmoothingAndOutlierDetectionExample-3" class="nav-link intrnllnk">Detecting Outliers</a></li><li class="nav-item"><a href="#DataSmoothingAndOutlierDetectionExample-4" class="nav-link intrnllnk">Nonuniform Data</a></li><li class="nav-item"><a href="#d126e947" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=preprocessing-data&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=preprocessing-data&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=preprocessing-data&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=preprocessing-data&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=preprocessing-data&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=preprocessing-data&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-topic">
<section><h1 class="r2025b" itemprop="title content" id="mw_9f93d13b-c971-4875-969d-7d8e7a8834e2">Data Smoothing and Outlier Detection</h1><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/DataSmoothingAndOutlierDetectionExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-DataSmoothingAndOutlierDetectionExample"><meta itemprop="exampletitle" content="Data Smoothing and Outlier Detection"></div><span id="DataSmoothingAndOutlierDetectionExample" class="anchor_target"></span><p class="shortdesc">This example shows how to use data smoothing to eliminate unwanted noise or behaviors in data using the <code class="literal">smoothdata</code> function. This example also shows how to identify and handle outliers, which are data points that are significantly different from the rest of the data, using the <code class="literal">isoutlier</code>, <code class="literal">filloutliers</code>, or <code class="literal">rmoutliers</code> functions. Alternatively, you can interactively smooth noisy data and handle outliers in data using the  <a href="../ref/smoothdatatask.html" data-docid="matlab_ref#mw_d854f391-cb2d-442c-84d6-967fc05ef601" class="a">Smooth Data</a> and <a href="../ref/cleanoutlierdata.html" data-docid="matlab_ref#mw_d85c9d3d-c277-4fe4-b666-fd5f665b6042" class="a">Clean Outlier Data</a> tasks in the Live Editor.</p><div class="procedure"><h3 class="title" id="DataSmoothingAndOutlierDetectionExample-1">Moving Window Methods</h3><p>Moving window methods are ways to process data in smaller batches at a time, typically in order to statistically represent a neighborhood of points in the data. The moving average is a common data smoothing technique that slides a window along the data, computing the mean of the points inside of each window. This can help to eliminate insignificant variations from one data point to the next. </p><p>For example, consider wind speed measurements taken every minute for about 3 hours. Use the <code class="literal">movmean</code> function with a window size of 5 minutes to smooth out high-speed wind gusts.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>load <span style="color:#A020F0">windData.mat</span>
mins = 1:length(speed);
window = 5;
meanspeed = movmean(speed,window);
plot(mins,speed,mins,meanspeed)
axis <span style="color:#A020F0">tight</span>
legend(<span style="color:#A020F0">"Measured Wind Speed"</span>,<span style="color:#A020F0">"Average Wind Speed over 5 min Window"</span>)
xlabel(<span style="color:#A020F0">"Time"</span>)
ylabel(<span style="color:#A020F0">"Speed"</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e766" class="mediaobject"><p><img src="../../examples/matlab/win64/DataSmoothingAndOutlierDetectionExample_01.png" alt="Figure contains an axes object. The axes object with xlabel Time, ylabel Speed contains 2 objects of type line. These objects represent Measured Wind Speed, Average Wind Speed over 5 min Window." width="560"></p></div></div><p>Similarly, you can compute the median wind speed over a sliding window using the <code class="literal">movmedian</code> function.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>medianspeed = movmedian(speed,window);
plot(mins,speed,mins,medianspeed)
axis <span style="color:#A020F0">tight</span>
legend(<span style="color:#A020F0">"Measured Wind Speed"</span>,<span style="color:#A020F0">"Median Wind Speed over 5 min Window"</span>)
xlabel(<span style="color:#A020F0">"Time"</span>)
ylabel(<span style="color:#A020F0">"Speed"</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e777" class="mediaobject"><p><img src="../../examples/matlab/win64/DataSmoothingAndOutlierDetectionExample_02.png" alt="Figure contains an axes object. The axes object with xlabel Time, ylabel Speed contains 2 objects of type line. These objects represent Measured Wind Speed, Median Wind Speed over 5 min Window." width="560"></p></div></div><p>Not all data is suitable for smoothing with a moving window method.  For example, create a sinusoidal signal with injected random noise.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>t = 1:0.2:15;
A = sin(2*pi*t) + cos(2*pi*0.5*t);
Anoise = A + 0.5*rand(1,length(t));
plot(t,A,t,Anoise)
axis <span style="color:#A020F0">tight</span>
legend(<span style="color:#A020F0">"Original Data"</span>,<span style="color:#A020F0">"Noisy Data"</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e785" class="mediaobject"><p><img src="../../examples/matlab/win64/DataSmoothingAndOutlierDetectionExample_03.png" alt="Figure contains an axes object. The axes object contains 2 objects of type line. These objects represent Original Data, Noisy Data." width="560"></p></div></div><p>Use a moving mean with a window size of 3 to smooth the noisy data.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>window = 3;
Amean = movmean(Anoise,window);
plot(t,A,t,Amean)
axis <span style="color:#A020F0">tight</span>
legend(<span style="color:#A020F0">"Original Data"</span>,<span style="color:#A020F0">"Moving Mean - Window Size 3"</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e794" class="mediaobject"><p><img src="../../examples/matlab/win64/DataSmoothingAndOutlierDetectionExample_04.png" alt="Figure contains an axes object. The axes object contains 2 objects of type line. These objects represent Original Data, Moving Mean - Window Size 3." width="560"></p></div></div><p>The moving mean achieves the general shape of the data, but doesn't capture the valleys (local minima) very accurately.  Since the valley points are surrounded by two larger neighbors in each window, the mean is not a very good approximation to those points. If you make the window size larger, the mean eliminates the shorter peaks altogether.  For this type of data, you might consider alternative smoothing techniques.    </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>Amean = movmean(Anoise,5);
plot(t,A,t,Amean)
axis <span style="color:#A020F0">tight</span>
legend(<span style="color:#A020F0">"Original Data"</span>,<span style="color:#A020F0">"Moving Mean - Window Size 5"</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e802" class="mediaobject"><p><img src="../../examples/matlab/win64/DataSmoothingAndOutlierDetectionExample_05.png" alt="Figure contains an axes object. The axes object contains 2 objects of type line. These objects represent Original Data, Moving Mean - Window Size 5." width="560"></p></div></div><h3 class="title" id="DataSmoothingAndOutlierDetectionExample-2">Common Smoothing Methods</h3><p>The <code class="literal">smoothdata</code> function provides several smoothing options such as the Savitzky-Golay method, which is a popular smoothing technique used in signal processing.  By default, <code class="literal">smoothdata</code> chooses a best-guess window size for the method depending on the data. </p><p>Use the Savitzky-Golay method to smooth the noisy signal <code class="literal">Anoise</code>, and output the window size that it uses. This method provides a better valley approximation compared to <code class="literal">movmean</code>.    </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[Asgolay,window] = smoothdata(Anoise,<span style="color:#A020F0">"sgolay"</span>);
plot(t,A,t,Asgolay)
axis <span style="color:#A020F0">tight</span>
legend(<span style="color:#A020F0">"Original Data"</span>,<span style="color:#A020F0">"Savitzky-Golay"</span>,<span style="color:#A020F0">"location"</span>,<span style="color:#A020F0">"best"</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e823" class="mediaobject"><p><img src="../../examples/matlab/win64/DataSmoothingAndOutlierDetectionExample_06.png" alt="Figure contains an axes object. The axes object contains 2 objects of type line. These objects represent Original Data, Savitzky-Golay." width="560"></p></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>window</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>window = 
3
</pre></div></div></div><p>The robust Lowess method is another smoothing method that is particularly helpful when outliers are present in the data in addition to noise. Inject an outlier into the noisy data, and use robust Lowess to smooth the data, which eliminates the outlier. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>Anoise(36) = 20;
Arlowess = smoothdata(Anoise,<span style="color:#A020F0">"rlowess"</span>,5);
plot(t,Anoise,t,Arlowess)
axis <span style="color:#A020F0">tight</span>
legend(<span style="color:#A020F0">"Noisy Data"</span>,<span style="color:#A020F0">"Robust Lowess"</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e835" class="mediaobject"><p><img src="../../examples/matlab/win64/DataSmoothingAndOutlierDetectionExample_07.png" alt="Figure contains an axes object. The axes object contains 2 objects of type line. These objects represent Noisy Data, Robust Lowess." width="560"></p></div></div><h3 class="title" id="DataSmoothingAndOutlierDetectionExample-3">Detecting Outliers</h3><p>Outliers in data can significantly skew data processing results and other computed quantities. For example, if you try to smooth data containing outliers with a moving median, you can get misleading peaks or valleys. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>Amedian = smoothdata(Anoise,<span style="color:#A020F0">"movmedian"</span>);
plot(t,Anoise,t,Amedian)
axis <span style="color:#A020F0">tight</span>
legend(<span style="color:#A020F0">"Noisy Data"</span>,<span style="color:#A020F0">"Moving Median"</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e845" class="mediaobject"><p><img src="../../examples/matlab/win64/DataSmoothingAndOutlierDetectionExample_08.png" alt="Figure contains an axes object. The axes object contains 2 objects of type line. These objects represent Noisy Data, Moving Median." width="560"></p></div></div><p>The <code class="literal">isoutlier</code> function returns a logical 1 when an outlier is detected. Verify the index and value of the outlier in <code class="literal">Anoise</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>TF = isoutlier(Anoise);
ind = find(TF)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ind = 
36
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>Aoutlier = Anoise(ind)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>Aoutlier = 
20
</pre></div></div></div><p>You can replace outliers in your data by using the <code class="literal">filloutliers</code> function and specifying a fill method. For example, fill the outlier in <code class="literal">Anoise</code> with the value of its neighbor immediately to the right.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>Afill = filloutliers(Anoise,<span style="color:#A020F0">"next"</span>);
plot(t,Anoise,t,Afill,<span style="color:#A020F0">"o-"</span>)
axis <span style="color:#A020F0">tight</span>
legend(<span style="color:#A020F0">"Noisy Data with Outlier"</span>,<span style="color:#A020F0">"Noisy Data with Filled Outlier"</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e873" class="mediaobject"><p><img src="../../examples/matlab/win64/DataSmoothingAndOutlierDetectionExample_09.png" alt="Figure contains an axes object. The axes object contains 2 objects of type line. These objects represent Noisy Data with Outlier, Noisy Data with Filled Outlier." width="560"></p></div></div><p>Alternatively, you can remove outliers from your data by using the <code class="literal">rmoutliers</code> function. For example, remove the outlier in <code class="literal">Anoise</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>Aremove = rmoutliers(Anoise);
plot(t,Anoise,t(~TF),Aremove,<span style="color:#A020F0">"o-"</span>)
axis <span style="color:#A020F0">tight</span>
legend(<span style="color:#A020F0">"Noisy Data with Outlier"</span>,<span style="color:#A020F0">"Noisy Data with Outlier Removed"</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e886" class="mediaobject"><p><img src="../../examples/matlab/win64/DataSmoothingAndOutlierDetectionExample_10.png" alt="Figure contains an axes object. The axes object contains 2 objects of type line. These objects represent Noisy Data with Outlier, Noisy Data with Outlier Removed." width="560"></p></div></div><h3 class="title" id="DataSmoothingAndOutlierDetectionExample-4">Nonuniform Data</h3><p>Not all data consists of equally spaced points, which can affect methods for data processing. Create a <code class="literal">datetime</code> vector that contains irregular sampling times for the data in <code class="literal">Airreg</code>. The <code class="literal">time</code> vector represents samples taken every minute for the first 30 minutes, then hourly over two days.    </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>t0 = datetime(2014,1,1,1,1,1);
timeminutes = sort(t0 + minutes(1:30));
timehours = t0 + hours(1:48);
time = [timeminutes timehours];
Airreg = rand(1,length(time));
plot(time,Airreg)
axis <span style="color:#A020F0">tight</span></pre></div></div></div><div class="informalfigure"><div id="d126e903" class="mediaobject"><p><img src="../../examples/matlab/win64/DataSmoothingAndOutlierDetectionExample_11.png" alt="Figure contains an axes object. The axes object contains an object of type line." width="560"></p></div></div><p>By default, <code class="literal">smoothdata</code> smooths with respect to equally spaced integers, in this case, <code class="literal">1,2,...,78</code>. Since integer time stamps do not coordinate with the sampling of the points in <code class="literal">Airreg</code>, the first half hour of data still appears noisy after smoothing. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>Adefault = smoothdata(Airreg,<span style="color:#A020F0">"movmean"</span>,3);
plot(time,Airreg,time,Adefault)
axis <span style="color:#A020F0">tight</span>
legend(<span style="color:#A020F0">"Original Data"</span>,<span style="color:#A020F0">"Smoothed Data with Default Sample Points"</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e918" class="mediaobject"><p><img src="../../examples/matlab/win64/DataSmoothingAndOutlierDetectionExample_12.png" alt="Figure contains an axes object. The axes object contains 2 objects of type line. These objects represent Original Data, Smoothed Data with Default Sample Points." width="560"></p></div></div><p>Many data processing functions in MATLAB&#174;, including <code class="literal">smoothdata</code>, <code class="literal">movmean</code>, and <code class="literal">filloutliers</code>, allow you to provide sample points, ensuring that data is processed relative to its sampling units and frequencies. To remove the high-frequency variation in the first half hour of data in <code class="literal">Airreg</code>, use the <code class="literal">SamplePoints</code> name-value argument with the time stamps in <code class="literal">time</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>Asamplepoints = smoothdata(Airreg,<span style="color:#A020F0">"movmean"</span>, <span style="color:#0000FF">...</span>
    hours(3),<span style="color:#A020F0">"SamplePoints"</span>,time);
plot(time,Airreg,time,Asamplepoints)
axis <span style="color:#A020F0">tight</span>
legend(<span style="color:#A020F0">"Original Data"</span>,<span style="color:#A020F0">"Smoothed Data with Sample Points"</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e940" class="mediaobject"><p><img src="../../examples/matlab/win64/DataSmoothingAndOutlierDetectionExample_13.png" alt="Figure contains an axes object. The axes object contains 2 objects of type line. These objects represent Original Data, Smoothed Data with Sample Points." width="560"></p></div></div></div>
            <h2 id="d126e947">See Also</h2><h3>Functions</h3><ul class="list-unstyled margined_10"><li><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/smoothdata.html"><span itemprop="name"><code class="function">smoothdata</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/isoutlier.html"><span itemprop="name"><code class="function">isoutlier</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/filloutliers.html"><span itemprop="name"><code class="function">filloutliers</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/rmoutliers.html"><span itemprop="name"><code class="function">rmoutliers</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/movmean.html"><span itemprop="name"><code class="function">movmean</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/movmedian.html"><span itemprop="name"><code class="function">movmedian</code></span></a></span></li></ul><h3>Live Editor Tasks</h3><ul class="list-unstyled margined_10"><li><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/smoothdatatask.html"><span itemprop="name"><span class="liveeditortask">Smooth
                        Data</span></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/cleanoutlierdata.html"><span itemprop="name"><span class="liveeditortask">Clean
                        Outlier Data</span></span></a></span></li></ul><h3>Apps</h3><ul class="list-unstyled margined_10"><li><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/datacleaner-app.html"><span itemprop="name"><span class="app">Data
                        Cleaner</span></span></a></span></li></ul>
            <h3 id="d126e987">Topics</h3><ul class="list-unstyled"><li><a href="cleandatawithliveeditortasks.html" class="a">Clean Messy
                    Data and Locate Extrema Using Live Editor Tasks</a></li><li><a href="filtering-data.html" class="a">Filter Data</a></li></ul>
        </section>
    </div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">Â© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

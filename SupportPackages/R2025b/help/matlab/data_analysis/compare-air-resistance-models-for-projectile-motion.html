<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Compare Air Resistance Models for Projectile Motion</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../data-import-and-analysis.html",
          "name": "Data Import and Analysis"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../manage-experiments.html",
          "name": "Manage Experiments"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "manage-experiments"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Compare Air Resistance Models for Projectile Motion",
          "description": "Calculate projectile trajectories assuming different models for air resistance.",
          "thumbnailURL": "../../examples/matlab/win64/ProjectileMotionExperimentExample_05.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "identifier": "matlab.ProjectileMotionExperimentExample",
          "name": "ProjectileMotionExperimentExample",
          "url": "compare-air-resistance-models-for-projectile-motion.html"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/ProjectileMotionExperimentExample')"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "ProjectileMotionExperimentExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="ug">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="other">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="Calculate projectile trajectories assuming different models for air resistance."><meta xmlns="http://www.w3.org/1999/xhtml" content="../../examples/matlab/win64/ProjectileMotionExperimentExample_05.png" itemprop="thumbnailUrl">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../data-import-and-analysis.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Data Import and Analysis</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../manage-experiments.html?s_tid=CRUX_lftnav" itemprop="url" id="mw_549be1f7-925a-4019-86f2-d2420ed8a143"><span itemprop="title">Manage Experiments</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item"><a href="#responsive_offcanvas">Compare Air Resistance Models for Projectile Motion</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#ProjectileMotionExperimentExample-1" class="nav-link intrnllnk">Open Experiment</a></li><li class="nav-item"><a href="#ProjectileMotionExperimentExample-2" class="nav-link intrnllnk">Run Experiment</a></li><li class="nav-item"><a href="#ProjectileMotionExperimentExample-3" class="nav-link intrnllnk">Evaluate Results</a></li><li class="nav-item"><a href="#ProjectileMotionExperimentExample-4" class="nav-link intrnllnk">Rerun Experiment</a></li><li class="nav-item"><a href="#ProjectileMotionExperimentExample-5" class="nav-link intrnllnk">Experiment Function</a></li><li class="nav-item"><a href="#ProjectileMotionExperimentExample-6" class="nav-link intrnllnk">Helper Functions</a></li><li class="nav-item"><a href="#d126e7123" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=manage-experiments&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=manage-experiments&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=manage-experiments&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=manage-experiments&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=manage-experiments&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=manage-experiments&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-topic">
<section><h1 class="r2025b" itemprop="title content" id="mw_747d8d40-1a26-41a8-9ccb-8bf97e13bd83">Compare Air Resistance Models for Projectile Motion</h1><div class="doc_topic_desc"><div class="purpose_container"><em>Since R2023b</em></div></div><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/ProjectileMotionExperimentExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-ProjectileMotionExperimentExample"><meta itemprop="exampletitle" content="Compare Air Resistance Models for Projectile Motion"></div><span id="ProjectileMotionExperimentExample" class="anchor_target"></span><p class="shortdesc">This example shows how to use <a href="../ref/experimentmanager-app.html" data-docid="matlab_ref#mw_7ba7200a-bead-4052-975b-57a38fd04820" class="a">Experiment Manager</a> to compare the effects of air resistance on the trajectory of a projectile assuming one of these models:</p><div class="itemizedlist"><ul><li><p>No air resistance &#8212; The motion of the projectile depends only on gravity.</p></li><li><p>Stokes drag &#8212; Air resistance is proportional to velocity.</p></li><li><p>Newton drag &#8212; Air resistance is proportional to the square of velocity.</p></li></ul></div><p>In this experiment, you observe the differences in trajectory shape, height, and range, and determine the launch angle that produces the longest projectile range for each air resistance model.</p><div class="procedure"><h3 class="title" id="ProjectileMotionExperimentExample-1">Open Experiment</h3><p>First, open the example. Experiment Manager loads a project with a preconfigured experiment that you can inspect and run. To open the experiment, in the <strong class="emphasis bold">Experiment Browser</strong> pane, double-click <strong class="emphasis bold">AirResistanceExperiment</strong>.</p><div class="informalfigure"><div id="d126e6931" class="mediaobject"><p><img src="../../examples/matlab/win64/ProjectileMotionExperimentExample_01.png" alt="Experiment editor containing the experiment description, parameter names and values, and experiment function name" height="641" width="753"></p></div></div><p>The experiment consists of a description, a table of parameters, and an experiment function.</p><p>The <strong class="emphasis bold">Description</strong> field contains a textual description of the experiment. For this example, the description is:</p><div class="code_responsive"><pre class="programlisting">Simulate projectile motion defined by angle Theta, coefficient of friction Mu, and one of these models:
* None - no air resistance
* Stokes - air resistance is proportional to velocity
* Newton - air resistance is proportional to the square of velocity
</pre></div><p>The <strong class="emphasis bold">Parameters</strong> section specifies the parameter values to use for the experiment. Experiment Manager runs multiple trials of your experiment using a different combination of parameters for each trial. In this example, the parameters <code class="literal">Model</code>, <code class="literal">Theta</code>, and <code class="literal">Mu</code> specify the air resistance model, the launch angle, and the coefficient of friction, respectively. <code class="literal">Model</code> is a string with the values <code class="literal">"None"</code>, <code class="literal">"Stokes"</code>, and <code class="literal">"Newton"</code>, <code class="literal">Theta</code> takes five values between 15 and 75 degrees, and <code class="literal">Mu</code> has a constant value of 0.02.</p><p>The <strong class="emphasis bold">Experiment Function</strong> section specifies the function <code class="literal">AirResistanceFunction</code>, which defines the procedure for the experiment. To open this function in MATLAB&#174; Editor, click <strong class="emphasis bold">Edit</strong>. The code for the function also appears in <a href="compare-air-resistance-models-for-projectile-motion.html#ProjectileMotionExperimentExample-5" class="intrnllnk">Experiment Function</a>. The input to the experiment function is a structure called <code class="literal">params</code> with fields from the parameter table. The function uses dot notation to extract the parameter values from this structure and to set up the initial conditions and differential equations for the projectile motion problem.</p><div class="code_responsive"><pre id="d126e6981" class="programlisting">theta = params.Theta;
mu = params.Mu;
g = 9.81;
vInitial = 300;
 
tInitial = 0;
tFinal = 2*vInitial*sind(theta)/g + 1;
 
yInitial = [0; 0; vInitial*cosd(theta); vInitial*sind(theta)];
 
<span style="color:#0000FF">switch</span> params.Model
    <span style="color:#0000FF">case</span> <span style="color:#A020F0">"None"</span>
        dydt = @(t,y) [y(3); y(4); 0; -g];
    <span style="color:#0000FF">case</span> <span style="color:#A020F0">"Stokes"</span>
        dydt = @(t,y) [y(3); y(4); -mu*y(3); -g-mu*y(4)];
    <span style="color:#0000FF">case</span> <span style="color:#A020F0">"Newton"</span>
        dydt = @(t,y) [y(3); y(4); -mu*y(3)*sqrt(y(3)^2+y(4)^2); <span style="color:#0000FF">...</span>
            -g-mu*y(4)*sqrt(y(3)^2+y(4)^2)];
    <span style="color:#0000FF">otherwise</span>
        error(<span style="color:#A020F0">"Invalid air resistance model"</span>)
<span style="color:#0000FF">end</span>
</pre></div><p>Next, the experiment function calls <a href="../ref/ode45.html" data-docid="matlab_ref#bu00_4l" class="a"><code class="olink">ode45</code></a> to solve the differential equations and to compute the maximum height and range reached by the projectile, as well as the time it takes the projectile to reach these points in the trajectory. The event functions <code class="literal">endOfAscent</code> and <code class="literal">endOfDescent</code> stop the integration when the projectile reaches the highest point in the trajectory and when it returns to a height of zero.</p><div class="code_responsive"><pre id="d126e6991" class="programlisting">options = odeset(<span style="color:#A020F0">'Events'</span>,@endOfAscent);
[~,yout,te,ye,~] = ode45(dydt,[tInitial tFinal],yInitial,options);
tMaxHeight = te;
maxHeight = ye(2);
 
tInitial = te;
yInitial = ye';
options = odeset(<span style="color:#A020F0">'Events'</span>,@endOfDescent);
[~,y,te,ye,~] = ode45(dydt,[tInitial tFinal],yInitial,options);
yout = [yout; y(2:end,:)];
tMaxRange = te;
maxRange = ye(1);
</pre></div><p>Finally, the experiment function plots the predicted trajectory of the projectile and a parabolic path with the same height and range. When you run the experiment, Experiment Manager adds a button to the <strong class="emphasis bold">Review Results</strong> gallery in the toolstrip so you can display the figure. The <code class="literal">Name</code> property of the figure specifies the name of the button in the toolstrip.</p><div class="code_responsive"><pre id="d126e7001" class="programlisting">figure(Name=<span style="color:#A020F0">"Projectile Trajectory"</span>)
hold <span style="color:#A020F0">on</span>
plot(yout(:,1),yout(:,2),LineWidth=2)
X = maxRange*(0:0.05:1);
Y = 4*maxHeight*X.*(maxRange-X)/maxRange^2;
plot(X,Y,<span style="color:#A020F0">"-."</span>)
title(<span style="color:#A020F0">"Comparison of Trajectory and Parabolic Path"</span>)
xlabel(<span style="color:#A020F0">"Horizontal Distance"</span>)
ylabel(<span style="color:#A020F0">"Vertical Distance"</span>)
legend(<span style="color:#A020F0">"Trajectory"</span>,<span style="color:#A020F0">"Parabolic Path"</span>)
axis <span style="color:#A020F0">tight</span>
hold <span style="color:#A020F0">off</span>
</pre></div><h3 class="title" id="ProjectileMotionExperimentExample-2">Run Experiment</h3><p>On the Experiment Manager toolstrip, click <strong class="emphasis bold">Run</strong>. Experiment Manager runs the experiment function 15 times, each time using a different combination of parameter values. A table of results displays the output values for each trial.</p><div class="informalfigure"><div id="d126e7011" class="mediaobject"><p><img src="../../examples/matlab/win64/ProjectileMotionExperimentExample_02.png" alt="Table of results containing columns for the experiment details, parameters, and outputs" height="397" width="1193"></p></div></div><h3 class="title" id="ProjectileMotionExperimentExample-3">Evaluate Results</h3><p>The results table shows that the height and range of the predicted trajectory decrease as air resistance increases. To visualize the effects of air resistance on the shape of the trajectory, select a trial. Then, on the Experiment Manager toolstrip, under <strong class="emphasis bold">Review Results</strong>, click <strong class="emphasis bold">Projectile Trajectory</strong>. When there is no air resistance, the trajectory of the projectile is a parabola.</p><div class="informalfigure"><div id="d126e7026" class="mediaobject"><p><img src="../../examples/matlab/win64/ProjectileMotionExperimentExample_03.png" alt="Horizontal distance versus vertical distance plot for trial using no air resistance" height="279" width="675"></p></div></div><p>The Stokes drag model offsets the trajectory slightly to the right of a parabolic path with the same height and range.</p><div class="informalfigure"><div id="d126e7032" class="mediaobject"><p><img src="../../examples/matlab/win64/ProjectileMotionExperimentExample_04.png" alt="Horizontal distance versus vertical distance plot for trial using the Stokes drag model" height="279" width="675"></p></div></div><p>In contrast, the trajectory under the Newton drag model is shifted significantly to the right of a parabolic path.</p><div class="informalfigure"><div id="d126e7038" class="mediaobject"><p><img src="../../examples/matlab/win64/ProjectileMotionExperimentExample_05.png" alt="Horizontal distance versus vertical distance plot for trial using the Newton drag model" height="279" width="675"></p></div></div><p>To investigate how the launch angle affects the maximum range of the projectile under each model, sort the results table by maximum range and by model:</p><div class="orderedlist"><ol style="list-style: decimal;"><li><p>Point to the header of the <strong class="emphasis bold">maxRange</strong> column.</p></li><li><p>Click the triangle icon.</p></li><li><p>Select <strong class="emphasis bold">Sort in Descending Order</strong>.</p></li><li><p>Repeat the previous steps for the <strong class="emphasis bold">Model</strong> column, but select  <strong class="emphasis bold">Sort in Ascending Order</strong>.</p></li></ol></div><div class="informalfigure"><div id="d126e7068" class="mediaobject"><p><img src="../../examples/matlab/win64/ProjectileMotionExperimentExample_06.png" alt="Table of results, where the maxRange column is sorted in ascending order" height="397" width="1193"></p></div></div><p>When there is no air resistance, the maximum range occurs at a launch angle of 45 degrees. For the Newton drag model, the maximum range occurs between 15 and 30 degrees, and for the Stokes drag model, the maximum range occurs between 30 and 45 degrees.</p><h3 class="title" id="ProjectileMotionExperimentExample-4">Rerun Experiment</h3><p>To identify the launch angle that maximizes the range of the projectile with greater precision, change the parameter values and rerun the experiment:</p><div class="orderedlist"><ol style="list-style: decimal;"><li><p>Return to the experiment definition tab.</p></li><li><p>In the parameter table, change the value of the parameter <code class="literal">Model</code> to  <code class="literal">"Newton"</code>.</p></li><li><p>Change the value of the parameter <code class="literal">Theta</code> to <code class="literal">15:30</code>.</p></li><li><p>Run the experiment using the new parameter values.</p></li></ol></div><p>Experiment Manager runs the experiment function 16 times, each time using the Newton drag model and a different launch angle between 15 and 30 degrees.</p><div class="informalfigure"><div id="d126e7097" class="mediaobject"><p><img src="../../examples/matlab/win64/ProjectileMotionExperimentExample_07.png" alt="Table of results containing columns for the experiment details, parameters, and outputs" height="419" width="1193"></p></div></div><p>The results show that the maximum range for the Newton drag model occurs at approximately 24 degrees. A similar approach shows that the maximum range for the Stokes drag model occurs at approximately 39 degrees.</p><h3 class="title" id="ProjectileMotionExperimentExample-5">Experiment Function<span id="mw_rtc_ProjectileMotionExperimentExample_H_54e1" class="anchor_target"></span></h3><p>This function extracts the values in the parameter table and sets up the initial conditions and differential equations for the projectile motion problem. The function calls <code class="literal">ode45</code> to solve the differential equations and to compute the maximum height and range reached by the projectile, as well as the time it takes the projectile to reach these points in the trajectory. Then, the function plots the trajectory of the projectile and a parabolic path with the same height and range.</p><div class="code_responsive"><pre id="d126e7110" class="programlisting"><span style="color:#0000FF">function</span> [maxHeight,maxRange,tMaxHeight,tMaxRange] = AirResistanceFunction(params)

theta = params.Theta;
mu = params.Mu;
g = 9.81;
vInitial = 300;
 
tInitial = 0;
tFinal = 2*vInitial*sind(theta)/g + 1;
 
yInitial = [0; 0; vInitial*cosd(theta); vInitial*sind(theta)];
 
<span style="color:#0000FF">switch</span> params.Model
    <span style="color:#0000FF">case</span> <span style="color:#A020F0">"None"</span>
        dydt = @(t,y) [y(3); y(4); 0; -g];
    <span style="color:#0000FF">case</span> <span style="color:#A020F0">"Stokes"</span>
        dydt = @(t,y) [y(3); y(4); -mu*y(3); -g-mu*y(4)];
    <span style="color:#0000FF">case</span> <span style="color:#A020F0">"Newton"</span>
        dydt = @(t,y) [y(3); y(4); -mu*y(3)*sqrt(y(3)^2+y(4)^2); <span style="color:#0000FF">...</span>
            -g-mu*y(4)*sqrt(y(3)^2+y(4)^2)];
    <span style="color:#0000FF">otherwise</span>
        error(<span style="color:#A020F0">"Invalid air resistance model"</span>)
<span style="color:#0000FF">end</span>
 
options = odeset(<span style="color:#A020F0">'Events'</span>,@endOfAscent);
[~,yout,te,ye,~] = ode45(dydt,[tInitial tFinal],yInitial,options);
tMaxHeight = te;
maxHeight = ye(2);
 
tInitial = te;
yInitial = ye';
options = odeset(<span style="color:#A020F0">'Events'</span>,@endOfDescent);
[~,y,te,ye,~] = ode45(dydt,[tInitial tFinal],yInitial,options);
yout = [yout; y(2:end,:)];
tMaxRange = te;
maxRange = ye(1);
 
figure(Name=<span style="color:#A020F0">"Projectile Trajectory"</span>)
hold <span style="color:#A020F0">on</span>
plot(yout(:,1),yout(:,2),LineWidth=2)
X = maxRange*(0:0.05:1);
Y = 4*maxHeight*X.*(maxRange-X)/maxRange^2;
plot(X,Y,<span style="color:#A020F0">"-."</span>)
title(<span style="color:#A020F0">"Comparison of Trajectory and Parabolic Path"</span>)
xlabel(<span style="color:#A020F0">"Horizontal Distance"</span>)
ylabel(<span style="color:#A020F0">"Vertical Distance"</span>)
legend(<span style="color:#A020F0">"Trajectory"</span>,<span style="color:#A020F0">"Parabolic Path"</span>)
axis <span style="color:#A020F0">tight</span>
hold <span style="color:#A020F0">off</span>
 
<span style="color:#0000FF">end</span>
</pre></div><h3 class="title" id="ProjectileMotionExperimentExample-6">Helper Functions</h3><p>This event function stops the integration when the projectile reaches the highest point in the trajectory.</p><div class="code_responsive"><pre id="d126e7115" class="programlisting"><span style="color:#0000FF">function</span> [value,isterminal,direction] = endOfAscent(~,y)
value = y(4);
isterminal = 1;
direction = 0;
<span style="color:#0000FF">end</span>
</pre></div><p>This event function stops the integration when the projectile returns to a height of zero.</p><div class="code_responsive"><pre id="d126e7118" class="programlisting"><span style="color:#0000FF">function</span> [value,isterminal,direction] = endOfDescent(~,y)
value = y(2);
isterminal = 1;
direction = 0;
<span style="color:#0000FF">end</span>
</pre></div></div>
      <h2 id="d126e7123">See Also</h2><h3>Apps</h3><ul class="list-unstyled margined_10"><li><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/experimentmanager-app.html"><span itemprop="name"><span class="app">Experiment Manager</span></span></a></span></li></ul><h3>Functions</h3><ul class="list-unstyled margined_10"><li><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/ode45.html"><span itemprop="name"><code class="function">ode45</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/odeset.html"><span itemprop="name"><code class="function">odeset</code></span></a></span></li></ul>
      <h3 id="d126e7141">Topics</h3><ul class="list-unstyled"><li><a href="experiment-with-predator-prey-equations.html" class="a">Experiment with Predator-Prey Equations</a></li><li><a href="../math/ode-event-location.html" class="a">ODE Event Location</a></li></ul>
    </section>
    </div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">Â© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

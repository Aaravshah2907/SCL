<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Overcome CAN Message Buffer Size Limitation</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../data-import-and-analysis.html",
          "name": "Data Import and Analysis"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../data-import-and-export.html",
          "name": "Data Import and Export"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../hardware-network-comm.html",
          "name": "Hardware and Network Communication"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 5,

          "item": {
          "@id": "../hardware-boards-and-kits.html",
          "name": "Hardware Boards and Kits"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 6,

          "item": {
          "@id": "../arduinoio.html",
          "name": "Arduino Hardware"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 7,

          "item": {
          "@id": "../arduinoio-can-interface.html",
          "name": "CAN Interface"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "arduinoio-can-interface"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Overcome CAN Message Buffer Size Limitation",
          "description": "You the limitation of Arduino based CAN Nodes by using the automatic periodic transmit feature of Vehicle Network Toolbox&#8482;. It also shows you how to overcome the limitation by using the timer feature which is available with MATLAB&#174;.",
          "thumbnailURL": "../../examples/arduinoio/win64/vehiclespeed.png",
          "genre": "Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "identifier": "arduinoio.UsingDatabaseToManipulateCANMessagesExample",
          "name": "UsingDatabaseToManipulateCANMessagesExample",
          "url": "overcome-can-message-buffer-size-limitation.html"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('arduinoio/UsingDatabaseToManipulateCANMessagesExample')"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "UsingDatabaseToManipulateCANMessagesExample.m",
        "collectData.m",
        "demoVNT_CANdb.dbc",
        "vehiclespeed.png",
        "messagedistribution_output.png"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="fe">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ex">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This example shows you the limitation of Arduino based CAN Nodes by using the automatic periodic transmit feature of Vehicle Network Toolbox&#8482;."><meta xmlns="http://www.w3.org/1999/xhtml" content="../../examples/arduinoio/win64/vehiclespeed.png" itemprop="thumbnailUrl">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../data-import-and-analysis.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Data Import and Analysis</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../data-import-and-export.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Data Import and Export</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../hardware-network-comm.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Hardware and Network Communication</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../hardware-boards-and-kits.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Hardware Boards and Kits</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../arduinoio.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Arduino Hardware</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../arduinoio-can-interface.html?s_tid=CRUX_lftnav" itemprop="url" id="mw_0689cbdf-4b5a-4a6e-a4ee-22f7d22eb5d2"><span itemprop="title">CAN Interface</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item"><a href="#responsive_offcanvas">Overcome CAN Message Buffer Size Limitation</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#d126e74425" class="nav-link intrnllnk">Required Hardware</a></li><li class="nav-item"><a href="#d126e74437" class="nav-link intrnllnk">Hardware Setup</a></li><li class="nav-item"><a href="#d126e74443" class="nav-link intrnllnk">Create CAN Channels and CAN Messages</a></li><li class="nav-item"><a href="#d126e74456" class="nav-link intrnllnk">Create the CAN Messages</a></li><li class="nav-item"><a href="#d126e74462" class="nav-link intrnllnk">Configure Messages for Periodic Transmit</a></li><li class="nav-item"><a href="#d126e74471" class="nav-link intrnllnk">Start Periodic Message Transmit</a></li><li class="nav-item"><a href="#d126e74480" class="nav-link intrnllnk">Modify Transmitted Data</a></li><li class="nav-item"><a href="#d126e74486" class="nav-link intrnllnk">Read the Messages</a></li><li class="nav-item"><a href="#d126e74492" class="nav-link intrnllnk">Analyze the Received Messages and take action</a></li><li class="nav-item"><a href="#d126e74499" class="nav-link intrnllnk">Modify Transmitted Data Again</a></li><li class="nav-item"><a href="#d126e74505" class="nav-link intrnllnk">Analyze the Periodic Transmit Behavior</a></li><li class="nav-item"><a href="#d126e74532" class="nav-link intrnllnk">View Messages Configured for Periodic Transmit</a></li><li class="nav-item"><a href="#d126e74541" class="nav-link intrnllnk">Clean Up</a></li><li class="nav-item"><a href="#d126e74547" class="nav-link intrnllnk">Routine to collect data using Arduino</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=arduinoio-can-interface&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=arduinoio-can-interface&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=arduinoio-can-interface&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=arduinoio-can-interface&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=arduinoio-can-interface&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=arduinoio-can-interface&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-example">
<section><div class="example_icon"></div><h1 class="r2025b" itemprop="title content" id="mw_da46948c-7b53-4c81-9349-81f01159d8d4">Overcome CAN Message Buffer Size Limitation</h1><div class="examples_short_list hidden_ios_android" data-products="ML ML_ARDUINO VN"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><p class="add_margin_5">This example uses:</p><ul class="list-unstyled add_border_bottom example_product_list" itemprop="requiredprods"><li><a href="matlab:matlab.internal.addons.showAddon('ML_ARDUINO')">MATLAB Support Package for Arduino Hardware</a></li><li><a href="matlab:matlab.internal.addons.showAddon('VN')">Vehicle Network Toolbox</a></li></ul><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('arduinoio/UsingDatabaseToManipulateCANMessagesExample')" data-ex-genre="Script">Open Script</a></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="arduinoio-UsingDatabaseToManipulateCANMessagesExample"><meta itemprop="exampletitle" content="Overcome CAN Message Buffer Size Limitation"></div><span id="UsingDatabaseToManipulateCANMessagesExample" class="anchor_target"></span>



<p class="shortdesc">This example shows you the limitation of Arduino based CAN Nodes by using the automatic periodic transmit feature of Vehicle Network Toolbox&#8482;. It also shows you how to overcome the limitation by using the timer feature which is available with MATLAB&#174;.</p>




<div class="procedure"><h3 class="title" id="d126e74425">Required Hardware<span id="UsingDatabaseToManipulateCANMessagesExample-1" class="anchor_target"></span></h3><p>To run this example, you will need the following hardware:</p><div class="itemizedlist"><ul><li><p>Vector CAN Case XL</p></li><li><p>Arduino Mega2560 board</p></li><li><p>Seeed Studio CAN-Bus Shield V2</p></li></ul></div><h3 class="title" id="d126e74437">Hardware Setup<span id="UsingDatabaseToManipulateCANMessagesExample-2" class="anchor_target"></span></h3><p>Seeed Studio CAN-Bus Shield V2 mounted on Arduino Mega2560 and the Vector CAN Case XL are the CAN nodes. Use the Vector CANcable 1 and Vector CANcable A combination to connect the CANH and CANL of Vector and Arduino nodes together.</p><p>The example uses Vector CAN Case XL as the transmitter and the Arduino Mega2560 with Seeed Studio CAN-Bus Shield V2 as the receiver.</p><h3 class="title" id="d126e74443">Create CAN Channels and CAN Messages<span id="UsingDatabaseToManipulateCANMessagesExample-3" class="anchor_target"></span></h3><p>Create the transmit CAN channel object on which you can use the automatic message transmit commands using the <code class="literal">canChannel</code> function from Vehicle Network Toolbox.</p><div class="code_responsive"><pre class="programlisting">  txCh = canChannel('Vector', 'CANCaseXL 1',1);</pre></div><p>Create the receive CAN channel object.</p><div class="code_responsive"><pre class="programlisting">  arduinoObj = arduino('COM11', 'Mega2560', 'Libraries', 'CAN');
  rxCh = canChannel(arduinoObj, 'Seeed Studio CAN-Bus Shield V2');</pre></div><p>In this example, you will use a CAN database file to define and decode messages. Open the database and attach it to the CAN channels.</p><div class="code_responsive"><pre class="programlisting">  db = canDatabase('demoVNT_CANdb.dbc');
  txCh.Database = db;
  rxCh.Database = db;</pre></div><h3 class="title" id="d126e74456">Create the CAN Messages<span id="UsingDatabaseToManipulateCANMessagesExample-4" class="anchor_target"></span></h3><p>Create CAN messages for periodic transmit using the database information.</p><div class="code_responsive"><pre class="programlisting">  msgFast = canMessage(db, 'EngineMsg');
  msgSlow = canMessage(db, 'TransmissionMsg');</pre></div><h3 class="title" id="d126e74462">Configure Messages for Periodic Transmit<span id="UsingDatabaseToManipulateCANMessagesExample-5" class="anchor_target"></span></h3><p>To configure a message for periodic transmit, use the <code class="literal">transmitPeriodic</code> command from Vehicle Network Toolbox to specify the channel, the message to register on the channel, a mode value, and the periodic rate.</p><div class="code_responsive"><pre class="programlisting">  transmitPeriodic(txCh, msgFast, 'On', 0.200);
  transmitPeriodic(txCh, msgSlow, 'On', 0.500);</pre></div><h3 class="title" id="d126e74471">Start Periodic Message Transmit<span id="UsingDatabaseToManipulateCANMessagesExample-6" class="anchor_target"></span></h3><p>Start the channel using the <code class="literal">start</code> function from the Vehicle Network Toolbox before you transmit the messages. When you start a channel which has periodic messages registered, transmit begins immediately. Allow the channels to run for a short time.</p><div class="code_responsive"><pre class="programlisting">  start(txCh);
  pause(2);</pre></div><h3 class="title" id="d126e74480">Modify Transmitted Data<span id="UsingDatabaseToManipulateCANMessagesExample-7" class="anchor_target"></span></h3><p>Update the live message or signal data sent onto the CAN bus.</p><div class="code_responsive"><pre class="programlisting">  msgFast.Signals.VehicleSpeed = 60;
  pause(1);
  msgFast.Signals.VehicleSpeed = 65;
  pause(1);
  msgFast.Signals.VehicleSpeed = 70;
  pause(1);</pre></div><h3 class="title" id="d126e74486">Read the Messages<span id="UsingDatabaseToManipulateCANMessagesExample-8" class="anchor_target"></span></h3><p>Read all periodically transmitted messages.</p><div class="code_responsive"><pre class="programlisting">  read(rxCh, 100)</pre></div><h3 class="title" id="d126e74492">Analyze the Received Messages and take action<span id="UsingDatabaseToManipulateCANMessagesExample-9" class="anchor_target"></span></h3><p>Having allowed the periodic messages to run for more than 5 seconds, at least 30 messages would have been transmitted. The MATLAB Support Package for Arduino Hardware provides only 10 buffers for CAN Frames. Since the messages have been received repeatedly, we see that more than 10 messages have been received. Also, only the oldest messages would be retained due to which Arduino does not receive an update to Vehicle Speed. To use Arduino as an effective receiver, in a CAN Network, we must do trial and error experiments to set it up according to the application.</p><p>To effectively receive all the messages that have been transmitted, the reading and data collection must happen in parallel to the vehicle speed update exercise. We use a timer to set up reception in Arduino.</p><div class="code_responsive"><pre class="programlisting">  msgRx = [];
  stopArduinoReceptionTimer = false;
  t = timer;
  t.Name = 'ArduinoTimer';
  t.ExecutionMode = 'fixedRate';
  t.Period = 0.1;
  t.TimerFcn = @collectData;
  start(t);
  pause(2);</pre></div><h3 class="title" id="d126e74499">Modify Transmitted Data Again<span id="UsingDatabaseToManipulateCANMessagesExample-10" class="anchor_target"></span></h3><p>Update the signal data transmitted onto the CAN bus.</p><div class="code_responsive"><pre class="programlisting">  msgFast.Signals.VehicleSpeed = 60;
  pause(1);
  msgFast.Signals.VehicleSpeed = 45;
  pause(1);
  msgFast.Signals.VehicleSpeed = 10;
  pause(1);</pre></div><h3 class="title" id="d126e74505">Analyze the Periodic Transmit Behavior<span id="UsingDatabaseToManipulateCANMessagesExample-11" class="anchor_target"></span></h3><p>Stop the transmission channel and the timer we created for Arduino to receive messages. You can analyze the distribution of messages by plotting the identifiers of each message against their timestamps. Notice the difference between how often the two messages appear according to their periodic rates.</p><div class="code_responsive"><pre class="programlisting">  stop(txCh);
  stopArduinoReceptionTimer = true;
  pause(1);
  plot(msgRx.Time, msgRx.ID, 'x')
  ylim([0 400])
  title('Message Distribution', 'FontWeight', 'bold')
  xlabel('Timestamp')
  ylabel('CAN Identifier')</pre></div><p>
</p>
<div class="informalfigure"><div id="d126e74514" class="mediaobject"><p><img src="../../examples/arduinoio/win64/xxmessagedistribution_output.png"></p></div></div><p>
 </p><p>For further analysis, separate the two messages into individual timetables.</p><div class="code_responsive"><pre class="programlisting">  msgRxFast = msgRx(strcmpi('EngineMsg', msgRx.Name), :);
  msgRxFast(1:10, :)
  msgRxSlow = msgRx(strcmpi('TransmissionMsg', msgRx.Name), :);
  msgRxSlow(1:10, :)</pre></div><p>Analyze the timestamps of each set of messages to see how closely the average of the differences corresponds to the configured periodic rates.</p><div class="code_responsive"><pre class="programlisting">  avgPeriodFast = mean(milliseconds(diff(msgRxFast.Time)))
  avgPeriodSlow = mean(milliseconds(diff(msgRxSlow.Time)))</pre></div><p>A plot of the received signal data reflects the updates in the message data sent on the CAN bus.</p><div class="code_responsive"><pre class="programlisting">  signalTimetable = canSignalTimetable(msgRx, 'EngineMsg');
  signalTimetable(10:25, :)
  plot(signalTimetable.Time, signalTimetable.VehicleSpeed)
  title('Vehicle Speed from EngineMsg', 'FontWeight', 'bold')
  xlabel('Timestamp')
  ylabel('Vehicle Speed')
  ylim([-5 75])</pre></div><p>
</p>
<div class="informalfigure"><div id="d126e74527" class="mediaobject"><p><img src="../../examples/arduinoio/win64/xxvehiclespeed.png"></p></div></div><p>
 </p><h3 class="title" id="d126e74532">View Messages Configured for Periodic Transmit<span id="UsingDatabaseToManipulateCANMessagesExample-12" class="anchor_target"></span></h3><p>To see messages configured on a channel for periodic transmit, use the <code class="literal">transmitConfiguration</code> function from the Vehicle Network Toolbox.</p><div class="code_responsive"><pre class="programlisting">  transmitConfiguration(txCh)</pre></div><h3 class="title" id="d126e74541">Clean Up<span id="UsingDatabaseToManipulateCANMessagesExample-13" class="anchor_target"></span></h3><p>When finished, clear the connections to the hardware and the created messages.</p><div class="code_responsive"><pre class="programlisting">  clear txCh
  clear arduinoObj
  clear rxCh
  clear msgFast
  clear msgSlow
  clear msgRx
  clear msgRxFast
  clear msgRxSlow
  clear signalTimetable</pre></div><h3 class="title" id="d126e74547">Routine to collect data using Arduino<span id="UsingDatabaseToManipulateCANMessagesExample-14" class="anchor_target"></span></h3><p>The <code class="literal">collectData</code> function is used to read CAN Messages in parallel to data update. For more information on the <code class="literal">collectData</code> function, execute the following command in the MATLAB command line:</p><div class="code_responsive"><pre class="programlisting">  open('collectData.m')</pre></div></div></section>
    </div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">Â© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Deploy Arduino Functions to Arduino Hardware Using MATLAB Function Block</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../data-import-and-analysis.html",
          "name": "Data Import and Analysis"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../data-import-and-export.html",
          "name": "Data Import and Export"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../hardware-network-comm.html",
          "name": "Hardware and Network Communication"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 5,

          "item": {
          "@id": "../hardware-boards-and-kits.html",
          "name": "Hardware Boards and Kits"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 6,

          "item": {
          "@id": "../arduinoio.html",
          "name": "Arduino Hardware"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 7,

          "item": {
          "@id": "../arduinoio-deploy-arduino-functions-to-arduino-hardware-using-matlab-function-block.html",
          "name": "Deploy Arduino Functions to Arduino Hardware Using MATLAB Function Block"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "arduinoio-deploy-arduino-functions-to-arduino-hardware-using-matlab-function-block"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Deploy Arduino Functions to Arduino Hardware Using MATLAB Function Block",
          "description": "Program a MATLAB&#174; Function block Simulink&#174; Support Package for Arduino&#174; Hardware to access multiple peripherals on the Arduino&#174; hardware.",
          "thumbnailURL": "../../examples/arduinoio/win64/DeployArduinoFunctionsHwdExample_02.png",
          "genre": "Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "Simulink"

        },
          "identifier": "arduinoio.DeployArduinoFunctionsHwdExample",
          "name": "DeployArduinoFunctionsHwdExample",
          "url": "code-generation-from-matlab-function-block.html"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('arduinoio/DeployArduinoFunctionsHwdExample')"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "DeployArduinoFunctionsHwdExample.m",
        "arduino_matlab_codegen.slx",
        "arduino_matlab_codegen_initblock.slx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="ug">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="other">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This example shows how to program a MATLAB&#174; Function block Simulink&#174; Support Package for Arduino&#174; Hardware to access multiple peripherals on the Arduino&#174; hardware."><meta xmlns="http://www.w3.org/1999/xhtml" content="../../examples/arduinoio/win64/DeployArduinoFunctionsHwdExample_02.png" itemprop="thumbnailUrl">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../data-import-and-analysis.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Data Import and Analysis</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../data-import-and-export.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Data Import and Export</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../hardware-network-comm.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Hardware and Network Communication</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../hardware-boards-and-kits.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Hardware Boards and Kits</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../arduinoio.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Arduino Hardware</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../arduinoio-deploy-arduino-functions-to-arduino-hardware-using-matlab-function-block.html?s_tid=CRUX_lftnav" itemprop="url" id="mw_b8507e6a-9002-4670-bfea-0247fae067f2"><span itemprop="title">Deploy Arduino Functions to Arduino Hardware Using MATLAB Function Block</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item"><a href="#responsive_offcanvas">Deploy Arduino Functions to Arduino Hardware Using MATLAB Function Block</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#d126e73177" class="nav-link intrnllnk">Supported Hardware</a></li><li class="nav-item"><a href="#d126e73203" class="nav-link intrnllnk">Deploy MATLAB IO Functions on Arduino Hardware</a></li><li class="nav-item"><a href="#d126e73288" class="nav-link intrnllnk">Run the MATLAB Function</a></li><li class="nav-item"><a href="#d126e73298" class="nav-link intrnllnk">Adding Delays</a></li><li class="nav-item"><a href="#d126e73305" class="nav-link intrnllnk">Limitation</a></li><li class="nav-item"><a href="#d126e73353" class="nav-link intrnllnk">Other Things to Try</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=arduinoio-deploy-arduino-functions-to-arduino-hardware-using-matlab-function-block&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=arduinoio-deploy-arduino-functions-to-arduino-hardware-using-matlab-function-block&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=arduinoio-deploy-arduino-functions-to-arduino-hardware-using-matlab-function-block&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=arduinoio-deploy-arduino-functions-to-arduino-hardware-using-matlab-function-block&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=arduinoio-deploy-arduino-functions-to-arduino-hardware-using-matlab-function-block&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=arduinoio-deploy-arduino-functions-to-arduino-hardware-using-matlab-function-block&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-topic">
<section><h1 class="r2025b" itemprop="title content" id="mw_7354b8b9-8eb6-4e00-9ec4-96b4c4be02d4">Deploy Arduino Functions to Arduino Hardware Using MATLAB Function Block</h1><div class="examples_short_list hidden_ios_android" data-products="ARDUINO ML ML_ARDUINO SL"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><p class="add_margin_5">This example uses:</p><ul class="list-unstyled add_border_bottom example_product_list" itemprop="requiredprods"><li><a href="matlab:matlab.internal.addons.showAddon('ARDUINO')">Simulink Support Package for Arduino Hardware</a></li><li><a href="matlab:matlab.internal.addons.showAddon('ML_ARDUINO')">MATLAB Support Package for Arduino Hardware</a></li><li><a href="matlab:matlab.internal.addons.showAddon('SL')">Simulink</a></li></ul><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('arduinoio/DeployArduinoFunctionsHwdExample')" data-ex-genre="Script">Open Script</a></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="arduinoio-DeployArduinoFunctionsHwdExample"><meta itemprop="exampletitle" content="Deploy Arduino Functions to Arduino Hardware Using MATLAB Function Block"></div><span id="DeployArduinoFunctionsHwdExample" class="anchor_target"></span>



<p class="shortdesc">This example shows how to program a MATLAB&#174; Function block Simulink&#174; Support Package for Arduino&#174; Hardware to access multiple peripherals on the Arduino&#174; hardware.</p>




<p>The <a href="../../simulink/slref/matlabfunction.html" data-docid="simulink_ref#f7-2761585" class="a">MATLAB Function</a><span role="cross_prod"> (Simulink)</span> block enables you to implement custom MATLAB functions in a Simulink&#174; model. You can use the MATLAB Function block to generate readable, efficient, and compact C/C++ code that can be deployed to the Arduino hardware.</p>


<p>For a detailed overview of the MATLAB Function block, see <a href="../../simulink/ug/what-is-a-matlab-function-block.html" data-docid="simulink_ug#f6-106262" class="a">Implement MATLAB Functions in Simulink with MATLAB Function Blocks</a><span role="cross_prod"> (Simulink)</span>.</p>


<p>Using the MATLAB Function block for code generation provides:</p>



<p></p>
<div class="itemizedlist"><ul><li><p>
<strong class="emphasis bold">Scheduling and Multitasking</strong> &#8212; You can set the sample rate of the MATLAB Function block. The generated code runs on the hardware at the specified sample rate. With the multitasking mode On, you can run different blocks at different rates on the hardware.</p></li><li><p>
<strong class="emphasis bold">Monitor and Tuning</strong> &#8212; You can monitor signals and tune parameters by using the Monitor &amp; Tune feature in the Simulink model and observe or log the output signal.</p></li></ul></div><p>
</p>



<div class="procedure"><h3 class="title" id="d126e73177">Supported Hardware<span id="DeployArduinoFunctionsHwdExample-5" class="anchor_target"></span></h3><p>MATLAB Function blocks support code generation on these boards:</p><div class="itemizedlist"><ul><li><p>Arduino Due</p></li><li><p>Arduino Nano 3.0</p></li><li><p>Arduino Uno</p></li><li><p>Arduino Mega 2560</p></li><li><p>Arduino Mega ADK</p></li><li><p>Arduino Leonardo</p></li><li><p>Arduino Micro</p></li><li><p>Arduino MKR1000</p></li><li><p>Arduino MKR1010</p></li><li><p>Arduino MKR Zero</p></li></ul></div><h3 class="title" id="d126e73203">Deploy MATLAB IO Functions on Arduino Hardware<span id="DeployArduinoFunctionsHwdExample-6" class="anchor_target"></span></h3><p>Deploy a function that sets the state of an LED pin based on its input, generates PWM signals, and reads the analog voltage by using the functions listed in <a href="../arduinoio-read-and-write-data.html" data-docid="matlab_doccenter#mw_f3fc353d-8465-41db-8547-9a821da5e2c4" class="a">Read and Write Data</a>.</p><p>To configure the model on the Arduino board:</p><p>1. Open the <a href="matlab:openExample('arduinoio/DeployArduinoFunctionsHwdExample','supportingFile','arduino_matlab_codegen')" target="_blank"><code class="literal">arduino_matlab_codegen</code></a> Simulink model.</p><div class="informalfigure"><div id="d126e73218" class="mediaobject"><p><img src="../../examples/arduinoio/win64/DeployArduinoFunctionsHwdExample_01.png"></p></div></div><p>2. On the <strong class="emphasis bold">Hardware</strong> tab, in the <strong class="emphasis bold">Prepare</strong> section, click <strong class="emphasis bold">Hardware Settings</strong> to open the Configuration Parameters dialog box.</p><p>3. Select the <strong class="emphasis bold">Hardware Implementation</strong> pane and select your Arduino hardware from the <strong class="emphasis bold">Hardware board</strong> parameter list. Do not change any other settings. Click OK.</p><p>4. To see the function written in the editor, double click the MATLAB Function block.</p><p>Tip: Before you deploy the function, you must validate the function. For more information, see the <strong class="emphasis bold">Run the MATLAB Function</strong> section in this example.</p><p>5. To build the model and run it on the hardware, on the <strong class="emphasis bold">Hardware</strong> tab of the Simulink model, in the <strong class="emphasis bold">Mode</strong> section, select <code class="literal">Run on board</code>, and then click <strong class="emphasis bold">Build, Deploy &amp; Start</strong>.</p><p>6. To perform signal monitoring and parameter tuning, on the <strong class="emphasis bold">Hardware</strong> tab of the Simulink model, in the <strong class="emphasis bold">Mode</strong> section, select <code class="literal">Run on board</code>, and then click <strong class="emphasis bold">Monitor &amp; Tune</strong>. For example, you can change the PWM duty cycle and observe the generated PWM signal or you can connect the analog pins to VCC or GND and log the analog voltages in the scope.</p><p>Follow the preceding steps for the <a href="matlab:openExample('arduinoio/DeployArduinoFunctionsHwdExample','supportingFile','arduino_matlab_codegen_initblock')" target="_blank"><code class="literal">arduino_matlab_codegen_initblock</code></a> Simulink model.</p><div class="informalfigure"><div id="d126e73279" class="mediaobject"><p><img src="../../examples/arduinoio/win64/DeployArduinoFunctionsHwdExample_02.png"></p></div></div><p>In this model, all pin configurations you must perform at the beginning of a program execution are in the <code class="literal">init</code> block. Configuring the pins in the <code class="literal">init</code> block makes the function in the MATLAB function block modular.</p><h3 class="title" id="d126e73288">Run the MATLAB Function<span id="DeployArduinoFunctionsHwdExample-17" class="anchor_target"></span></h3><p>Before deploying the function, run the function in the MATLAB Command Window. You can then:</p><div class="itemizedlist"><ul><li><p>Verify that the MATLAB function communicates with the hardware as expected.</p></li><li><p>Detect run-time errors, such as peripheral conflicts, that are harder to diagnose during deployment.</p></li></ul></div><h3 class="title" id="d126e73298">Adding Delays<span id="DeployArduinoFunctionsHwdExample-18" class="anchor_target"></span></h3><p>To add a delay in your function inside the MATLAB Function block, use this snippet:</p><div class="code_responsive"><pre class="programlisting">if
   coder.target('rtw')
   coder.ceval('delay', duration);
end</pre></div><p>The duration holds the delay value in milliseconds. Ensure that the total execution time, including the delay, of the MATLAB Function block on the hardware is less than the sample time to avoid overrun condition.</p><h3 class="title" id="d126e73305">Limitation<span id="DeployArduinoFunctionsHwdExample-19" class="anchor_target"></span></h3><p>
<strong class="emphasis bold">Invalid PWM Pins</strong>
</p><p>These PWM pin numbers are not allowed inside a MATLAB Function block.</p><div class="itemizedlist"><ul><li><p>Arduino Mega 2560, Mega ADK &#8212; 5</p></li><li><p>Arduino Leonardo, Micro &#8212; 5</p></li><li><p>Arduino Uno, Nano3.0 &#8212; 3, 11</p></li><li><p>Arduino Due &#8212; 11, 12</p></li><li><p>Arduino MKR1000, MKR WiFi 1010, MKR Zero &#8212; 4, 5</p></li></ul></div><p>If you use a PWM function from the MATLAB Support Package for Arduino Hardware in the MATLAB function block, then do not use the pins listed in this table in the Arduino PWM blocks from the Simulink Support Package for Arduino Hardware. Simulink requires a timer for scheduling on the Arduino hardware. When a PWM function is used in the MATLAB Function Block to generate a PWM signal, a timer is chosen for scheduling on the Arduino hardware. The PWM pins connected to that timer therefore cannot be used.</p><p>
<strong class="emphasis bold">Simulink I/O</strong>
</p><p>If you run Simulink I/O on your model that has the MATLAB Function block with <a href="../arduinoio-read-and-write-data.html" data-docid="matlab_doccenter#mw_f3fc353d-8465-41db-8547-9a821da5e2c4" class="a">Read and Write Data</a> functions and other Simulink Arduino blocks, Simulink I/O does not run on the MATLAB Function block. For the other Simulink Arduino blocks, Simulink I/O runs normally.</p><p>
<strong class="emphasis bold">Resource Conflicts</strong>
</p><p>To avoid resource conflicts:</p><div class="itemizedlist"><ul><li><p>Before you access the Arduino peripherals, set the mode of the pins by using <a href="arduinoio.configurepin.html" data-docid="mlsupportpkg#bus7qlz-1" class="a"><code class="olink">configurePin</code></a> to the mode that you plan to use.</p></li><li><p>Using the same pin across different peripherals in a model may lead to undefined behaviour. For example, if you are using <a href="arduinoio.readdigitalpin.html" data-docid="mlsupportpkg#buhprtx" class="a"><code class="olink">readDigitalPin</code></a> to read digital input from a pin in the MATLAB Function block, the same pin is not allowed as an output pin in another block in your model.</p></li></ul></div><h3 class="title" id="d126e73353">Other Things to Try<span id="DeployArduinoFunctionsHwdExample-27" class="anchor_target"></span></h3><p>You can use the I2C and SPI functions inside MATLAB Function block. See <a href="gyroscope-based-pedometer-arduino-i2c-matlab-function-block.html" data-docid="mlsupportpkg#mw_37828611-6c45-4380-a853-22fa59076405" class="a">Gyroscope-Based Pedometer Using MATLAB Functions</a> for more details.</p></div></section>
    </div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">Â© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

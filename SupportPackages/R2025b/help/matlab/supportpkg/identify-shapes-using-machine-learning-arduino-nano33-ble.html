<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Identify Shapes Using Machine Learning on Arduino Nano 33 BLE Sense Hardware</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../data-import-and-analysis.html",
          "name": "Data Import and Analysis"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../data-import-and-export.html",
          "name": "Data Import and Export"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../hardware-network-comm.html",
          "name": "Hardware and Network Communication"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 5,

          "item": {
          "@id": "../hardware-boards-and-kits.html",
          "name": "Hardware Boards and Kits"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 6,

          "item": {
          "@id": "../arduinoio.html",
          "name": "Arduino Hardware"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 7,

          "item": {
          "@id": "../arduinoio-sensors.html",
          "name": "Sensors"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "arduinoio-sensors"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Identify Shapes Using Machine Learning on Arduino Nano 33 BLE Sense Hardware",
          "description": "Use MATLAB&#174; Support Package for Arduino&#174; Hardware to identify shapes using a machine learning algorithm. This example uses the Arduino Nano 33 BLE Sense hardware board with an onboard LSM9DS1 inertial measurement unit (IMU) sensor.",
          "thumbnailURL": "../../examples/arduinoio/win64/IdentifyShapesMachineLearningArduinoNano33BLESenseExample_05.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "identifier": "arduinoio.IdentifyShapesMachineLearningArduinoNano33BLESenseExample",
          "name": "IdentifyShapesMachineLearningArduinoNano33BLESenseExample",
          "url": "identify-shapes-using-machine-learning-arduino-nano33-ble.html"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('arduinoio/IdentifyShapesMachineLearningArduinoNano33BLESenseExample')"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "IdentifyShapesMachineLearningArduinoNano33BLESenseExample.mlx",
        "ESP32_ble_connection.png",
        "I2C_select.png",
        "Workspace.png",
        "bluetooth_connection.png",
        "capture_training_data.m",
        "gr_script_shapes.m",
        "shapes_training_data.mat",
        "direction_circle.png",
        "direction_triangle.png"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="ug">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="other">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This example shows how to use MATLAB&#174; Support Package for Arduino&#174; Hardware to identify shapes using a machine learning algorithm."><meta xmlns="http://www.w3.org/1999/xhtml" content="../../examples/arduinoio/win64/IdentifyShapesMachineLearningArduinoNano33BLESenseExample_05.png" itemprop="thumbnailUrl">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../data-import-and-analysis.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Data Import and Analysis</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../data-import-and-export.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Data Import and Export</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../hardware-network-comm.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Hardware and Network Communication</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../hardware-boards-and-kits.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Hardware Boards and Kits</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../arduinoio.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Arduino Hardware</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../arduinoio-sensors.html?s_tid=CRUX_lftnav" itemprop="url" id="mw_a50129d8-52cc-41a2-a650-07e612c999b7"><span itemprop="title">Sensors</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item"><a href="#responsive_offcanvas">Identify Shapes Using Machine Learning on Arduino Nano 33 BLE Sense Hardware</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#IdentifyShapesMachineLearningArduinoNano33BLESenseExample-1" class="nav-link intrnllnk">Prerequisites</a></li><li class="nav-item"><a href="#IdentifyShapesMachineLearningArduinoNano33BLESenseExample-2" class="nav-link intrnllnk">Required Hardware</a></li><li class="nav-item"><a href="#IdentifyShapesMachineLearningArduinoNano33BLESenseExample-3" class="nav-link intrnllnk">Hardware Setup</a></li><li class="nav-item"><a href="#IdentifyShapesMachineLearningArduinoNano33BLESenseExample-4" class="nav-link intrnllnk">Capture Data to Train Machine Learning Algorithm</a></li><li class="nav-item"><a href="#IdentifyShapesMachineLearningArduinoNano33BLESenseExample-7" class="nav-link intrnllnk">Extract Feature, Prepare, and Train Data</a></li><li class="nav-item"><a href="#IdentifyShapesMachineLearningArduinoNano33BLESenseExample-10" class="nav-link intrnllnk">Predict Shape</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=arduinoio-sensors&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=arduinoio-sensors&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=arduinoio-sensors&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=arduinoio-sensors&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=arduinoio-sensors&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=arduinoio-sensors&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-topic">
<section><h1 class="r2025b" itemprop="title content" id="mw_0637f94d-caf0-4c12-8482-fda9b41b52eb">Identify Shapes Using Machine Learning on Arduino Nano 33 BLE Sense Hardware</h1><div class="examples_short_list hidden_ios_android" data-products="ML ML_ARDUINO"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><p class="add_margin_5">This example uses:</p><ul class="list-unstyled add_border_bottom example_product_list" itemprop="requiredprods"><li><a href="matlab:matlab.internal.addons.showAddon('ML_ARDUINO')">MATLAB Support Package for Arduino Hardware</a></li></ul><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('arduinoio/IdentifyShapesMachineLearningArduinoNano33BLESenseExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="arduinoio-IdentifyShapesMachineLearningArduinoNano33BLESenseExample"><meta itemprop="exampletitle" content="Identify Shapes Using Machine Learning on Arduino Nano 33 BLE Sense Hardware"></div><span id="IdentifyShapesMachineLearningArduinoNano33BLESenseExample" class="anchor_target"></span><p class="shortdesc">This example shows how to use MATLAB&#174; Support Package for Arduino&#174; Hardware to identify shapes using a machine learning algorithm. This example uses the Arduino Nano 33 BLE Sense hardware board with an onboard <a href="raspberrypiio.lsm9ds1.html" data-docid="mlsupportpkg#mw_dcb23e4d-75d4-465e-8b7d-e8c6caae9fb4" class="a"><code class="olink">lsm9ds1</code></a>.</p><p>To draw the shapes, hold the Arduino board in your palm and move your hand in the air. The IMU sensor captures the linear acceleration and angular rate data along the <span class="emphasis"><em>X</em></span>-, <span class="emphasis"><em>Y</em></span>-, and <span class="emphasis"><em>Z</em></span>-axes. Send this data to the machine learning algorithm which identifies the shape you have drawn and transmits the output over Bluetooth&#174; to the Arduino board. The shape identified by the machine learning algorithm then displays in the MATLAB Command Window.</p><p>To access all the files for this example, click <strong class="emphasis bold">Open Live Script</strong> and download the attached files.</p><div class="procedure"><h3 class="title" id="IdentifyShapesMachineLearningArduinoNano33BLESenseExample-1">Prerequisites</h3><div class="itemizedlist"><ul><li><p>For more information on how to use Arduino hardware with MATLAB, see <a href="../arduinoio-get-started-with-matlab-support-package-for-arduino-hardware.html" data-docid="matlab_doccenter#mw_cc87085a-8d6a-480b-b0ac-6b7287fe6632" class="a">Get Started with MATLAB Support Package for Arduino Hardware</a>.</p></li><li><p>For more information on machine learning, see <a href="../../stats/getting-started-12.html" data-docid="stats_doccenter#bs8t023" class="a">Get Started with Statistics and Machine Learning Toolbox</a><span role="cross_prod"> (Statistics and Machine Learning Toolbox)</span></p></li></ul></div><h3 class="title" id="IdentifyShapesMachineLearningArduinoNano33BLESenseExample-2">Required Hardware</h3><div class="itemizedlist"><ul><li><p>Use an Arduino board with an onboard IMU sensor. This example uses Arduino Nano 33 BLE Sense board that has an onboard LSM9DS1 IMU sensor. This helps you to easily hold the hardware in your hand while you move your hand to draw shapes in the air. Alternatively, you can connect an IMU sensor to any Arduino board that has a sufficiently large memory. For more information on how to connect an IMU sensor to your Arduino board, refer to the sensor datasheet.</p></li><li><p>Either connect a Bluetooth dongle to the computer or use the computer's Bluetooth.</p></li></ul></div><h3 class="title" id="IdentifyShapesMachineLearningArduinoNano33BLESenseExample-3">Hardware Setup</h3><p>Connect the Arduino Nano 33 BLE Sense board to the host computer over Bluetooth. For more information, see <a href="configure-setup-for-arduino-hardware.html#bvn8yxz-1" data-docid="mlsupportpkg#bvn8yxz-1" class="a">Connection over Bluetooth</a>.</p><div class="informalfigure"><div id="d126e70841" class="mediaobject"><p><img src="../../examples/arduinoio/win64/IdentifyShapesMachineLearningArduinoNano33BLESenseExample_01.png" height="127" width="487"></p></div></div><p>In the Choose Connection Type window under Hardware Setup, set the connection type to Bluetooth.</p><div class="informalfigure"><div id="d126e70846" class="mediaobject"><p><img src="../../examples/arduinoio/win64/IdentifyShapesMachineLearningArduinoNano33BLESenseExample_02.png" height="490" width="658"></p></div></div><p>In the Upload Arduino Server window, select the I2C libraries.</p><div class="informalfigure"><div id="d126e70851" class="mediaobject"><p><img src="../../examples/arduinoio/win64/IdentifyShapesMachineLearningArduinoNano33BLESenseExample_03.png" height="491" width="656"></p></div></div><p> </p><h3 class="title" id="IdentifyShapesMachineLearningArduinoNano33BLESenseExample-4">Capture Data to Train Machine Learning Algorithm</h3><p>You can either use the <code class="literal">shapes_training_data.mat</code> file that contains the data set for the circle and triangle shapes or capture the data and create the data set manually. </p><h4 class="title" id="IdentifyShapesMachineLearningArduinoNano33BLESenseExample-5">Import Training Data</h4><p>To use the training data file included with this example, click <strong class="emphasis bold">Open Live Script</strong> and download the <code class="literal">shapes_training_data.mat</code> file. The <code class="literal">shapes_training_data</code> MAT file contains 119 data samples from the accelerometer and gyroscope on the IMU sensor. The 119 samples are grouped into 100 frames, with each frame representing a hand gesture. Each frame has six values from the <span class="emphasis"><em>X</em></span>-, <span class="emphasis"><em>Y</em></span>-, and <span class="emphasis"><em>Z</em></span>-axes of the accelerometer and gyroscope, respectively. The data set contains a total of 11,900 observations for the circle and triangle shapes. </p><p>Load the shapes_training_data.mat file.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>load <span style="color:#A020F0">shapes_training_data</span></pre></div></div></div><h4 class="title" id="IdentifyShapesMachineLearningArduinoNano33BLESenseExample-6">Capture Data Manually</h4><p>If you are using the s<code class="literal">hapes_training_data.mat</code> file, skip this section<strong class="emphasis bold">. </strong>However, if you want to capture the training data for the machine learning algorithm manually, execute the <code class="literal">capture_training_data.m</code> file. </p><p>In the <code class="literal">capture_training_data.m</code> file, you can set the acceleration threshold in the <code class="literal">accelerationThreshold</code> parameter. For this example, set the threshold to <code class="literal">2.5</code>. For more information on how to adjust the acceleration threshold for an IMU sensor, refer to the sensor datasheet. </p><div class="code_responsive"><pre id="d126e70901" class="programlisting"><span style="color:#228B22">%Acceleration threshold to detect motion</span>
accelerationThreshold = 2.5;     
</pre></div><p>To set up a connection with the Arduino board, create an <a href="arduino.html" data-docid="mlsupportpkg#buhpnk9" class="a"><code class="olink">arduino</code></a> object and specify name of the board.</p><div class="code_responsive"><pre id="d126e70907" class="programlisting"><span style="color:#228B22">%Create arduino object</span>
a=arduino(<span style="color:#A020F0">'usersArduino'</span>); <span style="color:#228B22">% Change this to your Bluetooth name or address </span>
</pre></div><p>To read data from the LSM9DS1 IMU sensor, create an <a href="raspberrypiio.lsm9ds1.html" data-docid="mlsupportpkg#mw_dcb23e4d-75d4-465e-8b7d-e8c6caae9fb4" class="a"><code class="olink">lsm9ds1</code></a> object and specify the number of samples to read in a single execution of the <code class="literal">read</code> function. For this example, set the number of samples to read to <code class="literal">119</code>.</p><div class="code_responsive"><pre id="d126e70917" class="programlisting"><span style="color:#228B22">%Initialize imu sensor</span>
imu=lsm9ds1(a,<span style="color:#A020F0">'SamplesPerRead'</span>,119,<span style="color:#A020F0">'Bus'</span>,1);
</pre></div><p>Specify the number of frames to be captured per gesture in the <code class="literal">while</code> loop. For this example, set that value to <code class="literal">100</code>.</p><div class="code_responsive"><pre id="d126e70925" class="programlisting"><span style="color:#0000FF">while</span>(gesture &lt; 100)    
    <span style="color:#228B22">%Read acceleration data</span>
    accel=imu.readAcceleration;     
    <span style="color:#228B22">%Sum up absolute values of acceleration </span>
    aSum=sum(abs(accel))/9.8;       
    <span style="color:#228B22">%Capture values if there is significant motion</span>
    <span style="color:#0000FF">if</span> aSum&gt;=accelerationThreshold 
        gesture=gesture+1;
        <span style="color:#228B22">%Read IMU sensor data</span>
        imudata=imu.read;
        imudatatable=timetable2table(imudata);
        <span style="color:#228B22">%Save values in data variable</span>
        data{gesture}=[imudatatable.Acceleration/9.8 rad2deg(imudatatable.AngularVelocity)];    
        <span style="color:#228B22">%Display the captured gesture number</span>
        disp([<span style="color:#A020F0">'Gesture no.'</span> num2str(gesture)]);
    <span style="color:#0000FF">end</span>
<span style="color:#0000FF">end</span>
</pre></div><p>Hold the Arduino hardware in the palm of your hand and draw a circle in the air. If you want to create a data set of 100 frames for a circle, draw a circle 100 times in the air. Capture the data for the circle shape.</p><div class="code_responsive"><pre id="d126e70929" class="programlisting">circledata = capture_training_data;
</pre></div><div class="informalfigure"><div id="d126e70932" class="mediaobject"><p><img src="../../examples/arduinoio/win64/IdentifyShapesMachineLearningArduinoNano33BLESenseExample_04.png" height="190" width="181"></p></div></div><p>Repeat the procedure for the triangle shape. Capture the data for the triangle shape.</p><div class="code_responsive"><pre id="d126e70936" class="programlisting">triangledata = capture_training_data;
</pre></div><div class="informalfigure"><div id="d126e70939" class="mediaobject"><p><img src="../../examples/arduinoio/win64/IdentifyShapesMachineLearningArduinoNano33BLESenseExample_05.png" height="205" width="197"></p></div></div><p>Store the data in the <code class="literal">shapes_training_data.mat</code> file.</p><div class="code_responsive"><pre id="d126e70946" class="programlisting">save(<span style="color:#A020F0">'shapes_training_data'</span>,circledata,triangledata);
</pre></div><h3 class="title" id="IdentifyShapesMachineLearningArduinoNano33BLESenseExample-7">Extract Feature, Prepare, and Train Data</h3><h4 class="title" id="IdentifyShapesMachineLearningArduinoNano33BLESenseExample-8">Extract</h4><p>The <code class="literal">gr_script_shapes.m</code> file included with this example preprocesses the <code class="literal">shapes_training_data.mat</code> data set file, trains the machine learning algorithm with the data set, and evaluates whether the algorithm accurately predicts the circle and triangle shapes. The MATLAB function in this file performs a five-fold cross validation for the ensemble classifier and computes the validation accuracy of the algorithm. Execute the <code class="literal">gr_script_shapes.m</code> file. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>run <span style="color:#A020F0">gr_script_shapes.m</span></pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>validationAccuracy = 0.9833
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>testAccuracy = 1
</pre></div></div></div><p>The code in the gr_script_shapes.m file extracts features by calculating the mean and the standard deviation of each column in a frame. Considering the data from the <span class="emphasis"><em>X</em></span>-, <span class="emphasis"><em>Y</em></span>-, and <span class="emphasis"><em>Z</em></span>-axes for the accelerometer and the gyroscope and 100 frames per gesture, results in a 100-by-12 matrix of observations for each gesture.</p><div class="code_responsive"><pre id="d126e70974" class="programlisting">Nframe = 100;
<span style="color:#0000FF">for</span> ind = 1:Nframe
  featureC1(ind,:) = mean(circledata{ind});
  featureC2(ind,:) = std(circledata{ind});
  featureT1(ind,:) = mean(triangledata{ind});
  featureT2(ind,:) = std(triangledata{ind});
<span style="color:#0000FF">end</span>
X = [featureC1,featureC2;
featureT1,featureT2;
zeros(size(featureT1)),zeros(size(featureT2))];
<span style="color:#228B22">% labels - 1: circle, 2: triangle, 3: idle</span>
Y = [ones(Nframe,1);2*ones(Nframe,1);3*ones(Nframe,1)];
</pre></div><p>Note: You can configure the number of frames to be captured per gesture in the <code class="literal">while</code> loop.</p><h4 class="title" id="IdentifyShapesMachineLearningArduinoNano33BLESenseExample-9"><strong class="emphasis bold">Prepare</strong></h4><p>This example uses 80% of the observations to train a model that classifies two types of shapes and 20% of the observations to validate the trained model. Use <a href="../../stats/cvpartition.html" data-docid="stats_ug#brxwayf-1" class="a"><code class="olink">cvpartition</code></a><span role="cross_prod"> (Statistics and Machine Learning Toolbox)</span> to partition 20% of the data for the test data set.</p><div class="code_responsive"><pre id="d126e70988" class="programlisting">rng(<span style="color:#A020F0">'default'</span>) <span style="color:#228B22">% For reproducibility</span>
Partition = cvpartition(Y,<span style="color:#A020F0">'Holdout'</span>,0.20);
trainingInds = training(Partition); <span style="color:#228B22">% Indices for the training set</span>
XTrain = X(trainingInds,:);
YTrain = Y(trainingInds);
testInds = test(Partition); <span style="color:#228B22">% Indices for the test set</span>
</pre></div><p>The training variables are visible in the <strong class="emphasis bold">Workspace</strong> pane in MATLAB.</p><p><strong class="emphasis bold">Train Classification Model </strong></p><p>Train the classification model using the ensemble classifier.</p><div class="code_responsive"><pre id="d126e70999" class="programlisting">template = templateTree(<span style="color:#0000FF">...</span>
    <span style="color:#A020F0">'MaxNumSplits'</span>, 399);

ensMdl = fitcensemble(<span style="color:#0000FF">...</span>
    XTrain, <span style="color:#0000FF">...</span>
    YTrain, <span style="color:#0000FF">...</span>
    <span style="color:#A020F0">'Method'</span>, <span style="color:#A020F0">'Bag'</span>, <span style="color:#0000FF">...</span>
    <span style="color:#A020F0">'NumLearningCycles'</span>, 20, <span style="color:#0000FF">...</span>
    <span style="color:#A020F0">'Learners'</span>, template, <span style="color:#0000FF">...</span>
    <span style="color:#A020F0">'ClassNames'</span>, [1; 2; 3]);
</pre></div><p><strong class="emphasis bold">Validate Classifier</strong></p><p>Perform five-fold cross validation for the ensemble classifier and compute the validation accuracy to evaluate the performance of test data. </p><div class="code_responsive"><pre id="d126e71005" class="programlisting"><span style="color:#228B22">%% Prediction accuracy</span>
<span style="color:#228B22">% Perform five-fold cross-validation for classificationEnsemble and compute the validation accuracy.</span>
partitionedModel = crossval(ensMdl,<span style="color:#A020F0">'KFold'</span>,5);
validationAccuracy = 1-kfoldLoss(partitionedModel)
<span style="color:#228B22">%% Test data accuracy</span>
<span style="color:#228B22">% Evaluate performance of test data</span>
testAccuracy = 1-loss(ensMdl,XTest,YTest)
</pre></div><h3 class="title" id="IdentifyShapesMachineLearningArduinoNano33BLESenseExample-10">Predict Shape</h3><p>Run this MATLAB code to predict the shape. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#228B22">% Create an arduino object with Bluetooth connection</span>
aObj = arduino(<span style="color:#A020F0">"usersArduino"</span>);  <span style="color:#228B22">% Change this to required Bluetooth name or address </span>

<span style="color:#228B22">% Create LSM9DS1 object</span>
imuObj = lsm9ds1(aObj,<span style="color:#A020F0">"Bus"</span>,1,<span style="color:#A020F0">"SamplesPerRead"</span>,119,<span style="color:#A020F0">'Bus'</span>,1);
disp(<span style="color:#A020F0">'Start capturing gesture data.'</span>);</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>Start capturing gesture data.
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>
<span style="color:#228B22">% Set the acceleration threshold</span>
accelerationThreshold = 2.5;

<span style="color:#228B22">% Predict the shapes for 10 seconds</span>
tic;
<span style="color:#0000FF">while</span> (toc&lt;10)
    <span style="color:#228B22">% Read the acceleration</span>
    accel = readAcceleration(imuObj);
    
    <span style="color:#228B22">%Sum up absolute values of acceleration</span>
    aSum = sum(abs(accel))/9.8;
    
    <span style="color:#228B22">%Capture values if there is significant motion</span>
    <span style="color:#0000FF">if</span> aSum &gt;= accelerationThreshold
        <span style="color:#228B22">%Read IMU sensor data</span>
        imudata  =  read(imuObj);
        imudatatable = timetable2table(imudata);
        
        <span style="color:#228B22">%Save values in data variable</span>
        testGesture = [imudatatable.Acceleration/9.8 rad2deg(imudatatable.AngularVelocity)];
        
        <span style="color:#228B22">% Get the features of the captured gesture</span>
        feature1 = mean(testGesture);
        feature2 = std(testGesture);
        features = [feature1 feature2];
        
        <span style="color:#228B22">% Predict the gesture</span>
        y = predict(ensMdl,features);
        <span style="color:#0000FF">if</span> y == 1
            disp(<span style="color:#A020F0">'Circle'</span>);
        <span style="color:#0000FF">elseif</span> y == 2
            disp(<span style="color:#A020F0">'Triangle'</span>);
        <span style="color:#0000FF">end</span>
    <span style="color:#0000FF">end</span>
<span style="color:#0000FF">end</span>
release(imuObj);
clear <span style="color:#A020F0">imuObj</span> <span style="color:#A020F0">aObj</span>;</pre></div></div></div></div></section>
    </div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">Â© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Capturing and Stitching Panoramic Images Using ArduCam Multi Camera Adapter Module</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../data-import-and-analysis.html",
          "name": "Data Import and Analysis"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../data-import-and-export.html",
          "name": "Data Import and Export"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../hardware-network-comm.html",
          "name": "Hardware and Network Communication"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 5,

          "item": {
          "@id": "../hardware-boards-and-kits.html",
          "name": "Hardware Boards and Kits"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 6,

          "item": {
          "@id": "../raspberrypiio.html",
          "name": "Raspberry Pi Hardware"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 7,

          "item": {
          "@id": "../raspberrypiio-multi_camera_adapter.html",
          "name": "Multi Camera Adapter"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "raspberrypiio-multi_camera_adapter"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Capturing and Stitching Panoramic Images Using ArduCam Multi Camera Adapter Module",
          "description": "Capture images using ArduCam Multi Camera Adapter Module attached to Raspberry Pi&#174; and stitch the images to obtain a panoramic image using SURF feature detection and matching.",
          "thumbnailURL": "../../includes/product/images/doc_center/DefaultImage.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "identifier": "raspberrypiio.CapturingPanoramicImagesArduCamMultiCameraExample",
          "name": "CapturingPanoramicImagesArduCamMultiCameraExample",
          "url": "panoramic_image_stitching_arducam.html"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('raspberrypiio/CapturingPanoramicImagesArduCamMultiCameraExample')"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "CapturingPanoramicImagesArduCamMultiCameraExample.mlx",
        "raspi_arducam_panorama.m"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="ug">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="other">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This example shows how to capture images using ArduCam Multi Camera Adapter Module attached to Raspberry Pi&#174; and stitch the images to obtain a panoramic image using SURF feature detection and matching."><meta xmlns="http://www.w3.org/1999/xhtml" content="../../includes/product/images/doc_center/DefaultImage.png" itemprop="thumbnailUrl">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../data-import-and-analysis.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Data Import and Analysis</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../data-import-and-export.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Data Import and Export</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../hardware-network-comm.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Hardware and Network Communication</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../hardware-boards-and-kits.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Hardware Boards and Kits</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../raspberrypiio.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Raspberry Pi Hardware</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../raspberrypiio-multi_camera_adapter.html?s_tid=CRUX_lftnav" itemprop="url" id="mw_9b88c2d9-b2f8-4439-a58b-e0c67f184bb3"><span itemprop="title">Multi Camera Adapter</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item"><a href="#responsive_offcanvas">Capturing and Stitching Panoramic Images Using ArduCam Multi Camera Adapter Module</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#CapturingPanoramicImagesArduCamMultiCameraExample-1" class="nav-link intrnllnk">Overview</a></li><li class="nav-item"><a href="#CapturingPanoramicImagesArduCamMultiCameraExample-2" class="nav-link intrnllnk">Hardware Setup</a></li><li class="nav-item"><a href="#CapturingPanoramicImagesArduCamMultiCameraExample-3" class="nav-link intrnllnk">Initialize Image Parameters</a></li><li class="nav-item"><a href="#CapturingPanoramicImagesArduCamMultiCameraExample-4" class="nav-link intrnllnk">Initialize the Panorama and Register Image Pairs</a></li><li class="nav-item"><a href="#CapturingPanoramicImagesArduCamMultiCameraExample-5" class="nav-link intrnllnk">Compute the Size of the Panorama</a></li><li class="nav-item"><a href="#CapturingPanoramicImagesArduCamMultiCameraExample-6" class="nav-link intrnllnk">Create the Panorama</a></li><li class="nav-item"><a href="#CapturingPanoramicImagesArduCamMultiCameraExample-7" class="nav-link intrnllnk">Create a Hardware Configuration Object</a></li><li class="nav-item"><a href="#CapturingPanoramicImagesArduCamMultiCameraExample-8" class="nav-link intrnllnk">Deploy MATLAB Function on Hardware</a></li><li class="nav-item"><a href="#CapturingPanoramicImagesArduCamMultiCameraExample-9" class="nav-link intrnllnk">References</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=raspberrypiio-multi_camera_adapter&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=raspberrypiio-multi_camera_adapter&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=raspberrypiio-multi_camera_adapter&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=raspberrypiio-multi_camera_adapter&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=raspberrypiio-multi_camera_adapter&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=raspberrypiio-multi_camera_adapter&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-topic">
<section><h1 class="r2025b" itemprop="title content" id="mw_fe87858d-6f90-4639-b642-8f1db8d3c375">Capturing and Stitching Panoramic Images Using ArduCam Multi Camera Adapter Module</h1><div class="examples_short_list hidden_ios_android" data-products="ML RASPPIIO VP ME"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><p class="add_margin_5">This example uses:</p><ul class="list-unstyled add_border_bottom example_product_list" itemprop="requiredprods"><li><a href="matlab:matlab.internal.addons.showAddon('RASPPIIO')">MATLAB Support Package for Raspberry Pi Hardware</a></li><li><a href="matlab:matlab.internal.addons.showAddon('VP')">Computer Vision Toolbox</a></li><li><a href="matlab:matlab.internal.addons.showAddon('ME')">MATLAB Coder</a></li></ul><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('raspberrypiio/CapturingPanoramicImagesArduCamMultiCameraExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="raspberrypiio-CapturingPanoramicImagesArduCamMultiCameraExample"><meta itemprop="exampletitle" content="Capturing and Stitching Panoramic Images Using ArduCam Multi Camera Adapter Module"></div><span id="CapturingPanoramicImagesArduCamMultiCameraExample" class="anchor_target"></span><p class="shortdesc">This example shows how to capture images using ArduCam Multi Camera Adapter Module attached to Raspberry Pi&#174; and stitch the images to obtain a panoramic image using SURF feature detection and matching. </p><p>This example also shows how to deploy the MATLAB code for stitching the images on Raspberry Pi hardware as a standalone executable using MATLAB&#174; Support Package for Raspberry Pi Hardware. Display the result on a monitor connected to the same Raspberry Pi hardware.</p><p>To access all the files for this example, click the <strong class="emphasis bold">Open Live Script</strong> button and download the files attached with this example.</p><div class="procedure"><h3 class="title" id="CapturingPanoramicImagesArduCamMultiCameraExample-1">Overview</h3><p>Feature detection and matching are powerful techniques used in many computer vision applications such as image registration, tracking, and object detection. This example uses feature-based techniques to automatically stitch a set of images. The procedure for image stitching is an extension of feature- based image registration, where instead of registering a single pair of images, you register multiple successive image pairs relative to each other to form a panorama.</p><h3 class="title" id="CapturingPanoramicImagesArduCamMultiCameraExample-2">Hardware Setup</h3><div class="itemizedlist"><ul><li><p>Raspberry Pi 3 Model B+ with OpenCV libraries</p></li><li><p>ArduCam Mutli Camera Adapter Module</p></li><li><p>Four 5MP OV5647 cameras</p></li><li><p>Monitor</p></li></ul></div><h3 class="title" id="CapturingPanoramicImagesArduCamMultiCameraExample-3">Initialize Image Parameters</h3><p>Define the dimensions of the images that you want to capture using the cameras attached to the ArduCam module in pixels. For this example, define a height of 480 pixels and a width of 640 pixels.</p><p>Capture a minimum of two images and a maximum of four images.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#228B22">% Define image width and height.</span>
imgHeight = 480;
imgWidth = 640;

<span style="color:#228B22">% Define image resolution.</span>
imgResolution = <span style="color:#A020F0">'640x480'</span>;

<span style="color:#228B22">% Define number of images.</span>
numImages = 4;</pre></div></div></div><p>Create an image array to store the captured images.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>imgArray = uint8(zeros(imgHeight,imgWidth,3,numImages));</pre></div></div></div><p>Create an array of 2-D projective geometric transformation.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>tforms = {projtform2d(eye(3, <span style="color:#A020F0">'single'</span>)) projtform2d(eye(3, <span style="color:#A020F0">'single'</span>)) projtform2d(eye(3, <span style="color:#A020F0">'single'</span>)) projtform2d(eye(3, <span style="color:#A020F0">'single'</span>))};</pre></div></div></div><p>Create an <code class="literal">AlphaBlender</code> System object&#8482; to overlay the images.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#228B22">% Creates an alpha blender System object</span>
blender = vision.AlphaBlender(<span style="color:#A020F0">'Operation'</span>, <span style="color:#A020F0">'Binary mask'</span>, <span style="color:#0000FF">...</span>
    <span style="color:#A020F0">'MaskSource'</span>, <span style="color:#A020F0">'Input port'</span>);</pre></div></div></div><p>Create a <code class="literal">raspi</code> and an <code class="literal">arducam</code> object.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#228B22">% Create a raspi object.</span>
raspiObj = raspi(<span style="color:#A020F0">'bgl-arducam-raspi'</span>,<span style="color:#A020F0">'pi'</span>,<span style="color:#A020F0">'raspberry'</span>);

<span style="color:#228B22">% Create arducam object</span>
camObj = arducam(raspiObj,<span style="color:#A020F0">'MultiCamAdapter'</span>,<span style="color:#A020F0">'Resolution'</span>,imgResolution);
availableCameras = {<span style="color:#A020F0">'CAMERA A'</span>,<span style="color:#A020F0">'CAMERA B'</span>,<span style="color:#A020F0">'CAMERA C'</span>,<span style="color:#A020F0">'CAMERA D'</span>};</pre></div></div></div><h3 class="title" id="CapturingPanoramicImagesArduCamMultiCameraExample-4">Initialize the Panorama and Register Image Pairs</h3><p>Create an empty <code class="literal">panorama</code> variable to which you will map all the captured images later in the example. For this example, based on the hardware setup, set the canvas of the panorama to twice the dimensions of the captured images.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>panoramaImgHeight = 2*imgHeight;
panoramaImgWidth = 2*imgWidth;
panorama = uint8(zeros(panoramaImgHeight, panoramaImgWidth, 3));</pre></div></div></div><p>To create the panorama, start by registering successive image pairs using the following procedure:</p><div class="orderedlist"><ol style="list-style: decimal;"><li><p>Detect and match features between <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>I</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>I</mi><mo stretchy="false">(</mo><mi>n</mi><mo>-</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></math></span>.</p></li><li><p>Estimate the geometric transformation <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></math></span> that maps <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>I</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></math></span> to <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>I</mi><mo stretchy="false">(</mo><mi>n</mi><mo>-</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></math></span>.</p></li><li><p>Compute the transformation that maps <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>I</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></math></span> into the panorama image as <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>T</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><mo>*</mo><mi>T</mi><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo><mo>*</mo><mo stretchy="false">.</mo><mo stretchy="false">.</mo><mo stretchy="false">.</mo><mo>*</mo><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo>-</mo><mn>1</mn><mo stretchy="false">)</mo><mo>*</mo><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></math></span>.</p></li></ol></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#228B22">% Capture first image from the cameraboard and convert to grayscale.</span>
selectCamera(camObj,availableCameras{1});
imgArray(:,:,:,1) = snapshot(camObj);
grayImage = im2gray(imgArray(:,:,:,1));

<span style="color:#228B22">% Detect SURF features for the first image and extract features.</span>
points = detectSURFFeatures(grayImage);
[features, points] = extractFeatures(grayImage,points, <span style="color:#A020F0">'Method'</span>,<span style="color:#A020F0">'SURF'</span>);

<span style="color:#228B22">% Iterate over remaining images</span>
<span style="color:#0000FF">for</span> n = 2:numImages
    <span style="color:#228B22">% Store points and features for image (n-1).</span>
    pointsPrevious = points;
    featuresPrevious = features;

    <span style="color:#228B22">% Capture an image.</span>
    selectCamera(camObj,availableCameras{n});
    imgArray(:,:,:,n) = snapshot(camObj);

    <span style="color:#228B22">% Convert image to grayscale.</span>
    grayImage = im2gray(imgArray(:,:,:,n));

    <span style="color:#228B22">% Detect and extract SURF features for the captured images.</span>
    points = detectSURFFeatures(grayImage);
    [features, points] = extractFeatures(grayImage, points);

    <span style="color:#228B22">% Find correspondences between current image and previous image.</span>
    indexPairs = matchFeatures(features, featuresPrevious, <span style="color:#A020F0">'Unique'</span>, true);

    <span style="color:#228B22">% Extract the matched point locations.</span>
    matchedPoints  = points.Location(indexPairs(:,1),:);
    matchedPointsPrev = pointsPrevious.Location(indexPairs(:,2),:);

    <span style="color:#228B22">% Estimate the transformation between current image and previous image.</span>
    tforms{n} = estgeotform2d(matchedPoints, matchedPointsPrev,<span style="color:#0000FF">...</span>
        <span style="color:#A020F0">'projective'</span>, <span style="color:#A020F0">'Confidence'</span>, 99.9, <span style="color:#A020F0">'MaxNumTrials'</span>, 5000);

    <span style="color:#228B22">% Compute T(1) * T(2) * ... * T(n-1) * T(n).</span>
    tforms{n}.A = tforms{n-1}.A * tforms{n}.A;
<span style="color:#0000FF">end</span></pre></div></div></div><p>At this point, all the transformations in <code class="literal">tforms</code> are relative to the first image. This was a convenient way to code the image registration procedure because it allowed sequential processing of all the images. However, using the first image as the start of the panorama does not produce the most aesthetically pleasing panorama because it tends to distort most of the images that form the panorama. You can create a more aesthetically pleasing panorama by modifying the transformations such that the center of the scene is the least distorted. You can accomplish this by inverting the transformation for the center image and applying that transformation to all the other images.</p><p>Start by using the <a href="../../images/ref/projtform2d.html" data-docid="images_ref#mw_032fb3a7-d0b3-4f48-a70f-93d7aaeac28d" class="a"><code class="olink">projtform2d</code></a><span role="cross_prod"> (Image Processing Toolbox)</span> <code class="literal">outputLimits</code> method to find the output limits for each transformation. Then use the output limits to automatically find the image that is roughly at the center of the scene.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#228B22">% Compute the output limits for each transformation.</span>
xlim = zeros(numel(tforms) ,2);
ylim = zeros(numel(tforms) ,2);
[xlim(1,:), ylim(1,:)] = outputLimits(tforms{1}, [1 0], [1 0]);
<span style="color:#0000FF">for</span> i = 2:numel(tforms)
    [xlim(i,:), ylim(i,:)] = outputLimits(tforms{i}, [1 imgWidth], [1 imgHeight]);
<span style="color:#0000FF">end</span></pre></div></div></div><p>Next, compute the average <span class="emphasis"><em>X</em></span> limits for each transformation and find the image that is in the center. This example uses only the X limits because the scene for which you are generating the panorama is horizontal. If you are using a different set of images, you might need the <code class="literal">X</code> and <code class="literal">Y</code> limits to find the center image.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#228B22">% Compute the average X limits for each transformation and find the image</span>
<span style="color:#228B22">% that is in the center. Only the X limits are used here because the</span>
<span style="color:#228B22">% cameras are horizontally placed.</span>
avgXLim = mean(xlim, 2);
[~,idx] = sort(avgXLim);
centerIdx = floor((numel(tforms)+1)/2);
centerImageIdx = idx(centerIdx);</pre></div></div></div><p>Apply the inverse transformation of the center image to all the others.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#228B22">% Apply the center image's inverse transformation to all the others.</span>
Tinv = invert(tforms{centerImageIdx});
<span style="color:#0000FF">for</span> i = 1:numel(tforms)
    tforms{i}.A = Tinv.A * tforms{i}.A;
<span style="color:#0000FF">end</span></pre></div></div></div><h3 class="title" id="CapturingPanoramicImagesArduCamMultiCameraExample-5">Compute the Size of the Panorama</h3><p>Use the <code class="literal">outputLimits</code> method to compute the minimum and maximum output limits over all transformations. Then use these values to automatically compute the size of the panorama.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#228B22">% Use the outputLimits method to compute the minimum and maximum output</span>
<span style="color:#228B22">% limits over all transformations.</span>
[xlim(1,:), ylim(1,:)] = outputLimits(tforms{1}, [1 0], [1 0]);
<span style="color:#0000FF">for</span> i = 2:numel(tforms)
    [xlim(i,:), ylim(i,:)] = outputLimits(tforms{i}, [1 imgWidth], [1 imgHeight]);
<span style="color:#0000FF">end</span>

<span style="color:#228B22">% Find the minimum and maximum output limits.</span>
xMin = min([1; xlim(:)]);
xMax = max([imgWidth; xlim(:)]);

yMin = min([1; ylim(:)]);
yMax = max([imgHeight; ylim(:)]);

<span style="color:#228B22">% Create a 2-D spatial reference object defining the size of the panorama.</span>
xLimits = [xMin xMax];
yLimits = [yMin yMax];
panoramaView = imref2d([panoramaImgWidth panoramaImgHeight], xLimits, yLimits);
</pre></div></div></div><h3 class="title" id="CapturingPanoramicImagesArduCamMultiCameraExample-6"><strong class="emphasis bold">Create the Panorama</strong></h3><p>Use <a href="../../images/ref/imwarp.html" data-docid="images_ref#btqog63-1" class="a"><code class="olink">imwarp</code></a><span role="cross_prod"> (Image Processing Toolbox)</span> to map images into the panorama and use <a href="../../vision/ref/vision.alphablender-system-object.html" data-docid="vision_ref#bse82mo" class="a"><code class="olink">vision.AlphaBlender</code></a><span role="cross_prod"> (Computer Vision Toolbox)</span> to overlay the images. The field of view of each of the cameras is less than 60 degrees. Therefore, to have a common region in each of the captured images, place the cameras close to each other.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#228B22">% Create the panorama.</span>
<span style="color:#0000FF">for</span> i = 1:numImages

    <span style="color:#228B22">% Transform images into the panorama.</span>
    wrapedImage = imwarp(imgArray(:,:,:,i), tforms{i}, <span style="color:#A020F0">'OutputView'</span>, panoramaView);

    <span style="color:#228B22">% Generate a binary mask.</span>
    mask = imwarp(true(size(imgArray(:,:,:,i),1),size(imgArray(:,:,:,i),2)), tforms{i}, <span style="color:#A020F0">'OutputView'</span>, panoramaView);

    <span style="color:#228B22">% Overlay the warpedImage onto the panorama.</span>
    panorama = blender(panorama,wrapedImage,mask);
<span style="color:#0000FF">end</span>

<span style="color:#228B22">% Display individual images</span>
montage(imgArray)

<span style="color:#228B22">% Display the panoramic image</span>
displayImage(raspiObj,panorama);</pre></div></div></div><p>To continuously capture images and update the panorama, you can add the code in the Initialize the Panorama and Register Image Pairs and Create a Hardware Configuration Object sections in a <code class="literal">while</code> loop. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>clear <span style="color:#A020F0">raspiObj</span> <span style="color:#A020F0">camObj</span></pre></div></div></div><h3 class="title" id="CapturingPanoramicImagesArduCamMultiCameraExample-7"><strong class="emphasis bold">Create a Hardware Configuration Object</strong></h3><p>Create a hardware configuration object by using the <a href="targethardware.targethardware.html" data-docid="mlsupportpkg#mw_0826d141-e828-41a5-b465-cdf6268cb39a" class="a"><code class="olink">targetHardware</code></a> function in the MATLAB Command Window. For Raspberry Pi with 32-bit OS, use:</p><div class="code_responsive"><pre id="d126e122904" class="programlisting">board = targetHardware(<span style="color:#A020F0">'Raspberry Pi'</span>)
</pre></div><p>For Raspberry Pi with 64-bit OS, use:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>board = targetHardware(<span style="color:#A020F0">'Raspberry Pi (64bit)'</span>);</pre></div></div></div><p>Verify the <code class="literal">DeviceAddress</code>, <code class="literal">Username</code>, and <code class="literal">Password</code> properties listed in the output. If required, change the value of the properties by using the dot notation syntax.</p><p>For example, to change the device address to <code class="literal">192.168.0.1</code>, enter this code.</p><p><code class="literal">board.DeviceAddress = '192.168.0.1'</code></p><h3 class="title" id="CapturingPanoramicImagesArduCamMultiCameraExample-8">Deploy MATLAB Function on Hardware</h3><p>Download the function <code class="literal">raspi_arducam_panorama.m </code>attached with this example and deploy it as a standalone executable on the hardware by using the <code class="literal">deploy</code> function. To acces the file, click the <strong class="emphasis bold">Open Live Script</strong> button.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>deploy(board,<span style="color:#A020F0">'raspi_arducam_panorama.m'</span>);</pre></div></div></div><p>You can incorporate additional techniques into the example to improve the blending and alignment of the panorama images [1]. </p><h3 class="title" id="CapturingPanoramicImagesArduCamMultiCameraExample-9">References</h3><p>[1] Matthew Brown and David G. Lowe. 2007. Automatic Panoramic Image Stitching using Invariant Features. Int. J. Comput. Vision 74, 1 (August 2007), 59-73.</p></div></section>
    </div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">Â© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Analog Input Using SPI</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../data-import-and-analysis.html",
          "name": "Data Import and Analysis"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../data-import-and-export.html",
          "name": "Data Import and Export"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../hardware-network-comm.html",
          "name": "Hardware and Network Communication"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 5,

          "item": {
          "@id": "../hardware-boards-and-kits.html",
          "name": "Hardware Boards and Kits"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 6,

          "item": {
          "@id": "../beagleboneio.html",
          "name": "BeagleBone Black"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 7,

          "item": {
          "@id": "../beagleboneiospi-interface.html",
          "name": "SPI Interface"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "beagleboneiospi-interface"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Analog Input Using SPI",
          "description": "Use the SPI peripheral on BeagleBone Black&#174; hardware to connect to an MCP3008 10-bit 8-channel ADC.",
          "thumbnailURL": "../../examples/beagleboneio/win64/bbb_spi.png",
          "genre": "Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "identifier": "beagleboneio.AnalogInputUsingSPIExample",
          "name": "AnalogInputUsingSPIExample",
          "url": "beagleboneio-reading-analog-input-using-spi.html"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": ""

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "AnalogInputUsingSPIExample.m",
        "bbb_spi.png",
        "spi_diagram.png",
        "mcp3008.png"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="fe">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ex">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This example shows you how to use the SPI peripheral on BeagleBone Black&#174; hardware to connect to an MCP3008 10-bit 8-channel ADC."><meta xmlns="http://www.w3.org/1999/xhtml" content="../../examples/beagleboneio/win64/bbb_spi.png" itemprop="thumbnailUrl">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../data-import-and-analysis.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Data Import and Analysis</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../data-import-and-export.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Data Import and Export</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../hardware-network-comm.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Hardware and Network Communication</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../hardware-boards-and-kits.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Hardware Boards and Kits</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../beagleboneio.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">BeagleBone Black</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../beagleboneiospi-interface.html?s_tid=CRUX_lftnav" itemprop="url" id="mw_a80f48b2-dac2-4868-888a-7c3d29399080"><span itemprop="title">SPI Interface</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item"><a href="#responsive_offcanvas">Analog Input Using SPI</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#d126e141249" class="nav-link intrnllnk">Introduction</a></li><li class="nav-item"><a href="#d126e141254" class="nav-link intrnllnk">Prerequisites</a></li><li class="nav-item"><a href="#d126e141264" class="nav-link intrnllnk">Required Hardware</a></li><li class="nav-item"><a href="#d126e141278" class="nav-link intrnllnk">Overview of SPI</a></li><li class="nav-item"><a href="#d126e141299" class="nav-link intrnllnk">Enable SPI Peripheral</a></li><li class="nav-item"><a href="#d126e141305" class="nav-link intrnllnk">Overview of MCP3008</a></li><li class="nav-item"><a href="#d126e141347" class="nav-link intrnllnk">Connect MCP3008</a></li><li class="nav-item"><a href="#d126e141360" class="nav-link intrnllnk">Measure Voltage at CH0</a></li><li class="nav-item"><a href="#d126e141365" class="nav-link intrnllnk">Read Voltage</a></li><li class="nav-item"><a href="#d126e141376" class="nav-link intrnllnk">Advanced: Create a MATLAB Class for MCP3008</a></li><li class="nav-item"><a href="#d126e141383" class="nav-link intrnllnk">Summary</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=beagleboneiospi-interface&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=beagleboneiospi-interface&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=beagleboneiospi-interface&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=beagleboneiospi-interface&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=beagleboneiospi-interface&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=beagleboneiospi-interface&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-example">
<section><div class="example_icon"></div><h1 class="r2025b" itemprop="title content" id="example-beagleboneio_spi">Analog Input Using SPI</h1><div class="examples_short_list hidden_ios_android" data-products="ML ML_BEAGLEBONE_BLACK_IO"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><p class="add_margin_5">This example uses:</p><ul class="list-unstyled add_border_bottom example_product_list" itemprop="requiredprods"><li><a href="matlab:matlab.internal.addons.showAddon('ML_BEAGLEBONE_BLACK_IO')">MATLAB Support Package for BeagleBone Black Hardware</a></li></ul></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="beagleboneio-AnalogInputUsingSPIExample"><meta itemprop="exampletitle" content="Analog Input Using SPI"></div><span id="AnalogInputUsingSPIExample" class="anchor_target"></span>



<p class="shortdesc">This example shows you how to use the SPI peripheral on BeagleBone Black&#174; hardware to connect to an MCP3008 10-bit 8-channel ADC.</p>




<div class="procedure"><h3 class="title" id="d126e141249">Introduction<span id="AnalogInputUsingSPIExample-1" class="anchor_target"></span></h3><p>The Serial Peripheral Interface (SPI) is a very common device communication interface. BeagleBone Black hardware has SPI interface available on the expansion headers. In this example, you interface an ADC chip to BeagleBone Black hardware using the SPI peripheral.</p><h3 class="title" id="d126e141254">Prerequisites<span id="AnalogInputUsingSPIExample-2" class="anchor_target"></span></h3><div class="itemizedlist"><ul><li><p>It is helpful if you complete the <a href="getting-started-with-matlab-support-package-for-beaglebone-black-hardware.html" data-docid="mlsupportpkg#example-beagleboneio_gettingstarted" class="a">Getting Started with MATLAB Support Package for BeagleBone Black Hardware</a> example.</p></li></ul></div><h3 class="title" id="d126e141264">Required Hardware<span id="AnalogInputUsingSPIExample-3" class="anchor_target"></span></h3><p>To run this example you need the following hardware:</p><div class="itemizedlist"><ul><li><p>BeagleBone Black hardware</p></li><li><p>Breadboard and jumper cables</p></li><li><p>MCP3008 ADC</p></li><li><p>10 kOhm Potentiometer</p></li></ul></div><h3 class="title" id="d126e141278">Overview of SPI<span id="AnalogInputUsingSPIExample-4" class="anchor_target"></span></h3><p>The Serial Peripheral Interface (SPI) is a synchronous serial data link that you use to interface one or more peripheral devices to a single controller SPI device. SPI uses three signal lines common to all peripherals:</p><div class="itemizedlist"><ul><li><p>Serial Data In (SDI). Data is moved from peripheral to controller on this wire.</p></li><li><p>Serial Data Out (SDO). Data is moved from controller to peripheral on this wire.</p></li><li><p>Serial clock (SCLK). The controller SPI device generates this clock.</p></li></ul></div><p>Each peripheral is wired to an individual chip-select or peripheral-transmit enable line. During SPI communication, controller selects only one peripheral device at a time. Any other peripheral on the bus that has not been activated using its chip-select line must disregard the input clock and MOSI signals. It also must not drive the MISO line.</p><p>
</p>
<div class="informalfigure"><div id="d126e141294" class="mediaobject"><p><img src="../../examples/beagleboneio/win64/xxspi_diagram.png"></p></div></div><p>
 </p><p>SPI communications are full duplex. When the controller sends a bit on the MOSI line, the peripheral reads the bit and at the same time sends a bit on the MISO line that is in turn read by the controller. Therefore, to read from a peripheral device, you must write to it.</p><h3 class="title" id="d126e141299">Enable SPI Peripheral<span id="AnalogInputUsingSPIExample-5" class="anchor_target"></span></h3><p>There are 2 SPI buses available on BeagleBone Black hardware: SPI0 and SPI1. Use showAllPins method to determine the pins on the P8 / P9 expansion header the SPI peripheral is mapped to. Use enableSPI method to enable SPI0. After enabling SPI0, view AvailableSPIChannels property of the beaglebone object to verify that you see new SPI channels:</p><div class="code_responsive"><pre class="programlisting">clear bbb
bbb = beaglebone;
enableSPI(bbb, 0)
bbb.AvailableSPIChannels</pre></div><h3 class="title" id="d126e141305">Overview of MCP3008<span id="AnalogInputUsingSPIExample-6" class="anchor_target"></span></h3><p>MCP3008 is a 10-bit, 8-channel analog to digital converter (ADC) with an SPI interface.</p><p>
</p>
<div class="informalfigure"><div id="d126e141313" class="mediaobject"><p><img src="../../examples/beagleboneio/win64/xxmcp3008.png"></p></div></div><p>
 </p><p>As seen in this diagram, pins 1 through 8 are analog input channels. Pin 16 is the digital supply voltage and pin 9 is the digital ground. <span class="inlineequation"><span class="inlinemediaobject"><img src="../../examples/beagleboneio/win64/AnalogInputUsingSPIExample_eq10274564957467483355.png" alt="$V_{ref}$"></span></span> and <span class="inlineequation"><span class="inlinemediaobject"><img src="../../examples/beagleboneio/win64/AnalogInputUsingSPIExample_eq05309204497996043296.png" alt="$A_{GND}$"></span></span> are the pins used for reference voltage level for analog measurements. The digital 10-bit voltage measurement value is scaled so that a value of 0 corresponds to <span class="inlineequation"><span class="inlinemediaobject"><img src="../../examples/beagleboneio/win64/AnalogInputUsingSPIExample_eq05309204497996043296.png" alt="$A_{GND}$"></span></span> and a value of 1023 (2^10 - 1) corresponding to <span class="inlineequation"><span class="inlinemediaobject"><img src="../../examples/beagleboneio/win64/AnalogInputUsingSPIExample_eq10814286794362856379.png" alt="$V_{REF}$"></span></span>. Pins 10 through 13 are connections for SPI interface.</p><h3 class="title" id="d126e141347">Connect MCP3008<span id="AnalogInputUsingSPIExample-7" class="anchor_target"></span></h3><p>Connect MCP3008 to the BeagleBone Black hardware as seen in the following circuit diagram. To simulate a variable voltage applied to CH0, use a 10 kOhm potentiometer connected to CH0.</p><p>
</p>
<div class="informalfigure"><div id="d126e141355" class="mediaobject"><p><img src="../../examples/beagleboneio/win64/xxbbb_spi.png"></p></div></div><p>
 </p><p>In this example, the potentiometer (POT) is a three-terminal device with terminals 1 and 3 comprising the end points of a resistor embedded in the POT. The second terminal is connected to a variable wiper. As the wiper moves, the resistance across terminals 1 and 2 and terminals 2 and 3 changes. In this circuit, POT acts as a variable voltage divider. As you move the knob of the potentiometer, the voltage seen at terminal 2 changes between 3.3 Volts and 0 volts.</p><h3 class="title" id="d126e141360">Measure Voltage at CH0<span id="AnalogInputUsingSPIExample-8" class="anchor_target"></span></h3><p>MCP3008 uses the SPI interface to communicate with the SPI controller which in this case is BeagleBone Black hardware. An SPI transaction between MCP3008 and BeagleBone Black consist of 3 bytes. BeagleBone Black hardware sends a byte containing a value of '1' to MCP3008. At the same time, MCP3008 sends a do not care byte to BeagleBone Black hardware. BeagleBone Black hardware sends another byte to the MCP3008 with the most significant 4 bits containing a value of '1000'. This byte indicates to the MCP3008 that a single-ended voltage measurement at CH0 is requested. At the same time, MCP3008 sends the bits 9 and 10 of the ADC measurement. Finally, BeagleBone Black hardware sends a do not care byte and at the same time reads the least significant 8 bits of the voltage measurement. The 10-bit value read from MCP3008 is then converted to a voltage value.</p><h3 class="title" id="d126e141365">Read Voltage<span id="AnalogInputUsingSPIExample-9" class="anchor_target"></span></h3><p>To read the voltage value from MCP3008, first create an spidev object connected to SPI channel 'spidev1.0'. Perform the SPI transaction as previously described.</p><div class="code_responsive"><pre class="programlisting">clear mcp3008
mcp3008 = spidev(bbb, 'spidev1.0');
data = uint16(writeRead(mcp3008,[1, bin2dec('10000000'), 0]));
highbits = bitand(data(2), bin2dec('11'));
voltage = double(bitor(bitshift(highbits, 8), data(3)));
voltage = (3.3/1024) * voltage;</pre></div><p>The variable <strong class="emphasis bold">voltage</strong> holds the voltage value read from the CH0 pin of the MCP3008. You can substitute various analog sensors, such as a TMP36 temperature sensor, in place of the POT in this circuit.</p><h3 class="title" id="d126e141376">Advanced: Create a MATLAB Class for MCP3008<span id="AnalogInputUsingSPIExample-10" class="anchor_target"></span></h3><p>You can create a MATLAB&#174; class for MCP3008 that makes it easy to use this device from MATLAB command-line interface. You can condense the steps in this example using this MATLAB class.</p><div class="code_responsive"><pre class="programlisting">clear mcp3008
mcp3008 = beaglebone.mcp3008(bbb, 'spidev1.0');
for i = 1:20
    voltage = readVoltage(mcp3008, 0);
    fprintf('Voltage = %0.2f\n', voltage);
    pause(0.2);
end</pre></div><p>Experiment with the POT knob while executing the preceding loop. You see that the voltage value printed on the MATLAB prompt changes.</p><h3 class="title" id="d126e141383">Summary<span id="AnalogInputUsingSPIExample-11" class="anchor_target"></span></h3><p>This example introduced the workflow for working with the SPI interface. You learned how to use MCP3008 ADC to read analog input voltages.</p></div></section>
    </div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">Â© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

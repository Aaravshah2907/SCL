<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Optimization Solver Output Functions</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../optimization.html",
          "name": "Optimization"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "optimization"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="ug">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ex">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="Describes how to monitor or halt solvers."><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../optimization.html?s_tid=CRUX_lftnav" itemprop="url" id="optimization"><span itemprop="title">Optimization</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item"><a href="#responsive_offcanvas">Optimization Solver Output Functions</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#bsgue2z" class="nav-link intrnllnk">What Is an Output Function?</a></li><li class="nav-item"><a href="#bsgpq6p-25" class="nav-link intrnllnk">Creating and Using an Output Function</a></li><li class="nav-item"><a href="#bsgpq6q-30" class="nav-link intrnllnk">Structure of the Output Function</a></li><li class="nav-item"><a href="#bsgpq6q-31" class="nav-link intrnllnk">Example of a Nested Output Function</a></li><li class="nav-item"><a href="#bsgpq6q-37" class="nav-link intrnllnk">Fields in optimValues</a></li><li class="nav-item"><a href="#bsgpq6q-38" class="nav-link intrnllnk">States of the Algorithm</a></li><li class="nav-item"><a href="#bsgpq6q-39" class="nav-link intrnllnk">Stop Flag</a><ul class="nav"><li class="nav-item"><a href="#bsgpq6q-40" class="nav-link intrnllnk">Stopping an Optimization Based on Data in optimValues</a></li><li class="nav-item"><a href="#bsgpq6q-41" class="nav-link intrnllnk">Stopping an Optimization Based on Dialog Box Input</a></li></ul></li><li class="nav-item"><a href="#seealsoref" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=optimization&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=optimization&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=optimization&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=optimization&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=optimization&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=optimization&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-topic">
<section><h2 class="title r2025b" itemprop="title content" id="bsgpq6p-23">Optimization Solver Output Functions</h2><a class="indexterm" name="d126e25956"></a><span id="output_function" class="anchor_target"></span><section><h3 class="title" id="bsgue2z">What Is an Output Function?</h3><p>An <em class="firstterm">output function</em> is a function that
an optimization function calls at each iteration of its algorithm.
Typically, you use an output function to generate graphical output,
record the history of the data the algorithm generates, or halt the
algorithm based on the data at the current iteration. You can create
an output function as a function file, a local function, or a nested
function.</p><p>You can use the <code class="literal">OutputFcn</code> option with the
following MATLAB<sup>&#x00AE;</sup> optimization functions:</p><div class="itemizedlist"><ul><li><p><a href="../ref/fminbnd.html"><code class="function">fminbnd</code></a></p></li><li><p><a href="../ref/fminsearch.html"><code class="function">fminsearch</code></a></p></li><li><p><a href="../ref/fzero.html"><code class="function">fzero</code></a></p></li></ul></div></section><section><h3 class="title" id="bsgpq6p-25">Creating and Using an Output Function</h3><p>The following is a simple example of an output function that
plots the points generated by an optimization function.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> stop = outfun(x, optimValues, state)
stop = false;
hold <span style="color:#A020F0">on</span>;
plot(x(1),x(2),<span style="color:#A020F0">'.'</span>);
drawnow</pre></div></div></div><p>You can use this output function to plot the points generated
by <code class="literal">fminsearch</code> in solving the optimization problem</p><div id="d126e25996" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-15px" display="block"><mrow><munder><mrow><mi>min</mi></mrow><mi>x</mi></munder><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><munder><mrow><mi>min</mi></mrow><mi>x</mi></munder><msup><mi>e</mi><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow></msup><mrow><mo>(</mo><mrow><mn>4</mn><msubsup><mi>x</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><mn>2</mn><msubsup><mi>x</mi><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msub><mi>x</mi><mn>1</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mn>2</mn><msub><mi>x</mi><mn>2</mn></msub></mrow><mo>)</mo></mrow><mo>.</mo></mrow></math></p></div></div><p>To do so,</p><div class="procedure"><span id="bsgpq6q-26" class="anchor_target"></span><ol type="1"><li><p id="bsgpq6q-27">Create a file containing the preceding
code and save it as <code class="literal">outfun.m</code> in a folder on the MATLAB path.</p></li><li><p id="bsgpq6q-28">Set the value of the <code class="literal">Outputfcn</code> field
of the <code class="literal">options</code> structure to a function handle to <code class="literal">outfun</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>options = optimset(<span style="color:#A020F0">'OutputFcn'</span>, @outfun);</pre></div></div></div></li><li><p id="bsgpq6q-29">Enter the following commands:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>hold <span style="color:#A020F0">on</span>
objfun=@(x) exp(x(1))*(4*x(1)^2+2*x(2)^2+x(1)*x(2)+2*x(2));
[x fval] = fminsearch(objfun, [-1 1], options)
hold <span style="color:#A020F0">off</span></pre></div></div></div><p>These commands return the solution</p><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>x =
    0.1290   -0.5323

fval =
   -0.5689</pre></div></div></div><p>and display the following plot of the points generated by <code class="literal">fminsearch</code>:</p><div class="informalfigure"><div id="d126e26033" class="mediaobject"><p><img src="my_plot.gif" alt="Plot of x(1) vs. x(2)." height="377" width="482"></p></div></div></li></ol></div></section><section><h3 class="title" id="bsgpq6q-30">Structure of the Output Function<span id="matlab_math_outputfcn" class="anchor_target"></span></h3><p>The function definition line of the output function has the
following form:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>stop = outfun(x, optimValues, state)</pre></div></div></div><p>where</p><div class="itemizedlist"><ul><li><p><code class="literal">stop</code> is a flag that is <code class="literal">true</code> or <code class="literal">false</code> depending
on whether the optimization routine halts or continues. See <a href="output-functions.html#bsgpq6q-39" class="intrnllnk">Stop Flag</a>.</p></li><li><p><code class="literal">x</code> is the point computed by the
algorithm at the current iteration.</p></li><li><p><code class="literal">optimValues</code> is a structure containing
data from the current iteration. <a href="output-functions.html#bsgpq6q-37" class="intrnllnk">Fields in optimValues</a> describes the structure in detail.</p></li><li><p><code class="literal">state</code> is the current state of the
algorithm. <a href="output-functions.html#bsgpq6q-38" class="intrnllnk">States of the Algorithm</a> lists
the possible values.</p></li></ul></div><p>The optimization function passes the values of the input arguments
to <code class="literal">outfun</code> at each iteration.</p></section><section><h3 class="title" id="bsgpq6q-31">Example of a Nested Output Function</h3><p>The example in <a href="output-functions.html#bsgpq6p-25" class="intrnllnk">Creating and Using an Output Function</a> does not require the
output function to preserve data from one iteration to the next. When
you do not need to save data between iterations, you can write the
output function as a function file and call the optimization function
directly from the command line. However, to have an output function
to record data from one iteration to the next, write a single file
that does the following:</p><div class="itemizedlist"><ul><li><p>Contains the output function as a nested function&#8212;see <a href="../matlab_prog/nested-functions.html" class="a">Nested Functions</a> in MATLAB Programming
Fundamentals for more information.</p></li><li><p>Calls the optimization function.</p></li></ul></div><p>In the following example, the function file also contains the
objective function as a local function. You can instead write the
objective function as a separate file or as an anonymous function.</p><p>Nested functions have access to variables in the surrounding
file. Therefore, this method enables the output function to preserve
variables from one iteration to the next.</p><p>The following example uses an output function to record the <code class="literal">fminsearch</code> iterates
in solving</p><div id="d126e26100" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-15px" display="block"><mrow><munder><mrow><mi>min</mi></mrow><mi>x</mi></munder><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><munder><mrow><mi>min</mi></mrow><mi>x</mi></munder><msup><mi>e</mi><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow></msup><mrow><mo>(</mo><mrow><mn>4</mn><msubsup><mi>x</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><mn>2</mn><msubsup><mi>x</mi><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msub><mi>x</mi><mn>1</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mn>2</mn><msub><mi>x</mi><mn>2</mn></msub></mrow><mo>)</mo></mrow><mo>.</mo></mrow></math></p></div></div><p>The output function returns the sequence of points as a matrix
called <code class="literal">history</code>. </p><p>To run the example, do the following steps:</p><div class="procedure"><span id="bsgpq6q-32" class="anchor_target"></span><ol type="1"><li><p id="bsgpq6q-33">Open a new file in the MATLAB Editor.</p></li><li><p id="bsgpq6q-34">Copy and paste the following code into
the file.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> [x fval history] = myproblem(x0)
    history = [];
    options = optimset(<span style="color:#A020F0">'OutputFcn'</span>, @myoutput);
    [x fval] = fminsearch(@objfun, x0,options);
        
    <span style="color:#0000FF">function</span> stop = myoutput(x,optimvalues,state);
        stop = false;
        <span style="color:#0000FF">if</span> isequal(state,<span style="color:#A020F0">'iter'</span>)
          history = [history; x];
        <span style="color:#0000FF">end</span>
    <span style="color:#0000FF">end</span>
    
    <span style="color:#0000FF">function</span> z = objfun(x)
      z = exp(x(1))*(4*x(1)^2+2*x(2)^2+x(1)*x(2)+2*x(2));
    <span style="color:#0000FF">end</span>
<span style="color:#0000FF">end</span></pre></div></div></div></li><li><p id="bsgpq6q-35">Save the file as <code class="literal">myproblem.m</code> in
a folder on the MATLAB path.</p></li><li><p id="bsgpq6q-36">At the MATLAB prompt, enter</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[x fval history] = myproblem([-1 1]);</pre></div></div></div></li></ol></div><p>The function <code class="function">fminsearch</code> returns <code class="literal">x</code>,
the optimal point, and <code class="literal">fval</code>, the value of the objective
function at x.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>x,fval
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>x =
    0.1290   -0.5323

fval =
   -0.5689</pre></div></div></div><p>In addition, the output function <code class="function">myoutput</code> returns
the matrix <code class="literal">history</code>, which contains the points generated
by the algorithm at each iteration, to the MATLAB workspace.
The first four rows of <code class="literal">history</code> are</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>history(1:4,:)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans =

   -1.0000    1.0000
   -1.0000    1.0000
   -1.0750    0.9000
   -1.0125    0.8500</pre></div></div></div><p>The final row of points in <code class="literal">history</code> is the
same as the optimal point, <code class="literal">x</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>history(end,:)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans =

    0.1290   -0.5323</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>objfun(history(end,:))</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans =

   -0.5689</pre></div></div></div></section><section><h3 class="title" id="bsgpq6q-37">Fields in optimValues</h3><p>The following table lists the fields of the <code class="literal">optimValues</code> structure
that are provided by the optimization functions <a href="../ref/fminbnd.html"><code class="function">fminbnd</code></a>, <a href="../ref/fminsearch.html"><code class="function">fminsearch</code></a>,
and <a href="../ref/fzero.html"><code class="function">fzero</code></a>.</p><p> The “Command-Line Display Headings” column of
the table lists the headings that appear when you set the <code class="literal">Display</code> parameter
of <code class="literal">options</code> to <code class="literal">'iter'</code>.</p><div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="33%"><col class="tcol2" width="33%"><col class="tcol3" width="33%"></colgroup><thead><tr><th><p>optimValues Field (optimValues.field)</p></th><th><p>Description</p></th><th><p>Command-Line Display
Heading</p></th></tr></thead><tbody><tr><td><p><code class="literal">funccount</code></p></td><td><p>Cumulative number of function evaluations</p></td><td><p><code class="literal">Func-count</code></p> </td></tr><tr><td><p><code class="literal">fval</code></p></td><td><p>Function value at current point</p></td><td><p><code class="literal">min f(x)</code></p> </td></tr><tr><td><p><code class="literal">iteration</code></p></td><td><p>Iteration number &#8212; starts at <code class="literal">0</code></p></td><td><p><code class="literal">Iteration</code></p> </td></tr><tr><td><p><code class="literal">procedure</code></p></td><td><p>Procedure messages</p></td><td><p><code class="literal">Procedure</code></p> </td></tr></tbody></table></div></section><section><h3 class="title" id="bsgpq6q-38">States of the Algorithm</h3><p>The following table lists the possible values for <code class="literal">state</code>:</p><div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="38%"><col class="tcol2" width="63%"></colgroup><thead><tr><th><p>State</p></th><th><p>Description</p></th></tr></thead><tbody><tr><td><p><code class="literal">'init'</code></p></td><td><p>The algorithm is in the initial state before the first
iteration.</p></td></tr><tr><td><p><code class="literal">'interrupt'</code></p></td><td><p>The algorithm is performing an iteration. In this state,
the output function can halt the current iteration of the optimization.
You might want the output function to halt the iteration to improve
the efficiency of the computations. When state is set to <code class="literal">'interrupt'</code>,
the values of <code class="literal">x</code> and <code class="literal">optimValues</code> are
the same as at the last call to the output function, in which <code class="literal">state</code> is
set to <code class="literal">'iter'</code>.</p></td></tr><tr><td><p><code class="literal">'iter'</code></p></td><td><p>The algorithm is at the end of an iteration.</p></td></tr><tr><td><p><code class="literal">'done'</code></p></td><td><p>The algorithm is in the final state after the last iteration.</p></td></tr></tbody></table></div><p>The following code illustrates how the output function uses
the value of <code class="literal">state</code> to decide which tasks to perform
at the current iteration. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">switch</span> state
    <span style="color:#0000FF">case</span> <span style="color:#A020F0">'init'</span>
          <span style="color:#228B22">% Setup for plots or dialog boxes</span>
    <span style="color:#0000FF">case</span> <span style="color:#A020F0">'iter'</span>
          <span style="color:#228B22">% Make updates to plots or dialog boxes as needed</span>
    <span style="color:#0000FF">case</span> <span style="color:#A020F0">'interrupt'</span>
          <span style="color:#228B22">% Check conditions to see whether optimization </span>
          <span style="color:#228B22">% should quit</span>
    <span style="color:#0000FF">case</span> <span style="color:#A020F0">'done'</span>
          <span style="color:#228B22">% Cleanup of plots, dialog boxes, or final plot</span>
<span style="color:#0000FF">end</span></pre></div></div></div></section><section><h3 class="title" id="bsgpq6q-39">Stop Flag</h3><p>The output argument <code class="literal">stop</code> is a flag that is <code class="literal">true</code> or <code class="literal">false</code>.
The flag tells the optimization function whether the optimization
halts (<code class="literal">true</code>) or continues (<code class="literal">false</code>).
The following examples show typical ways to use the <code class="literal">stop</code> flag. </p><section><h4 class="title" id="bsgpq6q-40">Stopping an Optimization Based on Data in optimValues</h4><p>The output function can stop an optimization at any iteration
based on the current data in <code class="literal">optimValues</code>. For example,
the following code sets <code class="literal">stop</code> to <code class="literal">true</code> if
the objective function value is less than <code class="literal">5</code>:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> stop = myoutput(x, optimValues, state)
stop = false;
<span style="color:#228B22">% Check if objective function is less than 5.</span>
<span style="color:#0000FF">if</span> optimValues.fval &lt; 5
    stop = true;
<span style="color:#0000FF">end</span></pre></div></div></div></section><section><h4 class="title" id="bsgpq6q-41">Stopping an Optimization Based on Dialog Box Input</h4><p>If you design a UI to perform optimizations, you can have the
output function stop an optimization with, for example, a <strong class="guibutton">Stop</strong> button.
The following code shows how to do this callback. The code assumes
that the <strong class="guibutton">Stop</strong> button callback stores the value <code class="literal">true</code> in
the <code class="literal">optimstop</code> field of a <code class="literal">handles</code> structure
called <code class="literal">hObject</code> stored in <code class="literal">appdata</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> stop = myoutput(x, optimValues, state)
stop = false;
<span style="color:#228B22">% Check if user has requested to stop the optimization.</span>
stop = getappdata(hObject,<span style="color:#A020F0">'optimstop'</span>);</pre></div></div></div></section></section>
<h2 id="seealsoref">See Also</h2><h3 id="d126e26370">Topics</h3><ul class="list-unstyled"><li><a href="plot-functions.html" class="a">Optimization Solver Plot Functions</a></li><li><a href="setting-options.html" class="a">Set Optimization Options</a></li><li><a href="iterative-display.html" class="a">Optimization Solver Iterative Display</a></li></ul>
</section>
    </div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

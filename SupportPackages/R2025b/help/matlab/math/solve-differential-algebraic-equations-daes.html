<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Solve Differential Algebraic Equations (DAEs)</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../numerical-integration-and-differential-equations.html",
          "name": "Numerical Integration and Differential Equations"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../ordinary-differential-equations.html",
          "name": "Ordinary Differential Equations"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "ordinary-differential-equations"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="ug">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ex">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="Solve ODEs with a singular mass matrix."><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../numerical-integration-and-differential-equations.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Numerical Integration and Differential Equations</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../ordinary-differential-equations.html?s_tid=CRUX_lftnav" itemprop="url" id="ordinary-differential-equations"><span itemprop="title">Ordinary Differential Equations</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item"><a href="#responsive_offcanvas">Solve Differential Algebraic Equations (DAEs)</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#bu75a7z-2" class="nav-link intrnllnk">What is a Differential Algebraic Equation?</a></li><li class="nav-item"><a href="#bu75a7z-3" class="nav-link intrnllnk">Consistent Initial Conditions</a></li><li class="nav-item"><a href="#bu75a7z-4" class="nav-link intrnllnk">Differential Index</a></li><li class="nav-item"><a href="#mw_e5a3b36e-e3a0-4ac5-a43e-058fde3b7ddc" class="nav-link intrnllnk">Imposing Nonnegativity</a></li><li class="nav-item"><a href="#bu75a7z-5" class="nav-link intrnllnk">Solve Robertson Problem as Semi-Explicit Differential Algebraic Equations (DAEs)</a></li><li><a href="#References" class="intrnllnk">References</a></li><li class="nav-item"><a href="#d126e31814" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-topic">
<section><h2 class="title r2025b" itemprop="title content" id="bu75a7z-1">Solve Differential Algebraic Equations (DAEs)</h2><section><h3 class="title" id="bu75a7z-2">What is a Differential Algebraic Equation?</h3><p>Differential algebraic equations are a type of differential
equation where one or more derivatives of dependent variables are
not present in the equations. Variables that appear in the equations
without their derivative are called <span class="emphasis"><em>algebraic</em></span>,
and the presence of algebraic variables means that you cannot write
down the equations in the explicit form <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><mi>y</mi><mo>'</mo><mo>=</mo><mi>f</mi><mrow><mo>(</mo><mrow><mi>t</mi><mo>,</mo><mi>y</mi></mrow><mo>)</mo></mrow></mrow></math></span></span>.
Instead, you can solve DAEs with these forms:</p><div class="itemizedlist"><ul><li><p>The <a href="../ref/ode15s.html"><code class="function">ode15s</code></a> and <a href="../ref/ode23t.html"><code class="function">ode23t</code></a> solvers can solve index-1 linearly
implicit problems with a singular mass matrix <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><mi>M</mi><mrow><mo>(</mo><mrow><mi>t</mi><mo>,</mo><mi>y</mi></mrow><mo>)</mo></mrow><mi>y</mi><mo>'</mo><mo>=</mo><mi>f</mi><mrow><mo>(</mo><mrow><mi>t</mi><mo>,</mo><mi>y</mi></mrow><mo>)</mo></mrow></mrow></math></span></span>,
including semi-explicit DAEs of the form</p><div id="d126e31400" class="mediaobject"><div class="code_responsive"><p class="listprogramlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-20px" display="block"><mtable><mtr><mtd><mi>y</mi><mo>'</mo><mo>=</mo><mi>f</mi><mrow><mo>(</mo><mrow><mi>t</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mn>0</mn><mo>=</mo><mi>g</mi><mrow><mo>(</mo><mrow><mi>t</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></mrow><mo>)</mo></mrow><mtext> </mtext><mo>.</mo></mtd></mtr></mtable></math></p></div></div><p>In this form, the presence of algebraic variables leads to a
singular mass matrix, since there are one or more zeros on the main
diagonal.</p><div id="d126e31405" class="mediaobject"><div class="code_responsive"><p class="listprogramlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-37px" display="block"><mrow><mi>M</mi><mi>y</mi><mo>'</mo><mo>=</mo><mrow><mo>(</mo><mrow><mtable><mtr><mtd><mrow><mi>y</mi><msub><mo>'</mo><mn>1</mn></msub></mrow></mtd><mtd><mn>0</mn></mtd><mtd><mo>&#x22EF;</mo></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mrow><mi>y</mi><msub><mo>'</mo><mn>2</mn></msub></mrow></mtd><mtd><mn>0</mn></mtd><mtd><mo>&#x22EE;</mo></mtd></mtr><mtr><mtd><mo>&#x22EE;</mo></mtd><mtd><mn>0</mn></mtd><mtd><mo>⋱</mo></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mo>&#x22EF;</mo></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable></mrow><mo>)</mo></mrow><mtext> </mtext><mo>.</mo></mrow></math></p></div></div><p>By default, solvers automatically test the singularity of the
mass matrix to detect DAE systems. If you know about singularity ahead
of time then you can set the <code class="literal">MassSingular</code> option
of <code class="function">odeset</code> to <code class="literal">'yes'</code>. With DAEs,
you can also provide the solver with a guess of the initial conditions
for <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-7px" display="block"><mrow><mi>y</mi><msub><mo>'</mo><mn>0</mn></msub></mrow></math></span></span> using
the <code class="literal">InitialSlope</code> property of <code class="literal">odeset</code>.
This is in addition to specifying the usual initial conditions for <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-7px" display="block"><mrow><msub><mi>y</mi><mn>0</mn></msub></mrow></math></span></span> in
the call to the solver.</p></li><li><p>The <a href="../ref/ode15i.html"><code class="function">ode15i</code></a> solver
can solve more general DAEs in the fully implicit form </p><div id="d126e31438" class="mediaobject"><div class="code_responsive"><p class="listprogramlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><mi>f</mi><mrow><mo>(</mo><mrow><mi>t</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>'</mo></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn><mtext> </mtext><mo>.</mo></mrow></math></p></div></div><p>In the fully implicit form, the presence of algebraic variables
leads to a singular Jacobian matrix. This is because at least one
of the columns in the matrix is guaranteed to contain all zeros, since
the derivative of that variable does not appear in the equations.</p><div id="d126e31443" class="mediaobject"><div class="code_responsive"><p class="listprogramlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-48px" display="block"><mrow><mi>J</mi><mo>=</mo><mo>∂</mo><mi>f</mi><mo>/</mo><mo>∂</mo><mi>y</mi><mo>'</mo><mo>=</mo><mrow><mo>(</mo><mrow><mtable><mtr><mtd><mrow><mfrac><mrow><mo>∂</mo><msub><mi>f</mi><mn>1</mn></msub></mrow><mrow><mo>∂</mo><mi>y</mi><msub><mo>'</mo><mn>1</mn></msub></mrow></mfrac></mrow></mtd><mtd><mo>&#x22EF;</mo></mtd><mtd><mrow><mfrac><mrow><mo>∂</mo><msub><mi>f</mi><mn>1</mn></msub></mrow><mrow><mo>∂</mo><mi>y</mi><msub><mo>'</mo><mi>n</mi></msub></mrow></mfrac></mrow></mtd></mtr><mtr><mtd><mo>&#x22EE;</mo></mtd><mtd><mo>⋱</mo></mtd><mtd><mo>&#x22EE;</mo></mtd></mtr><mtr><mtd><mrow><mfrac><mrow><mo>∂</mo><msub><mi>f</mi><mi>m</mi></msub></mrow><mrow><mo>∂</mo><mi>y</mi><msub><mo>'</mo><mn>1</mn></msub></mrow></mfrac></mrow></mtd><mtd><mo>&#x22EF;</mo></mtd><mtd><mrow><mfrac><mrow><mo>∂</mo><msub><mi>f</mi><mi>m</mi></msub></mrow><mrow><mo>∂</mo><mi>y</mi><msub><mo>'</mo><mi>n</mi></msub></mrow></mfrac></mrow></mtd></mtr></mtable></mrow><mo>)</mo></mrow></mrow></math></p></div></div><p>The <code class="function">ode15i</code> solver requires that you specify
initial conditions for both <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-7px" display="block"><mrow><mi>y</mi><msub><mo>'</mo><mn>0</mn></msub></mrow></math></span></span> and <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-7px" display="block"><mrow><msub><mi>y</mi><mn>0</mn></msub></mrow></math></span></span>.
Also, unlike the other ODE solvers, <code class="function">ode15i</code> requires
the function encoding the equations to accept an extra input: <code class="literal">odefun(t,y,yp)</code>.</p></li></ul></div><p>DAEs arise in a wide variety of systems because physical conservation
laws often have forms like <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-7px" display="block"><mrow><mi>x</mi><mo>+</mo><mi>y</mi><mo>+</mo><mi>z</mi><mo>=</mo><mn>0</mn></mrow></math></span></span>.
If <code class="literal">x</code>, <code class="literal">x'</code>, <code class="literal">y</code>,
and <code class="literal">y'</code> are defined explicitly in the equations,
then this conservation equation is sufficient to solve for <code class="literal">z</code> without
having an expression for <code class="literal">z'</code>.</p></section><section><h3 class="title" id="bu75a7z-3">Consistent Initial Conditions</h3><p>When you are solving a DAE, you can specify initial conditions
for both <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-7px" display="block"><mrow><mi>y</mi><msub><mo>'</mo><mn>0</mn></msub></mrow></math></span></span> and <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-7px" display="block"><mrow><msub><mi>y</mi><mn>0</mn></msub></mrow></math></span></span>.
The <code class="function">ode15i</code> solver requires both initial conditions
to be specified as input arguments. For the <code class="function">ode15s</code> and <code class="function">ode23t</code> solvers,
the initial condition for <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-7px" display="block"><mrow><mi>y</mi><msub><mo>'</mo><mn>0</mn></msub></mrow></math></span></span> is
optional (but can be specified using the <code class="literal">InitialSlope</code> option
of <code class="function">odeset</code>). In both cases, it is possible that
the initial conditions you specify do not agree with the equations
you are trying to solve. Initial conditions that conflict with one
another are called <span class="emphasis"><em>inconsistent</em></span>. The treatment
of the initial conditions varies by solver:</p><div class="itemizedlist"><ul><li><p><code class="function">ode15s</code> and <code class="literal">ode23t</code> &#8212;
If you do not specify an initial condition for <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-7px" display="block"><mrow><mi>y</mi><msub><mo>'</mo><mn>0</mn></msub></mrow></math></span></span>,
then the solver automatically computes consistent initial conditions
based on the initial condition you provide for <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-7px" display="block"><mrow><msub><mi>y</mi><mn>0</mn></msub></mrow></math></span></span>.
If you specify an inconsistent initial condition for <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-7px" display="block"><mrow><mi>y</mi><msub><mo>'</mo><mn>0</mn></msub></mrow></math></span></span>,
then the solver treats the values as guesses, attempts to compute
consistent values close to the guesses, and continues on to solve
the problem.</p></li><li><p><code class="function">ode15i</code> &#8212; The initial conditions
you supply to the solver must be consistent, and <code class="function">ode15i</code> does
not check the supplied values for consistency. The helper function <a href="../ref/decic.html"><code class="function">decic</code></a> computes consistent initial conditions
for this purpose.</p></li></ul></div></section><section><h3 class="title" id="bu75a7z-4">Differential Index</h3><p>DAEs are characterized by their <span class="emphasis"><em>differential index</em></span>,
which is a measure of their singularity. By differentiating equations
you can eliminate algebraic variables, and if you do this enough times
then the equations take the form of a system of explicit ODEs. The
differential index of a system of DAEs is the number of derivatives
you must take to express the system as an equivalent system of explicit
ODEs. Thus, ODEs have a differential index of 0.</p><p>An example of an index-1 DAE is</p><div id="d126e31555" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><mi>y</mi><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow><mo>=</mo><mi>k</mi><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow><mtext> </mtext><mo>.</mo></mrow></math></p></div></div><p>For this equation, you can take a single derivative to obtain
the explicit ODE form</p><div id="d126e31560" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><mi>y</mi><mo>'</mo><mo>=</mo><mi>k</mi><mo>'</mo><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow><mtext> </mtext><mo>.</mo></mrow></math></p></div></div><p>An example of an index-2 DAE is</p><div id="d126e31565" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-19px" display="block"><mtable columnalign="left"><mtr><mtd><mi>y</mi><msub><mo>'</mo><mn>1</mn></msub><mo>=</mo><msub><mi>y</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><mn>0</mn><mo>=</mo><mi>k</mi><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow><mo>−</mo><msub><mi>y</mi><mn>1</mn></msub><mtext> </mtext><mo>.</mo></mtd></mtr></mtable></math></p></div></div><p>These equations require two derivatives to be rewritten in the
explicit ODE form</p><div id="d126e31570" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-20px" display="block"><mtable columnalign="left"><mtr><mtd><mi>y</mi><msub><mo>'</mo><mn>1</mn></msub><mo>=</mo><mi>k</mi><mo>'</mo><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mi>y</mi><msub><mo>'</mo><mn>2</mn></msub><mo>=</mo><mi>k</mi><mo>'</mo><mo>'</mo><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow><mtext> </mtext><mo>.</mo></mtd></mtr></mtable></math></p></div></div><p>The <code class="function">ode15s</code> and <code class="function">ode23t</code> solvers
only solve DAEs of index 1. If the index of your equations is 2 or
higher, then you need to rewrite the equations as an equivalent system
of index-1 DAEs. It is always possible to take derivatives and rewrite
a DAE system as an equivalent system of index-1 DAEs. Be aware that
if you replace algebraic equations with their derivatives, then you
might have removed some constraints. If the equations no longer include
the original constraints, then the numerical solution can drift.</p><p>If you have Symbolic Math Toolbox&#x2122;, then see <a href="../../symbolic/solve-differential-algebraic-equations.html" class="a">Solve Differential Algebraic Equations (DAEs)</a><span role="cross_prod"> (Symbolic Math Toolbox)</span> for more information.</p></section><section><h3 class="title" id="mw_e5a3b36e-e3a0-4ac5-a43e-058fde3b7ddc">Imposing Nonnegativity</h3><p>Most of the options in <a href="summary-of-ode-options.html" class="a"><code class="literal">odeset</code></a> work as
                expected with the DAE solvers <code class="function">ode15s</code>,
                    <code class="function">ode23t</code>, and <code class="function">ode15i</code>. However, one
                notable exception is with the use of the <a href="nonnegative-ode-solution.html" class="a"><code class="literal">NonNegative</code></a> option.
                The <code class="literal">NonNegative</code> option does not support implicit solvers
                    (<code class="function">ode15s</code>, <code class="function">ode23t</code>,
                    <code class="function">ode23tb</code>) applied to problems with a mass matrix. Therefore,
                you cannot use this option to impose nonnegativity constraints on a DAE problem,
                which necessarily has a singular mass matrix. For more details, see <a href="solve-differential-algebraic-equations-daes.html#mw_2225be1b-3b8b-4288-8d73-c0fdf0a644ed" class="intrnllnk">[1]</a>.</p></section><section><h3 class="title" id="bu75a7z-5">Solve Robertson Problem as Semi-Explicit Differential Algebraic Equations (DAEs)</h3><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/SolveDifferentialAlgebraicEquationDAEExample')" data-ex-genre="Script">Open Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Solve Robertson Problem as Semi-Explicit Differential Algebraic Equations (DAEs)",
          "description": "Reformulates a system of ODEs as a system of differential algebraic equations (DAEs). The Robertson problem found in hb1ode.m is a classic test problem for programs that solve stiff ODEs. The system of equations is",
          "thumbnailURL": "../../examples/matlab/win64/SolveDifferentialAlgebraicEquationDAEExample_01.png",
          "genre": "Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "solve-differential-algebraic-equations-daes.html"

        },
          "identifier": "matlab.SolveDifferentialAlgebraicEquationDAEExample",
          "name": "SolveDifferentialAlgebraicEquationDAEExample",
          "url": "solve-differential-algebraic-equations-daes.html#bu75a7z-5"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/SolveDifferentialAlgebraicEquationDAEExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "SolveDifferentialAlgebraicEquationDAEExample.m",
        "robertsdae.m"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-SolveDifferentialAlgebraicEquationDAEExample"><meta itemprop="exampletitle" content="Solve Robertson Problem as SemiExplicit Differential Algebraic Equations (DAEs)"></div><span id="SolveDifferentialAlgebraicEquationDAEExample" class="anchor_target"></span>



<p class="shortdesc">This example reformulates a system of ODEs as a system of differential algebraic equations (DAEs). The Robertson problem found in <a href="matlab:edit('hb1ode')" target="_blank">hb1ode.m</a> is a classic test problem for programs that solve stiff ODEs. The system of equations is</p>


<p>
<span class="inlineequation"><span class="inlinemediaobject"><img src="../../examples/matlab/win64/SolveDifferentialAlgebraicEquationDAEExample_eq01924970541687002238.png" alt="$$\begin{array}{cl} y'_1 &amp;#38;= -0.04y_1 + 10^4 y_2y_3\\ y'_2 &amp;#38;= 0.04y_1 -&amp;#10;10^4 y_2y_3- (3 \times 10^7)y_2^2\\ y'_3 &amp;#38;= (3 \times&amp;#10;10^7)y_2^2.\end{array}$$"></span></span></p>


<p>
<code class="literal">hb1ode</code> solves this system of ODEs to steady state with the initial conditions <span class="inlineequation"><span class="inlinemediaobject"><img src="../../examples/matlab/win64/SolveDifferentialAlgebraicEquationDAEExample_eq07509467344581689500.png" alt="$y_1 = 1$"></span></span>, <span class="inlineequation"><span class="inlinemediaobject"><img src="../../examples/matlab/win64/SolveDifferentialAlgebraicEquationDAEExample_eq09269305329532153692.png" alt="$y_2 = 0$"></span></span>, and <span class="inlineequation"><span class="inlinemediaobject"><img src="../../examples/matlab/win64/SolveDifferentialAlgebraicEquationDAEExample_eq00103485793999704739.png" alt="$y_3 = 0$"></span></span>. But the equations also satisfy a linear conservation law,</p>


<p>
<span class="inlineequation"><span class="inlinemediaobject"><img src="../../examples/matlab/win64/SolveDifferentialAlgebraicEquationDAEExample_eq01245969564575821959.png" alt="$$y'_1 + y'_2 + y'_3 = 0.$$"></span></span></p>


<p>In terms of the solution and initial conditions, the conservation law is</p>


<p>
<span class="inlineequation"><span class="inlinemediaobject"><img src="../../examples/matlab/win64/SolveDifferentialAlgebraicEquationDAEExample_eq13727414271214724426.png" alt="$$y_1 + y_2 + y_3 = 1.$$"></span></span></p>


<p>The system of equations can be rewritten as a system of DAEs by using the conservation law to determine the state of <span class="inlineequation"><span class="inlinemediaobject"><img src="../../examples/matlab/win64/SolveDifferentialAlgebraicEquationDAEExample_eq10388565144142677552.png" alt="$y_3$"></span></span>. This reformulates the problem as the DAE system</p>


<p>
<span class="inlineequation"><span class="inlinemediaobject"><img src="../../examples/matlab/win64/SolveDifferentialAlgebraicEquationDAEExample_eq06781426899143935705.png" alt="$$\begin{array}{cl} y'_1 &amp;#38;= -0.04y_1 + 10^4 y_2y_3\\ y'_2 &amp;#38;= 0.04y_1 -&amp;#10;10^4 y_2y_3-(3 \times 10^7)y_2^2\\ 0 &amp;#38;= y_1 + y_2 + y_3 - 1.\end{array}$$"></span></span></p>


<p>The differential index of this system is 1, since only a single derivative of <span class="inlineequation"><span class="inlinemediaobject"><img src="../../examples/matlab/win64/SolveDifferentialAlgebraicEquationDAEExample_eq10388565144142677552.png" alt="$y_3$"></span></span> is required to make this a system of ODEs. Therefore, no further transformations are required before solving the system.</p>


<p>The function <code class="literal">robertsdae</code> encodes this DAE system. Save <code class="literal">robertsdae.m</code> in your current folder to run the example.</p>


<p><div class="code_responsive"><pre id="d126e31745" class="programlisting">
<span style="color:#0000FF">function</span> out = robertsdae(t,y)
out = [-0.04*y(1) + 1e4*y(2).*y(3)
   0.04*y(1) - 1e4*y(2).*y(3) - 3e7*y(2).^2
   y(1) + y(2) + y(3) - 1 ];

</pre></div></p>


<p>The full example code for this formulation of the Robertson problem is available in <a href="matlab:edit('hb1dae.m')" target="_blank">hb1dae.m</a>.</p>


<div class="procedure"><p>Solve the DAE system using <code class="literal">ode15s</code>. Consistent initial conditions for <code class="literal">y0</code> are obvious based on the conservation law. Use <code class="literal">odeset</code> to set the options:</p><div class="itemizedlist"><ul><li><p>Use a constant mass matrix to represent the left hand side of the system of equations.</p></li></ul></div><p>
<span class="inlineequation"><span class="inlinemediaobject"><img src="../../examples/matlab/win64/SolveDifferentialAlgebraicEquationDAEExample_eq15393950162526114037.png" alt="$$\left( \begin{array}{c} y'_1\\ y'_2\\ 0 \end{array} \right) = M y'&amp;#10;\rightarrow M = \left( \begin{array}{ccc} 1 &amp;#38; 0 &amp;#38; 0\\ 0 &amp;#38; 1 &amp;#38; 0\\ 0 &amp;#38; 0 &amp;#38;&amp;#10;0 \end{array} \right)$$"></span></span></p><div class="itemizedlist"><ul><li><p>Set the relative error tolerance to <code class="literal">1e-4</code>.</p></li><li><p>Use an absolute tolerance of <code class="literal">1e-10</code> for the second solution component, since the scale varies dramatically from the other components.</p></li><li><p>Leave the <code class="literal">'MassSingular'</code> option at its default value <code class="literal">'maybe'</code> to test the automatic detection of a DAE.</p></li></ul></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>y0 = [1; 0; 0];
tspan = [0 4*logspace(-6,6)];
M = [1 0 0; 0 1 0; 0 0 0];
options = odeset(<span style="color:#A020F0">'Mass'</span>,M,<span style="color:#A020F0">'RelTol'</span>,1e-4,<span style="color:#A020F0">'AbsTol'</span>,[1e-6 1e-10 1e-6]);
[t,y] = ode15s(@robertsdae,tspan,y0,options);
</pre></div></div></div><p>Plot the solution.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>y(:,2) = 1e4*y(:,2);
semilogx(t,y);
ylabel(<span style="color:#A020F0">'1e4 * y(:,2)'</span>);
title(<span style="color:#A020F0">'Robertson DAE problem with a Conservation Law, solved by ODE15S'</span>);
</pre></div></div></div><div class="informalfigure"><div id="d126e31800" class="mediaobject"><p><img src="../../examples/matlab/win64/SolveDifferentialAlgebraicEquationDAEExample_01.png"></p></div></div></div></section><div class="bibliography"><h2 id="References">References</h2><div id="mw_2225be1b-3b8b-4288-8d73-c0fdf0a644ed" class="bibliomixed"><p>[1] Shampine, L.F., S.
                Thompson, J.A. Kierzenka, and G.D. Byrne. “Non-Negative Solutions of ODEs.”
                    <span class="emphasis"><em>Applied Mathematics and Computation</em></span> 170, no.
                1 (November 2005): 556&#8211;569. <a href="https://doi.org/10.1016/j.amc.2004.12.011" target="_blank">https://doi.org/10.1016/j.amc.2004.12.011</a>.</p></div></div>
<h2 id="d126e31814">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/ode15s.html"><span itemprop="name"><code class="function">ode15s</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/ode23t.html"><span itemprop="name"><code class="function">ode23t</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/ode15i.html"><span itemprop="name"><code class="function">ode15i</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/odeset.html"><span itemprop="name"><code class="function">odeset</code></span></a></span></p>

<h3 id="d126e31827">Topics</h3><ul class="list-unstyled"><li><a href="choose-an-ode-solver.html" class="a">Choose an ODE Solver</a></li><li><a href="summary-of-ode-options.html" class="a">Summary of ODE Options</a></li><li><a href="../../symbolic/equation-solving.html" class="a">Equation Solving</a><span role="cross_prod"> (Symbolic Math Toolbox)</span></li></ul>
<h3 id="d126e31836">External Websites</h3><ul class="list-unstyled"><li><a href="https://www.mathworks.com/matlabcentral/fileexchange/7481-manuscript-of-solving-index-1-daes-in-matlab-and-simulink">Solving
Index-1 DAEs in MATLAB and Simulink</a></li></ul>
</section>
    </div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

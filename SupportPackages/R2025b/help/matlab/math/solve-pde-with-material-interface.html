<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Solve PDE with Discontinuity</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../numerical-integration-and-differential-equations.html",
          "name": "Numerical Integration and Differential Equations"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../partial-differential-equations.html",
          "name": "1-D Partial Differential Equations"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "partial-differential-equations"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Solve PDE with Discontinuity",
          "description": "Solve a PDE that interfaces with a material. The material interface creates a discontinuity in the problem at x=0.5, and the initial condition has a discontinuity at the right boundary x=1.",
          "thumbnailURL": "../../examples/matlab/win64/SolvePDEWithMaterialInterfaceExample_02.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "identifier": "matlab.SolvePDEWithMaterialInterfaceExample",
          "name": "SolvePDEWithMaterialInterfaceExample",
          "url": "solve-pde-with-material-interface.html"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/SolvePDEWithMaterialInterfaceExample')"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "SolvePDEWithMaterialInterfaceExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="ug">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="other">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This example shows how to solve a PDE that interfaces with a material."><meta xmlns="http://www.w3.org/1999/xhtml" content="../../examples/matlab/win64/SolvePDEWithMaterialInterfaceExample_02.png" itemprop="thumbnailUrl">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../numerical-integration-and-differential-equations.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Numerical Integration and Differential Equations</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../partial-differential-equations.html?s_tid=CRUX_lftnav" itemprop="url" id="partial-differential-equations"><span itemprop="title">1-D Partial Differential Equations</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item"><a href="#responsive_offcanvas">Solve PDE with Discontinuity</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#SolvePDEWithMaterialInterfaceExample-1" class="nav-link intrnllnk">Code Equation</a></li><li class="nav-item"><a href="#SolvePDEWithMaterialInterfaceExample-2" class="nav-link intrnllnk">Code Initial Conditions</a></li><li class="nav-item"><a href="#SolvePDEWithMaterialInterfaceExample-3" class="nav-link intrnllnk">Code Boundary Conditions</a></li><li class="nav-item"><a href="#SolvePDEWithMaterialInterfaceExample-4" class="nav-link intrnllnk">Select Solution Mesh</a></li><li class="nav-item"><a href="#SolvePDEWithMaterialInterfaceExample-5" class="nav-link intrnllnk">Solve Equation</a></li><li class="nav-item"><a href="#SolvePDEWithMaterialInterfaceExample-6" class="nav-link intrnllnk">Plot Solution</a></li><li class="nav-item"><a href="#SolvePDEWithMaterialInterfaceExample-7" class="nav-link intrnllnk">Local Functions</a></li><li class="nav-item"><a href="#d126e49936" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=partial-differential-equations&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=partial-differential-equations&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=partial-differential-equations&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=partial-differential-equations&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=partial-differential-equations&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=partial-differential-equations&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-topic">
<section><h1 class="r2025b" itemprop="title content" id="mw_70a2aeb0-dca0-4253-a47a-8108a1f5d9a4">Solve PDE with Discontinuity</h1><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/SolvePDEWithMaterialInterfaceExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-SolvePDEWithMaterialInterfaceExample"><meta itemprop="exampletitle" content="Solve PDE with Discontinuity"></div><span id="SolvePDEWithMaterialInterfaceExample" class="anchor_target"></span><p class="shortdesc">This example shows how to solve a PDE that interfaces with a material. The material interface creates a discontinuity in the problem at <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi><mo>=</mo><mn>0</mn><mo>.</mo><mn>5</mn></mrow></math></span>, and the initial condition has a discontinuity at the right boundary <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi><mo>=</mo><mn>1</mn></mrow></math></span>.</p><p>Consider the piecewise PDE</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mtext> </mtext><mrow><mo>{</mo><mtable><mtr><mtd><mrow><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">t</mi></mrow></mfrac><mo>=</mo><msup><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mo>-</mo><mn>2</mn></mrow></msup><mfrac><mrow><mo>∂</mo></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac><mrow><mo>(</mo><mrow><msup><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>2</mn></mrow></msup><mtext> </mtext><mn>5</mn><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>-</mo><mn>1000</mn><msup><mrow><mi mathvariant="italic">e</mi></mrow><mrow><mi mathvariant="italic">u</mi></mrow></msup></mrow></mtd><mtd><mrow><mrow><mo>(</mo><mrow><mn>0</mn><mo>≤</mo><mi mathvariant="italic">x</mi><mo>≤</mo><mn>0</mn><mo>.</mo><mn>5</mn></mrow><mo>)</mo></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">t</mi></mrow></mfrac><mo>=</mo><msup><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mo>-</mo><mn>2</mn></mrow></msup><mfrac><mrow><mo>∂</mo></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac><mrow><mo>(</mo><mrow><msup><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>2</mn></mrow></msup><mtext> </mtext><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>-</mo><msup><mrow><mi mathvariant="italic">e</mi></mrow><mrow><mi mathvariant="italic">u</mi></mrow></msup></mrow></mtd><mtd><mrow><mrow><mo>(</mo><mrow><mn>0</mn><mo>.</mo><mn>5</mn><mo>≤</mo><mi mathvariant="italic">x</mi><mo>≤</mo><mn>1</mn></mrow><mo>)</mo></mrow></mrow></mtd></mtr></mtable></mrow></mrow></math></p></div><p></p><p>The initial conditions are</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mtable columnalign="left"><mtr><mtd><mrow><mi mathvariant="italic">u</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mn>0</mn></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn><mtext>  </mtext><mrow><mo>(</mo><mrow><mn>0</mn><mo>≤</mo><mi mathvariant="italic">x</mi><mo>&lt;</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="italic">u</mi><mrow><mo>(</mo><mrow><mn>1</mn><mo>,</mo><mn>0</mn></mrow><mo>)</mo></mrow><mo>=</mo><mn>1</mn><mtext>  </mtext><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>=</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>.</mo></mrow></mtd></mtr></mtable></mrow></math></p></div><p></p><p>The boundary conditions are</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mtable columnalign="left"><mtr><mtd><mrow><mtext>       </mtext><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac><mo>=</mo><mn>0</mn><mtext>  </mtext><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>=</mo><mn>0</mn></mrow><mo>)</mo></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="italic">u</mi><mrow><mo>(</mo><mrow><mn>1</mn><mo>,</mo><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow><mo>=</mo><mn>1</mn><mtext>  </mtext><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>=</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>.</mo></mrow></mtd></mtr></mtable></mrow></math></p></div><p></p><p>To solve this equation in MATLAB&#174;, you need to code the equation, the initial conditions, and the boundary conditions, then select a suitable solution mesh before calling the solver <code class="literal">pdepe</code>. You either can include the required functions as local functions at the end of a file (as done here), or save them as separate, named files in a directory on the MATLAB path.</p><div class="procedure"><h3 class="title" id="SolvePDEWithMaterialInterfaceExample-1">Code Equation</h3><p>Before you can code the equation, you need to make sure that it is in a form that the <code class="literal">pdepe</code> solver expects. The standard form that <code class="literal">pdepe</code> expects is </p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">c</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">t</mi></mrow></mfrac><mo>=</mo><msup><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mo>-</mo><mi mathvariant="italic">m</mi></mrow></msup><mfrac><mrow><mo>∂</mo></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac><mrow><mo>(</mo><mrow><msup><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mi mathvariant="italic">m</mi></mrow></msup><mi mathvariant="italic">f</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow><mo>+</mo><mi mathvariant="italic">s</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow></mrow></math></span>.</p><p>In this case, the PDE is in the proper form, so you can read off the values of the coefficients. </p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true"><mtext> </mtext><mrow><mo>{</mo><mtable><mtr><mtd><mrow><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">t</mi></mrow></mfrac><mo>=</mo><msup><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mo>-</mo><mn>2</mn></mrow></msup><mfrac><mrow><mo>∂</mo></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac><mrow><mo>(</mo><mrow><msup><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>2</mn></mrow></msup><mtext> </mtext><mn>5</mn><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>-</mo><mn>1000</mn><msup><mrow><mi mathvariant="italic">e</mi></mrow><mrow><mi mathvariant="italic">u</mi></mrow></msup></mrow></mtd><mtd><mrow><mrow><mo>(</mo><mrow><mn>0</mn><mo>≤</mo><mi mathvariant="italic">x</mi><mo>≤</mo><mn>0</mn><mo>.</mo><mn>5</mn></mrow><mo>)</mo></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">t</mi></mrow></mfrac><mo>=</mo><msup><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mo>-</mo><mn>2</mn></mrow></msup><mfrac><mrow><mo>∂</mo></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac><mrow><mo>(</mo><mrow><msup><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>2</mn></mrow></msup><mtext> </mtext><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>-</mo><msup><mrow><mi mathvariant="italic">e</mi></mrow><mrow><mi mathvariant="italic">u</mi></mrow></msup></mrow></mtd><mtd><mrow><mrow><mo>(</mo><mrow><mn>0</mn><mo>.</mo><mn>5</mn><mo>≤</mo><mi mathvariant="italic">x</mi><mo>≤</mo><mn>1</mn></mrow><mo>)</mo></mrow></mrow></mtd></mtr></mtable></mrow></math></p></div><p></p><p>The values for the flux term <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">f</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow></mrow></math></span> and source term <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">s</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>.</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow></mrow></math></span> change depending on the value of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi></mrow></math></span>. The coefficients are:</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">m</mi><mo>=</mo><mn>2</mn></mrow></math></p></div><p></p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">c</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>=</mo><mn>1</mn></mrow></math></p></div><p></p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mo>{</mo><mtable><mtr><mtd><mrow><mi mathvariant="italic">f</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>=</mo><mn>5</mn><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow></mtd><mtd><mrow><mrow><mo>(</mo><mrow><mn>0</mn><mo>≤</mo><mi mathvariant="italic">x</mi><mo>≤</mo><mn>0</mn><mo>.</mo><mn>5</mn></mrow><mo>)</mo></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="italic">f</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow></mtd><mtd><mrow><mrow><mo>(</mo><mrow><mn>0</mn><mo>.</mo><mn>5</mn><mo>≤</mo><mi mathvariant="italic">x</mi><mo>≤</mo><mn>1</mn></mrow><mo>)</mo></mrow></mrow></mtd></mtr></mtable></mrow></math></p></div><p></p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mo>{</mo><mtable><mtr><mtd><mrow><mi mathvariant="italic">s</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>=</mo><mo>-</mo><mn>1000</mn><msup><mrow><mi mathvariant="italic">e</mi></mrow><mrow><mi mathvariant="italic">u</mi></mrow></msup></mrow></mtd><mtd><mrow><mrow><mo>(</mo><mrow><mn>0</mn><mo>≤</mo><mi mathvariant="italic">x</mi><mo>≤</mo><mn>0</mn><mo>.</mo><mn>5</mn></mrow><mo>)</mo></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="italic">s</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>=</mo><mo>-</mo><msup><mrow><mi mathvariant="italic">e</mi></mrow><mrow><mi mathvariant="italic">u</mi></mrow></msup></mrow></mtd><mtd><mrow><mrow><mo>(</mo><mrow><mn>0</mn><mo>.</mo><mn>5</mn><mo>≤</mo><mi mathvariant="italic">x</mi><mo>≤</mo><mn>1</mn></mrow><mo>)</mo></mrow></mrow></mtd></mtr></mtable></mrow></math></p></div><p></p><p>Now you can create a function to code the equation. The function should have the signature <code class="literal">[c,f,s] = pdex2pde(x,t,u,dudx)</code>:</p><div class="itemizedlist"><ul><li><p><code class="literal">x</code> is the independent spatial variable.</p></li><li><p><code class="literal">t</code> is the independent time variable.</p></li><li><p><code class="literal">u</code> is the dependent variable being differentiated with respect to <code class="literal">x</code> and <code class="literal">t</code>.</p></li><li><p><code class="literal">dudx</code> is the partial spatial derivative <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mo>∂</mo><mi mathvariant="italic">u</mi><mo>/</mo><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></math></span>.</p></li><li><p>The outputs <code class="literal">c</code>, <code class="literal">f</code>, and <code class="literal">s</code> correspond to coefficients in the standard PDE equation form expected by <code class="literal">pdepe</code>. These coefficients are coded in terms of the input variables <code class="literal">x</code>, <code class="literal">t</code>, <code class="literal">u</code>, and <code class="literal">dudx</code>.</p></li></ul></div><p>As a result, the equation in this example can be represented by the function:</p><div class="code_responsive"><pre id="d126e49235" class="programlisting"><span style="color:#0000FF">function</span> [c,f,s] = pdex2pde(x,t,u,dudx)
c = 1;
<span style="color:#0000FF">if</span> x &lt;= 0.5
    f = 5*dudx;
    s = -1000*exp(u);
<span style="color:#0000FF">else</span>
    f = dudx;
    s = -exp(u);
<span style="color:#0000FF">end</span>
<span style="color:#0000FF">end</span>
</pre></div><p>(Note: All functions are included as local functions at the end of the example.)</p><h3 class="title" id="SolvePDEWithMaterialInterfaceExample-2">Code Initial Conditions</h3><p>Next, write a function that returns the initial conditions. The initial condition is applied at the first time value and provides the value of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">u</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><msub><mrow><mi mathvariant="italic">t</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo>)</mo></mrow></mrow></math></span> for any value of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi></mrow></math></span>. Use the function signature <code class="literal">u0 = pdex2ic(x)</code> to write the function.</p><p>The initial conditions are</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mtable columnalign="left"><mtr><mtd><mrow><mi mathvariant="italic">u</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mn>0</mn></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn><mtext>        </mtext><mrow><mo>(</mo><mrow><mn>0</mn><mo>≤</mo><mi mathvariant="italic">x</mi><mo>&lt;</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="italic">u</mi><mrow><mo>(</mo><mrow><mn>1</mn><mo>,</mo><mn>0</mn></mrow><mo>)</mo></mrow><mo>=</mo><mn>1</mn><mtext>        </mtext><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>=</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>.</mo></mrow></mtd></mtr></mtable></mrow></math></p></div><p></p><p>The corresponding function is</p><div class="code_responsive"><pre id="d126e49327" class="programlisting"><span style="color:#0000FF">function</span> u0 = pdex2ic(x)
<span style="color:#0000FF">if</span> x &lt; 1
    u0 = 0;
<span style="color:#0000FF">else</span>
    u0 = 1;
<span style="color:#0000FF">end</span>
<span style="color:#0000FF">end</span>
</pre></div><h3 class="title" id="SolvePDEWithMaterialInterfaceExample-3">Code Boundary Conditions</h3><p>Now, write a function that evaluates the boundary conditions. For problems posed on the interval <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">a</mi><mo>≤</mo><mi mathvariant="italic">x</mi><mo>≤</mo><mi mathvariant="italic">b</mi></mrow></math></span>, the boundary conditions apply for all <span class="emphasis"><em>t</em></span> and either <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi><mo>=</mo><mi mathvariant="italic">a</mi></mrow></math></span> or <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi><mo>=</mo><mi mathvariant="italic">b</mi></mrow></math></span>. The standard form for the boundary conditions expected by the solver is</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">p</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi></mrow><mo>)</mo></mrow><mo>+</mo><mi mathvariant="italic">q</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow><mi mathvariant="italic">f</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn><mo>.</mo></mrow></math></p></div><p></p><p>Since this example has spherical symmetry (<span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">m</mi><mo>=</mo><mn>2</mn></mrow></math></span>), the <code class="literal">pdepe</code> solver automatically enforces the left boundary condition to bound the solution at the origin, and ignores any conditions specified for the left boundary in the boundary function. So for the left boundary condition, you can specify <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">p</mi></mrow><mrow><mi mathvariant="italic">L</mi></mrow></msub><mo>=</mo><msub><mrow><mi mathvariant="italic">q</mi></mrow><mrow><mi mathvariant="italic">L</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow></math></span>. For the right boundary condition, you can rewrite the boundary condition in the standard form and read off the coefficient values for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">p</mi></mrow><mrow><mi mathvariant="italic">R</mi></mrow></msub></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">q</mi></mrow><mrow><mi mathvariant="italic">R</mi></mrow></msub></mrow></math></span>.</p><p>For <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi><mo>=</mo><mn>1</mn></mrow></math></span>, the equation is  <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">u</mi><mrow><mo>(</mo><mrow><mn>1</mn><mo>,</mo><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow><mo>=</mo><mn>1</mn><mo>→</mo><mrow><mo>(</mo><mrow><mi mathvariant="italic">u</mi><mo>-</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>+</mo><mn>0</mn><mo>⋅</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac><mo>=</mo><mn>0</mn></mrow></math></span>. The coefficients are:</p><div class="itemizedlist"><ul><li><p><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msub><mrow><mi mathvariant="italic">p</mi></mrow><mrow><mi mathvariant="italic">R</mi></mrow></msub><mrow><mo>(</mo><mrow><mn>1</mn><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi></mrow><mo>)</mo></mrow><mo>=</mo><mi mathvariant="italic">u</mi><mo>-</mo><mn>1</mn></mrow></math></span></p></li><li><p><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msub><mrow><mi mathvariant="italic">q</mi></mrow><mrow><mi mathvariant="italic">R</mi></mrow></msub><mrow><mo>(</mo><mrow><mn>1</mn><mo>,</mo><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn></mrow></math></span></p></li></ul></div><p>The boundary function should use the function signature <code class="literal">[pl,ql,pr,qr] = pdex2bc(xl,ul,xr,ur,t)</code>:</p><div class="itemizedlist"><ul><li><p>The inputs <code class="literal">xl</code> and <code class="literal">ul</code> correspond to <span class="emphasis"><em>u</em></span> and <span class="emphasis"><em>x</em></span> for the left boundary.</p></li><li><p>The inputs <code class="literal">xr</code> and <code class="literal">ur</code> correspond to <span class="emphasis"><em>u</em></span> and <span class="emphasis"><em>x</em></span> for the right boundary.</p></li><li><p><code class="literal">t</code> is the independent time variable.</p></li><li><p>The outputs <code class="literal">pl</code> and <code class="literal">ql</code> correspond to <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">p</mi></mrow><mrow><mi mathvariant="italic">L</mi></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi></mrow><mo>)</mo></mrow></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">q</mi></mrow><mrow><mi mathvariant="italic">L</mi></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow></mrow></math></span> for the left boundary (<span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi><mo>=</mo><mn>0</mn></mrow></math></span> for this problem).</p></li><li><p>The outputs <code class="literal">pr</code> and <code class="literal">qr</code> correspond to <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">p</mi></mrow><mrow><mi mathvariant="italic">R</mi></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi></mrow><mo>)</mo></mrow></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">q</mi></mrow><mrow><mi mathvariant="italic">R</mi></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow></mrow></math></span> for the right boundary (<span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi><mo>=</mo><mn>1</mn></mrow></math></span> for this problem).</p></li></ul></div><p>The boundary conditions in this example are represented by the function:</p><div class="code_responsive"><pre id="d126e49726" class="programlisting"><span style="color:#0000FF">function</span> [pl,ql,pr,qr] = pdex2bc(xl,ul,xr,ur,t)
pl = 0; 
ql = 0; 
pr = ur - 1;
qr = 0;
<span style="color:#0000FF">end</span>
</pre></div><h3 class="title" id="SolvePDEWithMaterialInterfaceExample-4">Select Solution Mesh</h3><p>The spatial mesh should include several values near <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi><mo>=</mo><mn>0</mn><mo>.</mo><mn>5</mn></mrow></math></span> to account for the discontinuous interface, as well as points near <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi><mo>=</mo><mn>1</mn></mrow></math></span> because of the inconsistent initial value (<span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">u</mi><mrow><mo>(</mo><mrow><mn>1</mn><mo>,</mo><mn>0</mn></mrow><mo>)</mo></mrow><mo>=</mo><mn>1</mn></mrow></math></span>) and boundary value (<span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">u</mi><mrow><mo>(</mo><mrow><mn>1</mn><mo>,</mo><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn></mrow></math></span>) at that point. The solution changes rapidly for small <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">t</mi></mrow></math></span>, so use a time step that can resolve this sharp change.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>x = [0 0.1 0.2 0.3 0.4 0.45 0.475 0.5 0.525 0.55 0.6 0.7 0.8 0.9 0.95 0.975 0.99 1];
t = [0 0.001 0.005 0.01 0.05 0.1 0.5 1];</pre></div></div></div><h3 class="title" id="SolvePDEWithMaterialInterfaceExample-5">Solve Equation</h3><p>Finally, solve the equation using the symmetry <code class="literal">m</code>, the PDE equation, the initial conditions, the boundary conditions, and the meshes for <code class="literal">x</code> and <code class="literal">t</code>. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>m = 2;
sol = pdepe(m,@pdex2pde,@pdex2ic,@pdex2bc,x,t);</pre></div></div></div><p><code class="literal">pdepe</code> returns the solution in a 3-D array <code class="literal">sol</code>, where <code class="literal">sol(i,j,k)</code> approximates the <code class="literal">k</code>th component of the solution <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">u</mi></mrow><mrow><mi mathvariant="italic">k</mi></mrow></msub></mrow></math></span> evaluated at <code class="literal">t(i)</code> and <code class="literal">x(j)</code>. The size of <code class="literal">sol</code> is <code class="literal">length(t)</code>-by-<code class="literal">length(x)</code>-by-<code class="literal">length(u0)</code>, since <code class="literal">u0</code> specifies an initial condition for each solution component. For this problem, <code class="literal">u</code> has only one component, so <code class="literal">sol</code> is a 8-by-18 matrix, but in general you can extract the <code class="literal">k</code>th solution component with the command <code class="literal">u = sol(:,:,k)</code>.</p><p>Extract the first solution component from <code class="literal">sol</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>u = sol(:,:,1);</pre></div></div></div><h3 class="title" id="SolvePDEWithMaterialInterfaceExample-6">Plot Solution</h3><p>Create a surface plot of the solution <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">u</mi></mrow></math></span> plotted at the selected mesh points for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">t</mi></mrow></math></span>. Since <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">m</mi><mo>=</mo><mn>2</mn></mrow></math></span> the problem is posed in a spherical geometry with spherical symmetry, so the solution only changes in the radial <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi></mrow></math></span> direction.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>surf(x,t,u)
title(<span style="color:#A020F0">'Numerical solution with nonuniform mesh'</span>)
xlabel(<span style="color:#A020F0">'Distance x'</span>)
ylabel(<span style="color:#A020F0">'Time t'</span>)
zlabel(<span style="color:#A020F0">'Solution u'</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e49890" class="mediaobject"><p><img src="../../examples/matlab/win64/SolvePDEWithMaterialInterfaceExample_01.png" alt="Figure contains an axes object. The axes object with title Numerical solution with nonuniform mesh, xlabel Distance x, ylabel Time t contains an object of type surface." width="560"></p></div></div><p>Now, plot just <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">u</mi></mrow></math></span> to get a side view of the contours in the surface plot. Add a line at <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi><mo>=</mo><mn>0</mn><mo>.</mo><mn>5</mn></mrow></math></span> to highlight the effect of the material interface.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>plot(x,u,x,u,<span style="color:#A020F0">'*'</span>)
line([0.5 0.5], [-3 1], <span style="color:#A020F0">'Color'</span>, <span style="color:#A020F0">'k'</span>)
xlabel(<span style="color:#A020F0">'Distance x'</span>)
ylabel(<span style="color:#A020F0">'Solution u'</span>)
title(<span style="color:#A020F0">'Solution profiles at several times'</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e49921" class="mediaobject"><p><img src="../../examples/matlab/win64/SolvePDEWithMaterialInterfaceExample_02.png" alt="Figure contains an axes object. The axes object with title Solution profiles at several times, xlabel Distance x, ylabel Solution u contains 17 objects of type line. One or more of the lines displays its values using only markers" width="560"></p></div></div><h3 class="title" id="SolvePDEWithMaterialInterfaceExample-7">Local Functions</h3><p>Listed here are the local helper functions that the PDE solver <code class="literal">pdepe</code> calls to calculate the solution. Alternatively, you can save these functions as their own files in a directory on the MATLAB path.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> [c,f,s] = pdex2pde(x,t,u,dudx) <span style="color:#228B22">% Equation to solve</span>
c = 1;
<span style="color:#0000FF">if</span> x &lt;= 0.5
    f = 5*dudx;
    s = -1000*exp(u);
<span style="color:#0000FF">else</span>
    f = dudx;
    s = -exp(u);
<span style="color:#0000FF">end</span>
<span style="color:#0000FF">end</span>
<span style="color:#228B22">%----------------------------------------------</span>
<span style="color:#0000FF">function</span> u0 = pdex2ic(x) <span style="color:#228B22">%Initial conditions</span>
<span style="color:#0000FF">if</span> x &lt; 1
    u0 = 0;
<span style="color:#0000FF">else</span>
    u0 = 1;
<span style="color:#0000FF">end</span>
<span style="color:#0000FF">end</span>
<span style="color:#228B22">%----------------------------------------------</span>
<span style="color:#0000FF">function</span> [pl,ql,pr,qr] = pdex2bc(xl,ul,xr,ur,t) <span style="color:#228B22">% Boundary conditions</span>
pl = 0;
ql = 0;
pr = ur - 1;
qr = 0;
<span style="color:#0000FF">end</span>
<span style="color:#228B22">%----------------------------------------------</span></pre></div></div></div></div>
            <h2 id="d126e49936">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/pdepe.html"><span itemprop="name"><code class="function">pdepe</code></span></a></span></p>
            <h3 id="d126e49942">Topics</h3><ul class="list-unstyled"><li><a href="partial-differential-equations.html" class="a">Solving Partial Differential Equations</a></li><li><a href="solve-transistor-pde.html" class="a">Solve PDE and Compute Partial Derivatives</a></li></ul>
            
        </section>
    </div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

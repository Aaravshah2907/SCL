<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Matrices in the MATLAB Environment</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../linear-algebra.html",
          "name": "Linear Algebra"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "linear-algebra"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="ug">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ex">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="Matrix creation and basic operations."><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../linear-algebra.html?s_tid=CRUX_lftnav" itemprop="url" id="linear-algebra"><span itemprop="title">Linear Algebra</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item"><a href="#responsive_offcanvas">Matrices in the MATLAB Environment</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#f4-965393" class="nav-link intrnllnk">Creating Matrices</a></li><li class="nav-item"><a href="#f4-959482" class="nav-link intrnllnk">Adding and Subtracting Matrices</a></li><li class="nav-item"><a href="#f4-959198" class="nav-link intrnllnk">Vector Products and Transpose</a></li><li class="nav-item"><a href="#f4-1772" class="nav-link intrnllnk">Multiplying Matrices</a></li><li class="nav-item"><a href="#f4-1884" class="nav-link intrnllnk">Identity Matrix</a></li><li class="nav-item"><a href="#mw_5e05a273-2329-4048-af5d-45fd52792bc3" class="nav-link intrnllnk">Matrix Inverse</a></li><li class="nav-item"><a href="#f4-1892" class="nav-link intrnllnk">Kronecker Tensor Product</a></li><li class="nav-item"><a href="#f4-1940" class="nav-link intrnllnk">Vector and Matrix Norms</a></li><li class="nav-item"><a href="#brs0fs4-1" class="nav-link intrnllnk">Using Multithreaded Computation with Linear Algebra Functions</a></li><li class="nav-item"><a href="#seealsoref" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=linear-algebra&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=linear-algebra&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=linear-algebra&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=linear-algebra&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=linear-algebra&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=linear-algebra&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-topic">
<section><h2 class="title r2025b" itemprop="title content" id="f4-988203">Matrices in the <span class="trademark entity">MATLAB</span> Environment</h2><a class="indexterm" name="d126e2967"></a><p class="shortdesc">This topic contains an introduction to creating matrices and performing basic matrix calculations in MATLAB<sup>&#x00AE;</sup>. </p><p class="shortdesc">The MATLAB environment uses the term <span class="emphasis"><em>matrix</em></span> to indicate a variable containing real or complex numbers arranged in a two-dimensional grid. An <span class="emphasis"><em>array</em></span> is, more generally, a vector, matrix, or higher dimensional grid of numbers. All arrays in MATLAB are rectangular, in the sense that the component vectors along any dimension are all the same length. The mathematical operations defined on matrices are the subject of linear algebra.</p><section><h3 class="title" id="f4-965393">Creating Matrices</h3><a class="indexterm" name="d126e2989"></a><a class="indexterm" name="d126e2992"></a><a class="indexterm" name="d126e2995"></a><p>MATLAB has many functions that create different kinds of matrices. For example, you can create a symmetric matrix with entries based on Pascal's triangle:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>A = pascal(3)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>A =
       1     1     1
       1     2     3
       1     3     6
</pre></div></div></div><p>Or, you can create an unsymmetric <span class="emphasis"><em>magic square matrix</em></span>, which has equal row and column sums:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>B = magic(3)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>B =
       8     1     6
       3     5     7
       4     9     2
</pre></div></div></div><p>Another example is a 3-by-2 rectangular matrix of random integers. In this case the first
            input to <code class="function">randi</code> describes the range of possible values for the
            integers, and the second two inputs describe the number of rows and columns.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>C = randi(10,3,2)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>
C =

     9    10
    10     7
     2     1</pre></div></div></div><a class="indexterm" name="d126e3022"></a><a class="indexterm" name="d126e3025"></a><p>A column vector is an <em class="varname">m</em>-by-1 matrix, a row vector is a 1-by-<em class="varname">n</em> matrix, and a scalar is a 1-by-1 matrix. To define a matrix manually, use square brackets <code class="literal">[ ]</code> to denote the beginning and end of the array. Within the brackets, use a semicolon <code class="literal">;</code> to denote the end of a row. In the case of a scalar (1-by-1 matrix), the brackets are not required. For example, these statements produce a column vector, a row vector, and a scalar:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>u = [3; 1; 4]

v = [2 0 -1]

s = 7
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>u =
       3
       1
       4

v =
       2     0    -1

s =
       7
</pre></div></div></div><p>For more information about creating and working with matrices, see <a href="creating-and-concatenating-matrices.html" class="a">Creating, Concatenating, and Expanding Matrices</a>.</p></section><section><h3 class="title" id="f4-959482">Adding and Subtracting Matrices</h3><a class="indexterm" name="d126e3048"></a><p>Addition and subtraction of matrices and arrays is performed element-by-element, or <span class="emphasis"><em>element-wise</em></span>. For example, adding <code class="literal">A</code> to <code class="literal">B</code> and then subtracting <code class="literal">A</code> from the result recovers <code class="literal">B</code>:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>X = A + B</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>X =
       9     2     7
       4     7    10
       5    12     8</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>Y = X - A</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>Y =
       8     1     6
       3     5     7
       4     9     2</pre></div></div></div><p>Addition and subtraction require both matrices to have compatible dimensions. If the dimensions are incompatible, an error results:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>X = A + C</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>Arrays have incompatible sizes for this operation.</pre></div></div></div><p>For more information, see <a href="../matlab_prog/array-vs-matrix-operations.html" class="a">Array vs. Matrix Operations</a>.</p></section><section><h3 class="title" id="f4-959198">Vector Products and Transpose</h3><a class="indexterm" name="d126e3082"></a><a class="indexterm" name="d126e3085"></a><a class="indexterm" name="d126e3087"></a><a class="indexterm" name="d126e3089"></a><p>A row vector and a column vector of the same length can be multiplied in either order. The result is either a scalar, called the <span class="emphasis"><em>inner product</em></span>, or a matrix, called the <span class="emphasis"><em>outer product</em></span>:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>u = [3; 1; 4];
v = [2 0 -1];
x = v*u</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>x =

     2</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>X = u*v</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>X =

     6     0    -3
     2     0    -1
     8     0    -4</pre></div></div></div><a class="indexterm" name="d126e3106"></a><a class="indexterm" name="d126e3110"></a><a class="indexterm" name="d126e3113"></a><p>For real matrices, the <span class="emphasis"><em>transpose</em></span> operation interchanges <em class="varname">a</em><sub><em class="varname">i</em><em class="varname">j</em></sub> and <em class="varname">a</em><sub><em class="varname">j</em><em class="varname">i</em></sub>. For complex matrices, another consideration is whether to take the complex conjugate of complex entries in the array to form the <span class="emphasis"><em>complex conjugate transpose</em></span>. MATLAB uses the apostrophe operator (<code class="literal">'</code>) to perform a complex conjugate transpose, and the dot-apostrophe operator (<code class="literal">.'</code>) to transpose without conjugation. For matrices containing all real elements, the two operators return the same result.</p><p>The example matrix <code class="literal">A = pascal(3)</code> is <span class="emphasis"><em>symmetric</em></span>, so <code class="literal">A'</code> is equal to <code class="literal">A</code>. However, <code class="literal">B = magic(3)</code> is not symmetric, so <code class="literal">B'</code> has the elements reflected along the main diagonal:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>B = magic(3)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>B =

     8     1     6
     3     5     7
     4     9     2</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>X = B'</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>X =

     8     3     4
     1     5     9
     6     7     2</pre></div></div></div><p>For vectors, transposition turns a row vector into a column vector (and vice-versa):</p><div class="code_responsive"><pre class="programlisting">x = v'

x =
       2
       0
      -1</pre></div><p>If <code class="literal">x</code> and <code class="literal">y</code> are both real column vectors, then the product <code class="literal">x*y</code> is not defined, but the two products</p><div class="code_responsive"><pre class="programlisting">x'*y</pre></div><p>and</p><div class="code_responsive"><pre class="programlisting">y'*x</pre></div><a class="indexterm" name="d126e3177"></a><a class="indexterm" name="d126e3179"></a><a class="indexterm" name="d126e3181"></a><p>produce the same scalar result. This quantity is used so frequently, it has three different names: <span class="emphasis"><em>inner</em></span> product, <span class="emphasis"><em>scalar</em></span> product, or <span class="emphasis"><em>dot</em></span> product. There is even a dedicated function for dot products named <a href="../ref/dot.html"><code class="function">dot</code></a>.</p><a class="indexterm" name="d126e3195"></a><a class="indexterm" name="d126e3198"></a><p>For a complex vector or matrix, <code class="literal">z</code>, the quantity <code class="literal">z'</code> not only transposes the vector or matrix, but also converts each complex element to its complex conjugate. That is, the sign of the imaginary part of each complex element changes. For example, consider the complex matrix</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>z = [1+2i 7-3i 3+4i; 6-2i 9i 4+7i]</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>z =

   1.0000 + 2.0000i   7.0000 - 3.0000i   3.0000 + 4.0000i
   6.0000 - 2.0000i   0.0000 + 9.0000i   4.0000 + 7.0000i</pre></div></div></div><p>The complex conjugate transpose of <code class="literal">z</code> is:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>z'</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans =

   1.0000 - 2.0000i   6.0000 + 2.0000i
   7.0000 + 3.0000i   0.0000 - 9.0000i
   3.0000 - 4.0000i   4.0000 - 7.0000i</pre></div></div></div><p>The unconjugated complex transpose, where the complex part of each element retains its sign, is denoted by <code class="literal">z.'</code>:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>z.'</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans =

   1.0000 + 2.0000i   6.0000 - 2.0000i
   7.0000 - 3.0000i   0.0000 + 9.0000i
   3.0000 + 4.0000i   4.0000 + 7.0000i</pre></div></div></div><p>For complex vectors, the two scalar products <code class="literal">x'*y</code> and <code class="literal">y'*x</code> are complex conjugates of each other, and the scalar product <code class="literal">x'*x</code> of a complex vector with itself is real.</p></section><section><h3 class="title" id="f4-1772">Multiplying Matrices</h3><a class="indexterm" name="d126e3238"></a><p>Multiplication of matrices is defined in a way that reflects composition of the underlying linear transformations and allows compact representation of systems of simultaneous linear equations. The matrix product <em class="varname">C</em>&nbsp;=&nbsp;<em class="varname">AB</em> is defined when the column dimension of <em class="varname">A</em> is equal to the row dimension of <em class="varname">B</em>, or when one of them is a scalar. If <em class="varname">A</em> is <em class="varname">m</em>-by-<em class="varname">p</em> and <em class="varname">B</em> is <em class="varname">p</em>-by-<em class="varname">n</em>, their product <em class="varname">C</em> is <em class="varname">m</em>-by-<em class="varname">n</em>. The product can actually be defined using MATLAB <a href="../ref/for.html"><code class="function">for</code></a> loops, <a href="../ref/double.colon.html"><code class="function">colon</code></a> notation, and vector dot products:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>A = pascal(3);
B = magic(3);
m = 3; 
n = 3;
<span style="color:#0000FF">for</span> i = 1:m
     <span style="color:#0000FF">for</span> j = 1:n
        C(i,j) = A(i,:)*B(:,j);
     <span style="color:#0000FF">end</span>
<span style="color:#0000FF">end</span></pre></div></div></div><p>MATLAB uses an asterisk to denote matrix multiplication, as in <code class="literal">C = A*B</code>. Matrix multiplication is not commutative; that is, <code class="literal">A*B</code> is typically not equal to <code class="literal">B*A</code>:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>X = A*B</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>X =
      15    15    15
      26    38    26
      41    70    39</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>Y = B*A</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>Y =
      15    28    47
      15    34    60
      15    28    43</pre></div></div></div><p>A matrix can be multiplied on the right by a column vector and on the left by a row vector:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>u = [3; 1; 4];
x = A*u</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>x =

     8
    17
    30</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>v = [2 0 -1];
y = v*B</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>y =

    12    -7    10</pre></div></div></div><p>Rectangular matrix multiplications must satisfy the dimension compatibility conditions. Since
                <code class="literal">A</code> is 3-by-3 and <code class="literal">u</code> is 3-by-1, you can multiply
            them to get a 3-by-1 result (the common inner dimension cancels):</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>x = A*u</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>x =

     8
    17
    30</pre></div></div></div><p>However, the multiplication does not work in the reverse order:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>y = u*A</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>Error using  * 
Incorrect dimensions for matrix multiplication. Check that the number of columns
in the first matrix matches the number of rows in the second matrix. To operate
on each element of the matrix individually, use TIMES (.*) for elementwise
multiplication.</pre></div></div></div><p>You can multiply anything with a scalar:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>s = 10;
w = s*y</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>w =

   120   -70   100</pre></div></div></div><p>When you multiply an array by a scalar, the scalar implicitly expands to be the same size as the other input. This is often referred to as <span class="emphasis"><em>scalar expansion</em></span>.</p></section><section><h3 class="title" id="f4-1884">Identity Matrix</h3><a class="indexterm" name="d126e3337"></a><a class="indexterm" name="d126e3340"></a><a class="indexterm" name="d126e3343"></a><a class="indexterm" name="d126e3345"></a><p>Generally accepted mathematical notation uses the capital letter <em class="varname">I</em> to denote identity matrices, matrices of various sizes with ones on the main diagonal and zeros elsewhere. These matrices have the property that <em class="varname">A</em><em class="varname">I</em> = <em class="varname">A</em> and <em class="varname">I</em><em class="varname">A</em> = <em class="varname">A</em> whenever the dimensions are compatible.</p><p>The original version of MATLAB could not use <em class="varname">I</em> for this purpose because it did not distinguish between uppercase and lowercase letters and <em class="varname">i</em> already served as a subscript and as the complex unit. So an English language pun was introduced. The function</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>eye(m,n)</pre></div></div></div><p>returns an <em class="varname">m</em>-by-<em class="varname">n</em> rectangular identity matrix and <code class="literal">eye(n)</code> returns an <em class="varname">n</em>-by-<em class="varname">n</em> square identity matrix.</p></section><section><h3 class="title" id="mw_5e05a273-2329-4048-af5d-45fd52792bc3">Matrix Inverse</h3><p>If a matrix <code class="literal">A</code> is square and nonsingular (nonzero determinant), then
            the equations <span class="inlineequation"><em class="varname">A</em><em class="varname">X</em> =
                    <em class="varname">I</em></span> and <span class="inlineequation"><em class="varname">X</em><em class="varname">A</em> =
                    <em class="varname">I</em></span> have the same solution <em class="varname">X</em>. This solution is called
            the <span class="emphasis"><em>inverse</em></span> of <code class="literal">A</code> and is denoted <span class="inlineequation"><em class="varname">A</em><sup>-1</sup></span>. The <a href="../ref/inv.html"><code class="function">inv</code></a> function and the expression
                <code class="literal">A^-1</code> both compute the matrix inverse.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>A = pascal(3)
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>A =
       1     1     1
       1     2     3
       1     3     6</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>X = inv(A)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>X =

    3.0000   -3.0000    1.0000
   -3.0000    5.0000   -2.0000
    1.0000   -2.0000    1.0000</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>A*X</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans =

    1.0000         0         0
    0.0000    1.0000         0
         0         0    1.0000</pre></div></div></div><p>The <span class="emphasis"><em>determinant</em></span> calculated by <a href="../ref/det.html"><code class="function">det</code></a> is a measure of the scaling factor of the linear transformation
            described by the matrix. When the determinant is exactly zero, the matrix is
                <span class="emphasis"><em>singular</em></span> and no inverse exists.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>d = det(A)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>d =

     1</pre></div></div></div><p>Some matrices are <span class="emphasis"><em>nearly singular</em></span>, and despite the fact that an
            inverse matrix exists, the calculation is susceptible to numerical errors. The <a href="../ref/cond.html"><code class="function">cond</code></a> function computes the <span class="emphasis"><em>condition number for
                inversion</em></span>, which gives an indication of the accuracy of the results from
            matrix inversion. The condition number ranges from <code class="literal">1</code> for a
            numerically stable matrix to <code class="literal">Inf</code> for a singular matrix.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>c = cond(A)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>c =

   61.9839</pre></div></div></div><p>It is seldom necessary to form the explicit inverse of a matrix. A frequent misuse of
                <code class="function">inv</code> arises when solving the system of linear equations <span class="inlineequation"><em class="varname">A</em><em class="varname">x</em> =
                    <em class="varname">b</em></span>. The best way to solve this equation, from the standpoint of both
            execution time and numerical accuracy, is to use the matrix backslash operator
                <code class="literal">x = A\b</code>. See <a href="../ref/double.mldivide.html"><code class="function">mldivide</code></a> for more information.</p></section><section><h3 class="title" id="f4-1892">Kronecker Tensor Product</h3><a class="indexterm" name="d126e3485"></a><a class="indexterm" name="d126e3487"></a><p>The Kronecker product, <code class="literal">kron(X,Y)</code>, of two matrices is the larger matrix formed from all possible products of the elements of <code class="literal">X</code> with those of <code class="literal">Y</code>. If <code class="literal">X</code> is <em class="varname">m</em>-by-<em class="varname">n</em> and <code class="literal">Y</code> is <em class="varname">p</em>-by-<em class="varname">q</em>, then <code class="literal">kron(X,Y)</code> is <em class="varname">mp</em>-by-<em class="varname">nq</em>. The elements are arranged such that each element of <code class="literal">X</code> is multiplied by the entire matrix <code class="literal">Y</code>:</p><div class="code_responsive"><pre class="programlisting">[X(1,1)*Y  X(1,2)*Y  . . .  X(1,n)*Y
                     . . .
 X(m,1)*Y  X(m,2)*Y  . . .  X(m,n)*Y]</pre></div><p>The Kronecker product is often used with matrices of zeros and ones to build up repeated copies of small matrices. For example, if <code class="literal">X</code> is the 2-by-2 matrix</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>X = [1   2
     3   4]</pre></div></div></div><p>and <div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>I = eye(2,2)</pre></div></div></div> is the 2-by-2
            identity matrix, then:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>kron(X,I)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans =

     1     0     2     0
     0     1     0     2
     3     0     4     0
     0     3     0     4</pre></div></div></div><p>and</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>kron(I,X)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans =

     1     2     0     0
     3     4     0     0
     0     0     1     2
     0     0     3     4</pre></div></div></div><p>Aside from <code class="function">kron</code>, some other functions that are useful to replicate arrays are <a href="../ref/repmat.html"><code class="function">repmat</code></a>, <a href="../ref/repelem.html"><code class="function">repelem</code></a>, and <a href="../ref/blkdiag.html"><code class="function">blkdiag</code></a>.</p></section><section><h3 class="title" id="f4-1940">Vector and Matrix Norms</h3><a class="indexterm" name="d126e3560"></a><p>The <em class="varname">p</em>-norm of a vector <em class="varname">x</em>,</p><div id="d126e3570" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-13px" display="block"><mrow><msub><mrow><mrow><mo>‖</mo><mi>x</mi><mo>‖</mo></mrow></mrow><mi>p</mi></msub><mo>=</mo><msup><mrow><mrow><mo>(</mo><mrow><mstyle displaystyle="true"><mo>∑</mo><mrow><msup><mrow><mrow><mo>|</mo><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><mo>|</mo></mrow></mrow><mi>p</mi></msup></mrow></mstyle></mrow><mo>)</mo></mrow></mrow><mrow><mfrac bevelled="true"><mn>1</mn><mi>p</mi></mfrac></mrow></msup><mtext> </mtext><mo>,</mo></mrow></math></p></div></div><p>is computed by <code class="literal">norm(x,p)</code>. This operation is defined for any value of <em class="varname">p</em> &gt; 1, but the most common values of <em class="varname">p</em> are 1, 2, and &#8734;. The default value is <em class="varname">p</em> = 2, which corresponds to <span class="emphasis"><em>Euclidean length</em></span> or <span class="emphasis"><em>vector magnitude</em></span>:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>v = [2 0 -1];
[norm(v,1) norm(v) norm(v,inf)]</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans =

    3.0000    2.2361    2.0000</pre></div></div></div><p>The <em class="varname">p</em>-norm of a matrix <em class="varname">A</em>,</p><div id="d126e3599" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-19px" display="block"><mrow><msub><mrow><mrow><mo>‖</mo><mi>A</mi><mo>‖</mo></mrow></mrow><mi>p</mi></msub><mo>=</mo><munder><mrow><mi>max</mi></mrow><mi>x</mi></munder><mfrac><mrow><msub><mrow><mrow><mo>‖</mo><mrow><mi>A</mi><mi>x</mi></mrow><mo>‖</mo></mrow></mrow><mi>p</mi></msub></mrow><mrow><msub><mrow><mrow><mo>‖</mo><mi>x</mi><mo>‖</mo></mrow></mrow><mi>p</mi></msub></mrow></mfrac><mo>,</mo></mrow></math></p></div></div><p>can be computed for <em class="varname">p</em> = 1, 2, and &#8734; by <code class="literal">norm(A,p)</code>. Again, the default value is <em class="varname">p</em> = 2:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>A = pascal(3);
[norm(A,1) norm(A) norm(A,inf)]</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans =

   10.0000    7.8730   10.0000</pre></div></div></div><p>In cases where you want to calculate the norm of each row or column of a matrix, you can use <a href="../ref/vecnorm.html"><code class="function">vecnorm</code></a>:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>vecnorm(A)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans =

    1.7321    3.7417    6.7823</pre></div></div></div></section><section><h3 class="title" id="brs0fs4-1">Using Multithreaded Computation with Linear Algebra Functions</h3><p>MATLAB supports multithreaded computation for a number of linear algebra and element-wise numerical functions. These functions automatically execute on multiple threads. For a function or expression to execute faster on multiple CPUs, a number of conditions must be true:</p><div class="orderedlist"><ol style="list-style: decimal;"><li><p>The function performs operations that easily partition into sections that execute concurrently. These sections must be able to execute with little communication between processes. They should require few sequential operations. </p></li><li><p>The data size is large enough so that any advantages of concurrent execution outweigh the time required to partition the data and manage separate execution threads. For example, most functions speed up only when the array contains several thousand elements or more.</p></li><li><p>The operation is not memory-bound; processing time is not dominated by memory access time. As a general rule, complicated functions speed up more than simple functions.</p></li></ol></div><p>The matrix multiply <code class="literal">(X*Y)</code> and matrix power <code class="literal">(X^p)</code> operators show significant increase in speed on large double-precision arrays (on order of 10,000 elements). The matrix analysis functions <a href="../ref/det.html"><code class="function">det</code></a>, <a href="../ref/rcond.html"><code class="function">rcond</code></a>, <a href="../ref/hess.html"><code class="function">hess</code></a>, and <a href="../ref/expm.html"><code class="function">expm</code></a> also show significant increase in speed on large double-precision arrays.</p></section>
        
        
        <h2 id="seealsoref">See Also</h2><h3 id="d126e3662">Topics</h3><ul class="list-unstyled"><li><a href="systems-of-linear-equations.html" class="a">Systems of Linear Equations</a></li><li><a href="factorizations.html" class="a">Factorizations</a></li><li><a href="eigenvalues.html" class="a">Eigenvalues</a></li><li><a href="singular-values.html" class="a">Singular Values</a></li></ul>
        <h3 id="d126e3673">External Websites</h3><ul class="list-unstyled"><li><a href="https://www.mathworks.com/matlabcentral/fileexchange/94730-matrix-methods-of-linear-algebra">Matrix Methods of Linear Algebra (MathWorks Teaching Resources)</a></li><li><a href="https://www.mathworks.com/matlabcentral/fileexchange/136364-applied-linear-algebra">Applied Linear Algebra (MathWorks Teaching Resources)</a></li></ul>
    </section>
    </div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Solve XOR Problem Using Quantum Neural Network (QNN)</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../quantum-computing.html",
          "name": "Quantum Computing"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../gate-based-quantum-computing.html",
          "name": "Gate-Based Quantum Computing"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "gate-based-quantum-computing"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Solve XOR Problem Using Quantum Neural Network (QNN)",
          "description": "Solve the XOR problem using a trained quantum neural network (QNN). You use the network to classify the classical data of 2-D coordinates. A QNN is a machine learning model that combines quantum computing layers and classical layers. This example shows how to train such a hybrid network for a classification problem that is nonlinearly separable, such as the exclusive-OR (XOR) problem.",
          "thumbnailURL": "../../examples/quantum/win64/QuantumNeuralNetworkQNNExample_06.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "identifier": "quantum.QuantumNeuralNetworkQNNExample",
          "name": "QuantumNeuralNetworkQNNExample",
          "url": "solve-xor-problem-using-quantum-neural-network.html"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('quantum/QuantumNeuralNetworkQNNExample')"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "QuantumNeuralNetworkQNNExample.mlx",
        "PQCLayer.m"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="ug">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="other">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This example shows how to solve the XOR problem using a trained quantum neural network (QNN)."><meta xmlns="http://www.w3.org/1999/xhtml" content="../../examples/quantum/win64/QuantumNeuralNetworkQNNExample_06.png" itemprop="thumbnailUrl">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../quantum-computing.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Quantum Computing</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../gate-based-quantum-computing.html?s_tid=CRUX_lftnav" itemprop="url" id="mw_89c73565-106a-4694-9620-a4310ac5bfc3"><span itemprop="title">Gate-Based Quantum Computing</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item"><a href="#responsive_offcanvas">Solve XOR Problem Using Quantum Neural Network (QNN)</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#QuantumNeuralNetworkQNNExample-1" class="nav-link intrnllnk">Generate Training and Validation Data</a></li><li class="nav-item"><a href="#QuantumNeuralNetworkQNNExample-2" class="nav-link intrnllnk">Create Parameterized Quantum Computing layer</a></li><li class="nav-item"><a href="#QuantumNeuralNetworkQNNExample-6" class="nav-link intrnllnk">Define Network Architecture</a></li><li class="nav-item"><a href="#QuantumNeuralNetworkQNNExample-7" class="nav-link intrnllnk">Specify Training Options</a></li><li class="nav-item"><a href="#QuantumNeuralNetworkQNNExample-8" class="nav-link intrnllnk">Train Network</a></li><li class="nav-item"><a href="#QuantumNeuralNetworkQNNExample-9" class="nav-link intrnllnk">Test Network</a></li><li class="nav-item"><a href="#QuantumNeuralNetworkQNNExample-10" class="nav-link intrnllnk">References</a></li><li class="nav-item"><a href="#seealsoref" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=gate-based-quantum-computing&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=gate-based-quantum-computing&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=gate-based-quantum-computing&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=gate-based-quantum-computing&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=gate-based-quantum-computing&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=gate-based-quantum-computing&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-topic">
<section><h1 class="r2025b" itemprop="title content" id="mw_ad094e71-4b2f-47fe-9f5c-e40d96f4f3a0">Solve XOR Problem Using Quantum Neural Network (QNN)</h1><div class="examples_short_list hidden_ios_android" data-products="ML QUANTUM NN"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><p class="add_margin_5">This example uses:</p><ul class="list-unstyled add_border_bottom example_product_list" itemprop="requiredprods"><li><a href="matlab:matlab.internal.addons.showAddon('QUANTUM')">MATLAB Support Package for Quantum Computing</a></li><li><a href="matlab:matlab.internal.addons.showAddon('NN')">Deep Learning Toolbox</a></li></ul><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('quantum/QuantumNeuralNetworkQNNExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="quantum-QuantumNeuralNetworkQNNExample"><meta itemprop="exampletitle" content="Solve XOR Problem Using Quantum Neural Network (QNN)"></div><span id="QuantumNeuralNetworkQNNExample" class="anchor_target"></span><p class="shortdesc">This example shows how to solve the XOR problem using a trained quantum neural network (QNN). You use the network to classify the classical data of 2-D coordinates. A QNN is a machine learning model that combines quantum computing layers and classical layers. This example shows how to train such a hybrid network for a classification problem that is nonlinearly separable, such as the exclusive-OR (XOR) problem.</p><div class="informalfigure"><div id="d126e67569" class="mediaobject"><p><img src="../../examples/quantum/win64/QuantumNeuralNetworkQNNExample_01.png" alt="Classification of 2-D data points in the XOR problem using a trained network" height="186" width="526"></p></div></div><p>In the XOR problem, two-dimensional (2-D) data points are classified based on the region of their <span class="emphasis"><em>x</em></span>- and <span class="emphasis"><em>y</em></span>-coordinates using a mapping function that resembles the XOR function. If the <span class="emphasis"><em>x</em></span>- and <span class="emphasis"><em>y</em></span>-coordinates are both in region 0 or 1, then the data are classified into class "0". Otherwise, the data are classified into class "1". In this problem, a single linear decision boundary cannot solve the classification problem. Instead, nonlinear decision boundaries are required to classify the data.</p><p>This example shows a proof-of-concept idea about how to train a QNN using a local simulation. For more general frameworks using a hybrid quantum-classical model to classify quantum and classical data, see references <a href="solve-xor-problem-using-quantum-neural-network.html#mw_rtc_QuantumNeuralNetworkQNNExample_M_6805CF50" class="intrnllnk">[1]</a> and <a href="solve-xor-problem-using-quantum-neural-network.html#mw_rtc_QuantumNeuralNetworkQNNExample_M_8184A34F" class="intrnllnk">[2]</a>. The QNN in this example consists of four layers:</p><div class="itemizedlist"><ul><li><p>A feature input layer for the XOR problem.</p></li><li><p>A parameterized quantum circuit (PQC) as the ansatz circuit. This circuit prepares the states of qubits according to the coordinates of the input data with learnable parameters. The circuit then measures the probability distributions of the quantum states along the <span class="emphasis"><em>z</em></span>-axis and passes them to the next layers.</p></li><li><p>A fully connected layer that applies a linear transformation to the quantum circuit measurements through a weight matrix and a bias vector.</p></li><li><p>A two-output softmax layer, which outputs probabilities for the data classification.</p></li></ul></div><div class="informalfigure"><div id="d126e67604" class="mediaobject"><p><img src="../../examples/quantum/win64/QuantumNeuralNetworkQNNExample_02.png" alt="Quantum neural network with quantum computing and classical layers" height="181" width="579"></p></div></div><p>Finally, train the network by computing the cross-entropy loss for classification and propagating the gradients of the loss with respect to the learnable parameters through the layers, using the stochastic gradient descent with momentum (SGDM) optimizer.</p><div class="procedure"><h3 class="title" id="QuantumNeuralNetworkQNNExample-1"><strong class="emphasis bold">Generate Training and Validation Data</strong></h3><p>The <code class="literal">generateData</code> function creates a sample of data points for the XOR problem. This function classifies data into two groups: <code class="literal">"Blue"</code> and <code class="literal">"Yellow"</code>. If the coordinates of the data points satisfy <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi><mo>&gt;</mo><mn>1</mn></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">y</mi><mo>&gt;</mo><mn>0</mn><mo>.</mo><mn>5</mn></mrow></math></span>, or <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi><mo>&lt;</mo><mn>1</mn></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">y</mi><mo>&lt;</mo><mn>0</mn><mo>.</mo><mn>5</mn></mrow></math></span>, then this function classifies the data points as <code class="literal">"Blue"</code>. Otherwise, if the coordinates of the data points satisfy <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi><mo>&gt;</mo><mn>1</mn></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">y</mi><mo>&lt;</mo><mn>0</mn><mo>.</mo><mn>5</mn></mrow></math></span>, or <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi><mo>&lt;</mo><mn>1</mn></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">y</mi><mo>&gt;</mo><mn>0</mn><mo>.</mo><mn>5</mn></mrow></math></span>, then this function classifies the data points as <code class="literal">"Yellow"</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> [X,Y] = generateData(numSamples)
    X = zeros(numSamples,2);
    labels = strings(numSamples,1);
    <span style="color:#0000FF">for</span> i = 1:numSamples
        x1 = 2*rand;
        x2 = rand;
        X(i,:) = [x1 x2];
        <span style="color:#0000FF">if</span> (x1 &gt; 1 &amp;&amp; x2 &gt; 0.5) || (x1 &lt; 1 &amp;&amp; x2 &lt; 0.5)    
            labels(i) = <span style="color:#A020F0">"Blue"</span>;
        <span style="color:#0000FF">else</span>
            labels(i) = <span style="color:#A020F0">"Yellow"</span>;
        <span style="color:#0000FF">end</span>
    <span style="color:#0000FF">end</span>
    Y = categorical(labels);
<span style="color:#0000FF">end</span></pre></div></div></div><p>Generate training data with 200 data points using the <code class="literal">generateData</code> function. The network classifies the data into the <code class="literal">"Blue"</code> and <code class="literal">"Yellow"</code> classes.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>numSamples = 200;
[X,Y] = generateData(numSamples);
classNames = [<span style="color:#A020F0">"Blue"</span>, <span style="color:#A020F0">"Yellow"</span>];</pre></div></div></div><p>The input for each data point has the form of 2-D coordinates. Specify the number of classes in the training data.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>inputSize = size(X,2);
numClasses = numel(classNames);</pre></div></div></div><p>Next, generate validation data with 100 data points using the <code class="literal">generateData</code> function.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>numValidation = 100;
[XValidation,YValidation] = generateData(numValidation);</pre></div></div></div><h3 class="title" id="QuantumNeuralNetworkQNNExample-2"><strong class="emphasis bold">Create Parameterized Quantum Computing layer</strong></h3><p>Define a custom layer for the quantum circuit. For more information about creating a custom deep learning layer in MATLAB&#174;, see <a href="../../deeplearning/ug/define-custom-deep-learning-layer.html" data-docid="nnet_ug#mw_8b4d91a4-3c08-49a1-8647-2c5fbc1841e8" class="a">Define Custom Deep Learning Layer with Learnable Parameters</a><span role="cross_prod"> (Deep Learning Toolbox)</span>.</p><h4 class="title" id="QuantumNeuralNetworkQNNExample-3">Forward Pass</h4><p>The quantum circuit consists of two qubits that are initially in the <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mfenced open="|" close="anglebracketright"><mrow><mn>0</mn></mrow></mfenced></mrow></math></span> state. Construct the quantum circuit by applying an RX gate with the rotation angle <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi>θ</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></math></span> to the first qubit and an RX gate with the rotation angle <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi>θ</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></math></span> to the second qubit, followed by a controlled NOT gate to the first qubit as the control and the second qubit as the target. These gates prepare the states of the qubits according to the coordinates of the input data by introducing two adjustable learnable parameters <span class="emphasis"><em>A</em></span> and <span class="emphasis"><em>B</em></span> in the rotation angles. These parameters are the scaling factors for the rotation angles of each qubit, which scale the <span class="emphasis"><em>x</em></span>- and <span class="emphasis"><em>y</em></span>-coordinates of the XOR problem to <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi>θ</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>=</mo><mi mathvariant="normal">Ax</mi></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi>θ</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>=</mo><mi mathvariant="normal">By</mi></mrow></math></span>. You then perform a measurement on the second qubit in the <span class="emphasis"><em>Z</em></span> basis. The quantity of interest is the <span class="emphasis"><em>magnetization</em></span> of the second qubit, which is the difference in counts of this qubit being in the <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mfenced open="|" close="anglebracketright"><mrow><mn>0</mn></mrow></mfenced></mrow></math></span> state and the <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mfenced open="|" close="anglebracketright"><mrow><mn>1</mn></mrow></mfenced></mrow></math></span> state. For this quantum circuit, the measured quantity <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mrow><mo>⟨</mo><mrow><mover accent="true"><mrow><mi mathvariant="italic">Z</mi></mrow><mrow><mo>ˆ</mo></mrow></mover></mrow><mo>⟩</mo></mrow></mrow></math></span> has a predicted form of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="normal">cos</mi><mtext> </mtext><msub><mrow><mi>θ</mi></mrow><mrow><mn>1</mn></mrow></msub><mtext> </mtext><mi mathvariant="normal">cos</mi><mtext> </mtext><msub><mrow><mi>θ</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></math></span> based on the states of the qubits. You then use the condition <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mrow><mo>⟨</mo><mrow><mover accent="true"><mrow><mi mathvariant="italic">Z</mi></mrow><mrow><mo>ˆ</mo></mrow></mover></mrow><mo>⟩</mo></mrow><mo>=</mo><mn>0</mn></mrow></math></span> to determine the classification boundaries of the XOR problem. In this conceptual example, you use local simulation to determine the probabilities of measuring the qubit in these states instead of real counts on quantum hardware.</p><div class="informalfigure"><div id="d126e67862" class="mediaobject"><p><img src="../../examples/quantum/win64/QuantumNeuralNetworkQNNExample_03.png" alt="Forward pass by the quantum gates in the parameterized quantum circuit" height="225" width="832"></p></div></div><h4 class="title" id="QuantumNeuralNetworkQNNExample-4">Backpropagation</h4><p>To train the network, the derivative of the loss function through the quantum computing layer needs to be backpropagated. Backpropagation requires the computation of the gradients of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mrow><mo>⟨</mo><mrow><mover accent="true"><mrow><mi mathvariant="italic">Z</mi></mrow><mrow><mo>ˆ</mo></mrow></mover></mrow><mo>⟩</mo></mrow></mrow></math></span> with respect to the learnable parameters. To find these gradients, use the parameter-shift rules that are valid at the operator level, as described in <a href="solve-xor-problem-using-quantum-neural-network.html#mw_rtc_QuantumNeuralNetworkQNNExample_M_C3BADC70" class="intrnllnk">[3]</a> and <a href="solve-xor-problem-using-quantum-neural-network.html#mw_rtc_QuantumNeuralNetworkQNNExample_M_9F0FA190" class="intrnllnk">[4]</a>. For this quantum circuit, these equations give the gradients of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true"><mrow><mo>⟨</mo><mrow><mover accent="true"><mrow><mi mathvariant="italic">Z</mi></mrow><mrow><mo>ˆ</mo></mrow></mover></mrow><mo>⟩</mo></mrow></math></span> with respect to the learnable parameters <span class="emphasis"><em>A</em></span> and <span class="emphasis"><em>B</em></span>.</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mtable columnalign="left"><mtr><mtd><mrow><mfrac><mrow><mo>∂</mo></mrow><mrow><mo>∂</mo><mi mathvariant="italic">A</mi></mrow></mfrac><mrow><mo>⟨</mo><mrow><mover accent="true"><mrow><mi mathvariant="italic">Z</mi></mrow><mrow><mo>ˆ</mo></mrow></mover><mrow><mo>(</mo><mrow><mi mathvariant="italic">A</mi><mo>,</mo><mi mathvariant="italic">B</mi></mrow><mo>)</mo></mrow></mrow><mo>⟩</mo></mrow><mo>=</mo><mi mathvariant="italic">x</mi><mfrac><mrow><mrow><mo>⟨</mo><mrow><mover accent="true"><mrow><mi mathvariant="italic">Z</mi></mrow><mrow><mo>ˆ</mo></mrow></mover><mrow><mo>(</mo><mrow><mi mathvariant="italic">A</mi><mo>+</mo><mi mathvariant="italic">s</mi><mo>,</mo><mi mathvariant="italic">B</mi></mrow><mo>)</mo></mrow></mrow><mo>⟩</mo></mrow><mo>-</mo><mrow><mo>⟨</mo><mrow><mover accent="true"><mrow><mi mathvariant="italic">Z</mi></mrow><mrow><mo>ˆ</mo></mrow></mover><mrow><mo>(</mo><mrow><mi mathvariant="italic">A</mi><mo>-</mo><mi mathvariant="italic">s</mi><mo>,</mo><mi mathvariant="italic">B</mi></mrow><mo>)</mo></mrow></mrow><mo>⟩</mo></mrow></mrow><mrow><mn>2</mn><mtext> </mtext><mi mathvariant="normal">sin</mi><mrow><mo>(</mo><mrow><mi mathvariant="normal">sx</mi></mrow><mo>)</mo></mrow></mrow></mfrac></mrow></mtd></mtr><mtr><mtd><mrow><mfrac><mrow><mo>∂</mo></mrow><mrow><mo>∂</mo><mi mathvariant="italic">B</mi></mrow></mfrac><mrow><mo>⟨</mo><mrow><mover accent="true"><mrow><mi mathvariant="italic">Z</mi></mrow><mrow><mo>ˆ</mo></mrow></mover><mrow><mo>(</mo><mrow><mi mathvariant="italic">A</mi><mo>,</mo><mi mathvariant="italic">B</mi></mrow><mo>)</mo></mrow></mrow><mo>⟩</mo></mrow><mo>=</mo><mi mathvariant="italic">y</mi><mfrac><mrow><mrow><mo>⟨</mo><mrow><mover accent="true"><mrow><mi mathvariant="italic">Z</mi></mrow><mrow><mo>ˆ</mo></mrow></mover><mrow><mo>(</mo><mrow><mi mathvariant="italic">A</mi><mo>,</mo><mi mathvariant="italic">B</mi><mo>+</mo><mi mathvariant="italic">s</mi></mrow><mo>)</mo></mrow></mrow><mo>⟩</mo></mrow><mo>-</mo><mrow><mo>⟨</mo><mrow><mover accent="true"><mrow><mi mathvariant="italic">Z</mi></mrow><mrow><mo>ˆ</mo></mrow></mover><mrow><mo>(</mo><mrow><mi mathvariant="italic">A</mi><mo>,</mo><mi mathvariant="italic">B</mi><mo>-</mo><mi mathvariant="italic">s</mi></mrow><mo>)</mo></mrow></mrow><mo>⟩</mo></mrow></mrow><mrow><mn>2</mn><mtext> </mtext><mi mathvariant="normal">sin</mi><mrow><mo>(</mo><mrow><mi mathvariant="normal">sy</mi></mrow><mo>)</mo></mrow></mrow></mfrac></mrow></mtd></mtr></mtable></mrow></math></p></div><p></p><p>As in [3], the gradients of the expectation values are exact for any choice of <span class="emphasis"><em>s</em></span> as long as <span class="emphasis"><em>s</em></span> is not an integer multiple of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi>π</mi></mrow></math></span>. This example chooses <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">s</mi><mo>=</mo><mfrac><mrow><mi>π</mi></mrow><mrow><mn>4</mn></mrow></mfrac></mrow></math></span>.</p><h4 class="title" id="QuantumNeuralNetworkQNNExample-5">Define Custom Layer</h4><p>To create a custom layer for the quantum circuit, create the <code class="literal">PQCLayer</code> class with this definition:</p><div class="itemizedlist"><ul><li><p>In the <code class="literal">properties</code> block, define the learnable parameters <code class="literal">A</code> and <code class="literal">B</code>.</p></li><li><p>Specify the layer constructor function as <code class="literal">PQCLayer</code>. In the constructor, specify the layer name, the layer description, and the initial values of the learnable parameters.</p></li><li><p>Specify the <code class="literal">predict</code> layer, which computes the <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mrow><mo>⟨</mo><mrow><mover accent="true"><mrow><mi mathvariant="italic">Z</mi></mrow><mrow><mo>ˆ</mo></mrow></mover></mrow><mo>⟩</mo></mrow></mrow></math></span> measurement at prediction time.</p></li><li><p>Specify the <code class="literal">backward</code> layer, which backpropagates the derivative of the loss function through the layer. You do not need the gradients of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mrow><mo>⟨</mo><mrow><mover accent="true"><mrow><mi mathvariant="italic">Z</mi></mrow><mrow><mo>ˆ</mo></mrow></mover></mrow><mo>⟩</mo></mrow></mrow></math></span> with respect to the <span class="emphasis"><em>x</em></span>- and <span class="emphasis"><em>y</em></span>-coordinates because you do not use the gradients of the loss function with respect to <span class="emphasis"><em>x</em></span> and <span class="emphasis"><em>y</em></span> during training.</p></li><li><p>Specify a <code class="literal">computeZ</code> function that defines the quantum circuit and computes the <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mrow><mo>⟨</mo><mrow><mover accent="true"><mrow><mi mathvariant="italic">Z</mi></mrow><mrow><mo>ˆ</mo></mrow></mover></mrow><mo>⟩</mo></mrow></mrow></math></span> measurement. Create the quantum circuit with two qubits by using <code class="literal">quantumCircuit</code>. Add the two RX gates with the rotation angles <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi>θ</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>=</mo><mi mathvariant="normal">Ax</mi></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi>θ</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>=</mo><mi mathvariant="normal">By</mi></mrow></math></span> by using <code class="literal">rxGate</code> and the CNOT gate by using <code class="literal">cxGate</code>. Locally simulate the final state of the quantum circuit by using <code class="literal">simulate</code>. Compute the predicted <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mrow><mo>⟨</mo><mrow><mover accent="true"><mrow><mi mathvariant="italic">Z</mi></mrow><mrow><mo>ˆ</mo></mrow></mover></mrow><mo>⟩</mo></mrow></mrow></math></span> measurement on the second qubit by using the <code class="literal">probability</code> function to find the difference in counts of this qubit being in the <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mfenced open="|" close="anglebracketright"><mrow><mn>0</mn></mrow></mfenced></mrow></math></span> state and the <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mfenced open="|" close="anglebracketright"><mrow><mn>1</mn></mrow></mfenced></mrow></math></span> state.</p></li></ul></div><p>Save the <code class="literal">PQCLayer</code> class definition in a separate file on the path.</p><div class="code_responsive"><pre id="d126e68271" class="programlisting"><span style="color:#0000FF">classdef</span> PQCLayer &lt; nnet.layer.Layer
    <span style="color:#228B22">% Custom PQC layer example.</span>

    <span style="color:#0000FF">properties</span> (Learnable)
        <span style="color:#228B22">% Define layer learnable parameters.</span>
        A
        B
    <span style="color:#0000FF">end</span>

    <span style="color:#0000FF">methods</span>
        <span style="color:#0000FF">function</span> layer = PQCLayer
            <span style="color:#228B22">% Set layer name.</span>
            layer.Name = <span style="color:#A020F0">"PQC"</span>;

            <span style="color:#228B22">% Set layer description.</span>
            layer.Description = <span style="color:#A020F0">"Layer containing a parameterized "</span> + <span style="color:#0000FF">...</span>
                <span style="color:#A020F0">"quantum circuit (PQC)"</span>;

            <span style="color:#228B22">% Initialize learnable parameter.</span>
            layer.A = 1;
            layer.B = 2;
        <span style="color:#0000FF">end</span>

        <span style="color:#0000FF">function</span> Z = predict(layer,X)
            <span style="color:#228B22">% Z = predict(layer,X) forwards the input data X through the</span>
            <span style="color:#228B22">% layer and outputs the result Z at prediction time.</span>
            Z = computeZ(X,layer.A,layer.B);
        <span style="color:#0000FF">end</span>

        <span style="color:#0000FF">function</span> [dLdX,dLdA,dLdB] = backward(layer,X,Z,dLdZ,memory)
            <span style="color:#228B22">% Backpropagate the derivative of the loss</span>
            <span style="color:#228B22">% function through the layer.</span>
            <span style="color:#228B22">%</span>
            <span style="color:#228B22">% Inputs:</span>
            <span style="color:#228B22">%     layer   - Layer though which data backpropagates</span>
            <span style="color:#228B22">%     X       - Layer input data</span>
            <span style="color:#228B22">%     Z       - Layer output data</span>
            <span style="color:#228B22">%     dLdZ    - Derivative of loss with respect to layer</span>
            <span style="color:#228B22">%               output</span>
            <span style="color:#228B22">%     memory  - Memory value from forward function</span>
            <span style="color:#228B22">% Outputs:</span>
            <span style="color:#228B22">%     dLdX   - Derivative of loss with respect to layer input</span>
            <span style="color:#228B22">%     dLdA   - Derivative of loss with respect to learnable</span>
            <span style="color:#228B22">%              parameter A</span>
            <span style="color:#228B22">%     dLdB   - Derivative of loss with respect to learnable</span>
            <span style="color:#228B22">%              parameter B</span>

            s = pi/4;
            ZPlus = computeZ(X,layer.A + s,layer.B);
            ZMinus = computeZ(X,layer.A - s,layer.B);
            dZdA = X(1,:).*((ZPlus - ZMinus)./(2*sin(X(1,:).*s)));
            dLdA = sum(dLdZ.*dZdA,<span style="color:#A020F0">"all"</span>);

            ZPlus = computeZ(X,layer.A,layer.B + s);
            ZMinus = computeZ(X,layer.A,layer.B - s);
            dZdB = X(2,:).*(((ZPlus - ZMinus)./(2*sin(X(2,:).*s))));
            dLdB = sum(dLdZ.*dZdB,<span style="color:#A020F0">"all"</span>);

            <span style="color:#228B22">% Set the gradients with respect to x and y to zero</span>
            <span style="color:#228B22">% because the QNN does not use them during training.</span>
            dLdX = zeros(size(X),<span style="color:#A020F0">"like"</span>,X);
        <span style="color:#0000FF">end</span>
    <span style="color:#0000FF">end</span>
<span style="color:#0000FF">end</span>

<span style="color:#0000FF">function</span> Z = computeZ(X, A, B)
    numSamples = size(X,2);
    x1 = X(1,:);
    x2 = X(2,:);
    Z = zeros(1,numSamples,<span style="color:#A020F0">"like"</span>,X);
    <span style="color:#0000FF">for</span> i = 1:numSamples
        circ = quantumCircuit(2);
        circ.Gates = [rxGate(1,x1(i)*A); rxGate(2,x2(i)*B); cxGate(1,2)];
        s = simulate(circ);
        Z(i) = probability(s,2,<span style="color:#A020F0">"0"</span>) - probability(s,2,<span style="color:#A020F0">"1"</span>);
    <span style="color:#0000FF">end</span>
<span style="color:#0000FF">end</span>
</pre></div><h3 class="title" id="QuantumNeuralNetworkQNNExample-6"><strong class="emphasis bold">Define Network Architecture</strong></h3><p>Define the layers in the QNN that you train to solve the XOR problem.</p><div class="itemizedlist"><ul><li><p>Create a feature input layer with observations consisting of two features. These features correspond to the coordinates of the XOR problem.</p></li><li><p>Specify a quantum computing layer using the <code class="literal">PQCLayer</code> class.</p></li><li><p>For classification, specify a fully connected layer with a size equal to the number of classes.</p></li><li><p>Map the output to probabilities by including a softmax layer.</p></li></ul></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>layers = [featureInputLayer(inputSize)
          PQCLayer
          fullyConnectedLayer(numClasses)
          softmaxLayer];</pre></div></div></div><h3 class="title" id="QuantumNeuralNetworkQNNExample-7"><strong class="emphasis bold">Specify Training Options</strong></h3><p>Configure the SGDM optimizer with a mini-batch size of 20 for each iteration, a learning rate of 0.1, and a momentum of 0.9. Specify data for validation during training, with a validation frequency of 10 iterations. Shuffle the training data before each training epoch and shuffle the validation data before each neural network validation. Use the CPU to train the network. Turn on the training progress plot to monitor accuracy and suppress the training progress indicator in the Command Window.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>options = trainingOptions(<span style="color:#A020F0">"sgdm"</span>, <span style="color:#0000FF">...</span>
    MiniBatchSize=20, <span style="color:#0000FF">...</span>
    InitialLearnRate=0.1, <span style="color:#0000FF">...</span>
    Momentum=0.9, <span style="color:#0000FF">...</span>
    ValidationData={XValidation,YValidation}, <span style="color:#0000FF">...</span>
    ValidationFrequency=5, <span style="color:#0000FF">...</span>
    Shuffle=<span style="color:#A020F0">"every-epoch"</span>, <span style="color:#0000FF">...</span>
    ExecutionEnvironment=<span style="color:#A020F0">"cpu"</span>, <span style="color:#0000FF">...</span>
    Plots=<span style="color:#A020F0">"training-progress"</span>, <span style="color:#0000FF">...</span>
    Metrics=<span style="color:#A020F0">"accuracy"</span>, <span style="color:#0000FF">...</span>
    Verbose=false);</pre></div></div></div><h3 class="title" id="QuantumNeuralNetworkQNNExample-8"><strong class="emphasis bold">Train Network</strong></h3><p>Train the QNN. For classification, use cross-entropy loss. After 300 iterations, the result shows an excellent accuracy above 90% for classifying the XOR problem.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>net = trainnet(X,Y,layers,<span style="color:#A020F0">"crossentropy"</span>,options)</pre></div></div></div><div class="informalfigure"><div id="d126e68307" class="mediaobject"><p><img src="../../examples/quantum/win64/QuantumNeuralNetworkQNNExample_04.png" width="1048"></p></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>net = 
  dlnetwork with properties:

         Layers: [4×1 nnet.cnn.layer.Layer]
    Connections: [3×2 table]
     Learnables: [4×3 table]
          State: [0×3 table]
     InputNames: {'input'}
    OutputNames: {'softmax'}
    Initialized: 1

  View summary with summary.

</pre></div></div></div><h3 class="title" id="QuantumNeuralNetworkQNNExample-9">Test Network</h3><p>Test the classification accuracy of the network by comparing the predictions on the test data with the true labels.</p><p>Generate new test data not used during training.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[XTest,trueLabels] = generateData(numSamples);</pre></div></div></div><p>Compute the output of the trained network for inference given the test data. Convert this output into predicted class labels.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>YTest = predict(net,XTest);
predictedLabels = scores2label(YTest,classNames);</pre></div></div></div><p>Plot the predicted classification for the test data.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>gscatter(XTest(:,1),XTest(:,2),predictedLabels,<span style="color:#A020F0">"by"</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e68325" class="mediaobject"><p><img src="../../examples/quantum/win64/QuantumNeuralNetworkQNNExample_05.png" alt="Figure contains an axes object. The axes object contains 2 objects of type line. One or more of the lines displays its values using only markers These objects represent Blue, Yellow." width="560"></p></div></div><p>Visualize the accuracy of the predictions in a confusion chart. Large values on the diagonal indicate accurate predictions for the corresponding class. Large values on the off-diagonal indicate strong confusion between the corresponding classes. Here, the confusion chart shows very small errors in classifying the test data.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>confusionchart(trueLabels,predictedLabels)</pre></div></div></div><div class="informalfigure"><div id="d126e68334" class="mediaobject"><p><img src="../../examples/quantum/win64/QuantumNeuralNetworkQNNExample_06.png" alt="Figure contains an object of type ConfusionMatrixChart." width="560"></p></div></div><p>Finally, calculate the classification accuracy of the trained network given the test data.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>accuracy = testnet(net,XTest,trueLabels,<span style="color:#A020F0">"accuracy"</span>)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>accuracy = 
99
</pre></div></div></div><h3 class="title" id="QuantumNeuralNetworkQNNExample-10">References</h3><span id="mw_rtc_QuantumNeuralNetworkQNNExample_M_6805CF50" class="anchor_target"></span><p>[1] Broughton, Michael, Guillaume Verdon, Trevor McCourt, Antonio J. Martinez, Jae Hyeon Yoo, Sergei V. Isakov, Philip Massey, et al. "TensorFlow Quantum: A Software Framework for Quantum Machine Learning." Preprint, submitted August 26, 2021. <a href="https://doi.org/10.48550/arXiv.2003.02989" target="_blank">https://doi.org/10.48550/arXiv.2003.02989</a>.</p><span id="mw_rtc_QuantumNeuralNetworkQNNExample_M_8184A34F" class="anchor_target"></span><p>[2] Farhi, Edward, and Hartmut Neven. "Classification with Quantum Neural Networks on Near Term Processors." Preprint, submitted August 30, 2018. <a href="https://doi.org/10.48550/arXiv.1802.06002" target="_blank">https://doi.org/10.48550/arXiv.1802.06002</a>.</p><span id="mw_rtc_QuantumNeuralNetworkQNNExample_M_C3BADC70" class="anchor_target"></span><p>[3] Mari, Andrea, Thomas R. Bromley, and Nathan Killoran. “Estimating the Gradient and Higher-Order Derivatives on Quantum Hardware.” <span class="emphasis"><em>Physical Review A</em></span> 103, no. 1 (January 11, 2021): 012405. <a href="https://doi.org/10.1103/PhysRevA.103.012405" target="_blank">https://doi.org/10.1103/PhysRevA.103.012405</a>.</p><span id="mw_rtc_QuantumNeuralNetworkQNNExample_M_9F0FA190" class="anchor_target"></span><p>[4] Wierichs, David, Josh Izaac, Cody Wang, and Cedric Yen-Yu Lin. “General Parameter-Shift Rules for Quantum Gradients.” <span class="emphasis"><em>Quantum</em></span> 6 (March 30, 2022): 677. <a href="https://doi.org/10.22331/q-2022-03-30-677" target="_blank">https://doi.org/10.22331/q-2022-03-30-677</a>.</p></div>
      
      <h2 id="seealsoref">See Also</h2><h3 id="d126e68378">Topics</h3><ul class="list-unstyled"><li><a href="introduction-to-quantum-computing.html" class="a">Introduction to Quantum Computing</a></li><li><a href="graph-coloring-with-grovers-algorithm.html" class="a">Graph Coloring with Grover's Algorithm</a></li><li><a href="ground-state-protein-folding-using-variational-quantum-eigensolver-vqe.html" class="a">Ground-State Protein Folding Using Variational Quantum Eigensolver (VQE)</a></li><li><a href="quantum-monte-carlo-simulation.html" class="a">Quantum Monte Carlo (QMC) Simulation</a></li></ul>
      
    </section>
    </div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

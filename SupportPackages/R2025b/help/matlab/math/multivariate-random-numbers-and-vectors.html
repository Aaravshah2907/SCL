<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Random Numbers and Vectors from Multivariate Normal Distributions</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../random-number-generation.html",
          "name": "Random Number Generation"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "random-number-generation"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Random Numbers and Vectors from Multivariate Normal Distributions",
          "description": "Generate and visualize random numbers and vectors that are drawn from multivariate normal distributions. This example discusses the steps to generate and visualize random numbers and vectors that are drawn from univariate, bivariate, and trivariate normal distributions. The randn function generates random numbers from the standard normal distribution. To generate random numbers and vectors from a multivariate normal distribution with a specific mean and covariance, you can transform the data generated from the standard normal distribution. Starting from a d-dimensional random variable u=[u1,u2,...,ud] that follows a normal distribution with zero mean and a unit covariance matrix, you can transform u to v=μ+uR. The variable v follows the normal distribution with mean μ and covariance matrix Σ=RTR. The covariance matrix Σ is a symmetric and positive definite (nonsingular) matrix, which indicates that the multivariate normal distribution is also nondegenerate. Therefore, you can perform Cholesky decomposition on Σ to obtain the upper triangular matrix R. A multivariate normal distribution that is degenerate, where Σ is not full rank (or singular), is beyond the scope of this example.",
          "thumbnailURL": "../../examples/matlab/win64/RandomNumbersAndVectorsFromMultivariateNormalExample_05.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "identifier": "matlab.RandomNumbersAndVectorsFromMultivariateNormalExample",
          "name": "RandomNumbersAndVectorsFromMultivariateNormalExample",
          "url": "multivariate-random-numbers-and-vectors.html"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/RandomNumbersAndVectorsFromMultivariateNormalExample')"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "RandomNumbersAndVectorsFromMultivariateNormalExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="fe">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ex">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This example shows how to generate and visualize random numbers and vectors that are drawn from multivariate normal distributions."><meta xmlns="http://www.w3.org/1999/xhtml" content="../../examples/matlab/win64/RandomNumbersAndVectorsFromMultivariateNormalExample_05.png" itemprop="thumbnailUrl">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/livecontrolpopover.js"></script>





<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../random-number-generation.html?s_tid=CRUX_lftnav" itemprop="url" id="btfmc36"><span itemprop="title">Random Number Generation</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item"><a href="#responsive_offcanvas">Random Numbers and Vectors from Multivariate Normal Distributions</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#RandomNumbersAndVectorsFromMultivariateNormalExample-1" class="nav-link intrnllnk">Univariate Normal Distribution</a></li><li class="nav-item"><a href="#RandomNumbersAndVectorsFromMultivariateNormalExample-4" class="nav-link intrnllnk">Multivariate Normal Distribution</a></li><li class="nav-item"><a href="#d126e12595" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=random-number-generation&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=random-number-generation&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=random-number-generation&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=random-number-generation&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=random-number-generation&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=random-number-generation&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-example">
<section><div class="example_icon"></div><h1 class="r2025b" itemprop="title content" id="mw_79c05718-2926-4cd2-9a97-37b99d2d3cd0">Random Numbers and Vectors from Multivariate Normal Distributions</h1><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/RandomNumbersAndVectorsFromMultivariateNormalExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-RandomNumbersAndVectorsFromMultivariateNormalExample"><meta itemprop="exampletitle" content="Random Numbers and Vectors from Multivariate Normal Distributions"></div><span id="RandomNumbersAndVectorsFromMultivariateNormalExample" class="anchor_target"></span><p class="shortdesc">This example shows how to generate and visualize random numbers and vectors that are drawn from multivariate normal distributions. This example discusses the steps to generate and visualize random numbers and vectors that are drawn from univariate, bivariate, and trivariate normal distributions. The <code class="literal">randn</code> function generates random numbers from the standard normal distribution. To generate random numbers and vectors from a multivariate normal distribution with a specific mean and covariance, you can transform the data generated from the standard normal distribution. Starting from a <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>d</mi></mrow></math></span>-dimensional random variable <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>u</mi></mrow></mstyle></mrow><mo>=</mo><mo stretchy="false">[</mo><msub><mrow><mi>u</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>,</mo><msub><mrow><mi>u</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>,</mo><mo stretchy="false">.</mo><mo stretchy="false">.</mo><mo stretchy="false">.</mo><mo>,</mo><msub><mrow><mi>u</mi></mrow><mrow><mi>d</mi></mrow></msub><mo stretchy="false">]</mo></mrow></math></span> that follows a normal distribution with zero mean and a unit covariance matrix, you can transform <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>u</mi></mrow></mstyle></mrow></mrow></math></span> to <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>v</mi></mrow></mstyle></mrow><mo>=</mo><mrow><mstyle mathvariant="bold"><mrow><mi>μ</mi></mrow></mstyle></mrow><mo>+</mo><mrow><mstyle mathvariant="bold"><mrow><mi>u</mi></mrow></mstyle></mrow><mrow><mstyle mathvariant="bold"><mrow><mi>R</mi></mrow></mstyle></mrow></mrow></math></span>. The variable <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>v</mi></mrow></mstyle></mrow></mrow></math></span> follows the normal distribution with mean <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>μ</mi></mrow></mstyle></mrow></mrow></math></span> and covariance matrix <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>Σ</mi></mrow></mstyle></mrow><mo>=</mo><msup><mrow><mstyle mathvariant="bold"><mrow><mi>R</mi></mrow></mstyle></mrow><mrow><mi>T</mi></mrow></msup><mrow><mstyle mathvariant="bold"><mrow><mi>R</mi></mrow></mstyle></mrow></mrow></math></span>. The covariance matrix <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>Σ</mi></mrow></mstyle></mrow></mrow></math></span> is a symmetric and positive definite (nonsingular) matrix, which indicates that the multivariate normal distribution is also nondegenerate. Therefore, you can perform Cholesky decomposition on <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>Σ</mi></mrow></mstyle></mrow></mrow></math></span> to obtain the upper triangular matrix <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>R</mi></mrow></mstyle></mrow></mrow></math></span>. A multivariate normal distribution that is degenerate, where <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>Σ</mi></mrow></mstyle></mrow></mrow></math></span> is not full rank (or singular), is beyond the scope of this example. </p><div class="procedure"><h3 class="title" id="RandomNumbersAndVectorsFromMultivariateNormalExample-1">Univariate Normal Distribution</h3><p>In statistics, a normal distribution, or Gaussian distribution, is a type of continuous probability distribution for a real random variable. The univariate normal distribution of the random variable <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>x</mi></mrow></math></span> is a probability density function (pdf) that has the form</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">f</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mi>σ</mi><msqrt><mrow><mn>2</mn><mi>π</mi></mrow></msqrt></mrow></mfrac><mi mathvariant="normal">exp</mi><mrow><mo>[</mo><mrow><mo>-</mo><mtext> </mtext><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></mfrac><msup><mrow><mrow><mo>(</mo><mrow><mfrac><mrow><mi mathvariant="italic">x</mi><mo>-</mo><mi>μ</mi></mrow><mrow><mi>σ</mi></mrow></mfrac></mrow><mo>)</mo></mrow></mrow><mrow><mn>2</mn></mrow></msup></mrow><mo>]</mo></mrow></mrow></math></span>.</p><p>The parameter <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>μ</mi></mrow></math></span> is the mean of the distribution, and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>σ</mi></mrow></math></span> is the standard deviation, with <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msup><mrow><mi>σ</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></math></span> being the variance of the distribution.</p><h4 class="title" id="RandomNumbersAndVectorsFromMultivariateNormalExample-2">Standard Normal Distribution</h4><p>The simplest case of a normal distribution is the standard normal distribution, which has a mean of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>μ</mi><mo>=</mo><mn>0</mn></mrow></math></span> and a standard deviation of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>σ</mi><mo>=</mo><mn>1</mn></mrow></math></span>. In MATLAB&#174;, you can use <code class="literal">randn</code> to generate random numbers that follow the standard normal distribution. For example, generate 10,000 random numbers.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>n = 10000;
x_standard = randn(n,1);</pre></div></div></div><p>Plot the probability density estimate of these numbers using <code class="literal">histogram</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>figure
histogram(x_standard,Normalization=<span style="color:#A020F0">"pdf"</span>,EdgeColor=<span style="color:#A020F0">"none"</span>)
xlabel(<span style="color:#A020F0">"x"</span>)
ylabel(<span style="color:#A020F0">"Probability Density"</span>)
grid <span style="color:#A020F0">on</span>
hold <span style="color:#A020F0">on</span></pre></div></div></div><p>To compare the sampled numbers with the pdf of the standard normal distribution, plot the pdf using <code class="literal">fplot</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>f = @(x) (1/sqrt(2*pi))*exp(-1/2*x.^2);
fplot(f,[-5 5],LineWidth=2)</pre></div></div></div><div class="informalfigure"><div id="d126e10882" class="mediaobject"><p><img src="../../examples/matlab/win64/RandomNumbersAndVectorsFromMultivariateNormalExample_01.png" alt="Figure contains an axes object. The axes object with xlabel x, ylabel Probability Density contains 2 objects of type histogram, functionline." width="560"></p></div></div><h4 class="title" id="RandomNumbersAndVectorsFromMultivariateNormalExample-3">Normal Distribution with Specified Mean and Standard Deviation</h4><p>To generate random numbers from a univariate normal distribution with a specific mean <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>μ</mi></mrow></math></span> and standard deviation <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>σ</mi></mrow></math></span>, you can transform the data generated from the standard normal distribution by multiplying the data by <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>σ</mi></mrow></math></span> and adding <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>μ</mi></mrow></math></span>. For example, transform the previously generated random numbers so that they follow a normal distribution with a mean of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>μ</mi><mo>=</mo><mo>-</mo><mn>2</mn></mrow></math></span> and a standard deviation of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>σ</mi><mo>=</mo><mn>3</mn></mrow></math></span>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>mu = -2;
sigma = 3;
x_transformed = sigma*x_standard + mu;</pre></div></div></div><p>Calculate the mean and the standard deviation of the transformed data. The results do not exactly match the specified mean and standard deviation because the calculation from the sampling of the distribution determines these results.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>mu_data = mean(x_transformed)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>mu_data = 
-1.9950
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>sigma_data = std(x_transformed)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>sigma_data = 
2.9744
</pre></div></div></div><p> Plot the probability density estimate and pdf of the transformed data. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>histogram(x_transformed,Normalization=<span style="color:#A020F0">"pdf"</span>,EdgeColor=<span style="color:#A020F0">"none"</span>)
g = @(x) (1/(sigma*sqrt(2*pi)))*exp(-1/2*((x-mu)/sigma).^2);
fplot(g,[-15 15],LineWidth=2)
hold <span style="color:#A020F0">off</span></pre></div></div></div><div class="informalfigure"><div id="d126e10941" class="mediaobject"><p><img src="../../examples/matlab/win64/RandomNumbersAndVectorsFromMultivariateNormalExample_02.png" alt="Figure contains an axes object. The axes object with xlabel x, ylabel Probability Density contains 4 objects of type histogram, functionline." width="560"></p></div></div><h3 class="title" id="RandomNumbersAndVectorsFromMultivariateNormalExample-4">Multivariate Normal Distribution</h3><p>The multivariate normal distribution extends the univariate normal distribution to two or more variables. It has two parameters: a mean vector <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>μ</mi></mrow></mstyle></mrow></mrow></math></span> and a covariance matrix <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>Σ</mi></mrow></mstyle></mrow></mrow></math></span>, which are analogous to the mean and variance parameters of a univariate normal distribution. In this example, the covariance matrix <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>Σ</mi></mrow></mstyle></mrow></mrow></math></span> is restricted to being a symmetric and positive definite (nonsingular) matrix, indicating that the multivariate normal distribution is nondegenerate. The diagonal elements of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>Σ</mi></mrow></mstyle></mrow></mrow></math></span> contain the variances for each variable, and the off-diagonal elements of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>Σ</mi></mrow></mstyle></mrow></mrow></math></span> contain the covariances between variables.</p><p>The pdf of the <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>d</mi></mrow></math></span>-dimensional multivariate normal distribution is</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mi>d</mi></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi mathvariant="normal">exp</mi><mrow><mo>(</mo><mo>-</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></mfrac><mo stretchy="false">(</mo><mrow><mstyle mathvariant="bold"><mrow><mi>v</mi></mrow></mstyle></mrow><mo>-</mo><mrow><mstyle mathvariant="bold"><mrow><mi>μ</mi></mrow></mstyle></mrow><mo stretchy="false">)</mo><mspace width="0.2777777777777778em"/><msup><mrow><mstyle mathvariant="bold"><mrow><mi>Σ</mi></mrow></mstyle></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup><mspace width="0.2777777777777778em"/><mo stretchy="false">(</mo><mrow><mstyle mathvariant="bold"><mrow><mi>v</mi></mrow></mstyle></mrow><mo>-</mo><mrow><mstyle mathvariant="bold"><mrow><mi>μ</mi></mrow></mstyle></mrow><msup><mrow><mo stretchy="false">)</mo></mrow><mrow><mi>T</mi></mrow></msup><mo>)</mo></mrow></mrow><mrow><msqrt><mrow><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><msup><mrow><mo stretchy="false">)</mo></mrow><mrow><mi>d</mi></mrow></msup><mrow><mo>|</mo><mrow><mstyle mathvariant="bold"><mrow><mi>Σ</mi></mrow></mstyle></mrow><mo>|</mo></mrow></mrow></msqrt></mrow></mfrac><mo>,</mo></mrow></math></p></div><p></p><p>where <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>v</mi></mrow></mstyle></mrow></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>μ</mi></mrow></mstyle></mrow></mrow></math></span> are 1-by-<span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>d</mi></mrow></math></span> row vectors, <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>Σ</mi></mrow></mstyle></mrow></mrow></math></span> is a <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>d</mi></mrow></math></span>-by-<span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>d</mi></mrow></math></span> symmetric, positive definite matrix, and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mo>|</mo><mrow><mstyle mathvariant="bold"><mrow><mi>Σ</mi></mrow></mstyle></mrow><mo>|</mo></mrow></mrow></math></span> is the determinant of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>Σ</mi></mrow></mstyle></mrow></mrow></math></span>.</p><h4 class="title" id="RandomNumbersAndVectorsFromMultivariateNormalExample-5">Bivariate Normal Distribution with Zero Mean and Unit Covariance</h4><p>In the two-dimensional case, the multivariate normal distribution becomes a bivariate normal distribution, which can also be written as</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn><mi>π</mi><msub><mrow><mi>σ</mi></mrow><mrow><mi>x</mi></mrow></msub><msub><mrow><mi>σ</mi></mrow><mrow><mi>y</mi></mrow></msub><msqrt><mrow><mn>1</mn><mo>-</mo><msubsup><mrow><mi>ρ</mi></mrow><mrow><mi>x</mi><mi>y</mi></mrow><mrow><mn>2</mn></mrow></msubsup></mrow></msqrt></mrow></mfrac><mi mathvariant="normal">exp</mi><mrow><mo>(</mo><mo>-</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn><mrow><mo>(</mo><mn>1</mn><mo>-</mo><msubsup><mrow><mi>ρ</mi></mrow><mrow><mi>x</mi><mi>y</mi></mrow><mrow><mn>2</mn></mrow></msubsup><mo>)</mo></mrow></mrow></mfrac><mrow><mo>[</mo><msup><mrow><mo>(</mo><mfrac><mrow><mi>x</mi><mo>-</mo><msub><mrow><mi>μ</mi></mrow><mrow><mi>x</mi></mrow></msub></mrow><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi>x</mi></mrow></msub></mrow></mfrac><mo>)</mo></mrow><mrow><mn>2</mn></mrow></msup><mo>-</mo><mn>2</mn><msub><mrow><mi>ρ</mi></mrow><mrow><mi>x</mi><mi>y</mi></mrow></msub><mrow><mo>(</mo><mfrac><mrow><mi>x</mi><mo>-</mo><msub><mrow><mi>μ</mi></mrow><mrow><mi>x</mi></mrow></msub></mrow><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi>x</mi></mrow></msub></mrow></mfrac><mo>)</mo></mrow><mrow><mo>(</mo><mfrac><mrow><mi>y</mi><mo>-</mo><msub><mrow><mi>μ</mi></mrow><mrow><mi>y</mi></mrow></msub></mrow><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi>y</mi></mrow></msub></mrow></mfrac><mo>)</mo></mrow><mo>+</mo><msup><mrow><mo>(</mo><mfrac><mrow><mi>y</mi><mo>-</mo><msub><mrow><mi>μ</mi></mrow><mrow><mi>y</mi></mrow></msub></mrow><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi>y</mi></mrow></msub></mrow></mfrac><mo>)</mo></mrow><mrow><mn>2</mn></mrow></msup><mo>]</mo></mrow><mo>)</mo></mrow><mo>,</mo></mrow></math></p></div><p></p><p>where the standard deviation of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>x</mi></mrow></math></span> is <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi>x</mi></mrow></msub><mo>&gt;</mo><mn>0</mn></mrow></math></span>, the standard deviation of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>y</mi></mrow></math></span> is <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi>y</mi></mrow></msub><mo>&gt;</mo><mn>0</mn></mrow></math></span>, and the correlation coefficient between the random variables <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>x</mi></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>y</mi></mrow></math></span> is <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mo>-</mo><mn>1</mn><mo>&lt;</mo><msub><mrow><mi>ρ</mi></mrow><mrow><mi>x</mi><mi>y</mi></mrow></msub><mo>&lt;</mo><mn>1</mn></mrow></math></span>. In this case, the mean vector is <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>μ</mi></mrow></mstyle></mrow><mo>=</mo><mrow><mo>[</mo><msub><mrow><mi>μ</mi></mrow><mrow><mi>x</mi></mrow></msub><mo>,</mo><mspace width="0.2222222222222222em"/><msub><mrow><mi>μ</mi></mrow><mrow><mi>y</mi></mrow></msub><mo>]</mo></mrow></mrow></math></span>. The covariance matrix is <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>Σ</mi></mrow></mstyle></mrow><mo>=</mo><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><msubsup><mrow><mi>σ</mi></mrow><mrow><mi>x</mi></mrow><mrow><mn>2</mn></mrow></msubsup></mrow></mtd><mtd><mrow><msub><mrow><mi>ρ</mi></mrow><mrow><mi>x</mi><mi>y</mi></mrow></msub><msub><mrow><mi>σ</mi></mrow><mrow><mi>x</mi></mrow></msub><msub><mrow><mi>σ</mi></mrow><mrow><mi>y</mi></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi>ρ</mi></mrow><mrow><mi>x</mi><mi>y</mi></mrow></msub><msub><mrow><mi>σ</mi></mrow><mrow><mi>x</mi></mrow></msub><msub><mrow><mi>σ</mi></mrow><mrow><mi>y</mi></mrow></msub></mrow></mtd><mtd><mrow><msubsup><mrow><mi>σ</mi></mrow><mrow><mi>y</mi></mrow><mrow><mn>2</mn></mrow></msubsup></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow></math></span>.</p><p>If <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi>x</mi></mrow></msub><mo>=</mo><msub><mrow><mi>σ</mi></mrow><mrow><mi>y</mi></mrow></msub></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msub><mrow><mi>ρ</mi></mrow><mrow><mi>x</mi><mi>y</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow></math></span>, then the bivariate normal distribution is a circularly symmetric bell-shaped surface in the <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>x</mi><mi>y</mi></mrow></math></span>-plane that is centered at <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>μ</mi></mrow></mstyle></mrow></mrow></math></span>.</p><p>For the special case where <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>x</mi></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>y</mi></mrow></math></span> are independent random variables that follow the standard normal distribution, the mean vector of the bivariate distribution is 0 and the covariance matrix is a 2-by-2 identity matrix. To generate random vectors that follow this bivariate normal distribution, you can use <code class="literal">randn</code> directly without any transformation. For example, generate 10,000 data points of 1-by-2 random vectors by specifying the array size when using <code class="literal">randn</code>. Plot the 2-D probability density estimate of these bivariate random vectors using <code class="literal">histogram2</code>. To compare the sampled vectors with the pdf of the bivariate normal distribution, plot the pdf using <code class="literal">fmesh</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>u = randn(n,2);

figure
histogram2(u(:,1),u(:,2),Normalization=<span style="color:#A020F0">"pdf"</span>,FaceAlpha=0.5,EdgeColor=<span style="color:#A020F0">"none"</span>)
xlabel(<span style="color:#A020F0">"x"</span>)
ylabel(<span style="color:#A020F0">"y"</span>)
zlabel(<span style="color:#A020F0">"Probability Density"</span>)
axis([-6 6 -6 6])
axis <span style="color:#A020F0">square</span>
view(10,30)
hold <span style="color:#A020F0">on</span>

mu = [0 0];
sigma = [1 0; 0 1];
f = @(x,y) exp(-0.5*dot(([x(:),y(:)]-mu),(sigma\([x(:),y(:)]-mu)')',2)')/ <span style="color:#0000FF">...</span>
    sqrt((2*pi)^2*det(sigma));
fmesh(f,FaceAlpha=0,EdgeColor=<span style="color:#A020F0">"cyan"</span>)
hold <span style="color:#A020F0">off</span></pre></div></div></div><div class="informalfigure"><div id="d126e11534" class="mediaobject"><p><img src="../../examples/matlab/win64/RandomNumbersAndVectorsFromMultivariateNormalExample_03.png" alt="Figure contains an axes object. The axes object with xlabel x, ylabel y contains 2 objects of type histogram2, functionsurface." width="560"></p></div></div><h4 class="title" id="RandomNumbersAndVectorsFromMultivariateNormalExample-6">Bivariate Normal Distribution with Specified Mean and Covariance Matrix</h4><p>To generate random vectors from a general bivariate normal distribution with a specific mean and covariance, you need to transform the previously generated data. Starting from a <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>d</mi></mrow></math></span>-dimensional random variable <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>u</mi></mrow></mstyle></mrow><mo>=</mo><mo stretchy="false">[</mo><msub><mrow><mi>u</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>,</mo><msub><mrow><mi>u</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>,</mo><mo stretchy="false">.</mo><mo stretchy="false">.</mo><mo stretchy="false">.</mo><mo>,</mo><msub><mrow><mi>u</mi></mrow><mrow><mi>d</mi></mrow></msub><mo stretchy="false">]</mo></mrow></math></span> that follows a normal distribution with zero mean and unit covariance matrix, you can transform <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>u</mi></mrow></mstyle></mrow></mrow></math></span> to <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>v</mi></mrow></mstyle></mrow><mo>=</mo><mrow><mstyle mathvariant="bold"><mrow><mi>μ</mi></mrow></mstyle></mrow><mo>+</mo><mrow><mstyle mathvariant="bold"><mrow><mi>u</mi></mrow></mstyle></mrow><mrow><mstyle mathvariant="bold"><mrow><mi>R</mi></mrow></mstyle></mrow></mrow></math></span>. The variable <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>v</mi></mrow></mstyle></mrow></mrow></math></span> follows the normal distribution with mean <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>μ</mi></mrow></mstyle></mrow></mrow></math></span> and covariance matrix <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>Σ</mi></mrow></mstyle></mrow><mo>=</mo><msup><mrow><mstyle mathvariant="bold"><mrow><mi>R</mi></mrow></mstyle></mrow><mrow><mi>T</mi></mrow></msup><mrow><mstyle mathvariant="bold"><mrow><mi>R</mi></mrow></mstyle></mrow></mrow></math></span>.</p><p>For example, specify the mean as <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>μ</mi></mrow></mstyle></mrow><mo>=</mo><mrow><mo>[</mo><mn>0</mn><mo stretchy="false">.</mo><mn>5</mn><mo>,</mo><mspace width="0.2222222222222222em"/><mn>1</mn><mo>]</mo></mrow></mrow></math></span>. Specify the standard deviation of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>x</mi></mrow></math></span> as <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi>x</mi></mrow></msub><mo>=</mo><mn>1</mn><mo stretchy="false">.</mo><mn>4</mn></mrow></math></span>, the standard deviation to <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>y</mi></mrow></math></span> as <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi>y</mi></mrow></msub><mo>=</mo><mn>2</mn></mrow></math></span>, and the correlation coefficient to <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msub><mrow><mi>ρ</mi></mrow><mrow><mi>x</mi><mi>y</mi></mrow></msub><mo>=</mo><mo>-</mo><mn>0</mn><mo stretchy="false">.</mo><mn>7</mn></mrow></math></span>. The covariance matrix becomes <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>Σ</mi></mrow></mstyle></mrow><mo>=</mo><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><msubsup><mrow><mi>σ</mi></mrow><mrow><mi>x</mi></mrow><mrow><mn>2</mn></mrow></msubsup></mrow></mtd><mtd><mrow><msub><mrow><mi>ρ</mi></mrow><mrow><mi>x</mi><mi>y</mi></mrow></msub><msub><mrow><mi>σ</mi></mrow><mrow><mi>x</mi></mrow></msub><msub><mrow><mi>σ</mi></mrow><mrow><mi>y</mi></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi>ρ</mi></mrow><mrow><mi>x</mi><mi>y</mi></mrow></msub><msub><mrow><mi>σ</mi></mrow><mrow><mi>x</mi></mrow></msub><msub><mrow><mi>σ</mi></mrow><mrow><mi>y</mi></mrow></msub></mrow></mtd><mtd><mrow><msubsup><mrow><mi>σ</mi></mrow><mrow><mi>y</mi></mrow><mrow><mn>2</mn></mrow></msubsup></mrow></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><mn>1</mn><mo stretchy="false">.</mo><mn>9</mn><mn>6</mn></mrow></mtd><mtd><mrow><mo>-</mo><mn>1</mn><mo stretchy="false">.</mo><mn>9</mn><mn>6</mn></mrow></mtd></mtr><mtr><mtd><mrow><mo>-</mo><mn>1</mn><mo stretchy="false">.</mo><mn>9</mn><mn>6</mn></mrow></mtd><mtd><mrow><mn>4</mn></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow></math></span>.</p><p>To interactively change the values of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi>x</mi></mrow></msub></mrow></math></span>, <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi>y</mi></mrow></msub></mrow></math></span>, and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msub><mrow><mi>ρ</mi></mrow><mrow><mi>x</mi><mi>y</mi></mrow></msub></mrow></math></span>, you can add sliders to your script. Go to the <strong class="emphasis bold">Insert</strong> tab, click the <strong class="emphasis bold">Control</strong> button, and select <strong class="emphasis bold">Slider</strong>. For more information, see <a href="../matlab_prog/add-interactive-controls-to-a-live-script.html" data-docid="matlab_prog#mw_70a04270-3af9-4a87-8e6e-722ca1f0cf82" class="a">Add Interactive Controls to a Live Script</a>. Add three interactive sliders that set the values of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi>x</mi></mrow></msub></mrow></math></span>, <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi>y</mi></mrow></msub></mrow></math></span>, and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msub><mrow><mi>ρ</mi></mrow><mrow><mi>x</mi><mi>y</mi></mrow></msub></mrow></math></span>. By default, when these values change, the Live Editor only runs the code in the current section. Configure this behavior by right-clicking the sliders, selecting <strong class="emphasis bold">Configure Control</strong>, and setting <strong class="emphasis bold">Run</strong> in the <strong class="emphasis bold">Execution</strong> section to <strong class="emphasis bold">Current section to end</strong>. This ensures the code in the section containing the sliders and any following sections runs whenever the values of the sliders change.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>mu = [0.5 1];
sigma_x = <span class="live_control_container"><img tabindex="-1" alt="" src="../../examples/matlab/win64/RandomNumbersAndVectorsFromMultivariateNormalExample_08.png"><span data-examplename="openExample('matlab/RandomNumbersAndVectorsFromMultivariateNormalExample')" tabindex="0" data-controlvalue="1.4" data-bs-trigger="focus" data-bs-container="body" data-bs-toggle="popover" data-bs-placement="top" data-bs-html="true" class="popover_trigger add_cursor_pointer live_control_equivalent_value">1.4</span></span>;
sigma_y = <span class="live_control_container"><img tabindex="-1" alt="" src="../../examples/matlab/win64/RandomNumbersAndVectorsFromMultivariateNormalExample_09.png"><span data-examplename="openExample('matlab/RandomNumbersAndVectorsFromMultivariateNormalExample')" tabindex="0" data-controlvalue="2" data-bs-trigger="focus" data-bs-container="body" data-bs-toggle="popover" data-bs-placement="top" data-bs-html="true" class="popover_trigger add_cursor_pointer live_control_equivalent_value">2</span></span>;
rho_xy = <span class="live_control_container"><img tabindex="-1" alt="" src="../../examples/matlab/win64/RandomNumbersAndVectorsFromMultivariateNormalExample_10.png"><span data-examplename="openExample('matlab/RandomNumbersAndVectorsFromMultivariateNormalExample')" tabindex="0" data-controlvalue="-0.7" data-bs-trigger="focus" data-bs-container="body" data-bs-toggle="popover" data-bs-placement="top" data-bs-html="true" class="popover_trigger add_cursor_pointer live_control_equivalent_value">-0.7</span></span>;
sigma = [sigma_x^2,              rho_xy*sigma_x*sigma_y;
         rho_xy*sigma_x*sigma_y, sigma_y^2 ];</pre></div></div></div><p>Perform the Cholesky decomposition of the covariance matrix. The result is an upper triangular matrix <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>R</mi></mrow></mstyle></mrow></mrow></math></span> such that <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>Σ</mi></mrow></mstyle></mrow><mo>=</mo><msup><mrow><mstyle mathvariant="bold"><mrow><mi>R</mi></mrow></mstyle></mrow><mrow><mi>T</mi></mrow></msup><mrow><mstyle mathvariant="bold"><mrow><mi>R</mi></mrow></mstyle></mrow></mrow></math></span>. Scale the original data by this matrix and shift the scaled data to the specified mean.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>R = chol(sigma);
v = mu + u*R;</pre></div></div></div><p>Plot the 2-D probability density estimate of the transformed data using <code class="literal">histogram2</code>. To compare the sampled vectors with the pdf of the bivariate normal distribution, plot the pdf using <code class="literal">fmesh</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>figure
histogram2(v(:,1),v(:,2),Normalization=<span style="color:#A020F0">"pdf"</span>,FaceAlpha=0.5,EdgeColor=<span style="color:#A020F0">"none"</span>)
xlabel(<span style="color:#A020F0">"x"</span>)
ylabel(<span style="color:#A020F0">"y"</span>)
zlabel(<span style="color:#A020F0">"Probability Density"</span>)
axis([-12 12 -12 12 0 0.45])
axis <span style="color:#A020F0">square</span>
view(330,25)
hold <span style="color:#A020F0">on</span>

f = @(x,y) exp(-0.5*dot(([x(:),y(:)]-mu),(sigma\([x(:),y(:)]-mu)')',2)')/ <span style="color:#0000FF">...</span>
    sqrt((2*pi)^2*det(sigma));
fmesh(f,FaceAlpha=0,EdgeColor=<span style="color:#A020F0">"cyan"</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e11968" class="mediaobject"><p><img src="../../examples/matlab/win64/RandomNumbersAndVectorsFromMultivariateNormalExample_04.png" alt="Figure contains an axes object. The axes object with xlabel x, ylabel y contains 2 objects of type histogram2, functionsurface." width="560"></p></div></div><h4 class="title" id="RandomNumbersAndVectorsFromMultivariateNormalExample-7">Marginal Distributions of Bivariate Normal Distribution</h4><p>One property of a multivariate normal distribution is that the marginal distribution of any subset of the random variables is also a multivariate normal distribution corresponding to that subset. In other words, the marginal distribution of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>x</mi></mrow></math></span> from the bivariate normal distribution <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></math></span> is a univariate normal distribution <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>x</mi></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></math></span> with <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msub><mrow><mi>μ</mi></mrow><mrow><mi>x</mi></mrow></msub></mrow></math></span> as its mean and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi>x</mi></mrow></msub></mrow></math></span> as its standard deviation, which can be written as</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">f</mi></mrow><mrow><mi mathvariant="italic">x</mi></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi></mrow><mo>)</mo></mrow><mo>=</mo><mrow><msubsup><mrow><mo>∫</mo></mrow><mrow><mo>-</mo><mo>&#8734;</mo></mrow><mrow><mo>&#8734;</mo></mrow></msubsup><mrow><mi mathvariant="italic">f</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">y</mi></mrow><mo>)</mo></mrow><mtext> </mtext><mi mathvariant="normal">dy</mi></mrow></mrow><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi mathvariant="italic">x</mi></mrow></msub><msqrt><mrow><mn>2</mn><mi>π</mi></mrow></msqrt></mrow></mfrac><mi mathvariant="normal">exp</mi><mrow><mo>[</mo><mrow><mo>-</mo><mtext> </mtext><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></mfrac><msup><mrow><mrow><mo>(</mo><mrow><mfrac><mrow><mi mathvariant="italic">x</mi><mo>-</mo><msub><mrow><mi>μ</mi></mrow><mrow><mi mathvariant="italic">x</mi></mrow></msub></mrow><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi mathvariant="italic">x</mi></mrow></msub></mrow></mfrac></mrow><mo>)</mo></mrow></mrow><mrow><mn>2</mn></mrow></msup></mrow><mo>]</mo></mrow></mrow></math></span>.</p><p>The marginal distribution of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>y</mi></mrow></math></span> from the bivariate normal distribution <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></math></span> is a univariate normal distribution <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>y</mi></mrow></msub><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></math></span> with <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msub><mrow><mi>μ</mi></mrow><mrow><mi>y</mi></mrow></msub></mrow></math></span> as its mean and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi>y</mi></mrow></msub></mrow></math></span> as its standard deviation. In the case of the bivariate normal distribution, changing the correlation coefficient <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msub><mrow><mi>ρ</mi></mrow><mrow><mi>x</mi><mi>y</mi></mrow></msub></mrow></math></span> does not affect the marginal distribution of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>x</mi></mrow></math></span> or <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>y</mi></mrow></math></span>.</p><p>To show this property, you can plot the marginal distributions of the transformed data in the previous section. Plot the marginal distribution of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>x</mi></mrow></math></span> by using <code class="literal">histogram</code> on <code class="literal">v(:,1)</code>. For visualization purposes, plot this distribution in the (<span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>x</mi></mrow></math></span>,<code class="literal">pdf</code>)-plane by using <code class="literal">hgtransform</code> and applying rotation and translation transformations to bring the plot into the plane. Compare the marginal distribution of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>x</mi></mrow></math></span> with the pdf of the univariate normal distribution using <code class="literal">fplot</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>ax = gca;
hgx = hgtransform(ax);
hgx.Matrix = makehgtform(<span style="color:#A020F0">"xrotate"</span>,pi/2,<span style="color:#A020F0">"translate"</span>,[0 0 -12]);
histogram(v(:,1),Normalization=<span style="color:#A020F0">"pdf"</span>,EdgeColor=<span style="color:#A020F0">"none"</span>,Parent=hgx)

f = @(x) exp(-0.5*(x-mu(1)).^2/sigma(1,1))/sqrt((2*pi)*sigma(1,1));
fplot(f,[-12 12],Parent=hgx)</pre></div></div></div><p>Plot the marginal distribution of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>y</mi></mrow></math></span> by using <code class="literal">histogram</code> on <code class="literal">v(:,2)</code>. Plot this distribution in the (<span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>y</mi></mrow></math></span>,<code class="literal">pdf</code>)-plane. Compare the marginal distribution of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>y</mi></mrow></math></span> with the pdf of the univariate normal distribution using <code class="literal">fplot</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>hgy = hgtransform(ax);
hgy.Matrix = makehgtform(<span style="color:#A020F0">"xrotate"</span>,pi/2,<span style="color:#A020F0">"yrotate"</span>,pi/2,<span style="color:#A020F0">"translate"</span>,[0 0 12]);
histogram(v(:,2),Normalization=<span style="color:#A020F0">"pdf"</span>,EdgeColor=<span style="color:#A020F0">"none"</span>,Parent=hgy)

f = @(y) exp(-0.5*(y-mu(2)).^2/sigma(2,2))/sqrt((2*pi)*sigma(2,2));
fplot(f,[-12 12],Parent=hgy)
hold <span style="color:#A020F0">off</span>;</pre></div></div></div><div class="informalfigure"><div id="d126e12253" class="mediaobject"><p><img src="../../examples/matlab/win64/RandomNumbersAndVectorsFromMultivariateNormalExample_05.png" alt="Figure contains an axes object. The axes object with xlabel x, ylabel y contains 6 objects of type histogram, functionline, histogram2, functionsurface." width="560"></p></div></div><h4 class="title" id="RandomNumbersAndVectorsFromMultivariateNormalExample-8">Trivariate Normal Distribution</h4><p>To generate random vectors from any nondegenerate multivariate normal distribution, you can follow the steps outlined in previous sections. For example, generate random vectors from a trivariate normal distribution with a specific mean and covariance matrix. Specify the mean as <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>μ</mi></mrow></mstyle></mrow><mo>=</mo><mrow><mo>[</mo><msub><mrow><mi>μ</mi></mrow><mrow><mi>x</mi></mrow></msub><mo>,</mo><mspace width="0.2222222222222222em"/><msub><mrow><mi>μ</mi></mrow><mrow><mi>y</mi></mrow></msub><mo>,</mo><mspace width="0.2222222222222222em"/><msub><mrow><mi>μ</mi></mrow><mrow><mi>z</mi></mrow></msub><mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="false">.</mo><mn>5</mn><mo>,</mo><mo>-</mo><mn>1</mn><mo stretchy="false">.</mo><mn>5</mn><mo>]</mo></mrow></mrow></math></span>. Specify the covariance matrix as <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>Σ</mi></mrow></mstyle></mrow><mo>=</mo><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><msubsup><mrow><mi>σ</mi></mrow><mrow><mi>x</mi></mrow><mrow><mn>2</mn></mrow></msubsup></mrow></mtd><mtd><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi>x</mi><mi>y</mi></mrow></msub></mrow></mtd><mtd><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi>x</mi><mi>z</mi></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi>x</mi><mi>y</mi></mrow></msub></mrow></mtd><mtd><mrow><msubsup><mrow><mi>σ</mi></mrow><mrow><mi>y</mi></mrow><mrow><mn>2</mn></mrow></msubsup></mrow></mtd><mtd><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi>y</mi><mi>z</mi></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi>x</mi><mi>z</mi></mrow></msub></mrow></mtd><mtd><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi>y</mi><mi>z</mi></mrow></msub></mrow></mtd><mtd><mrow><msubsup><mrow><mi>σ</mi></mrow><mrow><mi>z</mi></mrow><mrow><mn>2</mn></mrow></msubsup></mrow></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><mn>2</mn></mrow></mtd><mtd><mrow><mo>-</mo><mn>1</mn><mo stretchy="false">.</mo><mn>5</mn></mrow></mtd><mtd><mrow><mn>0</mn><mo stretchy="false">.</mo><mn>5</mn></mrow></mtd></mtr><mtr><mtd><mrow><mo>-</mo><mn>1</mn><mo stretchy="false">.</mo><mn>5</mn></mrow></mtd><mtd><mrow><mn>4</mn></mrow></mtd><mtd><mrow><mn>2</mn></mrow></mtd></mtr><mtr><mtd><mrow><mn>0</mn><mo stretchy="false">.</mo><mn>5</mn></mrow></mtd><mtd><mrow><mn>2</mn></mrow></mtd><mtd><mrow><mn>3</mn></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow></math></span>.</p><p>Because there are three random variables, generate 10,000 data points of 1-by-3 random vectors from the standard normal distribution by specifying the array size when using <code class="literal">randn</code>. Apply the transformation so that the generated data follows the specified multivariate normal distribution.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>u_3D = randn(n,3);
mu = [1 1.5 -1.5];
sigma = [2 -1.5 0.5; -1.5 4 2; 0.5 2 3];
R = chol(sigma);
v = mu + u_3D*R;</pre></div></div></div><p>Because the data already consists of 3-D points, you cannot visualize the histogram of the probability density in 3-D space (you would need an additional axis to show the frequencies). Instead, you can plot the location of the 3-D points by using <code class="literal">scatter3</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>figure
scatter3(v(:,1),v(:,2),v(:,3),1,<span style="color:#A020F0">"."</span>)
axis([-10 10 -10 10 -10 10])
axis <span style="color:#A020F0">square</span>
xlabel(<span style="color:#A020F0">"x"</span>)
ylabel(<span style="color:#A020F0">"y"</span>)
zlabel(<span style="color:#A020F0">"z"</span>)
grid <span style="color:#A020F0">on</span>
view(330,25)</pre></div></div></div><div class="informalfigure"><div id="d126e12462" class="mediaobject"><p><img src="../../examples/matlab/win64/RandomNumbersAndVectorsFromMultivariateNormalExample_06.png" alt="Figure contains an axes object. The axes object with xlabel x, ylabel y contains an object of type scatter." width="560"></p></div></div><p>You can also check if the generated data satisfies the property of the marginal distribution of a multivariate normal distribution. For example, the marginal distribution of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>z</mi><mo stretchy="false">)</mo></mrow></math></span> is a bivariate normal distribution with the mean <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>μ</mi></mrow></mstyle></mrow><mo>=</mo><mrow><mo>[</mo><msub><mrow><mi>μ</mi></mrow><mrow><mi>x</mi></mrow></msub><mo>,</mo><mspace width="0.2222222222222222em"/><msub><mrow><mi>μ</mi></mrow><mrow><mi>z</mi></mrow></msub><mo>]</mo></mrow></mrow></math></span> and the covariance matrix <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mstyle mathvariant="bold"><mrow><mi>Σ</mi></mrow></mstyle></mrow><mo>=</mo><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><msubsup><mrow><mi>σ</mi></mrow><mrow><mi>x</mi></mrow><mrow><mn>2</mn></mrow></msubsup></mrow></mtd><mtd><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi>x</mi><mi>z</mi></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi>x</mi><mi>z</mi></mrow></msub></mrow></mtd><mtd><mrow><msubsup><mrow><mi>σ</mi></mrow><mrow><mi>z</mi></mrow><mrow><mn>2</mn></mrow></msubsup></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow></math></span>.</p><p>Plot the marginal distribution of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>z</mi><mo stretchy="false">)</mo></mrow></math></span> by using <code class="literal">histogram2</code> on <code class="literal">v(:,1)</code> and <code class="literal">v(:,3)</code>. Compare the marginal distribution of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>z</mi><mo stretchy="false">)</mo></mrow></math></span> with the pdf of the bivariate normal distribution using <code class="literal">fmesh</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>figure
histogram2(v(:,1),v(:,3),Normalization=<span style="color:#A020F0">"pdf"</span>,FaceAlpha=0.5,EdgeColor=<span style="color:#A020F0">"none"</span>)
xlabel(<span style="color:#A020F0">"x"</span>)
ylabel(<span style="color:#A020F0">"z"</span>)
zlabel(<span style="color:#A020F0">"Probability Density"</span>)
axis([-10 10 -10 10])
axis <span style="color:#A020F0">square</span>
view(10,30)
hold <span style="color:#A020F0">on</span>

fxz = @(x,z) exp(-0.5*dot(([x(:),z(:)]-mu([1 3])),(sigma([1 3],[1 3])\ <span style="color:#0000FF">...</span>
      ([x(:),z(:)]-mu([1 3]))')',2)')/sqrt((2*pi)^2*det(sigma([1 3],[1 3])));
fmesh(fxz,FaceAlpha=0,EdgeColor=<span style="color:#A020F0">"cyan"</span>)
hold <span style="color:#A020F0">off</span></pre></div></div></div><div class="informalfigure"><div id="d126e12588" class="mediaobject"><p><img src="../../examples/matlab/win64/RandomNumbersAndVectorsFromMultivariateNormalExample_07.png" alt="Figure contains an axes object. The axes object with xlabel x, ylabel z contains 2 objects of type histogram2, functionsurface." width="560"></p></div></div></div>
            <h2 id="d126e12595">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/double.randn.html"><span itemprop="name"><code class="function">randn</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/rng.html"><span itemprop="name"><code class="function">rng</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/quantum.gate.quantumstate.histogram.html"><span itemprop="name"><code class="function">histogram</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/matlab.graphics.chart.primitive.histogram2.html"><span itemprop="name"><code class="function">histogram2</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/fplot.html"><span itemprop="name"><code class="function">fplot</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/fsurf.html"><span itemprop="name"><code class="function">fsurf</code></span></a></span></p>
            <h3 id="d126e12617">Topics</h3><ul class="list-unstyled"><li><a href="create-arrays-of-random-numbers.html" class="a">Create Arrays of Random Numbers</a></li><li><a href="generate-random-numbers-that-are-repeatable.html" class="a">Generate Random Numbers That Are Repeatable</a></li><li><a href="generate-random-numbers-that-are-different.html" class="a">Generate Random Numbers That Are Different</a></li><li><a href="floating-point-numbers-within-specific-range.html" class="a">Random Numbers Within a Specific Range</a></li><li><a href="numbers-placed-randomly-within-volume-of-sphere.html" class="a">Random Numbers Within a Sphere</a></li><li><a href="random-numbers-with-specific-mean-and-variance.html" class="a">Random Numbers from Normal Distribution with Specific Mean and Variance</a></li></ul>
            
            
        </section>
    </div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

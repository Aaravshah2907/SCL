<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Solving Partial Differential Equations</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../numerical-integration-and-differential-equations.html",
          "name": "Numerical Integration and Differential Equations"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../partial-differential-equations.html",
          "name": "1-D Partial Differential Equations"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "partial-differential-equations"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="ug">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ex">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="Solve 1-D partial differential equations with pdepe."><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../numerical-integration-and-differential-equations.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Numerical Integration and Differential Equations</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../partial-differential-equations.html?s_tid=CRUX_lftnav" itemprop="url" id="partial-differential-equations"><span itemprop="title">1-D Partial Differential Equations</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item"><a href="#responsive_offcanvas">Solving Partial Differential Equations</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#f1-697407" class="nav-link intrnllnk">What Types of PDEs Can You Solve with MATLAB?</a></li><li class="nav-item"><a href="#mw_27b3a009-6051-4525-8ac4-759c8d6b9bad" class="nav-link intrnllnk">Solving 1-D PDEs</a><ul class="nav"><li class="nav-item"><a href="#mw_13dde5ce-5f59-4e89-877f-71b45f0b32ca" class="nav-link intrnllnk">Solution Process</a></li><li class="nav-item"><a href="#mw_d5793814-1cfc-4a42-974d-193177cb53d3" class="nav-link intrnllnk">Equations</a></li><li class="nav-item"><a href="#mw_8b601180-8d69-4ebd-a830-3f26ee33ebad" class="nav-link intrnllnk">Initial Conditions</a></li><li class="nav-item"><a href="#mw_0a37c559-7e73-42da-9c45-c33267cb278f" class="nav-link intrnllnk">Boundary Conditions</a></li><li class="nav-item"><a href="#f1-700166" class="nav-link intrnllnk">Integration Options</a></li><li class="nav-item"><a href="#mw_b5208cc3-c0d6-4207-9b3f-6347838e035d" class="nav-link intrnllnk">Evaluating the Solution</a></li></ul></li><li class="nav-item"><a href="#mw_612bb0d6-2bf9-4ae8-8332-834fd18e5520" class="nav-link intrnllnk">Example: The Heat Equation</a><ul class="nav"><li class="nav-item"><a href="#HeatEquationExample-1" class="nav-link intrnllnk">Code Equation</a></li><li class="nav-item"><a href="#HeatEquationExample-2" class="nav-link intrnllnk">Code Initial Condition</a></li><li class="nav-item"><a href="#HeatEquationExample-3" class="nav-link intrnllnk">Code Boundary Conditions</a></li><li class="nav-item"><a href="#HeatEquationExample-4" class="nav-link intrnllnk">Select Solution Mesh</a></li><li class="nav-item"><a href="#HeatEquationExample-5" class="nav-link intrnllnk">Solve Equation</a></li><li class="nav-item"><a href="#HeatEquationExample-6" class="nav-link intrnllnk">Plot Solution</a></li><li class="nav-item"><a href="#HeatEquationExample-7" class="nav-link intrnllnk">Local Functions</a></li></ul></li><li class="nav-item"><a href="#brfhecb" class="nav-link intrnllnk">PDE Examples and Files</a></li><li><a href="#References" class="intrnllnk">References</a></li><li class="nav-item"><a href="#d126e46971" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=partial-differential-equations&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=partial-differential-equations&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=partial-differential-equations&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=partial-differential-equations&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=partial-differential-equations&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=partial-differential-equations&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-topic">
<section><h2 class="title r2025b" itemprop="title content" id="f1-663004">Solving Partial Differential Equations</h2><p>In a <em class="firstterm">partial differential equation</em> (PDE), the function being
            solved for depends on several variables, and the differential equation can include
            partial derivatives taken with respect to each of the variables. Partial differential
            equations are useful for modeling waves, heat flow, fluid dispersion, and other
            phenomena with spatial behavior that changes over time.</p><section><h3 class="title" id="f1-697407">What Types of PDEs Can You Solve with <span class="trademark entity">MATLAB</span>?</h3><p>The MATLAB<sup>&#x00AE;</sup> PDE solver <a href="../ref/pdepe.html"><code class="function">pdepe</code></a> solves initial-boundary
                value problems for systems of PDEs in one spatial variable <em class="varname">x</em> and
                time <span class="emphasis"><em>t</em></span>. You can think of these as ODEs of one variable that
                also change with respect to time.</p><p><code class="function">pdepe</code> uses an informal classification for the 1-D equations
                it solves:</p>
<div class="itemizedlist"><ul><li><p>Equations with a time derivative are <em class="firstterm">parabolic</em>. An example is the heat equation <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-16px" display="block"><mrow><mfrac><mrow><mo>∂</mo><mi>u</mi></mrow><mrow><mo>∂</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><msup><mo>∂</mo><mn>2</mn></msup><mi>u</mi></mrow><mrow><mo>∂</mo><msup><mi>x</mi><mn>2</mn></msup></mrow></mfrac></mrow></math></span></span>.</p></li><li><p>Equations without a time derivative are <em class="firstterm">elliptic</em>. An example is the Laplace equation <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-16px" display="block"><mrow><mfrac><mrow><msup><mo>∂</mo><mn>2</mn></msup><mi>u</mi></mrow><mrow><mo>∂</mo><msup><mi>x</mi><mn>2</mn></msup></mrow></mfrac><mo>=</mo><mn>0</mn></mrow></math></span></span>.</p></li></ul></div><p>
<code class="function">pdepe</code> requires at least one parabolic equation
                in the system. In other words, at least one equation in the system must include a
                time derivative.</p><p><code class="function">pdepe</code> also solves certain 2-D and 3-D problems that reduce to
                1-D problems due to angular symmetry (see the argument description for the <a href="../ref/pdepe.html#mw_bf53ae0b-d53a-47fc-81dc-ee63671697a8" class="a">symmetry
                    constant <code class="literal">m</code></a> for more information).</p><p><a href="../../pde/index.html" class="a">
                    Partial Differential Equation Toolbox&#x2122;
                </a> extends this functionality to generalized problems in 2-D and 3-D with
                Dirichlet and Neumann boundary conditions.</p></section><section><h3 class="title" id="mw_27b3a009-6051-4525-8ac4-759c8d6b9bad">Solving 1-D PDEs</h3><p>A 1-D PDE includes a function <span class="inlineequation"><em class="varname">u</em>(<em class="varname">x</em>,<em class="varname">t</em>)</span> that depends on time <em class="varname">t</em> and one spatial variable
                    <em class="varname">x</em>. The MATLAB PDE solver <code class="literal">pdepe</code> solves systems of 1-D parabolic
                and elliptic PDEs of the form </p><div id="d126e45796" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-17px" display="block"><mrow><mi>c</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi>u</mi></mrow><mrow><mo>∂</mo><mi>x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mfrac><mrow><mo>∂</mo><mi>u</mi></mrow><mrow><mo>∂</mo><mi>t</mi></mrow></mfrac><mo>=</mo><msup><mi>x</mi><mrow><mo>−</mo><mi>m</mi></mrow></msup><mfrac><mo>∂</mo><mrow><mo>∂</mo><mi>x</mi></mrow></mfrac><mrow><mo>(</mo><mrow><msup><mi>x</mi><mi>m</mi></msup><mi>f</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi>u</mi></mrow><mrow><mo>∂</mo><mi>x</mi></mrow></mfrac></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow><mo>+</mo><mi>s</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi>u</mi></mrow><mrow><mo>∂</mo><mi>x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>.</mo></mrow></math></p></div></div><p>The equation has the properties:</p>
<div class="itemizedlist"><ul><li><p>The PDEs hold for <span class="inlineequation"><em class="varname">t</em><sub>0</sub> ≤
                                        <em class="varname">t</em> ≤
                                            <em class="varname">t</em><sub><em class="varname">f</em></sub></span> and <span class="inlineequation"><em class="varname">a</em> ≤ <em class="varname">x</em> ≤
                                        <em class="varname">b</em></span>.</p></li><li><p>The spatial interval <span class="inlineequation">[<em class="varname">a</em>,
                                    <em class="varname">b</em>]</span> must be finite.</p></li><li><p><a href="../ref/pdepe.html#mw_bf53ae0b-d53a-47fc-81dc-ee63671697a8" class="a"><code class="literal">m</code></a> can be 0, 1, or 2, corresponding to
                                <span class="emphasis"><em>slab</em></span>, <span class="emphasis"><em>cylindrical</em></span>, or
                                <span class="emphasis"><em>spherical</em></span> symmetry, respectively. If <span class="inlineequation"><em class="varname">m</em> &gt; 0</span>, then <span class="inlineequation"><em class="varname">a</em> ≥ 0</span> must also hold.</p></li><li><p>The coefficient <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-19px" display="block"><mrow><mi>f</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi>u</mi></mrow><mrow><mo>∂</mo><mi>x</mi></mrow></mfrac></mrow><mo>)</mo></mrow></mrow></math></span></span> is a flux term and <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-19px" display="block"><mrow><mi>s</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi>u</mi></mrow><mrow><mo>∂</mo><mi>x</mi></mrow></mfrac></mrow><mo>)</mo></mrow></mrow></math></span></span> is a source term.</p></li><li><p>The flux term must depend on the partial derivative <span class="inlineequation">∂<em class="varname">u</em>/∂<em class="varname">x</em></span>.</p></li></ul></div><p>
</p><p>The coupling of the partial derivatives with respect to time is restricted to
                multiplication by a diagonal matrix <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-19px" display="block"><mrow><mi>c</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi>u</mi></mrow><mrow><mo>∂</mo><mi>x</mi></mrow></mfrac></mrow><mo>)</mo></mrow></mrow></math></span></span>. The diagonal elements of this matrix are either zero or positive.
                An element that is zero corresponds to an elliptic equation, and any other element
                corresponds to a parabolic equation. There must be at least one parabolic equation.
                An element of <em class="varname">c</em> that corresponds to a parabolic equation can
                vanish at isolated values of <em class="varname">x</em> if they are mesh points (points
                where the solution is evaluated). Discontinuities in <em class="varname">c</em> and
                    <em class="varname">s</em> due to material interfaces are permitted provided that a
                mesh point is placed at each interface.</p><section><h4 class="title" id="mw_13dde5ce-5f59-4e89-877f-71b45f0b32ca">Solution Process</h4><p>To solve PDEs with <code class="function">pdepe</code>, you must define the equation
                    coefficients for <em class="varname">c</em>, <em class="varname">f</em>, and
                        <em class="varname">s</em>, the initial conditions, the behavior of the solution
                    at the boundaries, and a mesh of points to evaluate the solution on. The
                    function call <code class="function">sol = pdepe(m,pdefun,icfun,bcfun,xmesh,tspan)</code>
                    uses this information to calculate a solution on the specified mesh:</p>
<div class="itemizedlist"><ul><li><p><a href="../ref/pdepe.html#mw_bf53ae0b-d53a-47fc-81dc-ee63671697a8" class="a"><code class="literal">m</code></a> is the symmetry
                                constant.</p></li><li><p><a href="../ref/pdepe.html#mw_ca773a23-ccd3-45fc-9eb0-0982f085f21d" class="a"><code class="literal">pdefun</code></a> defines the equations
                                being solved.</p></li><li><p><a href="../ref/pdepe.html#mw_dbdef752-2363-43aa-94c6-6c2242a43406" class="a"><code class="literal">icfun</code></a> defines the initial
                                conditions.</p></li><li><p><a href="../ref/pdepe.html#mw_5ccaac8a-d9a6-484d-8859-2ff9fc7e8913" class="a"><code class="literal">bcfun</code></a> defines the boundary
                                conditions.</p></li><li><p><a href="../ref/pdepe.html#mw_39f0a244-6853-4b5a-b45c-ef17928a7175" class="a"><code class="literal">xmesh</code></a> is a vector of spatial
                                values for <em class="varname">x</em>.</p></li><li><p><a href="../ref/pdepe.html#mw_86a8dc7c-372b-421b-8082-2b459cb51733" class="a"><code class="literal">tspan</code></a> is a vector of time values
                                for <em class="varname">t</em>.</p></li></ul></div><p>
Together, the <code class="literal">xmesh</code> and
                        <code class="literal">tspan</code> vectors form a 2-D grid that
                        <code class="function">pdepe</code> evaluates the solution on.</p></section><section><h4 class="title" id="mw_d5793814-1cfc-4a42-974d-193177cb53d3">Equations</h4><p>You must express the PDEs in the standard form expected by
                        <code class="function">pdepe</code>. Written in this form, you can read off the
                    values of the coefficients <em class="varname">c</em>, <em class="varname">f</em>, and
                        <em class="varname">s</em>.</p><p>In MATLAB you can code the equations with a function of the
                    form<div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> [c,f,s] = pdefun(x,t,u,dudx)
c = 1;
f = dudx;
s = 0;
<span style="color:#0000FF">end</span></pre></div></div></div>In
                    this case <code class="function">pdefun</code> defines the equation <span class="inlineequation"><span class="inlinemediaobject"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-16px" display="block"><mrow><mfrac><mrow><mo>∂</mo><mi>u</mi></mrow><mrow><mo>∂</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><msup><mo>∂</mo><mn>2</mn></msup><mi>u</mi></mrow><mrow><mo>∂</mo><msup><mi>x</mi><mn>2</mn></msup></mrow></mfrac></mrow></math></span></span>. If there are multiple equations, then <em class="varname">c</em>,
                        <em class="varname">f</em>, and <em class="varname">s</em> are vectors with each element
                    corresponding to one equation.</p></section><section><h4 class="title" id="mw_8b601180-8d69-4ebd-a830-3f26ee33ebad">Initial Conditions</h4><p>At the initial time <em class="varname">t</em> =
                        <em class="varname">t</em><sub>0</sub>, for all <em class="varname">x</em>,
                    the solution components satisfy initial conditions of the form</p><div id="d126e45997" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><mi>u</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><msub><mi>t</mi><mn>0</mn></msub></mrow><mo>)</mo></mrow><mo>=</mo><msub><mi>u</mi><mn>0</mn></msub><mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mo>.</mo></mrow></math></p></div></div><p>In MATLAB you can code the initial conditions with a function of the
                    form<div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> u0 = icfun(x)
u0 = 1;
<span style="color:#0000FF">end</span></pre></div></div></div>In
                    this case <code class="literal">u0 = 1</code> defines an initial condition of <span class="inlineequation"><em class="varname">u</em><sub>0</sub>(<em class="varname">x</em>,<em class="varname">t</em><sub>0</sub>)
                            = 1</span>. If there are multiple equations, then <code class="literal">u0</code>
                    is a vector with each element defining the initial condition of one
                    equation.</p></section><section><h4 class="title" id="mw_0a37c559-7e73-42da-9c45-c33267cb278f">Boundary Conditions</h4><p>At the boundary <em class="varname">x</em> = <em class="varname">a</em> or
                        <em class="varname">x</em> = <em class="varname">b</em>, for all <em class="varname">t</em>,
                    the solution components satisfy boundary conditions of the form </p><div id="d126e46038" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-16px" display="block"><mrow><mi>p</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>u</mi></mrow><mo>)</mo></mrow><mo>+</mo><mi>q</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>t</mi></mrow><mo>)</mo></mrow><mi>f</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi>u</mi></mrow><mrow><mo>∂</mo><mi>x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>=</mo><mn>0.</mn></mrow></math></p></div></div><p><span class="inlineequation"><em class="varname">q</em>(<em class="varname">x</em>,<em class="varname">t</em>)</span> is a diagonal matrix with elements that are either  zero or
                    never zero. Note that the boundary conditions are expressed in terms of the flux
                        <em class="varname">f</em>, rather than the partial derivative of
                        <em class="varname">u</em> with respect to <em class="varname">x</em>. Also, of the two
                    coefficients <span class="inlineequation"><em class="varname">p</em>(<em class="varname">x</em>,<em class="varname">t</em>,<em class="varname">u</em>)</span> and <span class="inlineequation"><em class="varname">q</em>(<em class="varname">x</em>,<em class="varname">t</em>)</span>, only <em class="varname">p</em> can depend on
                    <em class="varname">u</em>.</p><p>In MATLAB you can code the boundary conditions with a function of the
                        form<div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> [pL,qL,pR,qR] = bcfun(xL,uL,xR,uR,t)
pL = uL;
qL = 0;
pR = uR - 1;
qR = 0;
<span style="color:#0000FF">end</span>
</pre></div></div></div><code class="literal">pL</code>
                    and <code class="literal">qL</code> are the coefficients for the left boundary, while
                        <code class="literal">pR</code> and <code class="literal">qR</code> are the coefficients for the
                    right boundary. In this case <code class="function">bcfun</code> defines the boundary
                    conditions</p><div id="d126e46101" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-23px" display="block"><mtable columnalign="left"><mtr><mtd><msub><mi>u</mi><mi>L</mi></msub><mrow><mo>(</mo><mrow><msub><mi>x</mi><mi>L</mi></msub><mo>,</mo><mi>t</mi></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn></mtd></mtr><mtr><mtd><msub><mi>u</mi><mi>R</mi></msub><mrow><mo>(</mo><mrow><msub><mi>x</mi><mi>R</mi></msub><mo>,</mo><mi>t</mi></mrow><mo>)</mo></mrow><mo>=</mo><mn>1</mn></mtd></mtr></mtable></math></p></div></div><p>If there are multiple equations, then the outputs <code class="literal">pL</code>,
                        <code class="literal">qL</code>, <code class="literal">pR</code>, and <code class="literal">qR</code> are
                    vectors with each element defining the boundary condition of one
                    equation.</p></section><section><h4 class="title" id="f1-700166">Integration Options</h4><p>The default integration properties in the MATLAB PDE solver are selected to handle common problems. In some cases,
                    you can improve solver performance by overriding these default values. To do
                    this, use <a href="../ref/odeset.html"><code class="function">odeset</code></a> to create an
                        <code class="literal">options</code> structure. Then, pass the structure to
                        <code class="function">pdepe</code> as the last input argument:</p><div class="code_responsive"><pre class="programlisting">sol = pdepe(m,pdefun,icfun,bcfun,xmesh,tspan,options)
</pre></div><p>Of the options for the underlying ODE solver <code class="function">ode15s</code>, only
                    those shown in the following table are available for
                    <code class="function">pdepe</code>.</p><div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="50%"><col class="tcol2" width="50%"></colgroup><thead><tr><th><p>Category</p></th><th><p>Option Name</p></th></tr></thead><tbody><tr><td><p>Error control</p></td><td><p><a href="../ref/odeset.html#bu2m9z6-RelTol" class="a"><code class="literal">RelTol</code></a>, <a href="../ref/odeset.html#bu2m9z6-AbsTol" class="a"><code class="literal">AbsTol</code></a>, <a href="../ref/odeset.html#bu2m9z6-NormControl" class="a"><code class="literal">NormControl</code></a></p></td></tr><tr><td><p>Step-size</p></td><td><p><a href="../ref/odeset.html#bu2m9z6-InitialStep" class="a"><code class="literal">InitialStep</code></a>, <a href="../ref/odeset.html#bu2m9z6-MaxStep" class="a"><code class="literal">MaxStep</code></a></p></td></tr><tr><td><p>Event logging</p></td><td><p>
                                        <a href="../ref/odeset.html#bu2m9z6-Events" class="a"><code class="literal">Events</code></a>
                                    </p></td></tr></tbody></table></div></section><section><h4 class="title" id="mw_b5208cc3-c0d6-4207-9b3f-6347838e035d">Evaluating the Solution</h4><p>After you solve an equation with <code class="function">pdepe</code>, MATLAB returns the solution as a 3-D array <code class="literal">sol</code>, where
                        <code class="literal">sol(i,j,k)</code> contains the <code class="literal">k</code>th component
                    of the solution evaluated at <code class="literal">t(i)</code> and
                    <code class="literal">x(j)</code>. In general, you can extract the <code class="literal">k</code>th
                    solution component with the command <code class="literal">u = sol(:,:,k)</code>.</p><p>The time mesh you specify is used purely for output purposes, and does not
                    affect the internal time steps taken by the solver. However, the spatial mesh
                    you specify can affect the quality and speed of the solution. After solving an
                    equation, you can use <a href="../ref/pdeval.html"><code class="function">pdeval</code></a> to evaluate the
                    solution structure returned by <code class="function">pdepe</code> with a different
                    spatial mesh.</p></section></section><section><h3 class="title" id="mw_612bb0d6-2bf9-4ae8-8332-834fd18e5520">Example: The Heat Equation</h3><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/HeatEquationExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Example: The Heat Equation",
          "description": "An example of a parabolic PDE is the heat equation in one dimension:",
          "thumbnailURL": "../../examples/matlab/win64/HeatEquationExample_01.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "isPartOf": {
          "@type": "CreativeWork",
          "url": "partial-differential-equations.html"

        },
          "identifier": "matlab.HeatEquationExample",
          "name": "HeatEquationExample",
          "url": "partial-differential-equations.html#mw_612bb0d6-2bf9-4ae8-8332-834fd18e5520"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/HeatEquationExample')"

        }</script><script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "HeatEquationExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-HeatEquationExample"><meta itemprop="exampletitle" content="Example: The Heat Equation"></div><span id="HeatEquationExample" class="anchor_target"></span><p class="shortdesc">An example of a parabolic PDE is the heat equation in one dimension:</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">t</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><msup><mrow><mo>∂</mo></mrow><mrow><mn>2</mn></mrow></msup><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><msup><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac><mo>.</mo></mrow></math></p></div><p></p><p>This equation describes the dissipation of heat for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mn>0</mn><mo>≤</mo><mi mathvariant="italic">x</mi><mo>≤</mo><mi mathvariant="italic">L</mi></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">t</mi><mo>≥</mo><mn>0</mn></mrow></math></span>. The goal is to solve for the temperature <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">u</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow></mrow></math></span>. The temperature is initially a nonzero constant, so the initial condition is</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">u</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mn>0</mn></mrow><mo>)</mo></mrow><mo>=</mo><msub><mrow><mi mathvariant="italic">T</mi></mrow><mrow><mn>0</mn></mrow></msub><mo>.</mo></mrow></math></p></div><p></p><p>Also, the temperature is zero at the left boundary, and nonzero at the right boundary, so the boundary conditions are</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">u</mi><mrow><mo>(</mo><mrow><mn>0</mn><mo>,</mo><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn><mo>,</mo></mrow></math></p></div><p> </p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">u</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">L</mi><mo>,</mo><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow><mo>=</mo><mn>1</mn><mo>.</mo></mrow></math></p></div><p></p><p>To solve this equation in MATLAB&#174;, you need to code the equation, initial conditions, and boundary conditions, then select a suitable solution mesh before calling the solver <code class="literal">pdepe</code>. You either can include the required functions as local functions at the end of a file (as in this example), or save them as separate, named files in a directory on the MATLAB path.</p><div class="procedure"><span id="HeatEquationExample-1" class="anchor_target"></span><p class="title" id="HeatEquationExample-1"><b>Code Equation</b></p><p>Before you can code the equation, you need to make sure that it is in the form that the <code class="literal">pdepe</code> solver expects:</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">c</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">t</mi></mrow></mfrac><mo>=</mo><msup><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mo>-</mo><mi mathvariant="italic">m</mi></mrow></msup><mfrac><mrow><mo>∂</mo></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac><mrow><mo>(</mo><mrow><msup><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mi mathvariant="italic">m</mi></mrow></msup><mi mathvariant="italic">f</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow><mo>+</mo><mi mathvariant="italic">s</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>.</mo></mrow></math></p></div><p></p><p>In this form, the heat equation is</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mn>1</mn><mo>⋅</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">t</mi></mrow></mfrac><mo>=</mo><msup><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>0</mn></mrow></msup><mfrac><mrow><mo>∂</mo></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac><mrow><mo>(</mo><mrow><msup><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mn>0</mn></mrow></msup><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>+</mo><mn>0</mn><mo>.</mo></mrow></math></p></div><p></p><p>So the values of the coefficients are as follows:</p><div class="itemizedlist"><ul><li><p><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">m</mi><mo>=</mo><mn>0</mn></mrow></math></span></p></li><li><p><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">c</mi><mo>=</mo><mn>1</mn></mrow></math></span></p></li><li><p><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">f</mi><mo>=</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow></math></span></p></li><li><p><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">s</mi><mo>=</mo><mn>0</mn></mrow></math></span></p></li></ul></div><p>The value of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">m</mi></mrow></math></span> is passed as an argument to <code class="literal">pdepe</code>, while the other coefficients are encoded in a function for the equation, which is</p><div class="code_responsive"><pre id="d126e46587" class="programlisting"><span style="color:#0000FF">function</span> [c,f,s] = heatpde(x,t,u,dudx)
c = 1;
f = dudx;
s = 0;
<span style="color:#0000FF">end</span>
</pre></div><p>(Note: All functions are included as local functions at the end of the example.)</p><span id="HeatEquationExample-2" class="anchor_target"></span><p class="title" id="HeatEquationExample-2"><b>Code Initial Condition</b></p><p>The initial condition function for the heat equation assigns a constant value for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">u</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math></span>. This function must accept an input for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi></mrow></math></span>, even if it is unused.</p><div class="code_responsive"><pre id="d126e46610" class="programlisting"><span style="color:#0000FF">function</span> u0 = heatic(x)
u0 = 0.5;
<span style="color:#0000FF">end</span>
</pre></div><span id="HeatEquationExample-3" class="anchor_target"></span><p class="title" id="HeatEquationExample-3"><b>Code Boundary Conditions</b></p><p>The standard form for the boundary conditions expected by the <code class="literal">pdepe</code> solver is</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">p</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi></mrow><mo>)</mo></mrow><mo>+</mo><mi mathvariant="italic">q</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow><mi mathvariant="italic">f</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">u</mi><mo>,</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">u</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn><mo>.</mo></mrow></math></p></div><p></p><p>Written in this form, the boundary conditions for this problem are</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">u</mi><mrow><mo>(</mo><mrow><mn>0</mn><mo>,</mo><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow><mo>+</mo><mrow><mo>(</mo><mrow><mn>0</mn><mo>⋅</mo><mi mathvariant="italic">f</mi></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn><mo>,</mo></mrow></math></p></div><p></p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mo>(</mo><mrow><mi mathvariant="italic">u</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">L</mi><mo>,</mo><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow><mo>-</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>+</mo><mrow><mo>(</mo><mrow><mn>0</mn><mo>⋅</mo><mi mathvariant="italic">f</mi></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn><mo>.</mo></mrow></math></p></div><p></p><p>So the values for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">p</mi></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">q</mi></mrow></math></span> are</p><div class="itemizedlist"><ul><li><p><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msub><mrow><mi mathvariant="italic">p</mi></mrow><mrow><mi mathvariant="italic">L</mi></mrow></msub><mo>=</mo><msub><mrow><mi mathvariant="italic">u</mi></mrow><mrow><mi mathvariant="italic">L</mi></mrow></msub><mo>,</mo><msub><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext>         </mtext><mtext> </mtext><mi mathvariant="italic">q</mi></mrow><mrow><mi mathvariant="italic">L</mi></mrow></msub><mo>=</mo><mn>0</mn><mo>.</mo></mrow></math></span></p></li><li><p><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">p</mi></mrow><mrow><mi mathvariant="italic">R</mi></mrow></msub><mo>=</mo><msub><mrow><mi mathvariant="italic">u</mi></mrow><mrow><mi mathvariant="italic">R</mi></mrow></msub><mo>-</mo><mn>1</mn><mo>,</mo><msub><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mi mathvariant="italic">q</mi></mrow><mrow><mi mathvariant="italic">R</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow></math></span>.</p></li></ul></div><p>The corresponding function is then</p><div class="code_responsive"><pre id="d126e46825" class="programlisting"><span style="color:#0000FF">function</span> [pl,ql,pr,qr] = heatbc(xl,ul,xr,ur,t)
pl = ul;
ql = 0;
pr = ur - 1;
qr = 0;
<span style="color:#0000FF">end</span>
</pre></div><span id="HeatEquationExample-4" class="anchor_target"></span><p class="title" id="HeatEquationExample-4"><b>Select Solution Mesh</b></p><p>Use a spatial mesh of 20 points and a time mesh of 30 points. Since the solution rapidly reaches a steady state, the time points near <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">t</mi><mo>=</mo><mn>0</mn></mrow></math></span> are more closely spaced together to capture this behavior in the output. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>L = 1;
x = linspace(0,L,20);
t = [linspace(0,0.05,20), linspace(0.5,5,10)];</pre></div></div></div><span id="HeatEquationExample-5" class="anchor_target"></span><p class="title" id="HeatEquationExample-5"><b>Solve Equation</b></p><p>Finally, solve the equation using the symmetry <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">m</mi></mrow></math></span>, the PDE equation, the initial condition, the boundary conditions, and the meshes for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">t</mi></mrow></math></span>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>m = 0;
sol = pdepe(m,@heatpde,@heatic,@heatbc,x,t);</pre></div></div></div><span id="HeatEquationExample-6" class="anchor_target"></span><p class="title" id="HeatEquationExample-6"><b>Plot Solution</b></p><p>Use <code class="literal">pcolor</code> to visualize the solution matrix. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>colormap <span style="color:#A020F0">hot</span>
pcolor(x,t,sol)
colorbar
xlabel(<span style="color:#A020F0">'Distance x'</span>,<span style="color:#A020F0">'interpreter'</span>,<span style="color:#A020F0">'latex'</span>)
ylabel(<span style="color:#A020F0">'Time t'</span>,<span style="color:#A020F0">'interpreter'</span>,<span style="color:#A020F0">'latex'</span>)
title(<span style="color:#A020F0">'Heat Equation for $0 \le x \le 1$ and $0 \le t \le 5$'</span>,<span style="color:#A020F0">'interpreter'</span>,<span style="color:#A020F0">'latex'</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e46874" class="mediaobject"><p><img src="../../examples/matlab/win64/HeatEquationExample_01.png" alt="Figure contains an axes object. The axes object with title Heat Equation for 0 less equals x less equals 1 and 0 less equals t less equals 5, xlabel Distance x, ylabel Time t contains an object of type surface." width="560"></p></div></div><span id="HeatEquationExample-7" class="anchor_target"></span><p class="title" id="HeatEquationExample-7"><b>Local Functions</b></p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> [c,f,s] = heatpde(x,t,u,dudx)
c = 1;
f = dudx;
s = 0;
<span style="color:#0000FF">end</span>
<span style="color:#0000FF">function</span> u0 = heatic(x)
u0 = 0.5;
<span style="color:#0000FF">end</span>
<span style="color:#0000FF">function</span> [pl,ql,pr,qr] = heatbc(xl,ul,xr,ur,t)
pl = ul;
ql = 0;
pr = ur - 1;
qr = 0;
<span style="color:#0000FF">end</span></pre></div></div></div></div></section><section><h3 class="title" id="brfhecb">PDE Examples and Files</h3><p>Several available example files serve as excellent starting points for most common
                1-D PDE problems. To  explore and run examples, use the Differential Equations
                Examples app. To run this app, type</p><div class="code_responsive"><pre class="programlisting">odeexamples</pre></div><p>To open an individual file for editing, type</p><div class="code_responsive"><pre class="programlisting">edit exampleFileName.m</pre></div><p>To run an example, type</p><div class="code_responsive"><pre class="programlisting">exampleFileName</pre></div><p>This table contains a list of the available PDE example files.</p><div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="18%"><col class="tcol2" width="48%"><col class="tcol3" width="33%"></colgroup><thead><tr><th><p>Example File</p></th><th><p>Description</p></th><th>Example Link</th></tr></thead><tbody><tr><td><p id="brfhgfv-2"><code class="literal">pdex1</code></p></td><td><p>Simple PDE that illustrates the  formulation, computation,
                                    and plotting of the solution.</p></td><td><p>
                                    <a href="solve-single-pde.html" class="a">Solve Single PDE</a>
                                </p></td></tr><tr><td><p id="brfhgfv-3"><code class="literal">pdex2</code></p></td><td><p>Problem that involves discontinuities.</p></td><td><p>
                                    <a href="solve-pde-with-material-interface.html" class="a">Solve PDE with Discontinuity</a>
                                </p></td></tr><tr><td><p id="brfhgfv-4"><code class="literal">pdex3</code></p></td><td><p>Problem that requires computing values of the partial
                                    derivative.</p></td><td><p>
                                    <a href="solve-transistor-pde.html" class="a">Solve PDE and Compute Partial Derivatives</a>
                                </p></td></tr><tr><td><p id="brfhgfv-5"><code class="literal">pdex4</code></p></td><td><p>System of two PDEs whose solution has boundary layers at
                                    both ends of the interval and changes rapidly for small
                                        <em class="varname">t</em>.</p></td><td><p>
                                    <a href="solve-system-of-pdes.html" class="a">Solve System of PDEs</a>
                                </p></td></tr><tr><td><p id="brfhgfv-6"><code class="literal">pdex5</code></p></td><td><p>System of PDEs with step functions as initial
                                    conditions.</p></td><td><p>
                                    <a href="solve-angio-pde-system.html" class="a">Solve System of PDEs with Initial Condition Step Functions</a>
                                </p></td></tr></tbody></table></div></section><div class="bibliography"><h2 id="References">References</h2><div id="bu8tnr1" class="bibliomixed"><p>[1] Skeel, R. D. and M. Berzins, "A Method for the Spatial
                Discretization of Parabolic Equations in One Space Variable," <em class="citetitle">SIAM
                    Journal on Scientific and Statistical Computing</em>, Vol. 11, 1990, pp.
                1&#8211;32.</p></div></div>
            <h2 id="d126e46971">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/bvp4c.html"><span itemprop="name"><code class="function">bvp4c</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/ode45.html"><span itemprop="name"><code class="function">ode45</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/pdepe.html"><span itemprop="name"><code class="function">pdepe</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/odeset.html"><span itemprop="name"><code class="function">odeset</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/pdeval.html"><span itemprop="name"><code class="function">pdeval</code></span></a></span></p>
            
            <h3 id="d126e46991">Topics</h3><ul class="list-unstyled"><li><a href="solve-single-pde.html" class="a">Solve Single PDE</a></li><li><a href="solve-system-of-pdes.html" class="a">Solve System of PDEs</a></li></ul>
            
        </section>
    </div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Quantum Monte Carlo (QMC) Simulation</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../quantum-computing.html",
          "name": "Quantum Computing"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../gate-based-quantum-computing.html",
          "name": "Gate-Based Quantum Computing"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "gate-based-quantum-computing"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Quantum Monte Carlo (QMC) Simulation",
          "description": "Use Quantum Monte Carlo (QMC) simulation in MATLAB&#174; to compute the mean of a function of a random variable. There are a broad range of tasks in finance and economics that depend on Monte Carlo simulation, from option pricing to macroeconomic stress testing. While this example does not explore computational efficiency, research shows that QMC offers a quadratic speed-up compared to classic Monte Carlo methods.",
          "thumbnailURL": "../../examples/quantum/win64/QuantumMonteCarloQMCExample_06.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "identifier": "quantum.QuantumMonteCarloQMCExample",
          "name": "QuantumMonteCarloQMCExample",
          "url": "quantum-monte-carlo-simulation.html"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('quantum/QuantumMonteCarloQMCExample')"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "QuantumMonteCarloQMCExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="ug">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="other">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This example shows how to use Quantum Monte Carlo (QMC) simulation in MATLAB&#174; to compute the mean of a function of a random variable."><meta xmlns="http://www.w3.org/1999/xhtml" content="../../examples/quantum/win64/QuantumMonteCarloQMCExample_06.png" itemprop="thumbnailUrl">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../quantum-computing.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Quantum Computing</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../gate-based-quantum-computing.html?s_tid=CRUX_lftnav" itemprop="url" id="mw_89c73565-106a-4694-9620-a4310ac5bfc3"><span itemprop="title">Gate-Based Quantum Computing</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item"><a href="#responsive_offcanvas">Quantum Monte Carlo (QMC) Simulation</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#QuantumMonteCarloQMCExample-1" class="nav-link intrnllnk">Problem Formulation</a></li><li class="nav-item"><a href="#QuantumMonteCarloQMCExample-2" class="nav-link intrnllnk">Classic Monte Carlo</a></li><li class="nav-item"><a href="#QuantumMonteCarloQMCExample-3" class="nav-link intrnllnk">QMC Methodology</a></li><li class="nav-item"><a href="#QuantumMonteCarloQMCExample-7" class="nav-link intrnllnk">Simulate Final Circuit</a></li><li class="nav-item"><a href="#QuantumMonteCarloQMCExample-8" class="nav-link intrnllnk">Compare Results</a></li><li class="nav-item"><a href="#QuantumMonteCarloQMCExample-9" class="nav-link intrnllnk">References</a></li><li class="nav-item"><a href="#d126e68732" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=gate-based-quantum-computing&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=gate-based-quantum-computing&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=gate-based-quantum-computing&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=gate-based-quantum-computing&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=gate-based-quantum-computing&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=gate-based-quantum-computing&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-topic">
<section><h1 class="r2025b" itemprop="title content" id="mw_d97dd456-8298-4632-aa12-f282834d85a0"><strong class="emphasis bold">Quantum Monte Carlo (QMC) Simulation</strong></h1><div class="examples_short_list hidden_ios_android" data-products="ML QUANTUM ST"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><p class="add_margin_5">This example uses:</p><ul class="list-unstyled add_border_bottom example_product_list" itemprop="requiredprods"><li><a href="matlab:matlab.internal.addons.showAddon('QUANTUM')">MATLAB Support Package for Quantum Computing</a></li><li><a href="matlab:matlab.internal.addons.showAddon('ST')">Statistics and Machine Learning Toolbox</a></li></ul><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('quantum/QuantumMonteCarloQMCExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="quantum-QuantumMonteCarloQMCExample"><meta itemprop="exampletitle" content="Quantum Monte Carlo (QMC) Simulation"></div><span id="QuantumMonteCarloQMCExample" class="anchor_target"></span><p class="shortdesc">This example shows how to use Quantum Monte Carlo (QMC) simulation in MATLAB&#174; to compute the mean of a function of a random variable. There are a broad range of tasks in finance and economics that depend on Monte Carlo simulation, from option pricing to macroeconomic stress testing. While this example does not explore computational efficiency, research shows that QMC offers a quadratic speed-up compared to classic Monte Carlo methods.</p><p>This example follows <a href="quantum-monte-carlo-simulation.html#mw_rtc_QuantumMonteCarloQMCExample_M_23D001C9" class="intrnllnk">[1]</a> in considering an application of QMC to compute the mean of a function of a random variable. Specifically, the mean of a trigonometric function of an underlying normal distribution is computed. This calculation generalizes to many practical applications. For example, if the probability distribution represents the price of an underlying asset, the function could be the price of an option on that asset.</p><div class="procedure"><h3 class="title" id="QuantumMonteCarloQMCExample-1"><strong class="emphasis bold">Problem Formulation</strong></h3><p>Assume there is a random variable <span class="emphasis"><em>x</em></span> that is normally distributed, and the function to be evaluated is</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">f</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi></mrow><mo>)</mo></mrow><mo>=</mo><msup><mrow><mi mathvariant="normal">sin</mi></mrow><mrow><mn>2</mn></mrow></msup><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi></mrow><mo>)</mo></mrow></mrow></math></p></div><p></p><p>The expected value of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">f</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi></mrow><mo>)</mo></mrow></mrow></math></span> is given analytically by <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi>μ</mi><mo>=</mo><mfrac><mrow><mi mathvariant="normal">sinh</mi><mrow><mo>(</mo><mrow><mn>1</mn></mrow><mo>)</mo></mrow></mrow><mrow><mi mathvariant="italic">e</mi></mrow></mfrac></mrow></math></span>.</p><p>Calculate the value of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi>μ</mi></mrow></math></span>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>AnalyticMean = sinh(1)/exp(1)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>AnalyticMean = 
0.4323
</pre></div></div></div><h3 class="title" id="QuantumMonteCarloQMCExample-2"><strong class="emphasis bold">Classic Monte Carlo</strong></h3><p>For comparison, compute the mean <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi>μ</mi></mrow></math></span> with classic Monte Carlo. The steps to do this are:</p><div class="orderedlist"><ol style="list-style: decimal;"><li><p>Generate a sample of points from the underlying distribution of <span class="emphasis"><em>x.</em></span></p></li><li><p>Compute the function value at each point in the sample.</p></li><li><p>Compute the sample mean of the function values.</p></li></ol></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>func = @(x) sin(x).^2;
numSamples = 1000;
sampleData = randn(numSamples,1);
funcValues = func(sampleData);
MCMean = mean(funcValues)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>MCMean = 
0.4210
</pre></div></div></div><p>Plot the sample, function values, and calculated mean.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>tiledlayout(1,2)
nexttile
h1 = histogram(sampleData);
title(<span style="color:#A020F0">"Sample Points"</span>)
nexttile
h2 = histogram(funcValues);
hold <span style="color:#A020F0">on</span>
xline(MCMean,<span style="color:#A020F0">'--'</span>,<span style="color:#A020F0">'MCMean'</span>);
hold <span style="color:#A020F0">off</span>
title(<span style="color:#A020F0">"Classic Monte Carlo"</span>,<span style="color:#A020F0">"Mean of Function Values"</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e68522" class="mediaobject"><p><img src="../../examples/quantum/win64/QuantumMonteCarloQMCExample_01.png" alt="Figure contains 2 axes objects. Axes object 1 with title Sample Points contains an object of type histogram. Axes object 2 with title Classic Monte Carlo contains 2 objects of type histogram, constantline." width="560"></p></div></div><h3 class="title" id="QuantumMonteCarloQMCExample-3"><strong class="emphasis bold">QMC Methodology</strong></h3><p>First, define some parameters for the quantum simulation. Define the number of qubits for the probability distribution register as 5, and the number of qubits for the estimation register as 6. Then, discretize the probability distribution and function over a grid and compute the discrete mean of the function.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>m = 5;  <span style="color:#228B22">% Number of probability qubits</span>
n = 6;  <span style="color:#228B22">% Number of estimation qubits</span>
M = 2^m;
N = 2^n;
probQubits = 1:m; 

x_max = pi;
x = linspace(-x_max,x_max,M)';
p = normpdf(x);
p = p./sum(p);

DiscreteMean = sum(func(x).*p)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>DiscreteMean = 
0.4326
</pre></div></div></div><p>The QMC methodology covered in <a href="quantum-monte-carlo-simulation.html#mw_rtc_QuantumMonteCarloQMCExample_M_23D001C9" class="intrnllnk">[1]</a> consists of the steps</p><div class="orderedlist"><ol style="list-style: decimal;"><li><p>Load the probability distribution onto a quantum register of <code class="literal">m</code> qubits.</p></li><li><p>Encode the value of the random variable onto a value qubit.</p></li><li><p>Use amplitude estimation, with a register of <code class="literal">n</code> qubits, to estimate the probability of the value qubit being in the state <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mfenced open="|" close="anglebracketright"><mrow><mn>1</mn></mrow></mfenced></mrow></math></span>.</p></li></ol></div><p>While there are other approaches for amplitude estimation (such as iterative amplitude estimation), this example uses quantum phase estimation.</p><p>The circuit diagram below summarizes the approach. The F block loads the probability distribution and encodes the random variable onto a value qubit. The Q blocks and the inverse Quantum Fourier Transform (QFT) are used for quantum phase estimation.</p><div class="informalfigure"><div id="d126e68563" class="mediaobject"><p><img src="../../examples/quantum/win64/QuantumMonteCarloQMCExample_02.png" alt="Image of quantum circuit for QMC" height="617" width="427"></p></div></div><h4 class="title" id="QuantumMonteCarloQMCExample-4"><strong class="emphasis bold">1. Load Probability Distribution</strong></h4><p>Load the probability distribution onto m qubits. While <a href="quantum-monte-carlo-simulation.html#mw_rtc_QuantumMonteCarloQMCExample_M_23D001C9" class="intrnllnk">[1]</a> uses a quantum variational circuit to approximate the probability distribution, this example loads the probabilities directly onto the circuit. Use the <code class="literal">initGate</code> function to initialize the circuit.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>A = initGate(probQubits,sqrt(p));
A.Name = <span style="color:#A020F0">'Ainit'</span>;</pre></div></div></div><p>Simulate the register to verify that the probability distribution loaded correctly.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>circ = quantumCircuit(A);
state = simulate(circ);
figure
histogram(state,probQubits)
title(<span style="color:#A020F0">"Simulated Probabilities"</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e68584" class="mediaobject"><p><img src="../../examples/quantum/win64/QuantumMonteCarloQMCExample_03.png" alt="Figure contains an axes object. The axes object with title Simulated Probabilities, ylabel Probability contains an object of type categoricalhistogram." width="560"></p></div></div><h4 class="title" id="QuantumMonteCarloQMCExample-5"><strong class="emphasis bold">2. Encode Random Variable</strong></h4><p>Encode the discretized random variable function onto a value qubit.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>valueQubit = m + 1;                        <span style="color:#228B22">% Value qubit index</span>
estQubits = (valueQubit + 1):(n + m + 1);  <span style="color:#228B22">% Estimation qubits index</span>

anglesR = 2*asin(sqrt(func(x)));

R = inv(ucryGate(probQubits,valueQubit,anglesR));
R.Name = <span style="color:#A020F0">"R"</span>;</pre></div></div></div><p>Compute the probability of the value qubit being in the state <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mfenced open="|" close="anglebracketright"><mrow><mn>1</mn></mrow></mfenced></mrow></math></span>. The purpose of the F circuit is to evaluate the expected value of the random variable function.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>F = compositeGate([A; R],[probQubits valueQubit],Name=<span style="color:#A020F0">"F"</span>);
sF = simulate(quantumCircuit(F));
probability(sF,valueQubit,<span style="color:#A020F0">"1"</span>)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans = 
0.4326
</pre></div></div></div><h4 class="title" id="QuantumMonteCarloQMCExample-6"><strong class="emphasis bold">3. Quantum Phase Estimation</strong></h4><p>Estimate the value of the value qubit using quantum phase estimation.</p><p>The controlled-Q block in the circuit diagram is implemented with several composite gates as outlined in <a href="quantum-monte-carlo-simulation.html#mw_rtc_QuantumMonteCarloQMCExample_M_23D001C9" class="intrnllnk">[1]</a>. Create a composite gate to represent this circuit element and plot the circuit to see the gates it contains.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>controlQubit = valueQubit+1; <span style="color:#228B22">% Re-mapped to estQubits in the loop below</span>

cV = czGate(controlQubit,valueQubit); <span style="color:#228B22">% For simplicity, do not wrap in a named CompositeGate</span>

cZgates = [xGate([probQubits valueQubit])
          hGate(probQubits(1))
          mcxGate([probQubits(2:end) valueQubit controlQubit],probQubits(1),[])
          hGate(probQubits(1))
          xGate([probQubits valueQubit])];

cZ = compositeGate(cZgates,1:controlQubit,Name=<span style="color:#A020F0">"cZ"</span>);

<span style="color:#228B22">% Put the gates together to form controlled Q:</span>

cQ = compositeGate([cV; inv(F); cZ; F; cV; inv(F); cZ; F],<span style="color:#0000FF">...</span>
                   [probQubits valueQubit controlQubit],Name=<span style="color:#A020F0">'cQ'</span>);

QPE = [];
<span style="color:#0000FF">for</span> ii=1:n
    <span style="color:#228B22">% Repeat the cQ gate as needed and map to the current control qubit:</span>
    cQrep = compositeGate(repmat(cQ,2^(n-ii),1),<span style="color:#0000FF">...</span>
                          [probQubits valueQubit estQubits(ii)],<span style="color:#0000FF">...</span>
                          Name=<span style="color:#A020F0">"cQ"</span>+2^(n-ii));

    QPE = [QPE; cQrep];
<span style="color:#0000FF">end</span>

plot(cQ)</pre></div></div></div><div class="informalfigure"><div id="d126e68621" class="mediaobject"><p><img src="../../examples/quantum/win64/QuantumMonteCarloQMCExample_04.png" alt="Figure contains an object of type quantum.gate.quantumcircuitchart. The chart of type quantum.gate.quantumcircuitchart has title CompositeGate: cQ." width="560"></p></div></div><h3 class="title" id="QuantumMonteCarloQMCExample-7"><strong class="emphasis bold">Simulate Final Circuit</strong></h3><p>Assemble the final circuit using the various component circuits, and plot the result. Specify the <code class="literal">QubitBlocks</code> name-value argument to display the two registers and the single value qubit.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>circ = quantumCircuit([F;
                       hGate(estQubits); 
                       QPE; 
                       inv(qftGate(estQubits))]);
plot(circ,<span style="color:#A020F0">"QubitBlocks"</span>,[m 1 n])</pre></div></div></div><div class="informalfigure"><div id="d126e68636" class="mediaobject"><p><img src="../../examples/quantum/win64/QuantumMonteCarloQMCExample_05.png" alt="Figure contains an object of type quantum.gate.quantumcircuitchart." width="560"></p></div></div><p>Simulate the circuit.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>state = simulate(circ);</pre></div></div></div><h3 class="title" id="QuantumMonteCarloQMCExample-8"><strong class="emphasis bold">Compare Results</strong></h3><p>In terms of the phase <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi>θ</mi></mrow></math></span>, the analytical mean is given by</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>μ</mi><mo>=</mo><mfrac><mrow><mn>1</mn><mo>-</mo><mi mathvariant="normal">cos</mi><mrow><mo>(</mo><mrow><mi>π</mi><mi>θ</mi></mrow><mo>)</mo></mrow></mrow><mrow><mn>2</mn></mrow></mfrac></mrow></math></p></div><p></p><p>Solve for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi>θ</mi></mrow></math></span> using the analytic value for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi>μ</mi></mrow></math></span>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>AnalyticPhase = acos(-2*AnalyticMean + 1)/pi</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>AnalyticPhase = 
0.4568
</pre></div></div></div><p>Compare the analytic phase with the quantum phase estimation.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[states,probabilities] = querystates(state,estQubits);
plot(bin2dec(states)/N,probabilities)
xlim([.35 .65])
xline(AnalyticPhase,<span style="color:#A020F0">'--'</span>,<span style="color:#A020F0">"AnalyticPhase"</span>)
xlabel(<span style="color:#A020F0">"\theta"</span>)
ylabel(<span style="color:#A020F0">"Probability"</span>)
title(<span style="color:#A020F0">"Phase Estimation with QMC"</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e68694" class="mediaobject"><p><img src="../../examples/quantum/win64/QuantumMonteCarloQMCExample_06.png" alt="Figure contains an axes object. The axes object with title Phase Estimation with QMC, xlabel theta, ylabel Probability contains 2 objects of type line, constantline." width="560"></p></div></div><p>The estimated phase is the first maximum in amplitude. Use the estimated phase to compute the mean value of the function, and compare the quantum value against the analytic value, classic Monte Carlo value, and discrete value.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>y_ind = find(abs(probabilities - max(probabilities)) &lt; 1e3*eps,1);
phase_estimated = bin2dec(states(y_ind))/N;
QMCMean = (1 - cos(pi * phase_estimated)) / 2;

ResultTable = table(AnalyticMean,MCMean,DiscreteMean,QMCMean)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ResultTable=<span class="emphasis"><em>1×4 table</em></span>
    AnalyticMean    MCMean     DiscreteMean    QMCMean
    ____________    _______    ____________    _______

      0.43233       0.42103      0.43264       0.42663

</pre></div></div></div><h3 class="title" id="QuantumMonteCarloQMCExample-9">References</h3><span id="mw_rtc_QuantumMonteCarloQMCExample_M_23D001C9" class="anchor_target"></span><p>[1] Priazhkina, S., V. Skavysh, D. Guala, &amp; T. Bromley. "Quantum Monte Carlo for Economics: Stress Testing and Macroeconomic Deep Learning." Bank of Canada working paper (2022). <a href="https://www.bankofcanada.ca/wp-content/uploads/2022/06/swp2022-29.pdf" target="_blank">https://www.bankofcanada.ca/wp-content/uploads/2022/06/swp2022-29.pdf</a></p><p>[2] Brassard, G., P. Hoyer, M. Mosca, &amp; A. Tapp. "Quantum Amplitude Amplification and Estimation." Contemporary Mathematics 305 (2002): 53-74. <a href="https://arxiv.org/pdf/quant-ph/0005055" target="_blank">https://arxiv.org/pdf/quant-ph/0005055</a></p><p>[3] Rebentrost, P., B. Gupt, &amp; T. R. Bromley. "Quantum Computational Finance: Monte Carlo Pricing of Financial Derivatives." Physical Review A, 98(2), 022321 (2018). <a href="https://arxiv.org/pdf/1805.00109" target="_blank">https://arxiv.org/pdf/1805.00109</a></p><p>[4] Stamatopoulos, N., D. J. Egger, Y. Sun, C. Zoufal, R. Iten, N. Shen, &amp; S. Woerner. "Option Pricing Using Quantum Computers." Quantum 4, 291 (2020). <a href="https://arxiv.org/pdf/1905.02666" target="_blank">https://arxiv.org/pdf/1905.02666</a></p><p>[5] Woerner, S., &amp; D. J. Egger. "Quantum Risk Analysis." npj Quantum Information 5(1), 15 (2019). <a href="https://arxiv.org/pdf/1806.06893" target="_blank">https://arxiv.org/pdf/1806.06893</a></p></div>
      <h2 id="d126e68732">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/quantumcircuit.html"><span itemprop="name"><code class="object">quantumCircuit</code></span></a></span></p>
      <h3 id="d126e68738">Topics</h3><ul class="list-unstyled"><li><a href="introduction-to-quantum-computing.html" class="a">Introduction to Quantum Computing</a></li><li><a href="local-quantum-state-simulation.html" class="a">Local Quantum State Simulation</a></li><li><a href="graph-coloring-with-grovers-algorithm.html" class="a">Graph Coloring with Grover's Algorithm</a></li><li><a href="ground-state-protein-folding-using-variational-quantum-eigensolver-vqe.html" class="a">Ground-State Protein Folding Using Variational Quantum Eigensolver (VQE)</a></li><li><a href="solve-xor-problem-using-quantum-neural-network.html" class="a">Solve XOR Problem Using Quantum Neural Network (QNN)</a></li></ul>
      <h3 id="d126e68751">External Websites</h3><ul class="list-unstyled"><li><a href="https://www.mathworks.com/videos/quantum-monte-carlo-with-matlab-1728452048784.html" class="video">Quantum Monte Carlo with <span class="trademark entity">MATLAB</span></a></li></ul>
    </section>
    </div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Solve BVP with Unknown Parameter</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../numerical-integration-and-differential-equations.html",
          "name": "Numerical Integration and Differential Equations"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../boundary-value-problems.html",
          "name": "Boundary Value Problems"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "boundary-value-problems"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Solve BVP with Unknown Parameter",
          "description": "Use bvp4c to solve a boundary value problem with an unknown parameter.",
          "thumbnailURL": "../../examples/matlab/win64/SolveBVPWithUnknownParameterExample_01.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "identifier": "matlab.SolveBVPWithUnknownParameterExample",
          "name": "SolveBVPWithUnknownParameterExample",
          "url": "solve-bvp-with-unknown-parameter.html"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/SolveBVPWithUnknownParameterExample')"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "SolveBVPWithUnknownParameterExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="ug">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="other">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This example shows how to use bvp4c to solve a boundary value problem with an unknown parameter."><meta xmlns="http://www.w3.org/1999/xhtml" content="../../examples/matlab/win64/SolveBVPWithUnknownParameterExample_01.png" itemprop="thumbnailUrl">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../numerical-integration-and-differential-equations.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Numerical Integration and Differential Equations</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../boundary-value-problems.html?s_tid=CRUX_lftnav" itemprop="url" id="boundary-value-problems"><span itemprop="title">Boundary Value Problems</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item"><a href="#responsive_offcanvas">Solve BVP with Unknown Parameter</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#SolveBVPWithUnknownParameterExample-1" class="nav-link intrnllnk">Code Equation</a></li><li class="nav-item"><a href="#SolveBVPWithUnknownParameterExample-2" class="nav-link intrnllnk">Code Boundary Conditions</a></li><li class="nav-item"><a href="#SolveBVPWithUnknownParameterExample-3" class="nav-link intrnllnk">Create Initial Guess</a></li><li class="nav-item"><a href="#SolveBVPWithUnknownParameterExample-4" class="nav-link intrnllnk">Solve Equation</a></li><li class="nav-item"><a href="#SolveBVPWithUnknownParameterExample-5" class="nav-link intrnllnk">Value of Parameter</a></li><li class="nav-item"><a href="#SolveBVPWithUnknownParameterExample-6" class="nav-link intrnllnk">Plot Solution</a></li><li class="nav-item"><a href="#SolveBVPWithUnknownParameterExample-7" class="nav-link intrnllnk">Local Functions</a></li><li class="nav-item"><a href="#d126e42584" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=boundary-value-problems&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=boundary-value-problems&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=boundary-value-problems&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=boundary-value-problems&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=boundary-value-problems&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=boundary-value-problems&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-topic">
<section><h1 class="r2025b" itemprop="title content" id="brfhdff-1">Solve BVP with Unknown Parameter</h1><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/SolveBVPWithUnknownParameterExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-SolveBVPWithUnknownParameterExample"><meta itemprop="exampletitle" content="Solve BVP with Unknown Parameter"></div><span id="SolveBVPWithUnknownParameterExample" class="anchor_target"></span><p class="shortdesc">This example shows how to use <code class="literal">bvp4c</code> to solve a boundary value problem with an unknown parameter.</p><p>Mathieu's equation is defined on the interval <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mrow><mo>[</mo><mrow><mn>0</mn><mo>,</mo><mi>π</mi></mrow><mo>]</mo></mrow></mrow></math></span> by</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><msup><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mo>′</mo></mrow></msup></mrow><mrow><mo>′</mo></mrow></msup><mo>+</mo><mrow><mo>(</mo><mrow><mi>λ</mi><mo>-</mo><mn>2</mn><mi mathvariant="italic">q</mi><mtext> </mtext><mi mathvariant="normal">cos</mi><mrow><mo>(</mo><mrow><mn>2</mn><mi mathvariant="italic">x</mi></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow><mi mathvariant="italic">y</mi><mo>=</mo><mn>0</mn></mrow></math></span>.</p><p>When the parameter <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">q</mi><mo>=</mo><mn>5</mn></mrow></math></span>, the boundary conditions are</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mo>′</mo></mrow></msup><mrow><mo>(</mo><mrow><mn>0</mn></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn></mrow></math></span>,</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mo>′</mo></mrow></msup><mrow><mo>(</mo><mrow><mi>π</mi></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn></mrow></math></span>.</p><p>However, this only determines <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">y</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi></mrow><mo>)</mo></mrow></mrow></math></span> up to a constant multiple, so a third condition is required to specify a particular solution,</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">y</mi><mrow><mo>(</mo><mrow><mn>0</mn></mrow><mo>)</mo></mrow><mo>=</mo><mn>1</mn></mrow></math></span>.</p><p>To solve this system of equations in MATLAB&#174;, you need to code the equations, boundary conditions, and initial guess before calling the boundary value problem solver <code class="literal">bvp4c</code>. You can either include the required functions as local functions at the end of a file (as done here), or save them as separate, named files in a directory on the MATLAB path.</p><div class="procedure"><h3 class="title" id="SolveBVPWithUnknownParameterExample-1">Code Equation</h3><p>Create a function to code the equations. This function should have the signature <code class="literal">dydx = mat4ode(x,y,lambda)</code>, where:</p><div class="itemizedlist"><ul><li><p><code class="literal">x</code> is the independent variable.</p></li><li><p><code class="literal">y</code> is the dependent variable.</p></li><li><p><code class="literal">lambda</code> is an unknown parameter representing an eigenvalue.</p></li></ul></div><p>You can write Mathieu's equation as a first-order system using the substitutions <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>=</mo><mi mathvariant="italic">y</mi></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>=</mo><msup><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mo>′</mo></mrow></msup></mrow></math></span>,</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mrow><mo>′</mo></mrow></msup><mo>=</mo><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></math></span>,</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow><mrow><mo>′</mo></mrow></msup><mo>=</mo><mo>-</mo><mrow><mo>(</mo><mrow><mi>λ</mi><mo>-</mo><mn>2</mn><mi mathvariant="italic">q</mi><mtext> </mtext><mi mathvariant="normal">cos</mi><mrow><mo>(</mo><mrow><mn>2</mn><mi mathvariant="italic">x</mi></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></math></span>.</p><p>The corresponding function is then</p><div class="code_responsive"><pre id="d126e42266" class="programlisting"><span style="color:#0000FF">function</span> dydx = mat4ode(x,y,lambda) <span style="color:#228B22">% equation being solved</span>
dydx = [y(2)
      -(lambda - 2*q*cos(2*x))*y(1)];
<span style="color:#0000FF">end</span>
</pre></div><p><span class="emphasis"><em>Note: All functions are included as local functions at the end of the example.</em></span></p><h3 class="title" id="SolveBVPWithUnknownParameterExample-2">Code Boundary Conditions</h3><p>Now, write a function that returns the residual value of the boundary conditions at the boundary points. This function should have the signature <code class="literal">res = mat4bc(ya,yb,lambda)</code>, where:</p><div class="itemizedlist"><ul><li><p><code class="literal">ya</code> is the value of the boundary condition at the beginning of the interval <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mrow><mo>[</mo><mrow><mi mathvariant="italic">a</mi><mo>,</mo><mi mathvariant="italic">b</mi></mrow><mo>]</mo></mrow></mrow></math></span>.</p></li><li><p><code class="literal">yb</code> is the value of the boundary condition at the end of the interval <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true"><mrow><mo>[</mo><mrow><mi mathvariant="italic">a</mi><mo>,</mo><mi mathvariant="italic">b</mi></mrow><mo>]</mo></mrow></math></span>.</p></li><li><p><code class="literal">lambda</code> is an unknown parameter representing an eigenvalue.</p></li></ul></div><p>This problem has three boundary conditions in the interval <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mrow><mo>[</mo><mrow><mn>0</mn><mo>,</mo><mi>π</mi></mrow><mo>]</mo></mrow></mrow></math></span>. To calculate the residual values, you need to put the boundary conditions into the form <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">g</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">y</mi></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn></mrow></math></span>. In this form the boundary conditions are</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mo>′</mo></mrow></msup><mrow><mo>(</mo><mrow><mn>0</mn></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn></mrow></math></span>,</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mo>′</mo></mrow></msup><mrow><mo>(</mo><mrow><mi>π</mi></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn></mrow></math></span>,</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true"><mi mathvariant="italic">y</mi><mrow><mo>(</mo><mrow><mn>0</mn></mrow><mo>)</mo></mrow><mo>-</mo><mn>1</mn><mo>=</mo><mn>0</mn></math></span>.</p><p>The corresponding function is then</p><div class="code_responsive"><pre id="d126e42396" class="programlisting"><span style="color:#0000FF">function</span> res = mat4bc(ya,yb,lambda) <span style="color:#228B22">% boundary conditions</span>
res = [ya(2)
       yb(2)
       ya(1)-1];
<span style="color:#0000FF">end</span>
</pre></div><h3 class="title" id="SolveBVPWithUnknownParameterExample-3">Create Initial Guess</h3><p>Lastly, create an initial guess of the solution. You must provide an initial guess for both solution components <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>=</mo><mi mathvariant="italic">y</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi></mrow><mo>)</mo></mrow></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>=</mo><msup><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mo>′</mo></mrow></msup><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi></mrow><mo>)</mo></mrow></mrow></math></span>, as well as the unknown parameter <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi>λ</mi></mrow></math></span>. Only eigenvalues and eigenfunctions that are close to the initial guesses can be computed. To increase the likelihood that the computed eigenfunction corresponds to the fourth eigenvalue, you should choose an initial guess that has the correct qualitative behavior.</p><p>For this problem, a cosine function makes for a good initial guess since it satisfies the three boundary conditions. Code the initial guess for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">y</mi></mrow></math></span> using a function that returns the guess for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></math></span>.</p><div class="code_responsive"><pre id="d126e42477" class="programlisting"><span style="color:#0000FF">function</span> yinit = mat4init(x) <span style="color:#228B22">% initial guess function</span>
yinit = [cos(4*x)
        -4*sin(4*x)];
<span style="color:#0000FF">end</span>
</pre></div><p>Call <code class="literal">bvpinit</code> using a mesh of 10 points in the interval <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mrow><mo>[</mo><mrow><mn>0</mn><mo>,</mo><mi>π</mi></mrow><mo>]</mo></mrow></mrow></math></span>, the initial guess function, and a guess of 15 for the value of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true"><mi>λ</mi></math></span>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>lambda = 15;
solinit = bvpinit(linspace(0,pi,10),@mat4init,lambda);</pre></div></div></div><h3 class="title" id="SolveBVPWithUnknownParameterExample-4">Solve Equation</h3><p>Call <code class="literal">bvp4c</code> with the ODE function, boundary condition function, and initial guess.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>sol = bvp4c(@mat4ode, @mat4bc, solinit);</pre></div></div></div><h3 class="title" id="SolveBVPWithUnknownParameterExample-5">Value of Parameter</h3><p>Print the value of the unknown parameter <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true"><mi>λ</mi></math></span> found by <code class="literal">bvp4c</code>. This value is the fourth eigenvalue (<span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">q</mi><mo>=</mo><mn>5</mn></mrow></math></span>) of Mathieu's equation.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>fprintf(<span style="color:#A020F0">'Fourth eigenvalue is approximately %7.3f.\n'</span>,<span style="color:#0000FF">...</span>
            sol.parameters)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>Fourth eigenvalue is approximately  17.097.
</pre></div></div></div><h3 class="title" id="SolveBVPWithUnknownParameterExample-6">Plot Solution</h3><p>Use <code class="literal">deval</code> to evaluate the solution computed by <code class="literal">bvp4c</code> at 100 points in the interval <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mrow><mo>[</mo><mrow><mn>0</mn><mo>,</mo><mi>π</mi></mrow><mo>]</mo></mrow></mrow></math></span>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>xint = linspace(0,pi);
Sxint = deval(sol,xint);</pre></div></div></div><p>Plot both solution components. The plot shows the eigenfunction (and its derivative) associated with the fourth eigenvalue <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi>λ</mi></mrow><mrow><mn>4</mn></mrow></msub><mo>=</mo><mn>17</mn><mo>.</mo><mn>097</mn></mrow></math></span>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>plot(xint,Sxint)
axis([0 pi -4 4])
title(<span style="color:#A020F0">'Eigenfunction of Mathieu''s Equation.'</span>) 
xlabel(<span style="color:#A020F0">'x'</span>)
ylabel(<span style="color:#A020F0">'y'</span>)
legend(<span style="color:#A020F0">'y'</span>,<span style="color:#A020F0">'y'''</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e42569" class="mediaobject"><p><img src="../../examples/matlab/win64/SolveBVPWithUnknownParameterExample_01.png" alt="Figure contains an axes object. The axes object with title Eigenfunction of Mathieu's Equation., xlabel x, ylabel y contains 2 objects of type line. These objects represent y, y'." width="560"></p></div></div><h3 class="title" id="SolveBVPWithUnknownParameterExample-7">Local Functions</h3><p>Listed here are the local helper functions that the BVP solver <code class="literal">bvp4c</code> calls to calculate the solution. Alternatively, you can save these functions as their own files in a directory on the MATLAB path.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> dydx = mat4ode(x,y,lambda) <span style="color:#228B22">% equation being solved</span>
q = 5;
dydx = [y(2)
      -(lambda - 2*q*cos(2*x))*y(1)];
<span style="color:#0000FF">end</span>
<span style="color:#228B22">%-------------------------------------------</span>
<span style="color:#0000FF">function</span> res = mat4bc(ya,yb,lambda) <span style="color:#228B22">% boundary conditions</span>
res = [ya(2)
       yb(2)
       ya(1)-1];
<span style="color:#0000FF">end</span>
<span style="color:#228B22">%-------------------------------------------</span>
<span style="color:#0000FF">function</span> yinit = mat4init(x) <span style="color:#228B22">% initial guess function</span>
yinit = [cos(4*x)
        -4*sin(4*x)];
<span style="color:#0000FF">end</span>
<span style="color:#228B22">%-------------------------------------------</span></pre></div></div></div></div>
            <h2 id="d126e42584">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/bvp4c.html"><span itemprop="name"><code class="function">bvp4c</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/bvp5c.html"><span itemprop="name"><code class="function">bvp5c</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/bvpinit.html"><span itemprop="name"><code class="function">bvpinit</code></span></a></span></p>
            <h3 id="d126e42596">Topics</h3><ul class="list-unstyled"><li><a href="boundary-value-problems.html" class="a">Solving Boundary Value Problems</a></li></ul>
            
        </section>
    </div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Solve System of ODEs with Multiple Initial Conditions</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../numerical-integration-and-differential-equations.html",
          "name": "Numerical Integration and Differential Equations"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../ordinary-differential-equations.html",
          "name": "Ordinary Differential Equations"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "ordinary-differential-equations"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Solve System of ODEs with Multiple Initial Conditions",
          "description": "Compares two techniques to solve a system of ordinary differential equations with multiple sets of initial conditions.",
          "thumbnailURL": "../../examples/matlab/win64/ODESystemWithMultipleInitialConditionsExample_04.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "identifier": "matlab.ODESystemWithMultipleInitialConditionsExample",
          "name": "ODESystemWithMultipleInitialConditionsExample",
          "url": "solve-system-of-odes-with-multiple-initial-conditions.html"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/ODESystemWithMultipleInitialConditionsExample')"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "ODESystemWithMultipleInitialConditionsExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="ug">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="other">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This example compares two techniques to solve a system of ordinary differential equations with multiple sets of initial conditions."><meta xmlns="http://www.w3.org/1999/xhtml" content="../../examples/matlab/win64/ODESystemWithMultipleInitialConditionsExample_04.png" itemprop="thumbnailUrl">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../numerical-integration-and-differential-equations.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Numerical Integration and Differential Equations</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../ordinary-differential-equations.html?s_tid=CRUX_lftnav" itemprop="url" id="ordinary-differential-equations"><span itemprop="title">Ordinary Differential Equations</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item"><a href="#responsive_offcanvas">Solve System of ODEs with Multiple Initial Conditions</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#ODESystemWithMultipleInitialConditionsExample-1" class="nav-link intrnllnk">Problem Description</a></li><li class="nav-item"><a href="#ODESystemWithMultipleInitialConditionsExample-2" class="nav-link intrnllnk">Solve Equations with One Initial Condition</a></li><li class="nav-item"><a href="#ODESystemWithMultipleInitialConditionsExample-3" class="nav-link intrnllnk">Method 1: Compute Multiple Initial Conditions with for-loop</a></li><li class="nav-item"><a href="#ODESystemWithMultipleInitialConditionsExample-4" class="nav-link intrnllnk">Method 2: Compute Multiple Initial Conditions with Vectorized ODE Function</a></li><li class="nav-item"><a href="#ODESystemWithMultipleInitialConditionsExample-5" class="nav-link intrnllnk">Compare Timing Results</a></li><li class="nav-item"><a href="#ODESystemWithMultipleInitialConditionsExample-6" class="nav-link intrnllnk">Local Functions</a></li><li class="nav-item"><a href="#d126e38973" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-topic">
<section><h1 class="r2025b" itemprop="title content" id="mw_5fd4c24a-b47e-48ac-a1b3-dc6dd14cf5e9">Solve System of ODEs with Multiple Initial Conditions</h1><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/ODESystemWithMultipleInitialConditionsExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-ODESystemWithMultipleInitialConditionsExample"><meta itemprop="exampletitle" content="Solve System of ODEs with Multiple Initial Conditions"></div><span id="ODESystemWithMultipleInitialConditionsExample" class="anchor_target"></span><p class="shortdesc">This example compares two techniques to solve a system of ordinary differential equations with multiple sets of initial conditions. The techniques are:</p><div class="itemizedlist"><ul><li><p>Use a <code class="literal">for</code>-loop to perform several simulations, one for each set of initial conditions. This technique is simple to use but does not offer the best performance for large systems.</p></li><li><p>Vectorize the ODE function to solve the system of equations for all sets of initial conditions simultaneously. This technique is the faster method for large systems but requires rewriting the ODE function so that it reshapes the inputs properly.</p></li></ul></div><p>The equations used to demonstrate these techniques are the well-known Lotka-Volterra equations, which are first-order nonlinear differential equations that describe the populations of predators and prey.</p><div class="procedure"><h3 class="title" id="ODESystemWithMultipleInitialConditionsExample-1">Problem Description</h3><p>The <a href="https://en.wikipedia.org/wiki/Lotka%E2%80%93Volterra_equations" target="_blank">Lotka-Volterra equations</a> are a system of two first-order, nonlinear ODEs that describe the populations of predators and prey in a biological system. Over time, the populations of the predators and prey change according to the equations</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mtable columnalign="left"><mtr><mtd><mrow><mfrac><mrow><mi mathvariant="normal">dx</mi></mrow><mrow><mi mathvariant="normal">dt</mi></mrow></mfrac><mo>=</mo><mi>α</mi><mi mathvariant="italic">x</mi><mo>-</mo><mi>β</mi><mi mathvariant="normal">xy</mi><mo>,</mo></mrow></mtd></mtr><mtr><mtd><mrow><mfrac><mrow><mi mathvariant="normal">dy</mi></mrow><mrow><mi mathvariant="normal">dt</mi></mrow></mfrac><mo>=</mo><mi>δ</mi><mi mathvariant="normal">xy</mi><mo>-</mo><mi>γ</mi><mi mathvariant="italic">y</mi><mo>.</mo></mrow></mtd></mtr></mtable></mrow></math></p></div><p></p><p>The variables in these equations are</p><div class="itemizedlist"><ul><li><p><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi></mrow></math></span> is the population size of the prey</p></li><li><p><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">y</mi></mrow></math></span> is the population size of the predators</p></li><li><p><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">t</mi></mrow></math></span> is time</p></li><li><p><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi>α</mi></mrow></math></span>, <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi>β</mi></mrow></math></span>, <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi>δ</mi></mrow></math></span>, and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi>γ</mi></mrow></math></span> are constant parameters that describe the interactions between the two species. This example uses the parameter values <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi>α</mi><mo>=</mo><mi>γ</mi><mo>=</mo><mn>1</mn></mrow></math></span>, <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi>β</mi><mo>=</mo><mn>0</mn><mo>.</mo><mn>01</mn></mrow></math></span>, and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi>δ</mi><mo>=</mo><mn>0</mn><mo>.</mo><mn>02</mn></mrow></math></span>.</p></li></ul></div><p>For this problem, the initial values for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">y</mi></mrow></math></span> are the initial population sizes. Solving the equations then provides information about how the populations change over time as the species interact.</p><h3 class="title" id="ODESystemWithMultipleInitialConditionsExample-2">Solve Equations with One Initial Condition</h3><p>To solve the Lotka-Volterra equations in MATLAB&#174;, write a function that encodes the equations, specify a time interval for the integration, and specify the initial conditions. Then you can use one of the ODE solvers, such as <code class="literal">ode45</code>, to simulate the system over time.</p><p>A function that encodes the equations is</p><div class="code_responsive"><pre id="d126e38727" class="programlisting"><span style="color:#0000FF">function</span> dpdt = lotkaODE(t,p)
<span style="color:#228B22">% LOTKA Lotka-Volterra predator-prey model</span>
delta = 0.02;
beta = 0.01;

dpdt = [p(1) .* (1 - beta*p(2));
        p(2) .* (-1 + delta*p(1))];
<span style="color:#0000FF">end</span>
</pre></div><p>(This function is included as a local function at the end of the example.)</p><p>Since there are two equations in the system, <code class="literal">dpdt</code> is a vector with one element for each equation. Also, the solution vector <code class="literal">p</code> has one element for each solution component: <code class="literal">p(1)</code> represents <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi></mrow></math></span> in the original equations, and <code class="literal">p(2)</code> represents <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">y</mi></mrow></math></span> in the original equations.</p><p>Next, specify the time interval for integration as <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mrow><mo>[</mo><mrow><mn>0</mn><mo>,</mo><mn>15</mn></mrow><mo>]</mo></mrow></mrow></math></span> and set the initial population sizes for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">y</mi></mrow></math></span> to 50.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>t0 = 0;
tfinal = 15;
p0 = [50; 50];</pre></div></div></div><p>Solve the system with <code class="literal">ode45</code> by specifying the ODE function, the time span, and the initial conditions. Plot the resulting populations versus time.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[t,p] = ode45(@lotkaODE,[t0 tfinal],p0);
plot(t,p)
title(<span style="color:#A020F0">'Predator/Prey Populations Over Time'</span>)
xlabel(<span style="color:#A020F0">'t'</span>)
ylabel(<span style="color:#A020F0">'Population'</span>)
legend(<span style="color:#A020F0">'Prey'</span>,<span style="color:#A020F0">'Predators'</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e38787" class="mediaobject"><p><img src="../../examples/matlab/win64/ODESystemWithMultipleInitialConditionsExample_01.png" alt="Figure contains an axes object. The axes object with title Predator/Prey Populations Over Time, xlabel t, ylabel Population contains 2 objects of type line. These objects represent Prey, Predators." width="560"></p></div></div><p>Since the solutions exhibit periodicity, plot the solutions against each other in a phase plot.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>plot(p(:,1),p(:,2))
title(<span style="color:#A020F0">'Phase Plot of Predator/Prey Populations'</span>)
xlabel(<span style="color:#A020F0">'Prey'</span>)
ylabel(<span style="color:#A020F0">'Predators'</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e38796" class="mediaobject"><p><img src="../../examples/matlab/win64/ODESystemWithMultipleInitialConditionsExample_02.png" alt="Figure contains an axes object. The axes object with title Phase Plot of Predator/Prey Populations, xlabel Prey, ylabel Predators contains an object of type line." width="560"></p></div></div><p>The resulting plots show the solution for the given initial population sizes. To solve the equations for different initial population sizes, change the values in <code class="literal">p0</code> and rerun the simulation. However, this method only solves the equations for one initial condition at a time. The next two sections describe techniques to solve for many different initial conditions.</p><h3 class="title" id="ODESystemWithMultipleInitialConditionsExample-3">Method 1: Compute Multiple Initial Conditions with <code class="literal">for-</code>loop</h3><p>The simplest way to solve a system of ODEs for multiple initial conditions is with a <code class="literal">for</code>-loop. This technique uses the same ODE function as the single initial condition technique, but the <code class="literal">for</code>-loop automates the solution process.</p><p>For example, you can hold the initial population size for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi></mrow></math></span> constant at 50, and use the <code class="literal">for</code>-loop to vary the initial population size for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">y</mi></mrow></math></span> between 10 and 400. Create a vector of population sizes for <code class="literal">y0</code>, and then loop over the values to solve the equations for each set of initial conditions. Plot a phase plot with the results from all iterations.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>y0 = 10:10:400;
<span style="color:#0000FF">for</span> k = 1:length(y0)
    [t,p] = ode45(@lotkaODE,[t0 tfinal],[50 y0(k)]);
    plot(p(:,1),p(:,2))
    hold <span style="color:#A020F0">on</span>
<span style="color:#0000FF">end</span>
title(<span style="color:#A020F0">'Phase Plot of Predator/Prey Populations'</span>)
xlabel(<span style="color:#A020F0">'Prey'</span>)
ylabel(<span style="color:#A020F0">'Predators'</span>)
hold <span style="color:#A020F0">off</span></pre></div></div></div><div class="informalfigure"><div id="d126e38836" class="mediaobject"><p><img src="../../examples/matlab/win64/ODESystemWithMultipleInitialConditionsExample_03.png" alt="Figure contains an axes object. The axes object with title Phase Plot of Predator/Prey Populations, xlabel Prey, ylabel Predators contains 40 objects of type line." width="560"></p></div></div><p>The phase plot shows all of the computed solutions for the different sets of initial conditions.</p><h3 class="title" id="ODESystemWithMultipleInitialConditionsExample-4">Method 2: Compute Multiple Initial Conditions with Vectorized ODE Function</h3><p>Another method to solve a system of ODEs for multiple initial conditions is to rewrite the ODE function so that all of the equations are solved simultaneously. The steps to do this are:</p><div class="itemizedlist"><ul><li><p>Provide all of the initial conditions to <code class="literal">ode45</code> as a matrix. The size of the matrix is <code class="literal">s</code>-by-<code class="literal">n</code>, where <code class="literal">s</code> is the number of solution components and <code class="literal">n</code> is the number of initial conditions being solved for. Each column in the matrix then represents one complete set of initial conditions for the system.</p></li><li><p>The ODE function must accept an extra input parameter for <code class="literal">n</code>, the number of initial conditions.</p></li><li><p>Inside the ODE function, the solver passes the solution components p as a column vector. The ODE function must reshape the vector into a matrix with size <code class="literal">s</code>-by-n. Each row of the matrix then contains all of the initial conditions for each variable.</p></li><li><p>The ODE function must solve the equations in a vectorized format, so that the expression accepts vectors for the solution components. In other words, <code class="literal">f(t,[y1 y2 y3 ...])</code> must return <code class="literal">[f(t,y1) f(t,y2) f(t,y3) ...]</code>.</p></li><li><p>Finally, the ODE function must reshape its output back into a vector so that the ODE solver receives a vector back from each function call.</p></li></ul></div><p>If you follow these steps, then the ODE solver can solve the system of equations using a vector for the solution components, while the ODE function reshapes the vector into a matrix and solves each solution component for all of the initial conditions. The result is that you can solve the system for all of the initial conditions in one simulation.</p><p>To implement this method for the Lotka-Volterra system, start by finding the number of initial conditions <code class="literal">n</code>, and then form a matrix of initial conditions.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>n = length(y0);
p0_all = [50*ones(n,1) y0(:)]';</pre></div></div></div><p>Next, rewrite the ODE function so that it accepts <code class="literal">n</code> as an input. Use <code class="literal">n</code> to reshape the solution vector into a matrix, then solve the vectorized system and reshape the output back into a vector. A modified ODE function that performs these tasks is</p><div class="code_responsive"><pre id="d126e38890" class="programlisting"><span style="color:#0000FF">function</span> dpdt = lotkasystem(t,p,n)
<span style="color:#228B22">%LOTKA  Lotka-Volterra predator-prey model for system of inputs p.</span>
delta = 0.02;
beta = 0.01;

<span style="color:#228B22">% Change the size of p to be: Number of equations-by-number of initial</span>
<span style="color:#228B22">% conditions.</span>
p = reshape(p,[],n);

<span style="color:#228B22">% Write equations in vectorized form.</span>
dpdt = [p(1,:) .* (1 - beta*p(2,:)); 
        p(2,:) .* (-1 + delta*p(1,:))];

<span style="color:#228B22">% Linearize output.</span>
dpdt = dpdt(:);
<span style="color:#0000FF">end</span>
</pre></div><p>Solve the system of equations for all of the initial conditions using <code class="literal">ode45</code>. Since <code class="literal">ode45</code> requires the ODE function to accept two inputs, use an anonymous function to pass in the value of <code class="literal">n</code> from the workspace to <code class="literal">lotkasystem</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[t,p] = ode45(@(t,p) lotkasystem(t,p,n),[t0 tfinal],p0_all);</pre></div></div></div><p>Reshape the output vector into a matrix with size <code class="literal">(numTimeSteps*s)</code>-by-<code class="literal">n</code>. Each column of the output <code class="literal">p(:,k)</code> contains the solutions for one set of initial conditions. Plot a phase plot of the solution components.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>p = reshape(p,[],n);
nt = length(t);
<span style="color:#0000FF">for</span> k = 1:n
    plot(p(1:nt,k),p(nt+1:end,k))
    hold <span style="color:#A020F0">on</span>
<span style="color:#0000FF">end</span>
title(<span style="color:#A020F0">'Predator/Prey Populations Over Time'</span>)
xlabel(<span style="color:#A020F0">'t'</span>)
ylabel(<span style="color:#A020F0">'Population'</span>)
hold <span style="color:#A020F0">off</span></pre></div></div></div><div class="informalfigure"><div id="d126e38916" class="mediaobject"><p><img src="../../examples/matlab/win64/ODESystemWithMultipleInitialConditionsExample_04.png" alt="Figure contains an axes object. The axes object with title Predator/Prey Populations Over Time, xlabel t, ylabel Population contains 40 objects of type line." width="560"></p></div></div><p>The results are comparable to those obtained by the <code class="literal">for</code>-loop technique. However, there are some properties of the vectorized solution technique that you should keep in mind:</p><div class="itemizedlist"><ul><li><p>The calculated solutions can be slightly different than those computed from a single initial input. The difference arises because the ODE solver applies norm checks to the entire system to calculate the size of the time steps, so the time-stepping behavior of the solution is slightly different. The change in time steps generally does not affect the accuracy of the solution, but rather which times the solution is evaluated at.</p></li><li><p>For stiff ODE solvers (<code class="literal">ode15s</code>, <code class="literal">ode23s</code>, <code class="literal">ode23t</code>, <code class="literal">ode23tb</code>) that automatically evaluate the numerical Jacobian of the system, specifying the block diagonal sparsity pattern of the Jacobian using the <code class="literal">JPattern</code> option of <code class="literal">odeset</code> can improve the efficiency of the calculation. The block diagonal form of the Jacobian arises from the input reshaping performed in the rewritten ODE function.</p></li></ul></div><h3 class="title" id="ODESystemWithMultipleInitialConditionsExample-5">Compare Timing Results</h3><p>Time each of the previous methods using <code class="literal">timeit</code>. The timing for solving the equations with one set of initial conditions is included as a baseline number to see how the methods scale.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#228B22">% Time one IC</span>
baseline = timeit(@() ode45(@lotkaODE,[t0 tfinal],p0),2);

<span style="color:#228B22">% Time for-loop</span>
<span style="color:#0000FF">for</span> k = 1:length(y0)
    loop_timing(k) = timeit(@() ode45(@lotkaODE,[t0 tfinal],[50 y0(k)]),2);
<span style="color:#0000FF">end</span>
loop_timing = sum(loop_timing);

<span style="color:#228B22">% Time vectorized fcn</span>
vectorized_timing = timeit(@() ode45(@(t,p) lotkasystem(t,p,n),[t0 tfinal],p0_all),2);</pre></div></div></div><p>Create a table with the timing results. Multiply all of the results by 1e3 to express the times in milliseconds. Include a column with the time per solution, which divides each time by the number of initial conditions being solved for.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>TimingTable = table(1e3.*[baseline; loop_timing; vectorized_timing], <span style="color:#0000FF">...</span>
    1e3.*[baseline; loop_timing/n; vectorized_timing/n],<span style="color:#0000FF">...</span>
    <span style="color:#A020F0">'VariableNames'</span>,{<span style="color:#A020F0">'TotalTime (ms)'</span>,<span style="color:#A020F0">'TimePerSolution (ms)'</span>},<span style="color:#A020F0">'RowNames'</span>, <span style="color:#0000FF">...</span>
    {<span style="color:#A020F0">'One IC'</span>,<span style="color:#A020F0">'Multi ICs: For-loop'</span>, <span style="color:#A020F0">'Mult ICs: Vectorized'</span>})</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>TimingTable=<span class="emphasis"><em>3×2 table</em></span>
                            TotalTime (ms)    TimePerSolution (ms)
                            ______________    ____________________

    One IC                     0.28579               0.28579      
    Multi ICs: For-loop         8.8342               0.22086      
    Mult ICs: Vectorized       0.70672              0.017668      

</pre></div></div></div><p>The <code class="literal">TimePerSolution</code> column shows that the vectorized technique is the fastest of the three methods.</p><h3 class="title" id="ODESystemWithMultipleInitialConditionsExample-6">Local Functions</h3><p>Listed here are the local functions that <code class="literal">ode45</code> calls to calculate the solutions. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> dpdt = lotkaODE(t,p)
<span style="color:#228B22">% LOTKA Lotka-Volterra predator-prey model</span>
delta = 0.02;
beta = 0.01;

dpdt = [p(1) .* (1 - beta*p(2));
        p(2) .* (-1 + delta*p(1))];
<span style="color:#0000FF">end</span>
<span style="color:#228B22">%------------------------------------------------------------------</span>
<span style="color:#0000FF">function</span> dpdt = lotkasystem(t,p,n)
<span style="color:#228B22">%LOTKA  Lotka-Volterra predator-prey model for system of inputs p.</span>
delta = 0.02;
beta = 0.01;

<span style="color:#228B22">% Change the size of p to be: Number of equations-by-number of initial</span>
<span style="color:#228B22">% conditions.</span>
p = reshape(p,[],n);

<span style="color:#228B22">% Write equations in vectorized form.</span>
dpdt = [p(1,:) .* (1 - beta*p(2,:)); 
        p(2,:) .* (-1 + delta*p(1,:))];

<span style="color:#228B22">% Linearize output.</span>
dpdt = dpdt(:);
<span style="color:#0000FF">end</span></pre></div></div></div></div>
            <h2 id="d126e38973">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/ode45.html"><span itemprop="name"><code class="function">ode45</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/odeset.html"><span itemprop="name"><code class="function">odeset</code></span></a></span></p>
            <h3 id="d126e38982">Topics</h3><ul class="list-unstyled"><li><a href="choose-an-ode-solver.html" class="a">Choose an ODE Solver</a></li><li><a href="numerical-integration-of-differential-equations.html" class="a">Solve Predator-Prey Equations</a></li></ul>
            
        </section>
    </div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

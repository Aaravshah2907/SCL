<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Page-Wise Matrix Functions</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../linear-algebra.html",
          "name": "Linear Algebra"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "linear-algebra"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Page-Wise Matrix Functions",
          "description": "Simplify code and speed up computations involving stacks of matrices, especially large sets of comparatively small matrices.",
          "thumbnailURL": "../../examples/matlab/win64/PagewiseMatrixFunctionsExample_03.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "identifier": "matlab.PagewiseMatrixFunctionsExample",
          "name": "PagewiseMatrixFunctionsExample",
          "url": "page-wise-matrix-functions.html"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/PagewiseMatrixFunctionsExample')"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "PagewiseMatrixFunctionsExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="ug">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ex">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="Simplify code and speed up computations involving stacks of matrices, especially large sets of comparatively small matrices."><meta xmlns="http://www.w3.org/1999/xhtml" content="../../examples/matlab/win64/PagewiseMatrixFunctionsExample_03.png" itemprop="thumbnailUrl">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../linear-algebra.html?s_tid=CRUX_lftnav" itemprop="url" id="linear-algebra"><span itemprop="title">Linear Algebra</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item"><a href="#responsive_offcanvas">Page-Wise Matrix Functions</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#PagewiseMatrixFunctionsExample-1" class="nav-link intrnllnk">Simplifying Code for Matrix Operations on N-D Arrays</a></li><li class="nav-item"><a href="#PagewiseMatrixFunctionsExample-2" class="nav-link intrnllnk">How Do Page-Wise Matrix Functions Work?</a></li><li class="nav-item"><a href="#PagewiseMatrixFunctionsExample-3" class="nav-link intrnllnk">Page-Wise Matrix Functions Available in MATLAB&#174;</a></li><li class="nav-item"><a href="#PagewiseMatrixFunctionsExample-4" class="nav-link intrnllnk">Performance Gains</a></li><li class="nav-item"><a href="#d126e7271" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=linear-algebra&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=linear-algebra&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=linear-algebra&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=linear-algebra&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=linear-algebra&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=linear-algebra&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-topic">
<section><h1 class="r2025b" itemprop="title content" id="mw_03f20166-69a1-4824-980d-49a576310c8b">Page-Wise Matrix Functions</h1><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/PagewiseMatrixFunctionsExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-PagewiseMatrixFunctionsExample"><meta itemprop="exampletitle" content="PageWise Matrix Functions"></div><span id="PagewiseMatrixFunctionsExample" class="anchor_target"></span><p class="shortdesc">If you use <code class="literal">for</code>-loops for repetitive matrix operations on N-D arrays, consider simplifying your code with page-wise matrix functions. These functions make operations involving N-D arrays, which are containers for dense matrices, easier to write and faster to run.</p><div class="procedure"><h3 class="title" id="PagewiseMatrixFunctionsExample-1">Simplifying Code for Matrix Operations on N-D Arrays</h3><p>For example, compute array <code class="literal">C</code> as a collection of matrices formed by multiplying the matrices contained in the first two dimensions of 3-D arrays <code class="literal">A</code> and <code class="literal">B</code>.</p><div class="informalfigure"><div id="d126e7098" class="mediaobject"><p><img src="../../examples/matlab/win64/PagewiseMatrixFunctionsExample_01.png" height="156" width="534"></p></div></div><p>You can multiply the corresponding matrices by writing a <code class="literal">for</code>-loop. For this example, create <code class="literal">A</code> and <code class="literal">B</code> as sets of 100,000 matrices of random numbers. <code class="literal">A</code> contains 3-by-4 matrices, and <code class="literal">B</code> contains 4-by-2 matrices. Multiply each pair of corresponding matrices to form the array <code class="literal">C</code>, which contains 100,000 matrices of size 3-by-2.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>A = rand(3,4,100000);
B = rand(4,2,100000);
loopC = zeros(3,2,100000);
tic 
<span style="color:#0000FF">for</span> i=1:100000
    loopC(:,:,i) = A(:,:,i) * B(:,:,i);
<span style="color:#0000FF">end</span>
toc</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>Elapsed time is 0.220132 seconds.
</pre></div></div></div><p>Using the page-wise matrix function <code class="literal">pagemtimes</code>, you can simplify the code for this operation.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>tic
pageC = pagemtimes(A,B);
toc</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>Elapsed time is 0.005857 seconds.
</pre></div></div></div><p>Compare the results obtained with these approaches. The resulting arrays are the same.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>isequal(pageC,loopC)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans = <span class="emphasis"><em>logical</em></span>
   1

</pre></div></div></div><h3 class="title" id="PagewiseMatrixFunctionsExample-2">How Do Page-Wise Matrix Functions Work?</h3><p>Page-wise functions operate on 2-D matrices that have been arranged into a multidimensional array. For example, the elements in the third dimension of a 3-D array are commonly called <span class="emphasis"><em>pages</em></span> because they stack on top of each other like pages in a book. Each page is a matrix that the function operates on.</p><div class="informalfigure"><div id="d126e7143" class="mediaobject"><p><img src="../../examples/matlab/win64/PagewiseMatrixFunctionsExample_02.gif" alt="3-D array with several matrices stacked on top of each other as pages in the third dimension" height="207" width="460"></p></div></div><p>You can also assemble a collection of 2-D matrices into a higher dimensional array, like a 4-D or 5-D array, and in these cases, a page-wise function still treats the fundamental unit of the array as a 2-D matrix that the function operates on, such as <code class="literal">X(:,:,i,j,k,l)</code>. The <code class="literal">cat</code> function is useful for assembling a collection of matrices into a multidimensional array, and the <code class="literal">zeros</code> function is useful for preallocating a multidimensional array.</p><h3 class="title" id="PagewiseMatrixFunctionsExample-3">Page-Wise Matrix Functions Available in MATLAB&#174;</h3><p>MATLAB provides a growing list of page-wise matrix functions. The current list includes functions for page-wise left and right matrix division, matrix inversion, transposition, singular value decomposition, matrix norm, and calculation eigenvalues and eigenvectors. For the complete list, expand the Page-wise Matrix Functions section under "Functions" on the <a href="../linear-algebra.html" data-docid="matlab_doccenter#linear-algebra" class="a">Linear Algebra</a> page.</p><p>Typically, the page-wise versions of functions have the same name as the standard 2-D matrix functions, but with the prefix <code class="literal">page</code>. For instance, the <code class="literal">svd</code> function performs the singular value decomposition, the <code class="literal">pagesvd</code> function performs the page-wise singular value decomposition of the matrices in an N-D array.</p><p>For example, create two 4-by-4 matrices and concatenate them along the third dimension into a 4-by-4-by-2 array.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>A = magic(4);
B = hilb(4);
X = cat(3,A,B);</pre></div></div></div><p>Calculate the singular values of each page of <code class="literal">X</code> by using <code class="literal">pagesvd</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>S = pagesvd(X)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>S = 
S(:,:,1) =

   34.0000
   17.8885
    4.4721
    0.0000


S(:,:,2) =

    1.5002
    0.1691
    0.0067
    0.0001

</pre></div></div></div><p>If you compute the singular values of matrices <code class="literal">A</code> and <code class="literal">B</code> by using the <code class="literal">svd</code> function, you get the same results.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>svd(A)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans = <span class="emphasis"><em>4×1</em></span>

   34.0000
   17.8885
    4.4721
    0.0000

</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>svd(B)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans = <span class="emphasis"><em>4×1</em></span>

    1.5002
    0.1691
    0.0067
    0.0001

</pre></div></div></div><h3 class="title" id="PagewiseMatrixFunctionsExample-4">Performance Gains</h3><p>In general, page-wise matrix functions are easier to write and faster to run than the equivalent for-loop approach. For example, find the eigenvalues for a set of 1000 square matrices of random numbers by using the <code class="literal">for</code>-loop approach and the <code class="literal">pageeig</code> function.</p><p>Compare the computation times for these two approaches using different matrix sizes. For this example, vary the size of the matrix from 2 to 100.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>matrixSizes = [2 5 10:10:100];</pre></div></div></div><p>Create vectors for storing <code class="literal">for</code>-loop and <code class="literal">pageeig</code> computation times for each matrix size.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>n = numel(matrixSizes);
tLoop = zeros(n,1);
tPage = zeros(n,1);</pre></div></div></div><p>Create a function that computes the eigenvalues by using the <code class="literal">for</code>-loop approach.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> Bloop = loopeig(A)
m = size(A,1);
p = size(A,3);
Bloop = zeros(m,1,p);
<span style="color:#0000FF">for</span> j = 1:p
    Bloop(:,:,j) = eig(A(:,:,j));
<span style="color:#0000FF">end</span>
<span style="color:#0000FF">end</span></pre></div></div></div><p>Compute the eigenvalues of each matrix from the set of 1000 matrices by using the <code class="literal">for</code>-loop approach and the <code class="literal">pageeig</code> function. Store the computation times in vectors <code class="literal">tLoop</code> and <code class="literal">tPage</code>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>rng(<span style="color:#A020F0">"default"</span>); <span style="color:#228B22">% for reproducibility</span>
<span style="color:#0000FF">for</span> i = 1:n
    m = matrixSizes(i);
    A = rand(m,m,1000);
    f = @() loopeig(A);
    tLoop(i) = timeit(f);
    f = @() pageeig(A);
    tPage(i) = timeit(f);
<span style="color:#0000FF">end</span></pre></div></div></div><p>Plot the times and the speed-up factors for various numbers of rows.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> plotTimes(matrixSizes,tPage,tLoop)
figure(Position=[100,100,1200,450])
t = tiledlayout(1,2);

nexttile
plot(matrixSizes,tPage,<span style="color:#A020F0">"*"</span>)
hold <span style="color:#A020F0">on</span>
plot(matrixSizes,tLoop,<span style="color:#A020F0">"o"</span>)
legend({<span style="color:#A020F0">"pageeig"</span>,<span style="color:#A020F0">"for-loop"</span>},Location=<span style="color:#A020F0">"northwest"</span>)
title(<span style="color:#A020F0">"Times"</span>)
xlabel(<span style="color:#A020F0">"Matrix Size"</span>)
ylabel(<span style="color:#A020F0">"Seconds"</span>)
hold <span style="color:#A020F0">off</span>

nexttile
plot(matrixSizes,tLoop./tPage)
title(<span style="color:#A020F0">"Speed-ups of pageeig over for-loop"</span>)
xlabel(<span style="color:#A020F0">"Matrix Size"</span>)
<span style="color:#0000FF">end</span>

plotTimes(matrixSizes,tPage,tLoop)</pre></div></div></div><div class="informalfigure"><div id="d126e7245" class="mediaobject"><p><img src="../../examples/matlab/win64/PagewiseMatrixFunctionsExample_03.png" alt="Figure contains 2 axes objects. Axes object 1 with title Times, xlabel Matrix Size, ylabel Seconds contains 2 objects of type line. One or more of the lines displays its values using only markers These objects represent pageeig, for-loop. Axes object 2 with title Speed-ups of pageeig over for-loop, xlabel Matrix Size contains an object of type line." width="1200"></p></div></div><p>The first plot shows that the <code class="literal">for</code>-loop approach takes more time than <code class="literal">pageeig</code>. The second plot shows that the benefit of using <code class="literal">pageeig</code> is largest when there are many small matrices. However, even for the larger matrices, the speed-up factor is substantial. The page-wise functions are typically faster than the for-loop approach for these reasons:</p><div class="itemizedlist"><ul><li><p><strong class="emphasis bold">Argument checking</strong>. With the page-wise functions, you check arguments only once. If you loop over 1000 pages, you check arguments 1000 times. The improvement for smaller matrices is more significant because the argument-checking overhead makes up a larger percentage of the overall time. For larger matrices, this overhead can be insignificant. With thousands of very small matrices, the time for argument-checking can be comparable to the computation time.</p></li><li><p><strong class="emphasis bold">More parallelism</strong>. Most of the linear algebra functions in MATLAB already run in parallel. To see evidence of this behavior, multiply two large matrices and monitor your CPU workload. However, when you loop over many pages containing small matrices, the individual function call is too quick to benefit from running in parallel, and the loop itself runs the iterations sequentially. Page-wise matrix functions do not have this limitation: operations on small matrices (pages) in a set can be executed at the same time. Depending on the linear algebra operation and the specified set of matrices, MATLAB page-wise matrix functions choose the threading approach that seems to be more beneficial for the particular case, by choosing between threading per page or sequential execution per page but threading across the whole set of pages.</p></li></ul></div></div>
        <h2 id="d126e7271">See Also</h2><h3>Functions</h3><ul class="list-unstyled margined_10"><li><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/pagemldivide.html"><span itemprop="name"><code class="function">pagemldivide</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/pagemrdivide.html"><span itemprop="name"><code class="function">pagemrdivide</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/pagelsqminnorm.html"><span itemprop="name"><code class="function">pagelsqminnorm</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/pageinv.html"><span itemprop="name"><code class="function">pageinv</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/pagepinv.html"><span itemprop="name"><code class="function">pagepinv</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/pageeig.html"><span itemprop="name"><code class="function">pageeig</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/pagesvd.html"><span itemprop="name"><code class="function">pagesvd</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/pagemtimes.html"><span itemprop="name"><code class="function">pagemtimes</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/pagetranspose.html"><span itemprop="name"><code class="function">pagetranspose</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/pagectranspose.html"><span itemprop="name"><code class="function">pagectranspose</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/pagenorm.html"><span itemprop="name"><code class="function">pagenorm</code></span></a></span></li></ul>
        <h3 id="d126e7311">Topics</h3><ul class="list-unstyled"><li><a href="lapack-in-matlab.html" class="a">LAPACK in MATLAB</a></li></ul>
    </section>
    </div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

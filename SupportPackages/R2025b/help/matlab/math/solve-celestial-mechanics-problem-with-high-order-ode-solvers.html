<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Solve Celestial Mechanics Problem with High-Order Solvers</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../numerical-integration-and-differential-equations.html",
          "name": "Numerical Integration and Differential Equations"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../ordinary-differential-equations.html",
          "name": "Ordinary Differential Equations"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "ordinary-differential-equations"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Solve Celestial Mechanics Problem with High-Order Solvers",
          "description": "Use ode78 and ode89 to solve a celestial mechanics problem that requires high accuracy in each step from the ODE solver for a successful integration. Both ode45 and ode113 are unable to solve the problem using the default error tolerances. Even with more stringent error thresholds, ode89 performs best on the problem due to the high accuracy of the Runge-Kutta formulas it uses in each step.",
          "thumbnailURL": "../../examples/matlab/win64/PleiadesExample_01.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "identifier": "matlab.PleiadesExample",
          "name": "PleiadesExample",
          "url": "solve-celestial-mechanics-problem-with-high-order-ode-solvers.html"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/PleiadesExample')"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "PleiadesExample.mlx",
        "orbits.gif"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="ug">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="other">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This example shows how to use ode78 and ode89 to solve a celestial mechanics problem that requires high accuracy in each step from the ODE solver for a successful integration."><meta xmlns="http://www.w3.org/1999/xhtml" content="../../examples/matlab/win64/PleiadesExample_01.png" itemprop="thumbnailUrl">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../numerical-integration-and-differential-equations.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Numerical Integration and Differential Equations</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../ordinary-differential-equations.html?s_tid=CRUX_lftnav" itemprop="url" id="ordinary-differential-equations"><span itemprop="title">Ordinary Differential Equations</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item"><a href="#responsive_offcanvas">Solve Celestial Mechanics Problem with High-Order Solvers</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#PleiadesExample-1" class="nav-link intrnllnk">Problem Description</a></li><li class="nav-item"><a href="#PleiadesExample-2" class="nav-link intrnllnk">Code Equations</a></li><li class="nav-item"><a href="#PleiadesExample-3" class="nav-link intrnllnk">Set Optional Parameters</a></li><li class="nav-item"><a href="#PleiadesExample-4" class="nav-link intrnllnk">Solve System of Equations</a></li><li class="nav-item"><a href="#PleiadesExample-5" class="nav-link intrnllnk">Plot Solution Curves</a></li><li class="nav-item"><a href="#PleiadesExample-6" class="nav-link intrnllnk">Create Animation of Results</a></li><li class="nav-item"><a href="#PleiadesExample-7" class="nav-link intrnllnk">References</a></li><li class="nav-item"><a href="#PleiadesExample-8" class="nav-link intrnllnk">Local Functions</a></li><li class="nav-item"><a href="#d126e40364" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-topic">
<section><h1 class="r2025b" itemprop="title content" id="mw_16c0ff04-ff6d-47d7-8873-5bd95f76e854">Solve Celestial Mechanics Problem with High-Order Solvers</h1><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/PleiadesExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-PleiadesExample"><meta itemprop="exampletitle" content="Solve Celestial Mechanics Problem with HighOrder Solvers"></div><span id="PleiadesExample" class="anchor_target"></span><p class="shortdesc">This example shows how to use <code class="literal">ode78</code> and <code class="literal">ode89</code> to solve a celestial mechanics problem that requires high accuracy in each step from the ODE solver for a successful integration. Both <code class="literal">ode45</code> and <code class="literal">ode113</code> are unable to solve the problem using the default error tolerances. Even with more stringent error thresholds, <code class="literal">ode89</code> performs best on the problem due to the high accuracy of the Runge-Kutta formulas it uses in each step.</p><div class="procedure"><h3 class="title" id="PleiadesExample-1">Problem Description</h3><p>The <span class="emphasis"><em>Pleiades problem</em></span> is a celestial mechanics problem describing the gravitational interactions of seven stars [1]. This cluster of stars is also referred to as <span class="emphasis"><em>The Seven Sisters</em></span>, and it is visible to the human eye in the night sky due to its proximity to Earth [2]. The system of equations describing the motion of the stars in the cluster consists of 14 nonstiff second-order differential equations, which produce a system of 28 equations when rewritten in first-order form.</p><p>Newton's second law of motion relates the force applied to a body to its rate of change in momentum over time,</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">F</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub><mo>=</mo><mrow><mfrac><mrow><mi mathvariant="normal">d</mi></mrow><mrow><mi mathvariant="normal">d</mi><mrow><mi mathvariant="italic">t</mi></mrow></mrow></mfrac><mrow><msub><mrow><mi mathvariant="italic">p</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub></mrow></mrow></mrow></math></span>.</p><p>The momentum (<span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">p</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub><mo>=</mo><msub><mrow><mi mathvariant="italic">m</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub><msub><mrow><mi mathvariant="italic">v</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub></mrow></math></span>) has separate <span class="emphasis"><em>x</em></span>- and <span class="emphasis"><em>y</em></span>-components. At the same time, the universal law of gravitation describes the force working on body <span class="emphasis"><em>i</em></span> from body <span class="emphasis"><em>j</em></span> as</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">F</mi></mrow><mrow><mi mathvariant="normal">ij</mi></mrow></msub><mo>=</mo><mi mathvariant="italic">g</mi><mfrac><mrow><msub><mrow><mi mathvariant="italic">m</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub><msub><mrow><mi mathvariant="italic">m</mi></mrow><mrow><mi mathvariant="italic">j</mi></mrow></msub></mrow><mrow><msup><mrow><mrow><mo>‖</mo><mrow><msub><mrow><mi mathvariant="italic">p</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub><mo>-</mo><msub><mrow><mi mathvariant="italic">p</mi></mrow><mrow><mi mathvariant="italic">j</mi></mrow></msub></mrow><mo>‖</mo></mrow></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac><msub><mrow><mi mathvariant="italic">d</mi></mrow><mrow><mi mathvariant="normal">ij</mi></mrow></msub></mrow></math></span>.</p><p>The term <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">d</mi></mrow><mrow><mi mathvariant="normal">ij</mi></mrow></msub><mo>=</mo><mfrac><mrow><msub><mrow><mi mathvariant="italic">p</mi></mrow><mrow><mi mathvariant="italic">j</mi></mrow></msub><mo>-</mo><msub><mrow><mi mathvariant="italic">p</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub></mrow><mrow><mrow><mo>‖</mo><mrow><msub><mrow><mi mathvariant="italic">p</mi></mrow><mrow><mi mathvariant="italic">j</mi></mrow></msub><mo>-</mo><msub><mrow><mi mathvariant="italic">p</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub></mrow><mo>‖</mo></mrow></mrow></mfrac></mrow></math></span> gives the direction of the distance between the bodies, and the masses of the bodies are <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">m</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub><mo>=</mo><mi mathvariant="italic">i</mi></mrow></math></span> for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><mn>7</mn></mrow></math></span>. For a system with many bodies, the force applied to any individual body is the sum of its interactions with all others, so</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msub><mrow><mi mathvariant="italic">F</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub><mo>=</mo><mrow><munder><mrow><mo>∑</mo></mrow><mrow><mi mathvariant="italic">i</mi><mo>≠</mo><mi mathvariant="italic">j</mi></mrow></munder><mrow><msub><mrow><mi mathvariant="italic">F</mi></mrow><mrow><mi mathvariant="normal">ij</mi></mrow></msub><mo>.</mo></mrow></mrow></mrow></math></p></div><p></p><p>Setting the gravitational constant <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">g</mi></mrow></math></span> equal to 1 and solving yields a system of second-order equations describing the evolution of the <span class="emphasis"><em>x</em></span>- and <span class="emphasis"><em>y</em></span>-components over time.</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msup><mrow><msup><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub></mrow><mrow><mo>′</mo></mrow></msup></mrow><mrow><mo>′</mo></mrow></msup><mo>=</mo><msub><mrow><mi mathvariant="italic">f</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">y</mi></mrow><mo>)</mo></mrow><mo>=</mo><mrow><munder accent="false" accentunder="false"><mrow><mo>∑</mo></mrow><mrow><mi mathvariant="italic">j</mi><mo>≠</mo><mi mathvariant="italic">i</mi></mrow></munder><mrow><mfrac><mrow><msub><mrow><mi mathvariant="italic">m</mi></mrow><mrow><mi mathvariant="italic">j</mi></mrow></msub><mrow><mo>(</mo><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mi mathvariant="italic">j</mi></mrow></msub><mo>-</mo><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub></mrow><mo>)</mo></mrow></mrow><mrow><msubsup><mrow><mi mathvariant="italic">r</mi></mrow><mrow><mi mathvariant="normal">ij</mi></mrow><mrow><mtext> </mtext><mn>3</mn><mo>/</mo><mn>2</mn></mrow></msubsup></mrow></mfrac></mrow></mrow><mo>,</mo></mrow></math></p></div><p></p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msup><mrow><msup><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub></mrow><mrow><mo>′</mo></mrow></msup></mrow><mrow><mo>′</mo></mrow></msup><mo>=</mo><msub><mrow><mi mathvariant="italic">h</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">y</mi></mrow><mo>)</mo></mrow><mo>=</mo><mrow><munder accent="false" accentunder="false"><mrow><mo>∑</mo></mrow><mrow><mi mathvariant="italic">j</mi><mo>≠</mo><mi mathvariant="italic">i</mi></mrow></munder><mrow><mfrac><mrow><msub><mrow><mi mathvariant="italic">m</mi></mrow><mrow><mi mathvariant="italic">j</mi></mrow></msub><mrow><mo>(</mo><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mi mathvariant="italic">j</mi></mrow></msub><mo>-</mo><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub></mrow><mo>)</mo></mrow></mrow><mrow><msubsup><mrow><mi mathvariant="italic">r</mi></mrow><mrow><mi mathvariant="normal">ij</mi></mrow><mrow><mtext> </mtext><mn>3</mn><mo>/</mo><mn>2</mn></mrow></msubsup></mrow></mfrac></mrow></mrow><mo>,</mo></mrow></math></p></div><p></p><p>where <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">r</mi></mrow><mrow><mi mathvariant="normal">ij</mi></mrow></msub><mo>=</mo><msqrt><mrow><msup><mrow><mrow><mo>(</mo><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub><mo>-</mo><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mi mathvariant="italic">j</mi></mrow></msub></mrow><mo>)</mo></mrow></mrow><mrow><mn>2</mn></mrow></msup><mo>+</mo><msup><mrow><mrow><mo>(</mo><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub><mo>-</mo><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mi mathvariant="italic">j</mi></mrow></msub></mrow><mo>)</mo></mrow></mrow><mrow><mn>2</mn></mrow></msup></mrow></msqrt></mrow></math></span>. Because these two equations apply for each of the seven stars in the system, 14 second-order differential equations (<span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><mn>7</mn><mo>)</mo></mrow></math></span> describe the entire system. </p><p>The initial conditions for the system, as given in [1], are:</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mo>{</mo><mtable columnalign="left"><mtr><mtd><mrow><msub><mrow><mi>x</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></mtd><mtd><mrow><mo>=</mo><mo stretchy="false">(</mo><mn>3</mn><mo>,</mo><mn>3</mn><mo>,</mo><mo>-</mo><mn>1</mn><mo>,</mo><mo>-</mo><mn>3</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>-</mo><mn>2</mn><mo>,</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi>y</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></mtd><mtd><mrow><mo>=</mo><mo stretchy="false">(</mo><mn>3</mn><mo>,</mo><mo>-</mo><mn>3</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mo>-</mo><mn>4</mn><mo>,</mo><mn>4</mn><mo stretchy="false">)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mrow><mi>x</mi></mrow><mrow><mn>0</mn></mrow><mrow><mo>′</mo></mrow></msubsup></mrow></mtd><mtd><mrow><mo>=</mo><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">.</mo><mn>7</mn><mn>5</mn><mo>,</mo><mo>-</mo><mn>1</mn><mo stretchy="false">.</mo><mn>5</mn><mo stretchy="false">)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mrow><mi>y</mi></mrow><mrow><mn>0</mn></mrow><mrow><mo>′</mo></mrow></msubsup></mrow></mtd><mtd><mrow><mo>=</mo><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mo>-</mo><mn>1</mn><mo stretchy="false">.</mo><mn>2</mn><mn>5</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mtd></mtr></mtable></mrow></mrow></math></p></div><p></p><p>To solve this system of ODEs in MATLAB&#174;, you must code the equations into a function before calling the solvers <code class="literal">ode78</code> and <code class="literal">ode89</code>. You can either include the required functions as local functions at the end of a file (as done here), or save them as separate, named files in a directory on the MATLAB path.</p><h3 class="title" id="PleiadesExample-2">Code Equations</h3><p>The ODE solvers in MATLAB require equations to be written in first-order form, <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><mi mathvariant="italic">q</mi></mrow><mrow><mo>′</mo></mrow></msup><mo>=</mo><mi mathvariant="italic">u</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">q</mi></mrow><mo>)</mo></mrow></mrow></math></span>. For this problem, the system of equations can be rewritten in first-order form using the substitutions <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">w</mi><mo>=</mo><msup><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mo>′</mo></mrow></msup></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">z</mi><mo>=</mo><msup><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mo>′</mo></mrow></msup></mrow></math></span>. With these substitutions, the system contains 28 first-order equations organized into four groups of seven equations:</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><msubsup><mrow><mi>x</mi></mrow><mrow><mi>i</mi></mrow><mrow><mo>′</mo></mrow></msubsup></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mrow><mi>y</mi></mrow><mrow><mi>i</mi></mrow><mrow><mo>′</mo></mrow></msubsup></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mrow><mi>w</mi></mrow><mrow><mi>i</mi></mrow><mrow><mo>′</mo></mrow></msubsup></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mo>′</mo></mrow></msubsup></mrow></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><msub><mrow><mi>w</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>i</mi></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi>h</mi></mrow><mrow><mi>i</mi></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow></math></span>.</p><p>The solution vector produced by solving the system has the form</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi mathvariant="italic">q</mi><mo>=</mo><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">w</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">z</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub></mrow></mtd></mtr></mtable><mo>]</mo></mrow><mo>.</mo></mrow></math></p></div><p></p><p>Therefore, writing the original equations in terms of the solution vector <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">q</mi></mrow></math></span> yields</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><msup><mrow><msub><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub></mrow><mrow><mo>′</mo></mrow></msup></mrow></mtd></mtr><mtr><mtd><mrow><msup><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub></mrow><mrow><mo>′</mo></mrow></msup></mrow></mtd></mtr><mtr><mtd><mrow><msup><mrow><msub><mrow><mi mathvariant="italic">w</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub></mrow><mrow><mo>′</mo></mrow></msup></mrow></mtd></mtr><mtr><mtd><mrow><msup><mrow><msub><mrow><mi mathvariant="italic">z</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub></mrow><mrow><mo>′</mo></mrow></msup></mrow></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable columnalign="center"><mtr><mtd><mrow><mrow><mo>(</mo><mrow><msub><mrow><mi mathvariant="italic">q</mi></mrow><mrow><mn>15</mn></mrow></msub><mo>,</mo><msub><mrow><mi mathvariant="italic">q</mi></mrow><mrow><mn>16</mn></mrow></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mrow><mi mathvariant="italic">q</mi></mrow><mrow><mn>21</mn></mrow></msub></mrow><mo>)</mo></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mo>(</mo><mrow><msub><mrow><mi mathvariant="italic">q</mi></mrow><mrow><mn>22</mn></mrow></msub><mo>,</mo><msub><mrow><mi mathvariant="italic">q</mi></mrow><mrow><mn>23</mn></mrow></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mrow><mi mathvariant="italic">q</mi></mrow><mrow><mn>28</mn></mrow></msub></mrow><mo>)</mo></mrow></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">f</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">y</mi></mrow><mo>)</mo></mrow></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="italic">h</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">y</mi></mrow><mo>)</mo></mrow></mrow></mtd></mtr></mtable><mo>]</mo></mrow><mo>,</mo></mrow></math></p></div><p></p><p>where <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi><mo>=</mo><mrow><mo>(</mo><mrow><msub><mrow><mi mathvariant="italic">q</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>,</mo><msub><mrow><mi mathvariant="italic">q</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mrow><mi mathvariant="italic">q</mi></mrow><mrow><mn>7</mn></mrow></msub></mrow><mo>)</mo></mrow></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">y</mi><mo>=</mo><mrow><mo>(</mo><mrow><msub><mrow><mi mathvariant="italic">q</mi></mrow><mrow><mn>8</mn></mrow></msub><mo>,</mo><msub><mrow><mi mathvariant="italic">q</mi></mrow><mrow><mn>9</mn></mrow></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mrow><mi mathvariant="italic">q</mi></mrow><mrow><mn>14</mn></mrow></msub></mrow><mo>)</mo></mrow></mrow></math></span>. With the equations written in the first-order form <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><mi mathvariant="italic">q</mi></mrow><mrow><mo>′</mo></mrow></msup><mo>=</mo><mi mathvariant="italic">u</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">t</mi><mo>,</mo><mi mathvariant="italic">q</mi></mrow><mo>)</mo></mrow></mrow></math></span>, you can now write a function that calculates the components during each time step of the solution process. A function that codes this system of equations is:</p><div class="code_responsive"><pre id="d126e40176" class="programlisting"><span style="color:#0000FF">function</span> dqdt = pleiades(t,q)
  x = q(1:7);
  y = q(8:14);
  xDist = (x - x.');
  yDist = (y - y.');
  r = (xDist.^2+yDist.^2).^(3/2);
  m = (1:7)';
  dqdt = [q(15:28);
          sum(xDist.*m./r,1,<span style="color:#A020F0">'omitnan'</span>).';
          sum(yDist.*m./r,1,<span style="color:#A020F0">'omitnan'</span>).'];
<span style="color:#0000FF">end</span>
</pre></div><p>In this function, the <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">y</mi></mrow></math></span> values are extracted directly from the solution vector <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">q</mi></mrow></math></span>, as are the first 14 components of the output. Then, the function uses the position values to calculate the distances between all seven stars, and these distances are used in the code for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">f</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">y</mi></mrow><mo>)</mo></mrow></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">h</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi><mo>,</mo><mi mathvariant="italic">y</mi></mrow><mo>)</mo></mrow></mrow></math></span>. </p><h3 class="title" id="PleiadesExample-3">Set Optional Parameters</h3><p>Use the <code class="literal">odeset</code> function to set the value of several optional parameters:</p><div class="itemizedlist"><ul><li><p>Specify stringent error tolerances of <code class="literal">1e-13</code> and <code class="literal">1e-15</code> for the relative and absolute error tolerances, respectively. </p></li><li><p>Turn on the display of solver statistics.</p></li></ul></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>opts = odeset(<span style="color:#A020F0">"RelTol"</span>,1e-13,<span style="color:#A020F0">"AbsTol"</span>,1e-15,<span style="color:#A020F0">"Stats"</span>,<span style="color:#A020F0">"on"</span>);</pre></div></div></div><h3 class="title" id="PleiadesExample-4">Solve System of Equations</h3><p>Create a column vector with the initial conditions and a time vector with regularly spaced points in the range <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mrow><mo>[</mo><mrow><mn>0</mn><mo>,</mo><mn>15</mn></mrow><mo>]</mo></mrow></mrow></math></span>. When you specify a time vector with more than two elements, the solver returns solutions at the time points you specify.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>init = [3 3 -1 -3 2 -2 2 <span style="color:#0000FF">...</span>
        3 -3 2 0 0 -4 4 <span style="color:#0000FF">...</span>
        0 0 0 0 0 1.75 -1.5 <span style="color:#0000FF">...</span>
        0 0 0 -1.25 1 0 0]';
tspan = linspace(1,15,200);</pre></div></div></div><p>Now, solve the equations using both <code class="literal">ode78</code> and <code class="literal">ode89</code> by specifying the equations, time span, initial values, and options. Use <code class="literal">tic</code> and <code class="literal">toc</code> to time each solver for comparison (note that timings can differ depending on your computer).</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>tic
[t78,q78] = ode78(@pleiades,tspan,init,opts);</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>14963 successful steps
549 failed attempts
201899 function evaluations
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>toc</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>Elapsed time is 3.533438 seconds.
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>tic
[t89,q89] = ode89(@pleiades,tspan,init,opts);</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>4181 successful steps
56 failed attempts
68726 function evaluations
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>toc</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>Elapsed time is 1.307842 seconds.
</pre></div></div></div><p>The output indicates that <code class="literal">ode89</code> is best suited for solving the problem, because it is faster and has fewer failed steps.</p><h3 class="title" id="PleiadesExample-5">Plot Solution Curves</h3><p>The first 14 components of <code class="literal">q89</code> contain the <span class="emphasis"><em>x</em></span> and <span class="emphasis"><em>y</em></span> positions for each of the seven stars, as obtained by <code class="literal">ode89</code>. Plot these solution components to see the trajectories of all the stars over time.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>plot(q89(:,1),q89(:,8),<span style="color:#A020F0">'--'</span>,<span style="color:#0000FF">...</span>
     q89(:,2),q89(:,9),<span style="color:#A020F0">'--'</span>,<span style="color:#0000FF">...</span>
     q89(:,3),q89(:,10),<span style="color:#A020F0">'--'</span>,<span style="color:#0000FF">...</span>
     q89(:,4),q89(:,11),<span style="color:#A020F0">'--'</span>,<span style="color:#0000FF">...</span>
     q89(:,5),q89(:,12),<span style="color:#A020F0">'--'</span>,<span style="color:#0000FF">...</span>
     q89(:,6),q89(:,13),<span style="color:#A020F0">'--'</span>,<span style="color:#0000FF">...</span>
     q89(:,7),q89(:,14),<span style="color:#A020F0">'--'</span>)
title(<span style="color:#A020F0">'Position of Pleiades Stars, Solved by ODE89'</span>)
xlabel(<span style="color:#A020F0">'X Position'</span>)
ylabel(<span style="color:#A020F0">'Y Position'</span>)</pre></div></div></div><div class="informalfigure"><div id="d126e40319" class="mediaobject"><p><img src="../../examples/matlab/win64/PleiadesExample_01.png" alt="Figure contains an axes object. The axes object with title Position of Pleiades Stars, Solved by ODE89, xlabel X Position, ylabel Y Position contains 7 objects of type line." width="560"></p></div></div><h3 class="title" id="PleiadesExample-6">Create Animation of Results</h3><p>Because the trajectories of the stars overlap considerably, a better way to visualize the results is to create an animation showing the stars move over time. The function <code class="literal">AnimateOrbits</code>, included as a local function at the end of this example, accepts the output from a solver for this problem and creates an animated GIF file in the current folder that shows the stars move along their trajectories.</p><p>For example, you can generate an animation with the output from the <code class="literal">ode89</code> solver using the command</p><div class="code_responsive"><pre id="d126e40333" class="programlisting">AnimateOrbits(t89,q89);
</pre></div><p>The following is a sample output GIF.</p><div class="informalfigure"><div id="d126e40337" class="mediaobject"><p><img src="../../examples/matlab/win64/PleiadesExample_02.gif" alt="orbits.gif" height="344" width="435"></p></div></div><h3 class="title" id="PleiadesExample-7">References</h3><p>[1] Hairer, E., et al. <span class="emphasis"><em>Solving Ordinary Differential Equations I: Nonstiff Problems</em></span>. 2nd rev. ed, Springer, 2009.</p><p>[2] “Pleiades.” <span class="emphasis"><em>Wikipedia</em></span>, 21 June 2021. <span class="emphasis"><em>Wikipedia</em></span>, <a href="https://en.wikipedia.org/wiki/Pleiades" target="_blank">https://en.wikipedia.org/wiki/Pleiades</a>.</p><h3 class="title" id="PleiadesExample-8">Local Functions</h3><p>This section includes the local functions called by the ODE solver to calculate the solution. Alternatively, you can save these functions as their own files in a directory on the MATLAB path.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> dqdt = pleiades(t,q)
  x = q(1:7);
  y = q(8:14);
  xDist = (x - x.');
  yDist = (y - y.');
  r = (xDist.^2+yDist.^2).^(3/2);
  m = (1:7)';
  dqdt = [q(15:28);
          sum(xDist.*m./r,1,<span style="color:#A020F0">'omitnan'</span>).';
          sum(yDist.*m./r,1,<span style="color:#A020F0">'omitnan'</span>).'];
<span style="color:#0000FF">end</span>
<span style="color:#228B22">%-----------------------------------------------------------------</span>
<span style="color:#0000FF">function</span> AnimateOrbits(t,q)
<span style="color:#0000FF">for</span> k = 1:length(t)
    plot(q(:,1),q(:,8),<span style="color:#A020F0">'--'</span>,q(:,2),q(:,9),<span style="color:#A020F0">'--'</span>,<span style="color:#0000FF">...</span>
         q(:,3),q(:,10),<span style="color:#A020F0">'--'</span>,q(:,4),q(:,11),<span style="color:#A020F0">'--'</span>,<span style="color:#0000FF">...</span>
         q(:,5),q(:,12),<span style="color:#A020F0">'--'</span>,q(:,6),q(:,13),<span style="color:#A020F0">'--'</span>,<span style="color:#0000FF">...</span>
         q(:,7),q(:,14),<span style="color:#A020F0">'--'</span>)
    hold <span style="color:#A020F0">on</span>
    xlim([-20 20])
    ylim([-10 10])
    sz = 15;
    plot(q(k,1),q(k,8),<span style="color:#A020F0">'o'</span>,<span style="color:#A020F0">'MarkerSize'</span>,sz,<span style="color:#A020F0">'MarkerFaceColor'</span>,<span style="color:#A020F0">'r'</span>)
    plot(q(k,2),q(k,9),<span style="color:#A020F0">'o'</span>,<span style="color:#A020F0">'MarkerSize'</span>,sz,<span style="color:#A020F0">'MarkerFaceColor'</span>,<span style="color:#A020F0">'k'</span>)
    plot(q(k,3),q(k,10),<span style="color:#A020F0">'o'</span>,<span style="color:#A020F0">'MarkerSize'</span>,sz,<span style="color:#A020F0">'MarkerFaceColor'</span>,<span style="color:#A020F0">'b'</span>)
    plot(q(k,4),q(k,11),<span style="color:#A020F0">'o'</span>,<span style="color:#A020F0">'MarkerSize'</span>,sz,<span style="color:#A020F0">'MarkerFaceColor'</span>,<span style="color:#A020F0">'m'</span>)
    plot(q(k,5),q(k,12),<span style="color:#A020F0">'o'</span>,<span style="color:#A020F0">'MarkerSize'</span>,sz,<span style="color:#A020F0">'MarkerFaceColor'</span>,<span style="color:#A020F0">'c'</span>)
    plot(q(k,6),q(k,13),<span style="color:#A020F0">'o'</span>,<span style="color:#A020F0">'MarkerSize'</span>,sz,<span style="color:#A020F0">'MarkerFaceColor'</span>,<span style="color:#A020F0">'y'</span>)
    plot(q(k,7),q(k,14),<span style="color:#A020F0">'o'</span>,<span style="color:#A020F0">'MarkerSize'</span>,sz,<span style="color:#A020F0">'MarkerFaceColor'</span>,[210 120 0]./255)
    hold <span style="color:#A020F0">off</span>
    drawnow
    M(k) = getframe(gca);
    im{k} = frame2im(M(k));
<span style="color:#0000FF">end</span>

filename = <span style="color:#A020F0">"orbits.gif"</span>;
<span style="color:#0000FF">for</span> idx = 1:length(im)
    [A,map] = rgb2ind(im{idx},256);
    <span style="color:#0000FF">if</span> idx == 1
        imwrite(A,map,filename,<span style="color:#A020F0">'gif'</span>,<span style="color:#A020F0">'LoopCount'</span>,Inf,<span style="color:#A020F0">'DelayTime'</span>,0);
    <span style="color:#0000FF">else</span>
        imwrite(A,map,filename,<span style="color:#A020F0">'gif'</span>,<span style="color:#A020F0">'WriteMode'</span>,<span style="color:#A020F0">'append'</span>,<span style="color:#A020F0">'DelayTime'</span>,0);
    <span style="color:#0000FF">end</span>
<span style="color:#0000FF">end</span>
close <span style="color:#A020F0">all</span>
<span style="color:#0000FF">end</span></pre></div></div></div></div>
            <h2 id="d126e40364">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/ode78.html"><span itemprop="name"><code class="function">ode78</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/ode89.html"><span itemprop="name"><code class="function">ode89</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/odeset.html"><span itemprop="name"><code class="function">odeset</code></span></a></span></p>
            <h3 id="d126e40376">Topics</h3><ul class="list-unstyled"><li><a href="choose-an-ode-solver.html" class="a">Choose an ODE Solver</a></li><li><a href="summary-of-ode-options.html" class="a">Summary of ODE Options</a></li><li><a href="solve-equations-of-motion-for-baton.html" class="a">Solve Equations of Motion for Baton Thrown into Air</a></li></ul>
            
        </section>
    </div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

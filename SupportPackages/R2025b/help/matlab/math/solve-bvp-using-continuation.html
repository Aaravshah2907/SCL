<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Solve BVP Using Continuation</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../numerical-integration-and-differential-equations.html",
          "name": "Numerical Integration and Differential Equations"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../boundary-value-problems.html",
          "name": "Boundary Value Problems"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "boundary-value-problems"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Solve BVP Using Continuation",
          "description": "Solve a numerically difficult boundary value problem using continuation, which effectively breaks the problem up into a sequence of simpler problems.",
          "thumbnailURL": "../../examples/matlab/win64/SolveBVPUsingContinuationExample_01.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "identifier": "matlab.SolveBVPUsingContinuationExample",
          "name": "SolveBVPUsingContinuationExample",
          "url": "solve-bvp-using-continuation.html"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/SolveBVPUsingContinuationExample')"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "SolveBVPUsingContinuationExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="ug">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="other">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This example shows how to solve a numerically difficult boundary value problem using continuation, which effectively breaks the problem up into a sequence of simpler problems."><meta xmlns="http://www.w3.org/1999/xhtml" content="../../examples/matlab/win64/SolveBVPUsingContinuationExample_01.png" itemprop="thumbnailUrl">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../numerical-integration-and-differential-equations.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Numerical Integration and Differential Equations</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../boundary-value-problems.html?s_tid=CRUX_lftnav" itemprop="url" id="boundary-value-problems"><span itemprop="title">Boundary Value Problems</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item"><a href="#responsive_offcanvas">Solve BVP Using Continuation</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#SolveBVPUsingContinuationExample-1" class="nav-link intrnllnk">Code Equation</a></li><li class="nav-item"><a href="#SolveBVPUsingContinuationExample-2" class="nav-link intrnllnk">Code Boundary Conditions</a></li><li class="nav-item"><a href="#SolveBVPUsingContinuationExample-3" class="nav-link intrnllnk">Code Jacobians</a></li><li class="nav-item"><a href="#SolveBVPUsingContinuationExample-4" class="nav-link intrnllnk">Form Initial Guess</a></li><li class="nav-item"><a href="#SolveBVPUsingContinuationExample-5" class="nav-link intrnllnk">Solve Equation</a></li><li class="nav-item"><a href="#SolveBVPUsingContinuationExample-6" class="nav-link intrnllnk">Plot Solution</a></li><li class="nav-item"><a href="#SolveBVPUsingContinuationExample-7" class="nav-link intrnllnk">Local Functions</a></li><li class="nav-item"><a href="#d126e43437" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=boundary-value-problems&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=boundary-value-problems&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=boundary-value-problems&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=boundary-value-problems&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=boundary-value-problems&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=boundary-value-problems&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-topic">
<section><h1 class="r2025b" itemprop="title content" id="mw_186505af-d9a3-423b-bc66-fe510abff013">Solve BVP Using Continuation</h1><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/SolveBVPUsingContinuationExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-SolveBVPUsingContinuationExample"><meta itemprop="exampletitle" content="Solve BVP Using Continuation"></div><span id="SolveBVPUsingContinuationExample" class="anchor_target"></span><p class="shortdesc">This example shows how to solve a numerically difficult boundary value problem using continuation, which effectively breaks the problem up into a sequence of simpler problems.</p><p>For <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mn>0</mn><mo>&lt;</mo><mi mathvariant="italic">e</mi><mo>≪</mo><mn>1</mn></mrow></math></span>, consider the differential equation</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">e</mi><msup><mrow><msup><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mo>′</mo></mrow></msup></mrow><mrow><mo>′</mo></mrow></msup><mo>+</mo><msup><mrow><mi mathvariant="normal">xy</mi></mrow><mrow><mo>′</mo></mrow></msup><mo>=</mo><mo>-</mo><mi mathvariant="italic">e</mi><msup><mrow><mi>π</mi></mrow><mrow><mn>2</mn></mrow></msup><mi mathvariant="normal">cos</mi><mrow><mo>(</mo><mrow><mi>π</mi><mi mathvariant="italic">x</mi></mrow><mo>)</mo></mrow><mo>-</mo><mi>π</mi><mi mathvariant="normal">xsin</mi><mrow><mo>(</mo><mrow><mi>π</mi><mi mathvariant="italic">x</mi></mrow><mo>)</mo></mrow></mrow></math></span>.</p><p>The problem is posed on the interval <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mrow><mo>[</mo><mrow><mo>-</mo><mn>1</mn><mo>,</mo><mn>1</mn></mrow><mo>]</mo></mrow></mrow></math></span> and is subject to the boundary conditions</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">y</mi><mrow><mo>(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>=</mo><mo>-</mo><mn>2</mn></mrow></math></span>,</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">y</mi><mrow><mo>(</mo><mrow><mn>1</mn></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn></mrow></math></span>.</p><p>When <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">e</mi><mo>=</mo><msup><mrow><mn>10</mn></mrow><mrow><mo>-</mo><mn>4</mn></mrow></msup></mrow></math></span>, the solution to the equation undergoes a rapid transition near <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi><mo>=</mo><mn>0</mn></mrow></math></span>, so it is difficult to solve numerically. Instead, this example uses continuation to iterate through several values of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">e</mi></mrow></math></span> until <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">e</mi><mo>=</mo><msup><mrow><mn>10</mn></mrow><mrow><mo>-</mo><mn>4</mn></mrow></msup></mrow></math></span>. The intermediate solutions are each used as the initial guess for the next problem.</p><p>To solve this system of equations in MATLAB&#174;, you need to code the equations, boundary conditions, and initial guess before calling the boundary value problem solver <code class="literal">bvp4c</code>. You either can include the required functions as local functions at the end of a file (as done here), or you can save them as separate, named files in a directory on the MATLAB path.</p><div class="procedure"><h3 class="title" id="SolveBVPUsingContinuationExample-1">Code Equation</h3><p>Using the substitutions <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>=</mo><mi mathvariant="italic">y</mi></mrow></math></span> and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>=</mo><msup><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mo>′</mo></mrow></msup></mrow></math></span>, you can rewrite the equation as the system of first-order equations</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mrow><mo>′</mo></mrow></msup><mo>=</mo><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></math></span>,</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow><mrow><mo>′</mo></mrow></msup><mo>=</mo><mo>-</mo><mfrac><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mi mathvariant="italic">e</mi></mrow></mfrac><msup><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mo>′</mo></mrow></msup><mo>-</mo><msup><mrow><mi>π</mi></mrow><mrow><mn>2</mn></mrow></msup><mi mathvariant="normal">cos</mi><mrow><mo>(</mo><mrow><mi>π</mi><mi mathvariant="italic">x</mi></mrow><mo>)</mo></mrow><mo>-</mo><mfrac><mrow><mi>π</mi><mi mathvariant="italic">x</mi></mrow><mrow><mi mathvariant="italic">e</mi></mrow></mfrac><mi mathvariant="normal">sin</mi><mrow><mo>(</mo><mrow><mi>π</mi><mi mathvariant="italic">x</mi></mrow><mo>)</mo></mrow></mrow></math></span>.</p><p>Write a function to code the equations with the signature <code class="literal">dydx = shockode(x,y)</code>, where:</p><div class="itemizedlist"><ul><li><p><code class="literal">x</code> is the independent variable.</p></li><li><p><code class="literal">y</code> is the dependent variable.</p></li><li><p><code class="literal">dydx(1)</code> gives the equation for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mrow><mo>′</mo></mrow></msup></mrow></math></span>, and <code class="literal">dydx(2)</code> gives the equation for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow><mrow><mo>′</mo></mrow></msup></mrow></math></span>.</p></li></ul></div><p>Make the function vectorized, so that <code class="literal">shockode([x1 x2 ...],[y1 y2 ...])</code> returns <code class="literal">[shockode(x1,y1) shockode(x2,y2) ...]</code>. This approach improves solver performance.</p><p>The corresponding function is</p><div class="code_responsive"><pre id="d126e42953" class="programlisting"><span style="color:#0000FF">function</span> dydx = shockode(x,y)
pix = pi*x;
dydx = [y(2,:)
       -x/e.*y(2,:) - pi^2*cos(pix) - pix/e.*sin(pix)];
<span style="color:#0000FF">end</span>
</pre></div><p><span class="emphasis"><em>Note: All functions are included as local functions at the end of the example.</em></span></p><h3 class="title" id="SolveBVPUsingContinuationExample-2">Code Boundary Conditions</h3><p>The BVP solver requires the boundary conditions to be in the form <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">g</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">y</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">a</mi></mrow><mo>)</mo></mrow><mo>,</mo><mi mathvariant="italic">y</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">b</mi></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn></mrow></math></span>. In this form the boundary conditions are:</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">y</mi><mrow><mo>(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>+</mo><mn>2</mn><mo>=</mo><mn>0</mn></mrow></math></span>,</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">y</mi><mrow><mo>(</mo><mrow><mn>1</mn></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn></mrow></math></span>.</p><p>Write a function to code the boundary conditions with the signature <code class="literal">res = shockbc(ya,yb)</code>, where:</p><div class="itemizedlist"><ul><li><p><code class="literal">ya</code> is the value of the boundary condition at the beginning of the interval <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mrow><mo>[</mo><mrow><mi mathvariant="italic">a</mi><mo>,</mo><mi mathvariant="italic">b</mi></mrow><mo>]</mo></mrow></mrow></math></span>.</p></li><li><p><code class="literal">yb</code> is the value of the boundary condition at the end of the interval <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mrow><mo>[</mo><mrow><mi mathvariant="italic">a</mi><mo>,</mo><mi mathvariant="italic">b</mi></mrow><mo>]</mo></mrow></mrow></math></span>.</p></li></ul></div><p>The corresponding function is</p><div class="code_responsive"><pre id="d126e43061" class="programlisting"><span style="color:#0000FF">function</span> res = shockbc(ya,yb) <span style="color:#228B22">% boundary conditions</span>
res = [ya(1)+2
       yb(1)];
<span style="color:#0000FF">end</span>
</pre></div><h3 class="title" id="SolveBVPUsingContinuationExample-3">Code Jacobians</h3><p>The analytical Jacobians for the ODE function and boundary conditions can be calculated easily in this problem. Providing the Jacobians makes the solver more efficient, since the solver no longer needs to approximate them with finite differences.</p><p>For the ODE function, the Jacobian matrix is</p><p class="displayequation"><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">J</mi></mrow><mrow><mi mathvariant="normal">ODE</mi></mrow></msub><mo>=</mo><mfrac><mrow><mo>∂</mo><mi mathvariant="italic">f</mi></mrow><mrow><mo>∂</mo><mi mathvariant="italic">y</mi></mrow></mfrac><mo>=</mo><mrow><mo>[</mo><mtable><mtr><mtd><mrow><mfrac><mrow><mo>∂</mo><msub><mrow><mi mathvariant="italic">f</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mrow><mo>∂</mo><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mfrac><mrow><mo>∂</mo><msub><mrow><mi mathvariant="italic">f</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mrow><mo>∂</mo><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mfrac></mrow></mtd></mtr><mtr><mtd><mrow><mfrac><mrow><mo>∂</mo><msub><mrow><mi mathvariant="italic">f</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow><mrow><mo>∂</mo><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mfrac><mrow><mo>∂</mo><msub><mrow><mi mathvariant="italic">f</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow><mrow><mo>∂</mo><msub><mrow><mi mathvariant="italic">y</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mfrac></mrow></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable><mtr><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mn>1</mn></mrow></mtd></mtr><mtr><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mo>-</mo><mfrac><mrow><mi mathvariant="italic">x</mi></mrow><mrow><mi mathvariant="italic">e</mi></mrow></mfrac></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow></math></span>.</p><p>The corresponding function is</p><div class="code_responsive"><pre id="d126e43199" class="programlisting"><span style="color:#0000FF">function</span> jac = shockjac(x,y,e)
jac = [0   1
       0  -x/e];
<span style="color:#0000FF">end</span>
</pre></div><p>Similarly, for the boundary conditions, the Jacobian matrices are</p><p><span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">J</mi></mrow><mrow><mi mathvariant="italic">y</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">a</mi></mrow><mo>)</mo></mrow></mrow></msub><mo>=</mo><mrow><mo>[</mo><mtable><mtr><mtd><mrow><mn>1</mn></mrow></mtd><mtd><mrow><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mn>0</mn></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow></math></span> , <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">J</mi></mrow><mrow><mi mathvariant="italic">y</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">b</mi></mrow><mo>)</mo></mrow></mrow></msub><mo>=</mo><mrow><mo>[</mo><mtable><mtr><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow><mn>1</mn></mrow></mtd><mtd><mrow><mn>0</mn></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow></math></span>.</p><p>The corresponding function is</p><div class="code_responsive"><pre id="d126e43276" class="programlisting"><span style="color:#0000FF">function</span> [dBCdya,dBCdyb] = shockbcjac(ya,yb)
dBCdya = [1 0; 0 0];
dBCdyb = [0 0; 1 0];
<span style="color:#0000FF">end</span>
</pre></div><h3 class="title" id="SolveBVPUsingContinuationExample-4">Form Initial Guess</h3><p>Use a constant guess for the solution on a mesh of five points in <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mrow><mo>[</mo><mrow><mo>-</mo><mn>1</mn><mo>,</mo><mn>1</mn></mrow><mo>]</mo></mrow></mrow></math></span>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>sol = bvpinit([-1 -0.5 0 0.5 1],[1 0]);</pre></div></div></div><h3 class="title" id="SolveBVPUsingContinuationExample-5">Solve Equation</h3><p>If you try to solve the equation directly using <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">e</mi><mo>=</mo><msup><mrow><mn>10</mn></mrow><mrow><mo>-</mo><mn>4</mn></mrow></msup></mrow></math></span>, then the solver is not able to overcome the poor conditioning of the problem near the <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi><mo>=</mo><mn>0</mn></mrow></math></span> transition point. Instead, to obtain the solution for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">e</mi><mo>=</mo><msup><mrow><mn>10</mn></mrow><mrow><mo>-</mo><mn>4</mn></mrow></msup></mrow></math></span>, this example uses continuation by solving a sequence of problems for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><mn>10</mn></mrow><mrow><mo>-</mo><mn>2</mn></mrow></msup></mrow></math></span>, <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><mn>10</mn></mrow><mrow><mo>-</mo><mn>3</mn></mrow></msup></mrow></math></span>, and <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msup><mrow><mn>10</mn></mrow><mrow><mo>-</mo><mn>4</mn></mrow></msup></mrow></math></span>. The output from the solver in each iteration acts as the guess for the solution in the next iteration (this is why the variable for the initial guess from <code class="literal">bvpinit</code> is <code class="literal">sol</code>, and the output from the solver is also named <code class="literal">sol</code>).</p><p>Since the value of the Jacobian depends on the value of <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">e</mi></mrow></math></span>, set the options in the loop specifying the <code class="literal">shockjac</code> and <code class="literal">shockbcjac</code> functions for the Jacobians. Also, turn vectorization on since <code class="literal">shockode</code> is coded to handle vectors of values.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>e = 0.1;
<span style="color:#0000FF">for</span> i = 2:4
   e = e/10;
   options = bvpset(<span style="color:#A020F0">'FJacobian'</span>,@(x,y) shockjac(x,y,e),<span style="color:#0000FF">...</span>
                    <span style="color:#A020F0">'BCJacobian'</span>,@shockbcjac,<span style="color:#0000FF">...</span>
                    <span style="color:#A020F0">'Vectorized'</span>,<span style="color:#A020F0">'on'</span>);
   sol = bvp4c(@(x,y) shockode(x,y,e),@shockbc, sol, options);
<span style="color:#0000FF">end</span></pre></div></div></div><h3 class="title" id="SolveBVPUsingContinuationExample-6">Plot Solution</h3><p>Plot the results from <code class="literal">bvp4c</code> for the mesh <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi></mrow></math></span> and solution <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">y</mi><mrow><mo>(</mo><mrow><mi mathvariant="italic">x</mi></mrow><mo>)</mo></mrow></mrow></math></span>. With continuation, the solver is able to handle the discontinuity at <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">x</mi><mo>=</mo><mn>0</mn></mrow></math></span>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>plot(sol.x,sol.y(1,:),<span style="color:#A020F0">'-o'</span>);
axis([-1 1 -2.2 2.2]);
title([<span style="color:#A020F0">'There Is a Shock at x = 0 When e ='</span> sprintf(<span style="color:#A020F0">'%.e'</span>,e) <span style="color:#A020F0">'.'</span>]);
xlabel(<span style="color:#A020F0">'x'</span>);
ylabel(<span style="color:#A020F0">'solution y'</span>);</pre></div></div></div><div class="informalfigure"><div id="d126e43422" class="mediaobject"><p><img src="../../examples/matlab/win64/SolveBVPUsingContinuationExample_01.png" alt="Figure contains an axes object. The axes object with title There Is a Shock at x = 0 When e =1e-04., xlabel x, ylabel solution y contains an object of type line." width="560"></p></div></div><h3 class="title" id="SolveBVPUsingContinuationExample-7">Local Functions</h3><p>Listed here are the local functions that the BVP solver <code class="literal">bvp4c</code> calls to calculate the solution. Alternatively, you can save these functions as their own files in a directory on the MATLAB path.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> dydx = shockode(x,y,e) <span style="color:#228B22">% equation to solve</span>
pix = pi*x;
dydx = [y(2,:)
       -x/e.*y(2,:) - pi^2*cos(pix) - pix/e.*sin(pix)];
<span style="color:#0000FF">end</span>
<span style="color:#228B22">%-------------------------------------------</span>
<span style="color:#0000FF">function</span> res = shockbc(ya,yb) <span style="color:#228B22">% boundary conditions</span>
res = [ya(1)+2
       yb(1)];
<span style="color:#0000FF">end</span>
<span style="color:#228B22">%-------------------------------------------</span>
<span style="color:#0000FF">function</span> jac = shockjac(x,y,e) <span style="color:#228B22">% jacobian of shockode</span>
jac = [0   1
       0  -x/e];
<span style="color:#0000FF">end</span>
<span style="color:#228B22">%-------------------------------------------</span>
<span style="color:#0000FF">function</span> [dBCdya,dBCdyb] = shockbcjac(ya,yb) <span style="color:#228B22">% jacobian of shockbc</span>
dBCdya = [1 0; 0 0];
dBCdyb = [0 0; 1 0];
<span style="color:#0000FF">end</span>
<span style="color:#228B22">%-------------------------------------------</span></pre></div></div></div></div>
            <h2 id="d126e43437">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/bvp4c.html"><span itemprop="name"><code class="function">bvp4c</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/bvpinit.html"><span itemprop="name"><code class="function">bvpinit</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/bvpset.html"><span itemprop="name"><code class="function">bvpset</code></span></a></span></p>
            <h3 id="d126e43449">Topics</h3><ul class="list-unstyled"><li><a href="boundary-value-problems.html" class="a">Solving Boundary Value Problems</a></li><li><a href="verify-bvp-consistency-using-continuation.html" class="a">Verify BVP Consistency Using Continuation</a></li></ul>
            
        </section>
    </div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

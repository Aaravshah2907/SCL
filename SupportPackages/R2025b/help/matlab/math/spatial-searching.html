<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Spatial Searching</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../computational-geometry.html",
          "name": "Computational Geometry"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../spatial-search.html",
          "name": "Spatial Search"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "spatial-search"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Spatial Searching",
          "description": "This topic introduces nearest-neighbor and point-location searches.",
          "thumbnailURL": "../../examples/matlab/win64/SpatialSearchingExample_02.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "identifier": "matlab.SpatialSearchingExample",
          "name": "SpatialSearchingExample",
          "url": "spatial-searching.html"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/SpatialSearchingExample')"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "SpatialSearchingExample.mlx"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="ug">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ex">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This topic introduces nearest-neighbor and point-location searches."><meta xmlns="http://www.w3.org/1999/xhtml" content="../../examples/matlab/win64/SpatialSearchingExample_02.png" itemprop="thumbnailUrl">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../computational-geometry.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Computational Geometry</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../spatial-search.html?s_tid=CRUX_lftnav" itemprop="url" id="spatial-search"><span itemprop="title">Spatial Search</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item"><a href="#responsive_offcanvas">Spatial Searching</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#SpatialSearchingExample-1" class="nav-link intrnllnk">Introduction</a></li><li class="nav-item"><a href="#SpatialSearchingExample-2" class="nav-link intrnllnk">Nearest-Neighbor Search</a></li><li class="nav-item"><a href="#SpatialSearchingExample-3" class="nav-link intrnllnk">Point-Location Search</a></li><li class="nav-item"><a href="#d126e21512" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=spatial-search&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=spatial-search&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=spatial-search&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=spatial-search&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=spatial-search&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=spatial-search&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-topic">
<section><h1 class="r2025b" itemprop="title content" id="bspqkfv-1">Spatial Searching</h1><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/SpatialSearchingExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-SpatialSearchingExample"><meta itemprop="exampletitle" content="Spatial Searching"></div><span id="SpatialSearchingExample" class="anchor_target"></span><div class="procedure"><h3 class="title" id="SpatialSearchingExample-1">Introduction</h3><p class="shortdesc">MATLAB&#174; provides the necessary functions for performing a spatial search using either a Delaunay triangulation or a general triangulation. The search queries that MATLAB supports are:</p><div class="itemizedlist"><ul><li><p>Nearest-neighbor search (sometimes called closest-point search or proximity search).</p></li><li><p>Point-location search (sometimes called point-in-triangle search or point-in-simplex search, where a simplex is a triangle, tetrahedron or higher dimensional equivalent).</p></li></ul></div><p>Given a set of points <code class="literal">X</code> and a query point <code class="literal">q</code> in Euclidean space, the nearest-neighbor search locates a point <code class="literal">p</code> in <code class="literal">X</code> that is closer to <code class="literal">q</code> than to any other point in <code class="literal">X</code>. Given a triangulation of <code class="literal">X</code>, the point-location search locates the triangle or tetrahedron that contains the query point <code class="literal">q</code>. Since these methods work for both Delaunay as well as general triangulations, you can use them even if a modification of the points violates the Delaunay criterion. You also can search a general triangulation represented in matrix format.</p><p>While MATLAB supports these search schemes in <code class="literal">N</code> dimensions, exact spatial searches usually become prohibitive as the number of dimensions extends beyond 3-D. You should consider approximate alternatives for large problems in up to 10 dimensions.</p><h3 class="title" id="SpatialSearchingExample-2">Nearest-Neighbor Search</h3><p>There are a few ways to compute nearest-neighbors in MATLAB, depending on the dimensionality of the problem:</p><div class="itemizedlist"><ul><li><p>For 2-D and 3-D searches, use the <a href="../ref/triangulation.nearestneighbor.html" data-docid="matlab_ref#bugpbpi" class="a"><code class="olink">nearestNeighbor</code></a> method provided by the <a href="../ref/triangulation.html" data-docid="matlab_ref#btpws75-1" class="a"><code class="olink">triangulation</code></a> class and inherited by the <a href="../ref/delaunaytriangulation.html" data-docid="matlab_ref#btpykr7-1" class="a"><code class="olink">delaunayTriangulation</code></a> class.</p></li><li><p>For 4-D and higher, use the <a href="../ref/delaunayn.html" data-docid="matlab_ref#f81-998714" class="a"><code class="olink">delaunayn</code></a> function to construct the triangulation and the complementary <a href="../ref/dsearchn.html" data-docid="matlab_ref#f81-999250" class="a"><code class="olink">dsearchn</code></a> function to perform the search. While these N-D functions support 2-D and 3-D, they are not as general and efficient as the triangulation search methods.</p></li></ul></div><p>This example shows how to perform a nearest-neighbor search in 2-D with <code class="literal">delaunayTriangulation</code>.</p><p>Begin by creating a random set of 15 points.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>X = [3.5 8.2; 6.8 8.3; 1.3 6.5; 3.5 6.3; 5.8 6.2; 8.3 6.5;<span style="color:#0000FF">...</span>
    1 4; 2.7 4.3; 5 4.5; 7 3.5; 8.7 4.2; 1.5 2.1; 4.1 1.1; <span style="color:#0000FF">...</span>
    7 1.5; 8.5 2.75];</pre></div></div></div><p>Plot the points and add annotations to show the ID labels.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>plot(X(:,1),X(:,2),<span style="color:#A020F0">'ob'</span>)
hold <span style="color:#A020F0">on</span>
vxlabels = arrayfun(@(n) {sprintf(<span style="color:#A020F0">'X%d'</span>, n)}, (1:15)');
Hpl = text(X(:,1)+0.2, X(:,2)+0.2, vxlabels, <span style="color:#A020F0">'FontWeight'</span>, <span style="color:#0000FF">...</span>
    <span style="color:#A020F0">'bold'</span>, <span style="color:#A020F0">'HorizontalAlignment'</span>,<span style="color:#A020F0">'center'</span>, <span style="color:#A020F0">'BackgroundColor'</span>, <span style="color:#0000FF">...</span>
    <span style="color:#A020F0">'none'</span>);
hold <span style="color:#A020F0">off</span></pre></div></div></div><p>Create a Delaunay triangulation from the points.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>dt = delaunayTriangulation(X);</pre></div></div></div><p>Create some query points and for each query point find the index of its corresponding nearest neighbor in <code class="literal">X</code> using the <code class="literal">nearestNeighbor</code> method.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>numq = 10;
rng(0,<span style="color:#A020F0">'twister'</span>);
q = 2+rand(numq,2)*6;
xi = nearestNeighbor(dt, q);</pre></div></div></div><p>Add the query points to the plot and add line segments joining the query points to their nearest neighbors.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>xnn = X(xi,:);

hold <span style="color:#A020F0">on</span>
plot(q(:,1),q(:,2),<span style="color:#A020F0">'or'</span>);
plot([xnn(:,1) q(:,1)]',[xnn(:,2) q(:,2)]',<span style="color:#A020F0">'-r'</span>);

vxlabels = arrayfun(@(n) {sprintf(<span style="color:#A020F0">'q%d'</span>, n)}, (1:numq)');
Hpl = text(q(:,1)+0.2, q(:,2)+0.2, vxlabels, <span style="color:#A020F0">'FontWeight'</span>, <span style="color:#0000FF">...</span>
    <span style="color:#A020F0">'bold'</span>, <span style="color:#A020F0">'HorizontalAlignment'</span>,<span style="color:#A020F0">'center'</span>, <span style="color:#0000FF">...</span>
    <span style="color:#A020F0">'BackgroundColor'</span>,<span style="color:#A020F0">'none'</span>);

hold <span style="color:#A020F0">off</span></pre></div></div></div><div class="informalfigure"><div id="d126e21395" class="mediaobject"><p><img src="../../examples/matlab/win64/SpatialSearchingExample_01.png" alt="Figure contains an axes object. The axes object contains 37 objects of type line, text. One or more of the lines displays its values using only markers" width="560"></p></div></div><p>Performing a nearest-neighbor search in 3-D is a direct extension of the 2-D example based on <code class="literal">delaunayTriangulation</code>.</p><p>For 4-D and higher, use the <code class="literal">delaunayn</code> and <code class="literal">dsearchn</code> functions as illustrated in the following example:</p><p>Create a random sample of points in 4-D and triangulate the points using <code class="literal">delaunayn</code>:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>X = 20*rand(50,4) -10;
tri = delaunayn(X);</pre></div></div></div><p>Create some query points and for each query point find the index of its corresponding nearest-neighbor in <code class="literal">X</code> using the <code class="literal">dsearchn</code> function:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>q = rand(5,4);
xi = dsearchn(X,tri, q);</pre></div></div></div><p>The <code class="literal">nearestNeighbor</code> method and the <code class="literal">dsearchn</code> function allow the Euclidean distance between the query point and its nearest-neighbor to be returned as an optional argument. In the 4-D example, you can compute the distances, <code class="literal">dnn</code>, as follows:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[xi,dnn] = dsearchn(X,tri,q);</pre></div></div></div><h3 class="title" id="SpatialSearchingExample-3">Point-Location Search</h3><p>A point-location search is a triangulation search algorithm that locates the simplex (triangle, tetrahedron, and so on) enclosing a query point. As in the case of the nearest-neighbor search, there are a few approaches to performing a point-location search in MATLAB, depending on the dimensionality of the problem:</p><div class="itemizedlist"><ul><li><p>For 2-D and 3-D, use the class-based approach with the <a href="../ref/triangulation.pointlocation.html" data-docid="matlab_ref#bugpbnq" class="a"><code class="olink">pointLocation</code></a> method provided by the <code class="literal">triangulation</code> class and inherited by the <code class="literal">delaunayTriangulation</code> class.</p></li><li><p>For 4-D and higher, use the <code class="literal">delaunayn</code> function to construct the triangulation and the complementary <a href="../ref/tsearchn.html" data-docid="matlab_ref#f97-998871" class="a"><code class="olink">tsearchn</code></a> function to perform the point-location search. Although supporting 2-D and 3-D, these N-D functions are not as general and efficient as the triangulation search methods.</p></li></ul></div><p>This example shows how to use the <code class="literal">delaunayTriangulation</code> class to perform a point location search in 2-D.</p><p>Begin with a set of 2-D points.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>X = [3.5 8.2; 6.8 8.3; 1.3 6.5; 3.5 6.3; 5.8 6.2; <span style="color:#0000FF">...</span>
    8.3 6.5; 1 4; 2.7 4.3; 5 4.5; 7 3.5; 8.7 4.2; <span style="color:#0000FF">...</span>
    1.5 2.1; 4.1 1.1; 7 1.5; 8.5 2.75];</pre></div></div></div><p>Create the triangulation and plot it showing the triangle ID labels at the incenters of the triangles.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>dt = delaunayTriangulation(X);
triplot(dt);

hold <span style="color:#A020F0">on</span>
ic = incenter(dt);
numtri = size(dt,1);
trilabels = arrayfun(@(x) {sprintf(<span style="color:#A020F0">'T%d'</span>, x)}, (1:numtri)');
Htl = text(ic(:,1), ic(:,2), trilabels, <span style="color:#A020F0">'FontWeight'</span>, <span style="color:#0000FF">...</span>
      <span style="color:#A020F0">'bold'</span>, <span style="color:#A020F0">'HorizontalAlignment'</span>, <span style="color:#A020F0">'center'</span>, <span style="color:#A020F0">'Color'</span>, <span style="color:#0000FF">...</span>
      <span style="color:#A020F0">'blue'</span>);
hold <span style="color:#A020F0">off</span></pre></div></div></div><p>Now create some query points and add them to the plot. Then find the index of the corresponding enclosing triangles using the <code class="literal">pointLocation</code> method.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>q = [5.9344    6.2363;
    2.2143    2.1910;
    7.0948    3.6615;
    7.6040    2.2770;
    6.0724    2.5828;
    6.5464    6.9407;
    6.4588    6.1690;
    4.3534    3.9026;
    5.9329    7.7013;
    3.0271    2.2067];

hold <span style="color:#A020F0">on</span>; 
plot(q(:,1),q(:,2),<span style="color:#A020F0">'*r'</span>); 
vxlabels = arrayfun(@(n) {sprintf(<span style="color:#A020F0">'q%d'</span>, n)}, (1:10)');
Hpl = text(q(:,1)+0.2, q(:,2)+0.2, vxlabels, <span style="color:#A020F0">'FontWeight'</span>, <span style="color:#0000FF">...</span>
    <span style="color:#A020F0">'bold'</span>, <span style="color:#A020F0">'HorizontalAlignment'</span>,<span style="color:#A020F0">'center'</span>, <span style="color:#0000FF">...</span><span style="color:#228B22"> </span>
    <span style="color:#A020F0">'BackgroundColor'</span>, <span style="color:#A020F0">'none'</span>);
hold <span style="color:#A020F0">off</span></pre></div></div></div><div class="informalfigure"><div id="d126e21471" class="mediaobject"><p><img src="../../examples/matlab/win64/SpatialSearchingExample_02.png" alt="Figure contains an axes object. The axes object contains 30 objects of type line, text. One or more of the lines displays its values using only markers" width="560"></p></div></div><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>ti = pointLocation(dt,q);</pre></div></div></div><p>Performing a point-location search in 3-D is a direct extension of performing a point-location search in 2-D with <code class="literal">delaunayTriangulation</code>.</p><p>For 4-D and higher, use the <code class="literal">delaunayn</code> and <code class="literal">tsearchn</code> functions as illustrated in the following example:</p><p>Create a random sample of points in 4-D and triangulate them using <code class="literal">delaunayn</code>:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>X = 20*rand(50,4) -10;
tri = delaunayn(X);</pre></div></div></div><p>Create some query points and find the index of the corresponding enclosing simplices using the tsearchn function:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>q = rand(5,4);
ti = tsearchn(X,tri,q);</pre></div></div></div><p>The <code class="literal">pointLocation</code> method and the <code class="literal">tsearchn</code> function allow the corresponding barycentric coordinates to be returned as an optional argument. In the 4-D example, you can compute the barycentric coordinates as follows:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[ti,bc] = tsearchn(X,tri,q);</pre></div></div></div><p>The barycentric coordinates are useful for performing linear interpolation. These coordinates provide you with weights that you can use to scale the values at each vertex of the enclosing simplex. See <a href="interpolating-scattered-data.html" data-docid="matlab_math#bsou4rj-1" class="a">Interpolating Scattered Data</a> for further details.</p></div>
      <h2 id="d126e21512">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/triangulation.nearestneighbor.html"><span itemprop="name"><code class="method">nearestNeighbor</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/delaunaytriangulation.html"><span itemprop="name"><code class="object">delaunayTriangulation</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/triangulation.html"><span itemprop="name"><code class="object">triangulation</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/delaunayn.html"><span itemprop="name"><code class="function">delaunayn</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/dsearchn.html"><span itemprop="name"><code class="function">dsearchn</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/triangulation.pointlocation.html"><span itemprop="name"><code class="method">pointLocation</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/triangulation.html"><span itemprop="name"><code class="object">triangulation</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/tsearchn.html"><span itemprop="name"><code class="function">tsearchn</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/delaunay.html"><span itemprop="name"><code class="function">delaunay</code></span></a></span></p>
      <h3 id="d126e21543">Topics</h3><ul class="list-unstyled"><li><a href="delaunay-triangulation.html" class="a">Working with Delaunay Triangulations</a></li><li><a href="triangulation-representations.html" class="a">Triangulation Representations</a></li><li><a href="interpolating-scattered-data.html" class="a">Interpolating Scattered Data</a></li></ul>
    </section>
    </div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">Â© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

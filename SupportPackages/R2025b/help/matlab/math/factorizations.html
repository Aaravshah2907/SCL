<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Factorizations</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../linear-algebra.html",
          "name": "Linear Algebra"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "linear-algebra"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="ug">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ex">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="Common matrix factorizations (Cholesky, LU, QR)."><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../linear-algebra.html?s_tid=CRUX_lftnav" itemprop="url" id="linear-algebra"><span itemprop="title">Linear Algebra</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item"><a href="#responsive_offcanvas">Factorizations</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#brcdwoa" class="nav-link intrnllnk">Introduction</a></li><li class="nav-item"><a href="#f4-2432" class="nav-link intrnllnk">Cholesky Factorization</a></li><li class="nav-item"><a href="#f4-2502" class="nav-link intrnllnk">LU Factorization</a></li><li class="nav-item"><a href="#f4-2568" class="nav-link intrnllnk">QR Factorization</a></li><li class="nav-item"><a href="#brs0fvv-1" class="nav-link intrnllnk">Using Multithreaded Computation for Factorization</a></li><li class="nav-item"><a href="#d126e4932" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=linear-algebra&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=linear-algebra&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=linear-algebra&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=linear-algebra&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=linear-algebra&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=linear-algebra&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-topic">
<section><h2 class="title r2025b" itemprop="title content" id="f4-2418">Factorizations</h2><a class="indexterm" name="d126e4570"></a><a class="indexterm" name="d126e4573"></a><section><h3 class="title" id="brcdwoa">Introduction</h3><p>All three of the matrix factorizations discussed in this section make use of <span class="emphasis"><em>triangular</em></span> matrices, where all the elements either above or below the diagonal are zero. Systems of linear equations involving triangular matrices are easily and quickly solved using either <span class="emphasis"><em>forward</em></span> or <span class="emphasis"><em>back substitution</em></span>.</p></section><section><h3 class="title" id="f4-2432">Cholesky Factorization</h3><a class="indexterm" name="d126e4587"></a><a class="indexterm" name="d126e4589"></a><p>The Cholesky factorization expresses a symmetric matrix as the product of a triangular matrix and its transpose</p><div itemprop="content"><p class="programlistingindent"><em class="varname">A</em> = <em class="varname">R</em>′<em class="varname">R</em>,</p></div><p>where <em class="varname">R</em> is an upper triangular matrix.</p><a class="indexterm" name="d126e4605"></a><p>Not all symmetric matrices can be factored in this way; the matrices that have such a factorization are said to be positive definite. This implies that all the diagonal elements of <em class="varname">A</em> are positive and that the off-diagonal elements are “not too big.” The Pascal matrices provide an interesting example. Throughout this chapter, the example matrix <code class="literal">A</code> has been the 3-by-3 Pascal matrix. Temporarily switch to the 6-by-6:</p><div class="code_responsive"><pre class="programlisting">A = pascal(6)

A =
       1     1     1     1     1     1
       1     2     3     4     5     6
       1     3     6    10    15    21
       1     4    10    20    35    56
       1     5    15    35    70   126
       1     6    21    56   126   252</pre></div><p>The elements of <code class="literal">A</code> are binomial coefficients. Each element is the sum of its north and west neighbors. The Cholesky factorization is</p><div class="code_responsive"><pre class="programlisting">R = chol(A)

R =
     1     1     1     1     1     1
     0     1     2     3     4     5
     0     0     1     3     6    10
     0     0     0     1     4    10
     0     0     0     0     1     5
     0     0     0     0     0     1</pre></div><p>The elements are again binomial coefficients. The fact that <code class="literal">R'*R</code> is equal to <code class="literal">A</code> demonstrates an identity involving sums of products of binomial coefficients.</p><div class="alert alert-info d-inline-block"><a class="indexterm" name="d126e4628"></a><a class="indexterm" name="d126e4630"></a><span class="alert_icon icon-alert-info-reverse"></span><p class="alert_heading"><strong>Note</strong></p><p>The Cholesky factorization also applies to complex matrices. Any complex matrix that has a Cholesky factorization satisfies <div itemprop="content"><p class="programlistingindent"><em class="varname">A′</em> = <em class="varname">A</em></p></div> and is said to be <span class="emphasis"><em>Hermitian positive definite</em></span>.</p></div><p>The Cholesky factorization allows the linear system</p><div itemprop="content"><p class="programlistingindent"><em class="varname">Ax</em> = <em class="varname">b</em></p></div><p>to be replaced by</p><div itemprop="content"><p class="programlistingindent"><em class="varname">R</em>′<em class="varname">R</em><em class="varname">x</em> = <em class="varname">b</em>.</p></div><p>Because the backslash operator recognizes triangular systems, this can be solved in the MATLAB<sup>&#x00AE;</sup> environment quickly with</p><div class="code_responsive"><pre class="programlisting">x = R\(R'\b)</pre></div><p>If <code class="literal">A</code> is <em class="varname">n</em>-by-<em class="varname">n</em>, the computational complexity of <code class="literal">chol(A)</code> is O(<em class="varname">n</em><sup>3</sup>), but the complexity of the subsequent backslash solutions is only O(<em class="varname">n</em><sup>2</sup>).</p></section><section><h3 class="title" id="f4-2502">LU Factorization</h3><a class="indexterm" name="d126e4684"></a><a class="indexterm" name="d126e4686"></a><a class="indexterm" name="d126e4688"></a><p>LU factorization, or Gaussian elimination, expresses any square matrix <em class="varname">A</em> as the product of a permutation of a lower triangular matrix and an upper triangular matrix</p><div itemprop="content"><p class="programlistingindent"><em class="varname">A</em> = <em class="varname">LU</em>,</p></div><p>where <em class="varname">L</em> is a permutation of a lower triangular matrix with ones on its diagonal and <em class="varname">U</em> is an upper triangular matrix.</p><p>The permutations are necessary for both theoretical and computational reasons. The matrix</p><div id="d126e4709" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-17px" display="block"><mrow><mrow><mo>[</mo><mrow><mtable><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable></mrow><mo>]</mo></mrow></mrow></math></p></div></div><p>cannot be expressed as the product of triangular matrices without interchanging its two rows. <a class="indexterm" name="d126e4714"></a>Although the matrix</p><div id="d126e4719" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-17px" display="block"><mrow><mrow><mo>[</mo><mrow><mtable><mtr><mtd><mi>ε</mi></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable></mrow><mo>]</mo></mrow></mrow></math></p></div></div><p>can be expressed as the product of triangular matrices, when <em class="varname">ε</em> is small, the elements in the factors are large and magnify errors, so even though the permutations are not strictly necessary, they are desirable. Partial pivoting ensures that the elements of <em class="varname">L</em> are bounded by one in magnitude and that the elements of <em class="varname">U</em> are not much larger than those of <em class="varname">A</em>.</p><p>For example:</p><div class="code_responsive"><pre class="programlisting">[L,U] = lu(B)

L =
    1.0000         0         0
    0.3750    0.5441    1.0000
    0.5000    1.0000         0

U =
    8.0000    1.0000    6.0000
         0    8.5000   -1.0000
         0         0    5.2941</pre></div><p>The LU factorization of <code class="literal">A</code> allows the linear system</p><div class="code_responsive"><pre class="programlisting">A*x = b</pre></div><p>to be solved quickly with</p><div class="code_responsive"><pre class="programlisting">x = U\(L\b)</pre></div><p>Determinants and inverses are computed from the LU factorization using</p><div class="code_responsive"><pre class="programlisting">det(A) = det(L)*det(U)</pre></div><p>and</p><div class="code_responsive"><pre class="programlisting">inv(A) = inv(U)*inv(L)</pre></div><p>You can also compute the determinants using <code class="literal">det(A) = prod(diag(U))</code>, though the signs of the determinants might be reversed.</p></section><section><h3 class="title" id="f4-2568">QR Factorization</h3><a class="indexterm" name="d126e4753"></a><a class="indexterm" name="d126e4756"></a><a class="indexterm" name="d126e4758"></a><a class="indexterm" name="d126e4760"></a><a class="indexterm" name="d126e4763"></a><a class="indexterm" name="d126e4766"></a><p>An <span class="emphasis"><em>orthogonal</em></span> matrix, or a matrix with orthonormal columns, is a real matrix whose columns all have unit length and are perpendicular to each other. If <em class="varname">Q</em> is orthogonal, then</p><div itemprop="content"><p class="programlistingindent"><em class="varname">Q</em><sup>T</sup><em class="varname">Q</em> =
                    <em class="varname">I</em>,</p></div><p>where <span class="inlineequation"><em class="varname">I</em></span> is the identity matrix.</p><p>The simplest orthogonal matrices are two-dimensional coordinate rotations:</p><div id="d126e4792" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-17px" display="block"><mrow><mrow><mo>[</mo><mrow><mtable><mtr><mtd><mrow><mi>cos</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow></mtd><mtd><mrow><mi>sin</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow></mtd></mtr><mtr><mtd><mrow><mo>−</mo><mi>sin</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow></mtd><mtd><mrow><mi>cos</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow></mtd></mtr></mtable></mrow><mo>]</mo></mrow><mo>.</mo></mrow></math></p></div></div><p>For complex matrices, the corresponding term is <span class="emphasis"><em>unitary</em></span>. Orthogonal and unitary matrices are desirable for numerical computation because they preserve length, preserve angles, and do not magnify errors.</p><p>The orthogonal, or QR, factorization expresses any rectangular matrix as the product of an orthogonal or unitary matrix and an upper triangular matrix. A column permutation might also be involved:</p><div itemprop="content"><p class="programlistingindent"><em class="varname">A</em> = <em class="varname">QR</em></p></div><p>or</p><div itemprop="content"><p class="programlistingindent"><em class="varname">AP</em> = <em class="varname">QR</em>,</p></div><p>where <em class="varname">Q</em> is orthogonal or unitary, <em class="varname">R</em> is upper triangular, and <em class="varname">P</em> is a permutation.</p><p>There are four variants of the QR factorization&#8212;full or economy size, and with or without column permutation.</p><p>Overdetermined linear systems involve a rectangular matrix with more rows than columns, that is <em class="varname">m</em>-by-<em class="varname">n</em> with <em class="varname">m</em> &gt; <em class="varname">n</em>. The full-size QR factorization produces a square, <em class="varname">m</em>-by-<em class="varname">m</em> orthogonal <em class="varname">Q</em> and a rectangular <em class="varname">m</em>-by-<em class="varname">n</em> upper triangular <em class="varname">R</em>:</p><div class="code_responsive"><pre class="programlisting">C=gallery('uniformdata',[5 4], 0);
[Q,R] = qr(C)

Q =

    0.6191    0.1406   -0.1899   -0.5058    0.5522
    0.1506    0.4084    0.5034    0.5974    0.4475
    0.3954   -0.5564    0.6869   -0.1478   -0.2008
    0.3167    0.6676    0.1351   -0.1729   -0.6370
    0.5808   -0.2410   -0.4695    0.5792   -0.2207


R =

    1.5346    1.0663    1.2010    1.4036
         0    0.7245    0.3474   -0.0126
         0         0    0.9320    0.6596
         0         0         0    0.6648
         0         0         0         0</pre></div><p>In many cases, the last <em class="varname">m &#8211; n</em> columns of <em class="varname">Q</em> are not needed because they are multiplied by the zeros in the bottom portion of <em class="varname">R</em>. So the economy-size QR factorization produces a rectangular, <em class="varname">m</em>-by-<em class="varname">n</em> <em class="varname">Q</em> with orthonormal columns and a square <em class="varname">n</em>-by-<em class="varname">n</em> upper triangular <em class="varname">R</em>. For the 5-by-4 example, this is not much of a saving, but for larger, highly rectangular matrices, the savings in both time and memory can be quite important:</p><div class="code_responsive"><pre class="programlisting">[Q,R] = qr(C,0)	
Q =

    0.6191    0.1406   -0.1899   -0.5058
    0.1506    0.4084    0.5034    0.5974
    0.3954   -0.5564    0.6869   -0.1478
    0.3167    0.6676    0.1351   -0.1729
    0.5808   -0.2410   -0.4695    0.5792


R =

    1.5346    1.0663    1.2010    1.4036
         0    0.7245    0.3474   -0.0126
         0         0    0.9320    0.6596
         0         0         0    0.6648</pre></div><a class="indexterm" name="d126e4868"></a><p>In contrast to the LU factorization, the QR factorization does not require any pivoting or permutations. But an optional column permutation, triggered by the presence of a third output argument, is useful for detecting singularity or rank deficiency. At each step of the factorization, the column of the remaining unfactored matrix with largest norm is used as the basis for that step. This ensures that the diagonal elements of <em class="varname">R</em> occur in decreasing order and that any linear dependence among the columns is almost certainly be revealed by examining these elements. For the small example given here, the second column of <code class="literal">C</code> has a larger norm than the first, so the two columns are exchanged:</p><div class="code_responsive"><pre class="programlisting">[Q,R,P] = qr(C)

Q =
   -0.3522    0.8398   -0.4131
   -0.7044   -0.5285   -0.4739
   -0.6163    0.1241    0.7777

R =
  -11.3578   -8.2762
         0    7.2460
         0         0

P =
     0     1
     1     0</pre></div><p>When the economy-size and column permutations are combined, the third output argument is a permutation vector, rather than a permutation matrix:</p><div class="code_responsive"><pre class="programlisting">[Q,R,p] = qr(C,0)

Q =
   -0.3522    0.8398
   -0.7044   -0.5285
   -0.6163    0.1241

R =
  -11.3578   -8.2762
         0    7.2460


p =
     2     1</pre></div><p>The QR factorization transforms an overdetermined linear system into an equivalent triangular system. The expression</p><div class="code_responsive"><pre class="programlisting">norm(A*x - b)</pre></div><p>equals</p><div class="code_responsive"><pre class="programlisting">norm(Q*R*x - b)</pre></div><p>Multiplication by orthogonal matrices preserves the Euclidean norm, so this expression is also equal to</p><div class="code_responsive"><pre class="programlisting">norm(R*x - y)</pre></div><p>where <code class="literal">y = Q'*b</code>. Since the last <em class="varname">m</em>-<em class="varname">n</em> rows of <em class="varname">R</em> are zero, this expression breaks into two pieces:</p><div class="code_responsive"><pre class="programlisting">norm(R(1:n,1:n)*x - y(1:n))</pre></div><p>and</p><div class="code_responsive"><pre class="programlisting">norm(y(n+1:m))</pre></div><p>When <code class="literal">A</code> has full rank, it is possible to solve for <code class="literal">x</code> so that the first of these expressions is zero. Then the second expression gives the norm of the residual. When <code class="literal">A</code> does not have full rank, the triangular structure of <code class="literal">R</code> makes it possible to find a basic solution to the least-squares problem.</p></section><section><h3 class="title" id="brs0fvv-1">Using Multithreaded Computation for Factorization</h3><p>MATLAB software supports multithreaded computation for a number of linear algebra and element-wise numerical functions. These functions automatically execute on multiple threads. For a function or expression to execute faster on multiple CPUs, a number of conditions must be true:</p><div class="orderedlist"><ol style="list-style: decimal;"><li><p>The function performs operations that easily partition into sections that execute concurrently. These sections must be able to execute with little communication between processes. They should require few sequential operations. </p></li><li><p>The data size is large enough so that any advantages of concurrent execution outweigh the time required to partition the data and manage separate execution threads. For example, most functions speed up only when the array contains several thousand elements or more.</p></li><li><p>The operation is not memory-bound; processing time is not dominated by memory access time. As a general rule, complicated functions speed up more than simple functions.</p></li></ol></div><p><a href="../ref/lu.html"><code class="function">lu</code></a> and <a href="../ref/qr.html"><code class="function">qr</code></a> show significant increase in speed on large double-precision arrays (on order of 10,000 elements).</p></section>
        <h2 id="d126e4932">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/lu.html"><span itemprop="name"><code class="function">lu</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/qr.html"><span itemprop="name"><code class="function">qr</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/chol.html"><span itemprop="name"><code class="function">chol</code></span></a></span></p>
        
        <h3 id="d126e4946">Topics</h3><ul class="list-unstyled"><li><a href="matrices-in-the-matlab-environment.html" class="a">Matrices in the MATLAB Environment</a></li></ul>
        
    </section>
    </div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

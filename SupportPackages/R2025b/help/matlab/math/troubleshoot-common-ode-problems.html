<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Troubleshoot Common ODE Problems</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../numerical-integration-and-differential-equations.html",
          "name": "Numerical Integration and Differential Equations"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../ordinary-differential-equations.html",
          "name": "Ordinary Differential Equations"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "ordinary-differential-equations"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="ug">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ex">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="FAQ containing common problems and solutions."><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../numerical-integration-and-differential-equations.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Numerical Integration and Differential Equations</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../ordinary-differential-equations.html?s_tid=CRUX_lftnav" itemprop="url" id="ordinary-differential-equations"><span itemprop="title">Ordinary Differential Equations</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item"><a href="#responsive_offcanvas">Troubleshoot Common ODE Problems</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#bu8pzr7" class="nav-link intrnllnk">Error Tolerances</a></li><li class="nav-item"><a href="#bu8pzsf" class="nav-link intrnllnk">Problem Scale</a></li><li class="nav-item"><a href="#bu8pzsj" class="nav-link intrnllnk">Solution Components</a></li><li class="nav-item"><a href="#bu8pz5r" class="nav-link intrnllnk">Problem Type</a></li><li class="nav-item"><a href="#d126e32493" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-topic">
<section><h2 class="title r2025b" itemprop="title content" id="bu7wqih">Troubleshoot Common ODE Problems</h2><p>This topic describes common issues you might encounter when solving ODEs with solver
            functions (<code class="function">ode45</code>, <code class="function">ode15s</code>, and so on).</p><section><h3 class="title" id="bu8pzr7">Error Tolerances</h3><div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="50%"><col class="tcol2" width="50%"></colgroup><thead><tr><th>Question or Problem</th><th>Answer</th></tr></thead><tbody><tr><td><p>How do I choose the error thresholds <code class="literal">RelTol</code> and <code class="literal">AbsTol</code>?</p></td><td><p><code class="literal">RelTol</code>, the relative accuracy tolerance,
controls the number of correct digits in the computed answer. <code class="literal">AbsTol</code>,
the absolute error tolerance, controls the difference between the
computed answer and the true solution. At each step, the error <code class="literal">e</code> in
component <code class="literal">i</code> of the solution satisfies</p><p id="bu8pzsa-1"><code class="literal">|e(i)| ≤ max(RelTol*abs(y(i)),AbsTol(i))</code></p><p>Roughly
speaking, this means that you want <code class="literal">RelTol</code> correct
digits in all solution components, excluding those smaller than the
threshold <code class="literal">AbsTol(i)</code>. Even if you are not interested
in a component <code class="literal">y(i)</code> when it is small, you might
have to specify a value for <code class="literal">AbsTol(i)</code> that is small
enough to get some correct digits in <code class="literal">y(i)</code> so that
you can accurately compute more interesting components.</p></td></tr><tr><td><p>I want answers that are correct to the precision of the
computer. Why can I not simply set <code class="literal">RelTol</code> to <code class="literal">eps</code>?</p></td><td><p>You can get close to machine precision, but not that
close. The solvers do not allow <code class="literal">RelTol</code> near <code class="literal">eps</code> because
they try to approximate a continuous function. At tolerances comparable
to <code class="literal">eps</code>, the machine arithmetic causes all functions
to look discontinuous.</p></td></tr><tr><td><p>How do I tell the solver that I do not care about getting
an accurate answer for one of the solution components?</p></td><td><p>You can increase the absolute error tolerance <code class="literal">AbsTol</code> for
this solution component. If the tolerance is bigger than the solution
component, this specifies that no digits in the component need to
be correct. The solver might have to get some correct digits in this
component to compute other components accurately, but it generally
handles this automatically.</p></td></tr></tbody></table></div></section><section><h3 class="title" id="bu8pzsf">Problem Scale</h3><div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="50%"><col class="tcol2" width="50%"></colgroup><thead><tr><th>Question or Problem</th><th>Answer</th></tr></thead><tbody><tr><td><p>How large a problem can I solve with the ODE suite?</p></td><td><p>The primary constraints are memory and time. At each
time step, the solvers for nonstiff problems allocate vectors of length <code class="literal">n</code>,
where <code class="literal">n</code> is the number of equations in the system.
The solvers for stiff problems allocate vectors of length <code class="literal">n</code> but
also allocate an <code class="literal">n</code>-by-<code class="literal">n</code> Jacobian
matrix. For these solvers, it might be advantageous to specify the
Jacobian sparsity pattern using the <code class="literal">JPattern</code> option
of <code class="function">odeset</code>.</p><p>If the problem is nonstiff,
or if you are using the <code class="literal">JPattern</code> option, it might
be possible to solve a problem with thousands of unknowns. In this
case, however, storage of the result can be problematic. Ask the solver
to evaluate the solution at specific points only, or call the solver
with no output arguments and use an output function to monitor the
solution.</p></td></tr><tr><td><p>I am solving a very large system, but only care about
a few of the components of <code class="literal">y</code>. Is there any way
to avoid storing all of the elements?</p></td><td><p>Yes. The <code class="literal">OutputFcn</code> option is designed
specifically for this purpose. When you call the solver with no output
arguments, the solver does not allocate storage to hold the entire
solution history. Instead, the solver calls <code class="literal">OutputFcn(t,y,flag)</code> at
each time step. To keep the history of specific elements, write an
output function that stores or plots only the elements you care about.</p></td></tr><tr><td><p>What is the startup cost of the integration and how can
I reduce it?</p></td><td><p>The biggest startup cost occurs as the solver attempts
to find a step size appropriate to the scale of the problem. If you
happen to know an appropriate step size, use the <code class="literal">InitialStep</code> option.
For example, if you repeatedly call the integrator in an event location
loop, the last step that was taken before the event is probably scaled
correctly for the next integration. Type <code class="literal">edit ballode</code> to
see an example.</p></td></tr><tr><td><p>The first step size that the integrator takes is too
large, and it misses important behavior.</p></td><td><p>You can specify the first step size with the <code class="literal">InitialStep</code> option.
The integrator tries this step size, then reduces it if necessary.</p></td></tr></tbody></table></div></section><section><h3 class="title" id="bu8pzsj">Solution Components</h3><div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="50%"><col class="tcol2" width="50%"></colgroup><thead><tr><th>Question or Problem</th><th>Answer</th></tr></thead><tbody><tr><td><p>The solution does not look like what I expected.</p></td><td><p>If your expectations are correct, then reduce the error
tolerances from their default values. A smaller relative error tolerance
is needed to accurately solve problems integrated over “long”
intervals, as well as problems that are moderately unstable.</p><p>Check
whether there are solution components that stay smaller than their
absolute error tolerance for some time. If so, you are not requiring
any correct digits in these components. This might be acceptable for
these components, but failing to compute them accurately might degrade
the accuracy of other components that depend on them.</p></td></tr><tr><td><p>My plots are not smooth enough.</p></td><td><p>Increase the value of <a href="../ref/odeset.html#bu2m9z6-Refine"><code class="argument">Refine</code></a>
                                    from its default value of <code class="literal">4</code> in <a href="../ref/ode45.html"><code class="function">ode45</code></a>,
                                        <code class="literal">8</code> in <a href="../ref/ode78.html"><code class="function">ode78</code></a> and <a href="../ref/ode89.html"><code class="function">ode89</code></a>, and <code class="literal">1</code> in the other
                                    solvers. The larger the value of <code class="literal">Refine</code>, the
                                    more output points the solver generates. Execution speed is not
                                    affected much by increasing the value of
                                        <code class="literal">Refine</code> from its default
                                value.</p></td></tr><tr><td><p>I am plotting the solution as it is computed and it looks
fine, but the code gets stuck at some point.</p></td><td><p>First verify that the ODE function is smooth near the
point where the code gets stuck. If it is not, then the solver must
take small steps to deal with this. It might help to break the integration
interval into pieces over which the ODE function is smooth.</p><p>If
the function is smooth and the code is taking extremely small steps,
you are probably trying to solve a stiff problem with a solver not
intended for that purpose. Switch to using one of the stiff solvers <a href="../ref/ode15s.html"><code class="function">ode15s</code></a>, <a href="../ref/ode23s.html"><code class="function">ode23s</code></a>, <a href="../ref/ode23t.html"><code class="function">ode23t</code></a>, or <a href="../ref/ode23tb.html"><code class="function">ode23tb</code></a>.</p></td></tr><tr><td><p>What if I have the final and not the initial value?</p></td><td><p>All the solvers of the ODE suite allow you to solve backward
or forward in time. The syntax for the solvers is <code class="literal">[t,y] =
ode45(odefun,[t0 tf],y0);</code> and the syntax accepts <code class="literal">t0
&gt; tf</code>.</p></td></tr><tr><td><p>My integration proceeds very slowly, using too many time
steps.</p></td><td><p>First, check that <code class="literal">tspan</code> is not too long. Remember that the solver
                                    uses as many time points as necessary to produce a smooth
                                    solution. If the ODE function changes on a time scale that is
                                    very short compared to <code class="literal">tspan</code>, then the solver
                                    uses a lot of time steps. Long-time integration is a hard
                                    problem. Break <code class="literal">tspan</code> into smaller
                                    pieces.</p><p>If the ODE function does not change
                                    noticeably on the <code class="literal">tspan</code> interval, it could be
                                    that your problem is stiff. Try using one of the stiff solvers
                                        <a href="../ref/ode15s.html"><code class="function">ode15s</code></a>, <a href="../ref/ode23s.html"><code class="function">ode23s</code></a>, <a href="../ref/ode23t.html"><code class="function">ode23t</code></a>, or
                                        <a href="../ref/ode23tb.html"><code class="function">ode23tb</code></a>.</p><p>Finally, make sure that the ODE
                                    function is written in an efficient way. The solvers evaluate
                                    the derivatives in the ODE function many times. The cost of
                                    numerical integration depends critically on the expense of
                                    evaluating the ODE function. Rather than recomputing complicated
                                    constant parameters at each evaluation, store them in global
                                    variables, or calculate them once and pass them to nested
                                    functions.</p></td></tr><tr><td><p>I know that the solution undergoes a radical change at
time <code class="literal">t</code>, where <code class="literal">t0 &lt;= t &lt;= tf </code>,
but the integrator steps past without “seeing” it.</p></td><td><p>If you know that there is a sharp change at time <code class="literal">t</code>,
try breaking the <code class="literal">tspan</code> interval into two pieces, <code class="literal">[t0
t]</code> and <code class="literal">[t tf]</code>, and call the integrator
twice or continue the integration using <code class="function">odextend</code>.</p><p>If
the differential equation has periodic coefficients or solutions,
ensure the solver does not step over periods by restricting the maximum
step size to the length of the period.</p></td></tr></tbody></table></div></section><section><h3 class="title" id="bu8pz5r">Problem Type</h3><div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="50%"><col class="tcol2" width="50%"></colgroup><tbody><tr><td><p>Can the solvers handle partial differential equations
(PDEs) that have been discretized by the method of lines?</p></td><td><p>Yes, because the discretization produces a system of
ODEs. Depending on the discretization, you might have a form involving
mass matrices, which the ODE solvers provide for. Often the system
is stiff. This is to be expected if the PDE is parabolic, or when
there are phenomena that happen on very different time scales such
as a chemical reaction in a fluid flow. In such cases, use one of
the four stiff solvers <code class="literal">ode15s</code>, <code class="literal">ode23s</code>, <code class="literal">ode23t</code>,
or <code class="literal">ode23tb</code>.</p><p>If there are many equations,
use the <code class="literal">JPattern</code> option to specify the Jacobian
sparsity pattern. This can make the difference between success and
failure as it prevents the computation from being too expensive. Type <code class="literal">edit
burgersode</code> to see an example that uses <code class="literal">JPattern</code>.</p><p>If
the system is not stiff, or not very stiff, then <a href="../ref/ode23.html"><code class="function">ode23</code></a> and <a href="../ref/ode45.html"><code class="function">ode45</code></a> are
more efficient than the stiff solvers <a href="../ref/ode15s.html"><code class="function">ode15s</code></a>, <a href="../ref/ode23s.html"><code class="function">ode23s</code></a>, <a href="../ref/ode23t.html"><code class="function">ode23t</code></a>,
and <a href="../ref/ode23tb.html"><code class="function">ode23tb</code></a>.</p><p>You
can solve parabolic-elliptic partial differential equations in 1-D
directly with the MATLAB<sup>&#x00AE;</sup> PDE solver <a href="../ref/pdepe.html"><code class="function">pdepe</code></a>.</p></td></tr><tr><td><p>Can I integrate a set of sampled data?</p></td><td><p>Not directly. Instead, represent the data as a function
by interpolation or some other scheme for fitting data. The smoothness
of this function is critical. A piecewise polynomial fit such as a
spline can look smooth to the eye, but rough to a solver; the solver
takes small steps where the derivatives of the fit have jumps. Either
use a smooth function to represent the data or use one of the lower-order
solvers (<a href="../ref/ode23.html"><code class="function">ode23</code></a>, <a href="../ref/ode23s.html"><code class="function">ode23s</code></a>, <a href="../ref/ode23t.html"><code class="function">ode23t</code></a>, <a href="../ref/ode23tb.html"><code class="function">ode23tb</code></a>) that is less sensitive to smoothness.
See <a href="../ref/ode45.html#bu3l43b" class="a">ODE with Time-Dependent Terms</a> for an example.</p></td></tr></tbody></table></div></section>
<h2 id="d126e32493">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/odeset.html"><span itemprop="name"><code class="function">odeset</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/odeget.html"><span itemprop="name"><code class="function">odeget</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/deval.html"><span itemprop="name"><code class="function">deval</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/odextend.html"><span itemprop="name"><code class="function">odextend</code></span></a></span></p>

<h3 id="d126e32506">Topics</h3><ul class="list-unstyled"><li><a href="choose-an-ode-solver.html" class="a">Choose an ODE Solver</a></li><li><a href="summary-of-ode-options.html" class="a">Summary of ODE Options</a></li><li><a href="ode-event-location.html" class="a">ODE Event Location</a></li><li><a href="nonnegative-ode-solution.html" class="a">Nonnegative ODE Solution</a></li></ul>

</section>
    </div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

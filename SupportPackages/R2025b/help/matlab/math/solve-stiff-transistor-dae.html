<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Solve Stiff Transistor Differential Algebraic Equation</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../numerical-integration-and-differential-equations.html",
          "name": "Numerical Integration and Differential Equations"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../ordinary-differential-equations.html",
          "name": "Ordinary Differential Equations"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "ordinary-differential-equations"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Solve Stiff Transistor Differential Algebraic Equation",
          "description": "Solve a stiff differential algebraic equation (DAE) that describes an electrical circuit [1]. The one-transistor amplifier problem coded in the example file amp1dae.m can be rewritten in semi-explicit form, but this example solves it in its original form Mu′=ϕ(u). The problem includes a constant, singular mass matrix M.",
          "thumbnailURL": "../../examples/matlab/win64/SolveStiffDAEExample_02.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "identifier": "matlab.SolveStiffDAEExample",
          "name": "SolveStiffDAEExample",
          "url": "solve-stiff-transistor-dae.html"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('matlab/SolveStiffDAEExample')"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "SolveStiffDAEExample.mlx",
        "transistor_amplifier.png"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="ug">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="other">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This example shows how to solve a stiff differential algebraic equation (DAE) that describes an electrical circuit [1]."><meta xmlns="http://www.w3.org/1999/xhtml" content="../../examples/matlab/win64/SolveStiffDAEExample_02.png" itemprop="thumbnailUrl">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../numerical-integration-and-differential-equations.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Numerical Integration and Differential Equations</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../ordinary-differential-equations.html?s_tid=CRUX_lftnav" itemprop="url" id="ordinary-differential-equations"><span itemprop="title">Ordinary Differential Equations</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item"><a href="#responsive_offcanvas">Solve Stiff Transistor Differential Algebraic Equation</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#SolveStiffDAEExample-1" class="nav-link intrnllnk">Code Mass Matrix</a></li><li class="nav-item"><a href="#SolveStiffDAEExample-2" class="nav-link intrnllnk">Code Equations</a></li><li class="nav-item"><a href="#SolveStiffDAEExample-3" class="nav-link intrnllnk">Code Initial Conditions</a></li><li class="nav-item"><a href="#SolveStiffDAEExample-4" class="nav-link intrnllnk">Solve System of Equations</a></li><li class="nav-item"><a href="#SolveStiffDAEExample-5" class="nav-link intrnllnk">Plot Results</a></li><li class="nav-item"><a href="#SolveStiffDAEExample-6" class="nav-link intrnllnk">References</a></li><li class="nav-item"><a href="#d126e38526" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=ordinary-differential-equations&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-topic">
<section><h1 class="r2025b" itemprop="title content" id="mw_eca9c41d-ac5a-4c6c-a13f-c0bab9b3120a">Solve Stiff Transistor Differential Algebraic Equation</h1><div class="examples_short_list hidden_ios_android" data-products="ML"><div data-pane="metadata" class="card metadata_container"><div class="card-body metadata_content"><div class="d-grid"><a class="btn btn_color_blue" href="matlab:openExample('matlab/SolveStiffDAEExample')" data-ex-genre="Live Script">Open Live Script</a></div></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="matlab-SolveStiffDAEExample"><meta itemprop="exampletitle" content="Solve Stiff Transistor Differential Algebraic Equation"></div><span id="SolveStiffDAEExample" class="anchor_target"></span><p class="shortdesc">This example shows how to solve a stiff differential algebraic equation (DAE) that describes an electrical circuit <a href="solve-stiff-transistor-dae.html#mw_rtc_SolveStiffDAEExample_M_9D991C9F" class="intrnllnk">[1]</a>. The one-transistor amplifier problem coded in the example file <a href="matlab:edit('amp1dae.m')" target="_blank">amp1dae.m</a> can be rewritten in semi-explicit form, but this example solves it in its original form <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>M</mi><msup><mrow><mi>u</mi></mrow><mrow><mo>′</mo></mrow></msup><mo>=</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow></math></span>. The problem includes a constant, singular mass matrix <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">M</mi></mrow></math></span>. </p><p>The transistor amplifier circuit contains six resistors, three capacitors, and a transistor.</p><div class="informalfigure"><div id="d126e37613" class="mediaobject"><p><img src="../../examples/matlab/win64/SolveStiffDAEExample_01.png" height="334" width="498"></p></div></div><div class="itemizedlist"><ul><li><p>The initial voltage signal is <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msub><mrow><mi>U</mi></mrow><mrow><mi>e</mi></mrow></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn><mo stretchy="false">.</mo><mn>4</mn><mi mathvariant="normal">sin</mi><mrow><mo>(</mo><mn>2</mn><mn>0</mn><mn>0</mn><mi>π</mi><mi>t</mi><mo>)</mo></mrow></mrow></math></span>.</p></li><li><p>The operating voltage is <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">U</mi></mrow><mrow><mi mathvariant="italic">b</mi></mrow></msub><mo>=</mo><mn>6</mn></mrow></math></span>.</p></li><li><p>The voltages at the nodes are given by <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">U</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow><mtext>  </mtext><mrow><mo>(</mo><mrow><mi mathvariant="italic">i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>5</mn></mrow><mo>)</mo></mrow></mrow></math></span>.</p></li><li><p>The values of the resistors <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">R</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub><mtext>  </mtext><mrow><mo>(</mo><mrow><mi mathvariant="italic">i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>5</mn><mo>,</mo><mn>6</mn></mrow><mo>)</mo></mrow></mrow></math></span> are constant, and the current through each resistor satisfies <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">I</mi><mo>=</mo><mi mathvariant="italic">U</mi><mo>/</mo><mi mathvariant="italic">R</mi></mrow></math></span>.</p></li><li><p>The values of the capacitors <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">C</mi></mrow><mrow><mi mathvariant="italic">i</mi></mrow></msub><mtext>  </mtext><mrow><mo>(</mo><mrow><mi mathvariant="italic">i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn></mrow><mo>)</mo></mrow></mrow></math></span> are constant, and the current through each capacitor satisfies <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><mi mathvariant="italic">I</mi><mo>=</mo><mi mathvariant="italic">C</mi><mo>⋅</mo><mi mathvariant="normal">dU</mi><mo>/</mo><mi mathvariant="normal">dt</mi></mrow></math></span>.</p></li></ul></div><p>The goal is to solve for the output voltage through node 5, <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">U</mi></mrow><mrow><mn>5</mn></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow></mrow></math></span>.</p><p>To solve this equation in MATLAB&#174;, you can use an <code class="literal">ode</code> object and set properties of the object to define the equations, mass matrix, and initial conditions. Then, use the <code class="literal">solve</code> method to simulate the system over time. You can either include the required functions as functions within a script (as done here), or save them as separate, named files in a directory on the MATLAB path.</p><div class="procedure"><h3 class="title" id="SolveStiffDAEExample-1">Code Mass Matrix</h3><p>Using Kirchoff's law to equalize the current through each node (1 through 5), you can obtain a system of five equations describing the circuit:</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mtable columnalign="left"><mtr><mtd><mrow><mi mathvariant="normal">node</mi><mtext> </mtext><mn>1</mn><mo>:</mo><mtext>  </mtext><mfrac><mrow><msub><mrow><mi mathvariant="italic">U</mi></mrow><mrow><mi mathvariant="italic">e</mi></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="italic">t</mi></mrow><mo>)</mo></mrow></mrow><mrow><msub><mrow><mi mathvariant="italic">R</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></mfrac><mo>-</mo><mfrac><mrow><msub><mrow><mi mathvariant="italic">U</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mrow><msub><mrow><mi mathvariant="italic">R</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></mfrac><mo>+</mo><msub><mrow><mi mathvariant="italic">C</mi></mrow><mrow><mn>1</mn></mrow></msub><mrow><mo>(</mo><mrow><msup><mrow><msub><mrow><mi mathvariant="italic">U</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow><mrow><mo>′</mo></mrow></msup><mo>-</mo><msup><mrow><msub><mrow><mi mathvariant="italic">U</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mrow><mo>′</mo></mrow></msup></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn><mo>,</mo></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">node</mi><mtext> </mtext><mn>2</mn><mo>:</mo><mtext>  </mtext><mfrac><mrow><msub><mrow><mi mathvariant="italic">U</mi></mrow><mrow><mi mathvariant="italic">b</mi></mrow></msub></mrow><mrow><msub><mrow><mi mathvariant="italic">R</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mfrac><mo>-</mo><msub><mrow><mi mathvariant="italic">U</mi></mrow><mrow><mn>2</mn></mrow></msub><mrow><mo>(</mo><mrow><mfrac><mrow><mn>1</mn></mrow><mrow><msub><mrow><mi mathvariant="italic">R</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><mn>1</mn></mrow><mrow><msub><mrow><mi mathvariant="italic">R</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mfrac></mrow><mo>)</mo></mrow><mo>+</mo><msub><mrow><mi mathvariant="italic">C</mi></mrow><mrow><mn>1</mn></mrow></msub><mrow><mo>(</mo><mrow><msup><mrow><msub><mrow><mi mathvariant="italic">U</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mrow><mo>′</mo></mrow></msup><mo>-</mo><msup><mrow><msub><mrow><mi mathvariant="italic">U</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow><mrow><mo>′</mo></mrow></msup></mrow><mo>)</mo></mrow><mo>-</mo><mn>0</mn><mo>.</mo><mn>01</mn><mi mathvariant="italic">f</mi><mrow><mo>(</mo><mrow><msub><mrow><mi mathvariant="italic">U</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>-</mo><msub><mrow><mi mathvariant="italic">U</mi></mrow><mrow><mn>3</mn></mrow></msub></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn><mo>,</mo></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">node</mi><mtext> </mtext><mn>3</mn><mo>:</mo><mtext> </mtext><mtext> </mtext><mi mathvariant="italic">f</mi><mrow><mo>(</mo><mrow><msub><mrow><mi mathvariant="italic">U</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>-</mo><msub><mrow><mi mathvariant="italic">U</mi></mrow><mrow><mn>3</mn></mrow></msub></mrow><mo>)</mo></mrow><mo>-</mo><mfrac><mrow><msub><mrow><mi mathvariant="italic">U</mi></mrow><mrow><mn>3</mn></mrow></msub></mrow><mrow><msub><mrow><mi mathvariant="italic">R</mi></mrow><mrow><mn>3</mn></mrow></msub></mrow></mfrac><mo>-</mo><msub><mrow><mi mathvariant="italic">C</mi></mrow><mrow><mn>2</mn></mrow></msub><msup><mrow><msub><mrow><mi mathvariant="italic">U</mi></mrow><mrow><mn>3</mn></mrow></msub></mrow><mrow><mo>′</mo></mrow></msup><mo>=</mo><mn>0</mn><mo>,</mo></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">node</mi><mtext> </mtext><mn>4</mn><mo>:</mo><mtext>  </mtext><mfrac><mrow><msub><mrow><mi mathvariant="italic">U</mi></mrow><mrow><mi mathvariant="italic">b</mi></mrow></msub></mrow><mrow><msub><mrow><mi mathvariant="italic">R</mi></mrow><mrow><mn>4</mn></mrow></msub></mrow></mfrac><mo>-</mo><mfrac><mrow><msub><mrow><mi mathvariant="italic">U</mi></mrow><mrow><mn>4</mn></mrow></msub></mrow><mrow><msub><mrow><mi mathvariant="italic">R</mi></mrow><mrow><mn>4</mn></mrow></msub></mrow></mfrac><mo>+</mo><msub><mrow><mi mathvariant="italic">C</mi></mrow><mrow><mn>3</mn></mrow></msub><mrow><mo>(</mo><mrow><msup><mrow><msub><mrow><mi mathvariant="italic">U</mi></mrow><mrow><mn>5</mn></mrow></msub></mrow><mrow><mo>′</mo></mrow></msup><mo>-</mo><msup><mrow><msub><mrow><mi mathvariant="italic">U</mi></mrow><mrow><mn>4</mn></mrow></msub></mrow><mrow><mo>′</mo></mrow></msup></mrow><mo>)</mo></mrow><mo>-</mo><mn>0</mn><mo>.</mo><mn>99</mn><mi mathvariant="italic">f</mi><mrow><mo>(</mo><mrow><msub><mrow><mi mathvariant="italic">U</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>-</mo><msub><mrow><mi mathvariant="italic">U</mi></mrow><mrow><mn>3</mn></mrow></msub></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn><mo>,</mo></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">node</mi><mtext> </mtext><mn>5</mn><mo>:</mo><mtext> </mtext><mtext> </mtext><mo>-</mo><mfrac><mrow><msub><mrow><mi mathvariant="italic">U</mi></mrow><mrow><mn>5</mn></mrow></msub></mrow><mrow><msub><mrow><mi mathvariant="italic">R</mi></mrow><mrow><mn>5</mn></mrow></msub></mrow></mfrac><mo>+</mo><msub><mrow><mi mathvariant="italic">C</mi></mrow><mrow><mn>3</mn></mrow></msub><mrow><mo>(</mo><mrow><msup><mrow><msub><mrow><mi mathvariant="italic">U</mi></mrow><mrow><mn>4</mn></mrow></msub></mrow><mrow><mo>′</mo></mrow></msup><mo>-</mo><msup><mrow><msub><mrow><mi mathvariant="italic">U</mi></mrow><mrow><mn>5</mn></mrow></msub></mrow><mrow><mo>′</mo></mrow></msup></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn><mo>.</mo></mrow></mtd></mtr></mtable></mrow></math></p></div><p></p><p>The mass matrix of this system, found by collecting the derivative terms on the left side of the equations, has the form</p><p></p>
<div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>M</mi><mo>=</mo><mrow><mo>(</mo><mtable columnalign="center center center center center"><mtr><mtd><mrow><mo>-</mo><msub><mrow><mi>c</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></mtd><mtd><mrow><msub><mrow><mi>c</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></mtd><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi>c</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></mtd><mtd><mrow><mo>-</mo><msub><mrow><mi>c</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></mtd><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mo>-</mo><msub><mrow><mi>c</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></mtd><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mo>-</mo><msub><mrow><mi>c</mi></mrow><mrow><mn>3</mn></mrow></msub></mrow></mtd><mtd><mrow><msub><mrow><mi>c</mi></mrow><mrow><mn>3</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><msub><mrow><mi>c</mi></mrow><mrow><mn>3</mn></mrow></msub></mrow></mtd><mtd><mrow><mo>-</mo><msub><mrow><mi>c</mi></mrow><mrow><mn>3</mn></mrow></msub></mrow></mtd></mtr></mtable><mo>)</mo></mrow><mo>,</mo></mrow></math></p></div><p></p><p>where <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msub><mrow><mi>c</mi></mrow><mrow><mi>k</mi></mrow></msub><mo>=</mo><mi>k</mi><mo>×</mo><mn>1</mn><msup><mrow><mn>0</mn></mrow><mrow><mo>-</mo><mn>6</mn></mrow></msup></mrow></math></span> for <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn></mrow></math></span>.</p><p>Create a mass matrix with the appropriate constants <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="inline"><mrow><msub><mrow><mi mathvariant="italic">c</mi></mrow><mrow><mi mathvariant="italic">k</mi></mrow></msub></mrow></math></span>, and then create an <code class="literal">odeMassMatrix</code> object to store the mass matrix. Even though it is apparent that the mass matrix is singular, leave the <code class="literal">Singular</code> property at its default value of <code class="literal">"maybe"</code> to test the automatic detection of a DAE problem by the solver.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>c = 1e-6 * (1:3);
M = zeros(5,5);
M(1,1) = -c(1);
M(1,2) =  c(1);
M(2,1) =  c(1);
M(2,2) = -c(1);
M(3,3) = -c(2);
M(4,4) = -c(3);
M(4,5) =  c(3);
M(5,4) =  c(3);
M(5,5) = -c(3);
Mass = odeMassMatrix(MassMatrix=M);</pre></div></div></div><h3 class="title" id="SolveStiffDAEExample-2">Code Equations</h3><p>The function <code class="literal">transampdae</code> contains the system of equations for this example. The function defines values for all of the voltages and constant parameters. The derivatives gathered on the left side of the equations are coded in the mass matrix, and <code class="literal">transampdae</code> codes the right side of the equations.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> dudt = transampdae(t,u)
<span style="color:#228B22">% Define voltages and parameters</span>
Ue = @(t) 0.4*sinpi(200*t);
Ub = 6;
R0 = 1000;
R15 = 9000;
alpha = 0.99;
beta = 1e-6;
Uf = 0.026;

<span style="color:#228B22">% Define system of equations</span>
f23 = beta*(exp((u(2) - u(3))/Uf) - 1);
dudt = [ -(Ue(t) - u(1))/R0
    -(Ub/R15 - u(2)*2/R15 - (1-alpha)*f23)
    -(f23 - u(3)/R15)
    -((Ub - u(4))/R15 - alpha*f23)
    (u(5)/R15) ];
<span style="color:#0000FF">end</span></pre></div></div></div><h3 class="title" id="SolveStiffDAEExample-3">Code Initial Conditions</h3><p>Set the initial conditions. This example uses the consistent initial conditions for the current through each node computed in [1].</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>Ub = 6;
u0(1) = 0;
u0(2) = Ub/2;
u0(3) = Ub/2;
u0(4) = Ub;
u0(5) = 0;</pre></div></div></div><h3 class="title" id="SolveStiffDAEExample-4">Solve System of Equations</h3><p>Create an <code class="literal">ode</code> object to describe the problem, setting the values of the <code class="literal">ODEFcn</code>, <code class="literal">MassMatrix</code>, and <code class="literal">InitialValue</code> properties. Also, select the <code class="literal">ode23t</code> solver to solve the problem.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>F = ode(ODEFcn=@transampdae,MassMatrix=Mass,InitialValue=u0,Solver=<span style="color:#A020F0">"ode23t"</span>)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>F = 
  ode with properties:

   Problem definition
               ODEFcn: @transampdae
          InitialTime: 0
         InitialValue: [0 3 3 6 0]
             Jacobian: []
           MassMatrix: [1×1 odeMassMatrix]
         EquationType: standard

   Solver properties
    AbsoluteTolerance: 1.0000e-06
    RelativeTolerance: 1.0000e-03
               Solver: ode23t

  Show all properties


</pre></div></div></div><p>Solve the DAE system over the time interval <code class="literal">[0 0.05]</code> using the <code class="literal">solve</code> method. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>S = solve(F,0,0.05);
t = S.Time;
u = S.Solution;</pre></div></div></div><h3 class="title" id="SolveStiffDAEExample-5">Plot Results</h3><p>Plot the initial voltage <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msub><mrow><mi>U</mi></mrow><mrow><mi>e</mi></mrow></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></math></span> and output voltage through node 5, <span class="inlineequation"><math xmlns="http://www.w3.org/1998/Math/MathML" xmlns:mwmmlx="https://www.mathworks.com/namespace/MathMLextensions" mwmmlx:extension="true" display="block"><mrow><msub><mrow><mi>U</mi></mrow><mrow><mn>5</mn></mrow></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></math></span>.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>Ue = @(t) 0.4*sinpi(200*t);
plot(t,Ue(t),<span style="color:#A020F0">"o"</span>,t,u(5,:),<span style="color:#A020F0">"."</span>)
axis([0 0.05 -3 2]);
legend(<span style="color:#A020F0">"Input Voltage U_e(t)"</span>,<span style="color:#A020F0">"Output Voltage U_5(t)"</span>,Location=<span style="color:#A020F0">"NorthWest"</span>);
title(<span style="color:#A020F0">"One Transistor Amplifier DAE Problem Solved by ODE23T"</span>);
xlabel(<span style="color:#A020F0">"t"</span>);</pre></div></div></div><div class="informalfigure"><div id="d126e38512" class="mediaobject"><p><img src="../../examples/matlab/win64/SolveStiffDAEExample_02.png" alt="Figure contains an axes object. The axes object with title One Transistor Amplifier DAE Problem Solved by ODE23T, xlabel t contains 2 objects of type line. One or more of the lines displays its values using only markers These objects represent Input Voltage U_e(t), Output Voltage U_5(t)." width="560"></p></div></div><h3 class="title" id="SolveStiffDAEExample-6">References</h3><span id="mw_rtc_SolveStiffDAEExample_M_9D991C9F" class="anchor_target"></span><p>[1] Hairer, E., and Gerhard Wanner. <span class="emphasis"><em>Solving Ordinary Differential Equations II: Stiff and Differential-Algebraic Problems</em></span>. Springer Berlin Heidelberg, 1991, p. 377.</p></div>
            <h2 id="d126e38526">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/ode23t.html"><span itemprop="name"><code class="function">ode23t</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/ode15s.html"><span itemprop="name"><code class="function">ode15s</code></span></a></span></p>
            <h3 id="d126e38535">Topics</h3><ul class="list-unstyled"><li><a href="choose-an-ode-solver.html" class="a">Choose an ODE Solver</a></li><li><a href="summary-of-ode-options.html" class="a">Summary of ODE Options</a></li><li><a href="solve-differential-algebraic-equations-daes.html" class="a">Solve Differential Algebraic Equations (DAEs)</a></li><li><a href="solve-ode-with-strongly-state-dependent-mass-matrix.html" class="a">Solve ODE with Strongly State-Dependent Mass Matrix</a></li></ul>
            
        </section>
    </div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>

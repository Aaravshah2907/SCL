<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Solving Boundary Value Problems</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "MATLAB"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../mathematics.html",
          "name": "Mathematics"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../numerical-integration-and-differential-equations.html",
          "name": "Numerical Integration and Differential Equations"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../boundary-value-problems.html",
          "name": "Boundary Value Problems"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "boundary-value-problems"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="ug">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="ex">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="Background information, solver capabilities and algorithms, and example summary."><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-3.6.0.min.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-migrate.min.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/shared/highlight/styles/mwdochighlight.min.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/matlab_dialog_shared.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/highlight/highlight.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/localstorage.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset/docset.xml";
            product_help_location = "matlab";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.bundle.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2025b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="visually-hidden form-label">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search float-end icon_32 d-sm-none" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="d-sm-none" id="search_actuator"><button class="btn icon-search btn_search float-end icon_16" data-bs-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-bs-toggle="offcanvas" data-bs-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="visually-hidden">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav" id="index">MATLAB</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../mathematics.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Mathematics</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../numerical-integration-and-differential-equations.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Numerical Integration and Differential Equations</span></a></li><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../boundary-value-problems.html?s_tid=CRUX_lftnav" itemprop="url" id="boundary-value-problems"><span itemprop="title">Boundary Value Problems</span></a></li></ul><div class="search_refine_v4"><div id="facets_area"><ul class="nav_scrollspy nav list-unstyled" id="pnav">
<li class="nav_scrollspy_function nav-item"><a href="#responsive_offcanvas">Solving Boundary Value Problems</a></li>
<li class="nav_scrollspy_title nav-item" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li class="nav-item"><a href="#mw_21222c6f-dff3-4ba2-8711-61ce70a6fb3e" class="nav-link intrnllnk">Boundary Conditions</a></li><li class="nav-item"><a href="#f1-694073" class="nav-link intrnllnk">Initial Guess of Solution</a></li><li class="nav-item"><a href="#mw_708d0907-70e4-4132-af20-5b75f359ff37" class="nav-link intrnllnk">Finding Unknown Parameters</a></li><li class="nav-item"><a href="#brfhd0w" class="nav-link intrnllnk">Singular BVPs</a></li><li class="nav-item"><a href="#mw_abbd5eea-964e-4e3a-a59d-3b23db49924c" class="nav-link intrnllnk">BVP Solver Selection</a></li><li class="nav-item"><a href="#brfhdn3-10" class="nav-link intrnllnk">Evaluating the Solution</a></li><li class="nav-item"><a href="#brfhfsv-1" class="nav-link intrnllnk">BVP Examples and Files</a></li><li><a href="#References" class="intrnllnk">References</a></li><li class="nav-item"><a href="#d126e41705" class="nav-link intrnllnk">See Also</a></li></ul></div></div>
</nav></div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 d-none d-sm-block"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=boundary-value-problems&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=boundary-value-problems&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=boundary-value-problems&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></nav></div><div class="d-sm-none"><div class="container-fluid"><div class="row"><div class="col-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=boundary-value-problems&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=boundary-value-problems&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=boundary-value-problems&amp;s_tid=CRUX_topnav">Apps</a></li></ul></div></div></div><div class="col-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-12">

<main id="skip_link_anchor" tabindex="-1">
<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-topic">
<section><h2 class="title r2025b" itemprop="title content" id="f1-713877">Solving Boundary Value Problems</h2><span id="bvp_problems" class="anchor_target"></span><p>In a <span class="emphasis"><em>boundary value problem</em></span> (BVP), the goal is to find a solution
            to an ordinary differential equation (ODE) that also satisfies certain specified
                <span class="emphasis"><em>boundary conditions</em></span>. The boundary conditions specify a
            relationship between the values of the solution at two or more locations in the interval
            of integration. In the simplest case, the boundary conditions apply at the beginning and
            end (or boundaries) of the interval. </p><p>The MATLAB<sup>&#x00AE;</sup> BVP solvers <code class="function">bvp4c</code> and <code class="function">bvp5c</code> are
            designed to handle systems of ODEs of the form</p><div id="d126e41128" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-8px" display="block"><mrow><mi>y</mi><mo>'</mo><mo>=</mo><mi>f</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi></mrow><mo>)</mo></mrow></mrow></math></p></div></div><p>where:</p>
<div class="itemizedlist"><ul><li><p><em class="varname">x</em> is the independent variable</p></li><li><p><em class="varname">y</em> is the dependent variable</p></li><li><p><em class="varname">y</em>′ represents the derivative of <em class="varname">y</em>
                        with respect to <em class="varname">x</em>, also written as
                            <em class="varname">dy</em>/<em class="varname">dx</em></p></li></ul></div><p>

        </p><section><h3 class="title" id="mw_21222c6f-dff3-4ba2-8711-61ce70a6fb3e">Boundary Conditions</h3><p>In the simplest case of a <span class="emphasis"><em>two-point BVP</em></span>, the solution to the
                ODE is sought on an interval [<em class="varname">a</em>, <em class="varname">b</em>], and must
                satisfy the boundary conditions</p><div id="d126e41165" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-9px" display="block"><mrow><mi>g</mi><mrow><mo>(</mo><mrow><mi>y</mi><mrow><mo>(</mo><mi>a</mi><mo>)</mo></mrow><mo>,</mo><mi>y</mi><mrow><mo>(</mo><mi>b</mi><mo>)</mo></mrow></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn><mtext> </mtext><mo>.</mo></mrow></math></p></div></div><p>To specify the boundary conditions for a given BVP, you must:</p>
<div class="itemizedlist"><ul><li><p>Write a function of the form <code class="literal">res = bcfun(ya,yb)</code>, or
                            use the form <code class="literal">res = bcfun(ya,yb,p)</code> if there are
                            unknown parameters involved. You supply this function to the solver as
                            the second input argument. The function returns <code class="literal">res</code>,
                            which is the residual value of the solution at the boundary point. For
                            example, if <em class="varname">y(a) = 1</em> and <em class="varname">y(b) = 0</em>,
                            then the boundary condition function
                            is<div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> res = bcfun(ya,yb)
res = [ya(1)-1
       yb(1)];
<span style="color:#0000FF">end</span></pre></div></div></div></p></li><li><p>In the initial guess for the solution, the first and last points in
                            the mesh specify the points at which the boundary conditions are
                            enforced. For the above boundary conditions, you can specify
                                <code class="literal">bvpinit(linspace(a,b,5),yinit)</code> to enforce the
                            boundary conditions at <em class="varname">a</em> and
                            <em class="varname">b</em>.</p></li></ul></div><p>
</p><p>The BVP solvers in MATLAB also can accommodate other types of problems that have:</p><div class="itemizedlist"><ul><li><p>Unknown parameters <em class="varname">p</em></p></li><li><p>Singularities in the solutions</p></li><li><p>Multipoint conditions (internal boundaries that separate the integration
                        interval into several regions)</p></li></ul></div><p>In the case of <span class="emphasis"><em>multipoint boundary conditions</em></span>, the boundary
                conditions apply at more than two points in the interval of integration. For
                example, the solution might be required to be zero at the beginning, middle, and end
                of the interval. See <a href="../ref/bvpinit.html"><code class="function">bvpinit</code></a> for details on how to
                specify multiple boundary conditions.</p></section><section><h3 class="title" id="f1-694073">Initial Guess of Solution</h3><p>Unlike initial value problems, a boundary value problem can have:</p>
<div class="itemizedlist"><ul><li><p>No solution</p></li><li><p>A finite number of solutions</p></li><li><p>Infinitely many solutions</p></li></ul></div><p>
 An important part of the process of solving a BVP is providing a
                guess for the required solution. The quality of this guess can be critical for the
                solver performance and even for a successful computation.</p><p>Use the <a href="../ref/bvpinit.html"><code class="function">bvpinit</code></a> function to create a
                structure for the initial guess of the solution. The solvers
                    <code class="function">bvp4c</code> and <code class="function">bvp5c</code> accept this structure
                as the third input argument.</p><p>Creating a good initial guess for the solution is more an art than a science.
                However, some general guidelines include:</p>
<div class="itemizedlist"><ul><li><p>Have the initial guess satisfy the boundary conditions, since the
                            solution is required to satisfy them as well. If the problem contains
                            unknown parameters, then the initial guess for the parameters also
                            should satisfy the boundary conditions.</p></li><li><p>Try to incorporate as much information about the physical problem or
                            expected solution into the initial guess as possible. For example, if
                            the solution is supposed to oscillate or have a certain number of sign
                            changes, then the initial guess should as well.</p></li><li><p>Consider the placement of the mesh points (the x-coordinates of the
                            initial guess of the solution). The BVP solvers adapt these points
                            during the solution process, so you do not need to specify too many mesh
                            points. Best practice is to specify a few mesh points placed near where
                            the solution changes rapidly.</p></li><li><p>If there is a known, simpler solution on a smaller interval, then use
                            it as an initial guess on a larger interval. Often you can solve a
                            problem as a series of relatively simpler problems, a practice called
                                <span class="emphasis"><em>continuation</em></span>. With continuation, a series of
                            simple problems are connected by using the solution of one problem as
                            the initial guess to solve the next problem.</p></li></ul></div><p>
</p></section><section><h3 class="title" id="mw_708d0907-70e4-4132-af20-5b75f359ff37">Finding Unknown Parameters</h3><p>Often BVPs involve unknown parameters <em class="varname">p</em> that have to be
                determined as part of solving the problem. The ODE and boundary conditions
                become</p><div id="d126e41259" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-20px" display="block"><mtable columnalign="left"><mtr><mtd><mi>y</mi><mo>'</mo><mo>=</mo><mi>f</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>p</mi></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mi>g</mi><mrow><mo>(</mo><mrow><mi>y</mi><mrow><mo>(</mo><mi>a</mi><mo>)</mo></mrow><mo>,</mo><mi>y</mi><mrow><mo>(</mo><mi>b</mi><mo>)</mo></mrow><mo>,</mo><mi>p</mi></mrow><mo>)</mo></mrow><mo>=</mo><mn>0</mn></mtd></mtr></mtable></math></p></div></div><p>In this case, the boundary conditions must suffice to determine the values of the
                parameters <em class="varname">p</em>. </p><p>You must provide the solver with an initial guess for any unknown parameters. When
                you call <a href="../ref/bvpinit.html"><code class="function">bvpinit</code></a> to create the structure
                    <code class="literal">solinit</code>, specify the initial guess as a vector in the third
                input argument <code class="literal">parameters</code>.</p><div class="code_responsive"><pre class="programlisting">solinit = bvpinit(x,v,parameters)</pre></div><p>Additionally, the functions <code class="literal">odefun</code> and <code class="literal">bcfun</code>
                that encode the ODE equations and boundary conditions must each have a third
                argument.</p><div class="code_responsive"><pre class="programlisting">dydx = odefun(x,y,parameters)
res = bcfun(ya,yb,parameters)</pre></div><p>While solving the differential equations, the solver adjusts the value of the
                unknown parameters to satisfy the boundary conditions. The solver returns the final
                values of these unknown parameters in <code class="literal">sol.parameters</code>.</p></section><section><h3 class="title" id="brfhd0w">Singular BVPs</h3><p><code class="function">bvp4c</code> and <code class="function">bvp5c</code> can solve a class of
                singular BVPs of the form</p><div id="d126e41295" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-27px" display="block"><mtable><mtr><mtd><msup><mi>y</mi><mo>′</mo></msup><mo>=</mo><mfrac><mn>1</mn><mi>x</mi></mfrac><mi>S</mi><mi>y</mi><mo>+</mo><mi>f</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi></mrow><mo>)</mo></mrow><mo>,</mo></mtd></mtr><mtr><mtd><mn>0</mn><mo>=</mo><mi>g</mi><mrow><mo>(</mo><mrow><mi>y</mi><mrow><mo>(</mo><mn>0</mn><mo>)</mo></mrow><mo>,</mo><mi>y</mi><mrow><mo>(</mo><mi>b</mi><mo>)</mo></mrow></mrow><mo>)</mo></mrow><mo>.</mo></mtd></mtr></mtable></math></p></div></div><p>The solvers can also accommodate unknown parameters for problems of the form </p><div id="d126e41300" class="mediaobject"><div class="code_responsive"><p class="programlistingindent"><math xmlns="http://www.w3.org/1998/Math/MathML" altimg-valign="-27px" display="block"><mtable><mtr><mtd><msup><mi>y</mi><mo>′</mo></msup><mo>=</mo><mfrac><mn>1</mn><mi>x</mi></mfrac><mi>S</mi><mi>y</mi><mo>+</mo><mi>f</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>p</mi></mrow><mo>)</mo></mrow><mo>,</mo></mtd></mtr><mtr><mtd><mn>0</mn><mo>=</mo><mi>g</mi><mrow><mo>(</mo><mrow><mi>y</mi><mrow><mo>(</mo><mn>0</mn><mo>)</mo></mrow><mo>,</mo><mi>y</mi><mrow><mo>(</mo><mi>b</mi><mo>)</mo></mrow><mo>,</mo><mi>p</mi></mrow><mo>)</mo></mrow><mo>.</mo></mtd></mtr></mtable></math></p></div></div><p>Singular problems must be posed on an interval [0,<em class="varname">b</em>] with
                    <em class="varname">b</em> &gt; 0. Use <a href="../ref/bvpset.html"><code class="function">bvpset</code></a> to pass the constant matrix
                    <em class="varname">S</em> to the solver as the value of the
                    <code class="literal">'SingularTerm'</code> option. Boundary conditions at
                    <em class="varname">x</em> = 0 must be consistent with the necessary condition for a
                smooth solution, <em class="varname">Sy</em>(0) = 0. The initial guess of the solution
                also should satisfy this condition.</p><p>When you solve a singular BVP, the solver requires that your function
                    <code class="literal">odefun(x,y)</code> return only the value of the
                    <em class="varname">f</em>(<em class="varname">x</em>, <em class="varname">y</em>) term in the
                equation. The term involving <em class="varname">S</em> is handled by the solver
                separately using the <code class="literal">'SingularTerm'</code> option.</p></section><section><h3 class="title" id="mw_abbd5eea-964e-4e3a-a59d-3b23db49924c">BVP Solver Selection</h3><p>MATLAB includes the solvers <code class="function">bvp4c</code> and
                    <code class="function">bvp5c</code> to solve BVPs. In most cases you can use the solvers
                interchangeably. The main difference between the solvers is that
                    <code class="function">bvp4c</code> implements a fourth-order formula, while
                    <code class="function">bvp5c</code> implements a fifth-order formula.</p><p> The <a href="../ref/bvp5c.html"><code class="function">bvp5c</code></a> function is used exactly
                like <code class="function">bvp4c</code>, with the exception of the meaning of error
                tolerances between the two solvers. If <em class="varname">S</em>(<em class="varname">x</em>)
                approximates the solution <em class="varname">y(x)</em>, <code class="function">bvp4c</code>
                controls the residual
                    |<em class="varname">S</em>′(<em class="varname">x</em>)&nbsp;&#8211;&nbsp;<em class="varname">f</em>(<em class="varname">x</em>,<em class="varname">S</em>(<em class="varname">x</em>))|.
                This approach indirectly controls the true error
                    |<em class="varname">y</em>(<em class="varname">x</em>) &#8211;
                    <em class="varname">S</em>(<em class="varname">x</em>)|. Use <code class="function">bvp5c</code> to
                control the true error directly.</p><div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="50%"><col class="tcol2" width="50%"></colgroup><thead><tr><th>Solver</th><th>Description</th></tr></thead><tbody><tr><td><p><a href="../ref/bvp4c.html"><code class="function">bvp4c</code></a></p></td><td><p><code class="function">bvp4c</code> is a finite difference code that
                                    implements the 3-stage Lobatto IIIa formula. This is a
                                    collocation formula, and the collocation polynomial provides a
                                        C<sup>1</sup>-continuous solution that is
                                    fourth-order accurate uniformly in the interval of integration.
                                    Mesh selection and error control are based on the residual of
                                    the continuous solution.</p><p>The collocation technique
                                    uses a mesh of points to divide the interval of integration into
                                    subintervals. The solver determines a numerical solution by
                                    solving a global system of algebraic equations resulting from
                                    the boundary conditions and the collocation conditions imposed
                                    on all the subintervals. The solver then estimates the error of
                                    the numerical solution on each subinterval. If the solution does
                                    not satisfy the tolerance criteria, then the solver adapts the
                                    mesh and repeats the process. You <span class="emphasis"><em>must</em></span>
                                    provide the points of the initial mesh, as well as an initial
                                    approximation of the solution at the mesh points.</p></td></tr><tr><td><p><a href="../ref/bvp5c.html"><code class="function">bvp5c</code></a></p></td><td><code class="function">bvp5c</code> is a finite difference code that
                                implements the four-stage Lobatto IIIa formula. This is a
                                collocation formula and the collocation polynomial provides a
                                    C<sup>1</sup>-continuous solution that is
                                fifth-order accurate uniformly in [a,b]. The formula is implemented
                                as an implicit Runge-Kutta formula. <code class="function">bvp5c</code>
                                solves the algebraic equations directly, whereas
                                    <code class="function">bvp4c</code> uses analytical condensation.
                                    <code class="function">bvp4c</code> handles unknown parameters directly,
                                while <code class="function">bvp5c</code> augments the system with trivial
                                differential equations for unknown parameters.</td></tr></tbody></table></div></section><section><h3 class="title" id="brfhdn3-10">Evaluating the Solution</h3><p>The collocation methods implemented in <code class="function">bvp4c</code> and
                    <code class="function">bvp5c</code> produce C<sup>1</sup>-continuous
                solutions over the interval of integration
                    [<em class="varname">a</em>,<em class="varname">b</em>]. You can evaluate the approximate
                solution, <em class="varname">S</em>(<em class="varname">x</em>), at any point in
                    [<em class="varname">a</em>,<em class="varname">b</em>] using the helper function
                    <code class="literal">deval</code> and the structure <code class="literal">sol</code> returned by
                the solver. For example, to evaluate the solution <code class="literal">sol</code> at the mesh
                of points <code class="literal">xint</code>, use the command</p><div class="code_responsive"><pre class="programlisting">Sxint = deval(sol,xint)</pre></div><p>The <code class="function">deval</code> function is vectorized. For a vector
                    <code class="literal">xint</code>, the <code class="literal">i</code>th column of
                    <code class="literal">Sxint</code> approximates the solution
                <code class="literal">y(xint(i))</code>.</p></section><section><h3 class="title" id="brfhfsv-1">BVP Examples and Files</h3><p>Several available example files serve as excellent starting points for most common
                BVP problems. To easily explore and run examples, simply use the <strong class="emphasis bold">Differential Equations Examples</strong> app. To run this app,
                type<div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>odeexamples</pre></div></div></div>To open an
                individual example file for editing,
                type<div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>edit <span style="color:#A020F0">exampleFileName.m</span></pre></div></div></div>To
                run an example,
                type<div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>exampleFileName</pre></div></div></div></p><p>This table contains a list of the available BVP example files, as well as the
                solvers and the options they use.</p><div class="table-responsive"><table class="table table-condensed"><colgroup><col class="tcol1" width="11%"><col class="tcol2" width="20%"><col class="tcol3" width="20%"><col class="tcol4" width="29%"><col class="tcol5" width="20%"></colgroup><thead><tr><th><p>Example File</p></th><th>Solver Used</th><th>Options Specified</th><th><p>Description</p></th><th>Example Link</th></tr></thead><tbody><tr><td><p id="brfhfsv-2"><code class="literal">emdenbvp</code></p></td><td><p><code class="function">bvp4c</code> or
                                    <code class="function">bvp5c</code></p></td><td><p>
                                    </p>
<div class="itemizedlist"><ul><li><p><code class="literal">'SingularTerm'</code></p></li></ul></div><p>

                                </p></td><td><p>Emden's equation, a singular BVP</p></td><td><p>
                                    <a href="solve-bvp-with-singular-term.html" class="a">Solve BVP with Singular Term</a>
                                </p></td></tr><tr><td><p id="brfhfsv-3"><code class="literal">fsbvp</code></p></td><td><p><code class="function">bvp4c</code> or
                                    <code class="function">bvp5c</code></p></td><td><p>&#8212;</p></td><td><p>Falkner-Skan BVP on an infinite interval</p></td><td><p>
                                    <a href="verify-bvp-consistency-using-continuation.html" class="a">Verify BVP Consistency Using Continuation</a>
                                </p></td></tr><tr><td><p id="brfhfsv-4"><code class="literal">mat4bvp</code></p></td><td><p><code class="function">bvp4c</code> or
                                    <code class="function">bvp5c</code></p></td><td><p>&#8212;</p></td><td><p>Fourth eigenfunction of Mathieu's equation</p></td><td><p>
                                    <a href="solve-bvp-with-unknown-parameter.html" class="a">Solve BVP with Unknown Parameter</a>
                                </p></td></tr><tr><td><p><code class="literal">rcbvp</code></p></td><td><p><code class="function">bvp4c</code> and
                                    <code class="function">bvp5c</code></p></td><td><p>
                                    </p>
<div class="itemizedlist"><ul><li><p><code class="literal">'FJacobian'</code></p></li><li><p><code class="literal">'AbsTol'</code></p></li><li><p><code class="literal">'RelTol'</code></p></li><li><p><code class="literal">'Stats'</code></p></li></ul></div><p>

                                </p></td><td><p>Example comparing the errors controlled by
                                        <code class="function">bvp4c</code> and
                                    <code class="function">bvp5c</code></p></td><td><p><a href="../ref/bvp4c.html#mw_98a60189-597b-435f-96bb-a8f1c64768b1" class="a">Compare bvp4c and bvp5c Solvers</a> (<code class="literal">bvp4c</code>)</p><p><a href="../ref/bvp5c.html#mw_5f68e7f8-a167-4d62-bba0-0d1bf9d35734" class="a">Compare bvp4c and bvp5c Solvers</a> (<code class="literal">bvp5c</code>)</p></td></tr><tr><td><p id="brfhfsv-5"><code class="literal">shockbvp</code></p></td><td><p><code class="function">bvp4c</code> or
                                    <code class="function">bvp5c</code></p></td><td><p>
                                    </p>
<div class="itemizedlist"><ul><li><p><code class="literal">'FJacobian'</code></p></li><li><p><code class="literal">'BCJacobian'</code></p></li><li><p><code class="literal">'Vectorized'</code></p></li></ul></div><p>

                                </p></td><td><p>Solution with a shock layer near x = 0</p></td><td><p>
                                    <a href="solve-bvp-using-continuation.html" class="a">Solve BVP Using Continuation</a>
                                </p></td></tr><tr><td><p id="brfhfsv-6"><code class="literal">twobvp</code></p></td><td><p><code class="function">bvp4c</code></p></td><td><p>&#8212;</p></td><td><p>BVP with exactly two solutions</p></td><td><p>
                                    <a href="solve-bvp-with-two-solutions.html" class="a">Solve BVP with Two Solutions</a>
                                </p></td></tr><tr><td><p id="brfhfsv-7"><code class="literal">threebvp</code></p></td><td><p><code class="function">bvp4c</code> or
                                    <code class="function">bvp5c</code></p></td><td><p>&#8212;</p></td><td><p>Three-point boundary value problem</p></td><td><p>
                                    <a href="solve-bvp-with-multiple-boundary-conditions.html" class="a">Solve BVP with Multiple Boundary Conditions</a>
                                </p></td></tr></tbody></table></div></section><div class="bibliography"><h2 id="References">References</h2><div id="bu8tnl7" class="bibliomixed"><p>[1] Ascher, U., R. Mattheij, and R. Russell.
                    “<em class="citetitle">Numerical Solution of Boundary Value Problems for Ordinary
                    Differential Equations</em>.” Philadelphia, PA: SIAM, 1995, p.
                372.</p></div><div id="mw_ee311e54-7f7c-4308-bb63-25b1a09ecacb" class="bibliomixed"><p>[2] Shampine, L.F., and J.
                Kierzenka. "A BVP Solver based on residual control and the MATLAB PSE." <span class="emphasis"><em>ACM Trans. Math. Softw.</em></span> Vol. 27, Number 3, 2001, pp.
                299&#8211;316.</p></div><div id="mw_0e86fe3b-7b3f-4a9f-8d05-865f9b8de031" class="bibliomixed"><p>[3] Shampine, L.F., M.W.
                Reichelt, and J. Kierzenka. "<a href="https://www.mathworks.com/matlabcentral/fileexchange/3819-tutorial-on-solving-bvps-with-bvp4c">Solving Boundary Value Problems for Ordinary Differential Equations in MATLAB
                    with bvp4c</a>." <em class="citetitle">MATLAB File Exchange</em>,
                2004.</p></div><div id="mw_8e64485c-2eab-4fee-8a44-747903e81603" class="bibliomixed"><p>[4] Shampine, L.F., and J.
                Kierzenka. "A BVP Solver that Controls Residual and Error." <em class="citetitle">J. Numer.
                    Anal. Ind. Appl. Math.</em> Vol. 3(1-2), 2008, pp. 27&#8211;41.</p></div></div>
            <h2 id="d126e41705">See Also</h2><p><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/bvp4c.html"><span itemprop="name"><code class="function">bvp4c</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/bvp5c.html"><span itemprop="name"><code class="function">bvp5c</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/bvpinit.html"><span itemprop="name"><code class="function">bvpinit</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/bvpset.html"><span itemprop="name"><code class="function">bvpset</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/pdepe.html"><span itemprop="name"><code class="function">pdepe</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/ode45.html"><span itemprop="name"><code class="function">ode45</code></span></a></span></p>
            
            
            
        </section>
    </div></section><div xmlns="http://www.w3.org/1999/xhtml" class="clearfix"></div>
<div xmlns="http://www.w3.org/1999/xhtml" align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></main>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-12">
<p class="copyright">© 1994-2025 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>
